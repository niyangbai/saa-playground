var LK=Object.defineProperty;var BK=(e,t,n)=>t in e?LK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Pu=(e,t,n)=>BK(e,typeof t!="symbol"?t+"":t,n);function zK(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Sg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Be(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function jK(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var X1={exports:{}},lh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XR;function UK(){if(XR)return lh;XR=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,i,a){var s=null;if(a!==void 0&&(s=""+a),i.key!==void 0&&(s=""+i.key),"key"in i){a={};for(var o in i)o!=="key"&&(a[o]=i[o])}else a=i;return i=a.ref,{$$typeof:e,type:r,key:s,ref:i!==void 0?i:null,props:a}}return lh.Fragment=t,lh.jsx=n,lh.jsxs=n,lh}var KR;function VK(){return KR||(KR=1,X1.exports=UK()),X1.exports}var Kt=VK(),K1={exports:{}},ee={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YR;function WK(){if(YR)return ee;YR=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function p(F){return F===null||typeof F!="object"?null:(F=d&&F[d]||F["@@iterator"],typeof F=="function"?F:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function b(F,G,H){this.props=F,this.context=G,this.refs=x,this.updater=H||g}b.prototype.isReactComponent={},b.prototype.setState=function(F,G){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,G,"setState")},b.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function w(){}w.prototype=b.prototype;function C(F,G,H){this.props=F,this.context=G,this.refs=x,this.updater=H||g}var T=C.prototype=new w;T.constructor=C,v(T,b.prototype),T.isPureReactComponent=!0;var $=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},E=Object.prototype.hasOwnProperty;function O(F,G,H,Y,ot,ht){return H=ht.ref,{$$typeof:e,type:F,key:G,ref:H!==void 0?H:null,props:ht}}function N(F,G){return O(F.type,G,void 0,void 0,void 0,F.props)}function _(F){return typeof F=="object"&&F!==null&&F.$$typeof===e}function R(F){var G={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(H){return G[H]})}var I=/\/+/g;function P(F,G){return typeof F=="object"&&F!==null&&F.key!=null?R(""+F.key):G.toString(36)}function B(){}function V(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(B,B):(F.status="pending",F.then(function(G){F.status==="pending"&&(F.status="fulfilled",F.value=G)},function(G){F.status==="pending"&&(F.status="rejected",F.reason=G)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function z(F,G,H,Y,ot){var ht=typeof F;(ht==="undefined"||ht==="boolean")&&(F=null);var yt=!1;if(F===null)yt=!0;else switch(ht){case"bigint":case"string":case"number":yt=!0;break;case"object":switch(F.$$typeof){case e:case t:yt=!0;break;case h:return yt=F._init,z(yt(F._payload),G,H,Y,ot)}}if(yt)return ot=ot(F),yt=Y===""?"."+P(F,0):Y,$(ot)?(H="",yt!=null&&(H=yt.replace(I,"$&/")+"/"),z(ot,G,H,"",function(mt){return mt})):ot!=null&&(_(ot)&&(ot=N(ot,H+(ot.key==null||F&&F.key===ot.key?"":(""+ot.key).replace(I,"$&/")+"/")+yt)),G.push(ot)),1;yt=0;var It=Y===""?".":Y+":";if($(F))for(var $t=0;$t<F.length;$t++)Y=F[$t],ht=It+P(Y,$t),yt+=z(Y,G,H,ht,ot);else if($t=p(F),typeof $t=="function")for(F=$t.call(F),$t=0;!(Y=F.next()).done;)Y=Y.value,ht=It+P(Y,$t++),yt+=z(Y,G,H,ht,ot);else if(ht==="object"){if(typeof F.then=="function")return z(V(F),G,H,Y,ot);throw G=String(F),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return yt}function M(F,G,H){if(F==null)return F;var Y=[],ot=0;return z(F,Y,"","",function(ht){return G.call(H,ht,ot++)}),Y}function U(F){if(F._status===-1){var G=F._result;G=G(),G.then(function(H){(F._status===0||F._status===-1)&&(F._status=1,F._result=H)},function(H){(F._status===0||F._status===-1)&&(F._status=2,F._result=H)}),F._status===-1&&(F._status=0,F._result=G)}if(F._status===1)return F._result.default;throw F._result}var W=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function q(){}return ee.Children={map:M,forEach:function(F,G,H){M(F,function(){G.apply(this,arguments)},H)},count:function(F){var G=0;return M(F,function(){G++}),G},toArray:function(F){return M(F,function(G){return G})||[]},only:function(F){if(!_(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},ee.Component=b,ee.Fragment=n,ee.Profiler=i,ee.PureComponent=C,ee.StrictMode=r,ee.Suspense=l,ee.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ee.__COMPILER_RUNTIME={__proto__:null,c:function(F){return A.H.useMemoCache(F)}},ee.cache=function(F){return function(){return F.apply(null,arguments)}},ee.cloneElement=function(F,G,H){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var Y=v({},F.props),ot=F.key,ht=void 0;if(G!=null)for(yt in G.ref!==void 0&&(ht=void 0),G.key!==void 0&&(ot=""+G.key),G)!E.call(G,yt)||yt==="key"||yt==="__self"||yt==="__source"||yt==="ref"&&G.ref===void 0||(Y[yt]=G[yt]);var yt=arguments.length-2;if(yt===1)Y.children=H;else if(1<yt){for(var It=Array(yt),$t=0;$t<yt;$t++)It[$t]=arguments[$t+2];Y.children=It}return O(F.type,ot,void 0,void 0,ht,Y)},ee.createContext=function(F){return F={$$typeof:s,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},ee.createElement=function(F,G,H){var Y,ot={},ht=null;if(G!=null)for(Y in G.key!==void 0&&(ht=""+G.key),G)E.call(G,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(ot[Y]=G[Y]);var yt=arguments.length-2;if(yt===1)ot.children=H;else if(1<yt){for(var It=Array(yt),$t=0;$t<yt;$t++)It[$t]=arguments[$t+2];ot.children=It}if(F&&F.defaultProps)for(Y in yt=F.defaultProps,yt)ot[Y]===void 0&&(ot[Y]=yt[Y]);return O(F,ht,void 0,void 0,null,ot)},ee.createRef=function(){return{current:null}},ee.forwardRef=function(F){return{$$typeof:o,render:F}},ee.isValidElement=_,ee.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:U}},ee.memo=function(F,G){return{$$typeof:c,type:F,compare:G===void 0?null:G}},ee.startTransition=function(F){var G=A.T,H={};A.T=H;try{var Y=F(),ot=A.S;ot!==null&&ot(H,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(q,W)}catch(ht){W(ht)}finally{A.T=G}},ee.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ee.use=function(F){return A.H.use(F)},ee.useActionState=function(F,G,H){return A.H.useActionState(F,G,H)},ee.useCallback=function(F,G){return A.H.useCallback(F,G)},ee.useContext=function(F){return A.H.useContext(F)},ee.useDebugValue=function(){},ee.useDeferredValue=function(F,G){return A.H.useDeferredValue(F,G)},ee.useEffect=function(F,G,H){var Y=A.H;if(typeof H=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(F,G)},ee.useId=function(){return A.H.useId()},ee.useImperativeHandle=function(F,G,H){return A.H.useImperativeHandle(F,G,H)},ee.useInsertionEffect=function(F,G){return A.H.useInsertionEffect(F,G)},ee.useLayoutEffect=function(F,G){return A.H.useLayoutEffect(F,G)},ee.useMemo=function(F,G){return A.H.useMemo(F,G)},ee.useOptimistic=function(F,G){return A.H.useOptimistic(F,G)},ee.useReducer=function(F,G,H){return A.H.useReducer(F,G,H)},ee.useRef=function(F){return A.H.useRef(F)},ee.useState=function(F){return A.H.useState(F)},ee.useSyncExternalStore=function(F,G,H){return A.H.useSyncExternalStore(F,G,H)},ee.useTransition=function(){return A.H.useTransition()},ee.version="19.1.0",ee}var ZR;function xA(){return ZR||(ZR=1,K1.exports=WK()),K1.exports}var Tt=xA();const et=Be(Tt);var Y1={exports:{}},uh={},Z1={exports:{}},Q1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QR;function GK(){return QR||(QR=1,function(e){function t(M,U){var W=M.length;M.push(U);t:for(;0<W;){var q=W-1>>>1,F=M[q];if(0<i(F,U))M[q]=U,M[W]=F,W=q;else break t}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var U=M[0],W=M.pop();if(W!==U){M[0]=W;t:for(var q=0,F=M.length,G=F>>>1;q<G;){var H=2*(q+1)-1,Y=M[H],ot=H+1,ht=M[ot];if(0>i(Y,W))ot<F&&0>i(ht,Y)?(M[q]=ht,M[ot]=W,q=ot):(M[q]=Y,M[H]=W,q=H);else if(ot<F&&0>i(ht,W))M[q]=ht,M[ot]=W,q=ot;else break t}}return U}function i(M,U){var W=M.sortIndex-U.sortIndex;return W!==0?W:M.id-U.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],h=1,d=null,p=3,g=!1,v=!1,x=!1,b=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function $(M){for(var U=n(c);U!==null;){if(U.callback===null)r(c);else if(U.startTime<=M)r(c),U.sortIndex=U.expirationTime,t(l,U);else break;U=n(c)}}function A(M){if(x=!1,$(M),!v)if(n(l)!==null)v=!0,E||(E=!0,P());else{var U=n(c);U!==null&&z(A,U.startTime-M)}}var E=!1,O=-1,N=5,_=-1;function R(){return b?!0:!(e.unstable_now()-_<N)}function I(){if(b=!1,E){var M=e.unstable_now();_=M;var U=!0;try{t:{v=!1,x&&(x=!1,C(O),O=-1),g=!0;var W=p;try{e:{for($(M),d=n(l);d!==null&&!(d.expirationTime>M&&R());){var q=d.callback;if(typeof q=="function"){d.callback=null,p=d.priorityLevel;var F=q(d.expirationTime<=M);if(M=e.unstable_now(),typeof F=="function"){d.callback=F,$(M),U=!0;break e}d===n(l)&&r(l),$(M)}else r(l);d=n(l)}if(d!==null)U=!0;else{var G=n(c);G!==null&&z(A,G.startTime-M),U=!1}}break t}finally{d=null,p=W,g=!1}U=void 0}}finally{U?P():E=!1}}}var P;if(typeof T=="function")P=function(){T(I)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,V=B.port2;B.port1.onmessage=I,P=function(){V.postMessage(null)}}else P=function(){w(I,0)};function z(M,U){O=w(function(){M(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(M){switch(p){case 1:case 2:case 3:var U=3;break;default:U=p}var W=p;p=U;try{return M()}finally{p=W}},e.unstable_requestPaint=function(){b=!0},e.unstable_runWithPriority=function(M,U){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var W=p;p=M;try{return U()}finally{p=W}},e.unstable_scheduleCallback=function(M,U,W){var q=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?q+W:q):W=q,M){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=W+F,M={id:h++,callback:U,priorityLevel:M,startTime:W,expirationTime:F,sortIndex:-1},W>q?(M.sortIndex=W,t(c,M),n(l)===null&&M===n(c)&&(x?(C(O),O=-1):x=!0,z(A,W-q))):(M.sortIndex=F,t(l,M),v||g||(v=!0,E||(E=!0,P()))),M},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(M){var U=p;return function(){var W=p;p=U;try{return M.apply(this,arguments)}finally{p=W}}}}(Q1)),Q1}var JR;function qK(){return JR||(JR=1,Z1.exports=GK()),Z1.exports}var J1={exports:{}},gr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tD;function HK(){if(tD)return gr;tD=1;var e=xA();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(l,c,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:d==null?null:""+d,children:l,containerInfo:c,implementation:h}}var s=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return gr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,gr.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return a(l,c,null,h)},gr.flushSync=function(l){var c=s.T,h=r.p;try{if(s.T=null,r.p=2,l)return l()}finally{s.T=c,r.p=h,r.d.f()}},gr.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},gr.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},gr.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var h=c.as,d=o(h,c.crossOrigin),p=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:p,fetchPriority:g}):h==="script"&&r.d.X(l,{crossOrigin:d,integrity:p,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},gr.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},gr.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,d=o(h,c.crossOrigin);r.d.L(l,h,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},gr.preloadModule=function(l,c){if(typeof l=="string")if(c){var h=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},gr.requestFormReset=function(l){r.d.r(l)},gr.unstable_batchedUpdates=function(l,c){return l(c)},gr.useFormState=function(l,c,h){return s.H.useFormState(l,c,h)},gr.useFormStatus=function(){return s.H.useHostTransitionStatus()},gr.version="19.1.0",gr}var eD;function XK(){if(eD)return J1.exports;eD=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),J1.exports=HK(),J1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nD;function KK(){if(nD)return uh;nD=1;var e=qK(),t=xA(),n=XK();function r(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function a(u){var f=u,m=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(m=f.return),u=f.return;while(u)}return f.tag===3?m:null}function s(u){if(u.tag===13){var f=u.memoizedState;if(f===null&&(u=u.alternate,u!==null&&(f=u.memoizedState)),f!==null)return f.dehydrated}return null}function o(u){if(a(u)!==u)throw Error(r(188))}function l(u){var f=u.alternate;if(!f){if(f=a(u),f===null)throw Error(r(188));return f!==u?null:u}for(var m=u,y=f;;){var S=m.return;if(S===null)break;var k=S.alternate;if(k===null){if(y=S.return,y!==null){m=y;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===m)return o(S),u;if(k===y)return o(S),f;k=k.sibling}throw Error(r(188))}if(m.return!==y.return)m=S,y=k;else{for(var D=!1,L=S.child;L;){if(L===m){D=!0,m=S,y=k;break}if(L===y){D=!0,y=S,m=k;break}L=L.sibling}if(!D){for(L=k.child;L;){if(L===m){D=!0,m=k,y=S;break}if(L===y){D=!0,y=k,m=S;break}L=L.sibling}if(!D)throw Error(r(189))}}if(m.alternate!==y)throw Error(r(190))}if(m.tag!==3)throw Error(r(188));return m.stateNode.current===m?u:f}function c(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=c(u),f!==null)return f;u=u.sibling}return null}var h=Object.assign,d=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function P(u){return u===null||typeof u!="object"?null:(u=I&&u[I]||u["@@iterator"],typeof u=="function"?u:null)}var B=Symbol.for("react.client.reference");function V(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===B?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case v:return"Fragment";case b:return"Profiler";case x:return"StrictMode";case A:return"Suspense";case E:return"SuspenseList";case _:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case g:return"Portal";case T:return(u.displayName||"Context")+".Provider";case C:return(u._context.displayName||"Context")+".Consumer";case $:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case O:return f=u.displayName||null,f!==null?f:V(u.type)||"Memo";case N:f=u._payload,u=u._init;try{return V(u(f))}catch{}}return null}var z=Array.isArray,M=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},q=[],F=-1;function G(u){return{current:u}}function H(u){0>F||(u.current=q[F],q[F]=null,F--)}function Y(u,f){F++,q[F]=u.current,u.current=f}var ot=G(null),ht=G(null),yt=G(null),It=G(null);function $t(u,f){switch(Y(yt,f),Y(ht,u),Y(ot,null),f.nodeType){case 9:case 11:u=(u=f.documentElement)&&(u=u.namespaceURI)?SR(u):0;break;default:if(u=f.tagName,f=f.namespaceURI)f=SR(f),u=CR(f,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}H(ot),Y(ot,u)}function mt(){H(ot),H(ht),H(yt)}function At(u){u.memoizedState!==null&&Y(It,u);var f=ot.current,m=CR(f,u.type);f!==m&&(Y(ht,u),Y(ot,m))}function kt(u){ht.current===u&&(H(ot),H(ht)),It.current===u&&(H(It),rh._currentValue=W)}var gt=Object.prototype.hasOwnProperty,Ut=e.unstable_scheduleCallback,Lt=e.unstable_cancelCallback,Zt=e.unstable_shouldYield,Wt=e.unstable_requestPaint,qt=e.unstable_now,fe=e.unstable_getCurrentPriorityLevel,Rn=e.unstable_ImmediatePriority,Ge=e.unstable_UserBlockingPriority,pn=e.unstable_NormalPriority,nn=e.unstable_LowPriority,Fr=e.unstable_IdlePriority,dr=e.log,Lr=e.unstable_setDisableYieldValue,Br=null,an=null;function er(u){if(typeof dr=="function"&&Lr(u),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Br,u)}catch{}}var Dn=Math.clz32?Math.clz32:P0,cf=Math.log,ff=Math.LN2;function P0(u){return u>>>=0,u===0?32:31-(cf(u)/ff|0)|0}var za=256,Yl=4194304;function ja(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function fm(u,f,m){var y=u.pendingLanes;if(y===0)return 0;var S=0,k=u.suspendedLanes,D=u.pingedLanes;u=u.warmLanes;var L=y&134217727;return L!==0?(y=L&~k,y!==0?S=ja(y):(D&=L,D!==0?S=ja(D):m||(m=L&~u,m!==0&&(S=ja(m))))):(L=y&~k,L!==0?S=ja(L):D!==0?S=ja(D):m||(m=y&~u,m!==0&&(S=ja(m)))),S===0?0:f!==0&&f!==S&&(f&k)===0&&(k=S&-S,m=f&-f,k>=m||k===32&&(m&4194048)!==0)?f:S}function hf(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function $8(u,f){switch(u){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aO(){var u=za;return za<<=1,(za&4194048)===0&&(za=256),u}function sO(){var u=Yl;return Yl<<=1,(Yl&62914560)===0&&(Yl=4194304),u}function F0(u){for(var f=[],m=0;31>m;m++)f.push(u);return f}function df(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function A8(u,f,m,y,S,k){var D=u.pendingLanes;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=m,u.entangledLanes&=m,u.errorRecoveryDisabledLanes&=m,u.shellSuspendCounter=0;var L=u.entanglements,K=u.expirationTimes,lt=u.hiddenUpdates;for(m=D&~m;0<m;){var bt=31-Dn(m),wt=1<<bt;L[bt]=0,K[bt]=-1;var ut=lt[bt];if(ut!==null)for(lt[bt]=null,bt=0;bt<ut.length;bt++){var ft=ut[bt];ft!==null&&(ft.lane&=-536870913)}m&=~wt}y!==0&&oO(u,y,0),k!==0&&S===0&&u.tag!==0&&(u.suspendedLanes|=k&~(D&~f))}function oO(u,f,m){u.pendingLanes|=f,u.suspendedLanes&=~f;var y=31-Dn(f);u.entangledLanes|=f,u.entanglements[y]=u.entanglements[y]|1073741824|m&4194090}function lO(u,f){var m=u.entangledLanes|=f;for(u=u.entanglements;m;){var y=31-Dn(m),S=1<<y;S&f|u[y]&f&&(u[y]|=f),m&=~S}}function L0(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function B0(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function uO(){var u=U.p;return u!==0?u:(u=window.event,u===void 0?32:UR(u.type))}function k8(u,f){var m=U.p;try{return U.p=u,f()}finally{U.p=m}}var Os=Math.random().toString(36).slice(2),pr="__reactFiber$"+Os,zr="__reactProps$"+Os,Zl="__reactContainer$"+Os,z0="__reactEvents$"+Os,E8="__reactListeners$"+Os,I8="__reactHandles$"+Os,cO="__reactResources$"+Os,pf="__reactMarker$"+Os;function j0(u){delete u[pr],delete u[zr],delete u[z0],delete u[E8],delete u[I8]}function Ql(u){var f=u[pr];if(f)return f;for(var m=u.parentNode;m;){if(f=m[Zl]||m[pr]){if(m=f.alternate,f.child!==null||m!==null&&m.child!==null)for(u=kR(u);u!==null;){if(m=u[pr])return m;u=kR(u)}return f}u=m,m=u.parentNode}return null}function Jl(u){if(u=u[pr]||u[Zl]){var f=u.tag;if(f===5||f===6||f===13||f===26||f===27||f===3)return u}return null}function mf(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u.stateNode;throw Error(r(33))}function tu(u){var f=u[cO];return f||(f=u[cO]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function Wn(u){u[pf]=!0}var fO=new Set,hO={};function Do(u,f){eu(u,f),eu(u+"Capture",f)}function eu(u,f){for(hO[u]=f,u=0;u<f.length;u++)fO.add(f[u])}var O8=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),dO={},pO={};function N8(u){return gt.call(pO,u)?!0:gt.call(dO,u)?!1:O8.test(u)?pO[u]=!0:(dO[u]=!0,!1)}function hm(u,f,m){if(N8(f))if(m===null)u.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":u.removeAttribute(f);return;case"boolean":var y=f.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){u.removeAttribute(f);return}}u.setAttribute(f,""+m)}}function dm(u,f,m){if(m===null)u.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(f);return}u.setAttribute(f,""+m)}}function Ua(u,f,m,y){if(y===null)u.removeAttribute(m);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(m);return}u.setAttributeNS(f,m,""+y)}}var U0,mO;function nu(u){if(U0===void 0)try{throw Error()}catch(m){var f=m.stack.trim().match(/\n( *(at )?)/);U0=f&&f[1]||"",mO=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+U0+u+mO}var V0=!1;function W0(u,f){if(!u||V0)return"";V0=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(f){var wt=function(){throw Error()};if(Object.defineProperty(wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(wt,[])}catch(ft){var ut=ft}Reflect.construct(u,[],wt)}else{try{wt.call()}catch(ft){ut=ft}u.call(wt.prototype)}}else{try{throw Error()}catch(ft){ut=ft}(wt=u())&&typeof wt.catch=="function"&&wt.catch(function(){})}}catch(ft){if(ft&&ut&&typeof ft.stack=="string")return[ft.stack,ut.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=y.DetermineComponentFrameRoot(),D=k[0],L=k[1];if(D&&L){var K=D.split(`
`),lt=L.split(`
`);for(S=y=0;y<K.length&&!K[y].includes("DetermineComponentFrameRoot");)y++;for(;S<lt.length&&!lt[S].includes("DetermineComponentFrameRoot");)S++;if(y===K.length||S===lt.length)for(y=K.length-1,S=lt.length-1;1<=y&&0<=S&&K[y]!==lt[S];)S--;for(;1<=y&&0<=S;y--,S--)if(K[y]!==lt[S]){if(y!==1||S!==1)do if(y--,S--,0>S||K[y]!==lt[S]){var bt=`
`+K[y].replace(" at new "," at ");return u.displayName&&bt.includes("<anonymous>")&&(bt=bt.replace("<anonymous>",u.displayName)),bt}while(1<=y&&0<=S);break}}}finally{V0=!1,Error.prepareStackTrace=m}return(m=u?u.displayName||u.name:"")?nu(m):""}function _8(u){switch(u.tag){case 26:case 27:case 5:return nu(u.type);case 16:return nu("Lazy");case 13:return nu("Suspense");case 19:return nu("SuspenseList");case 0:case 15:return W0(u.type,!1);case 11:return W0(u.type.render,!1);case 1:return W0(u.type,!0);case 31:return nu("Activity");default:return""}}function gO(u){try{var f="";do f+=_8(u),u=u.return;while(u);return f}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function gi(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function yO(u){var f=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function R8(u){var f=yO(u)?"checked":"value",m=Object.getOwnPropertyDescriptor(u.constructor.prototype,f),y=""+u[f];if(!u.hasOwnProperty(f)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,k=m.set;return Object.defineProperty(u,f,{configurable:!0,get:function(){return S.call(this)},set:function(D){y=""+D,k.call(this,D)}}),Object.defineProperty(u,f,{enumerable:m.enumerable}),{getValue:function(){return y},setValue:function(D){y=""+D},stopTracking:function(){u._valueTracker=null,delete u[f]}}}}function pm(u){u._valueTracker||(u._valueTracker=R8(u))}function vO(u){if(!u)return!1;var f=u._valueTracker;if(!f)return!0;var m=f.getValue(),y="";return u&&(y=yO(u)?u.checked?"true":"false":u.value),u=y,u!==m?(f.setValue(u),!0):!1}function mm(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var D8=/[\n"\\]/g;function yi(u){return u.replace(D8,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function G0(u,f,m,y,S,k,D,L){u.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?u.type=D:u.removeAttribute("type"),f!=null?D==="number"?(f===0&&u.value===""||u.value!=f)&&(u.value=""+gi(f)):u.value!==""+gi(f)&&(u.value=""+gi(f)):D!=="submit"&&D!=="reset"||u.removeAttribute("value"),f!=null?q0(u,D,gi(f)):m!=null?q0(u,D,gi(m)):y!=null&&u.removeAttribute("value"),S==null&&k!=null&&(u.defaultChecked=!!k),S!=null&&(u.checked=S&&typeof S!="function"&&typeof S!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?u.name=""+gi(L):u.removeAttribute("name")}function bO(u,f,m,y,S,k,D,L){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(u.type=k),f!=null||m!=null){if(!(k!=="submit"&&k!=="reset"||f!=null))return;m=m!=null?""+gi(m):"",f=f!=null?""+gi(f):m,L||f===u.value||(u.value=f),u.defaultValue=f}y=y??S,y=typeof y!="function"&&typeof y!="symbol"&&!!y,u.checked=L?u.checked:!!y,u.defaultChecked=!!y,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(u.name=D)}function q0(u,f,m){f==="number"&&mm(u.ownerDocument)===u||u.defaultValue===""+m||(u.defaultValue=""+m)}function ru(u,f,m,y){if(u=u.options,f){f={};for(var S=0;S<m.length;S++)f["$"+m[S]]=!0;for(m=0;m<u.length;m++)S=f.hasOwnProperty("$"+u[m].value),u[m].selected!==S&&(u[m].selected=S),S&&y&&(u[m].defaultSelected=!0)}else{for(m=""+gi(m),f=null,S=0;S<u.length;S++){if(u[S].value===m){u[S].selected=!0,y&&(u[S].defaultSelected=!0);return}f!==null||u[S].disabled||(f=u[S])}f!==null&&(f.selected=!0)}}function xO(u,f,m){if(f!=null&&(f=""+gi(f),f!==u.value&&(u.value=f),m==null)){u.defaultValue!==f&&(u.defaultValue=f);return}u.defaultValue=m!=null?""+gi(m):""}function wO(u,f,m,y){if(f==null){if(y!=null){if(m!=null)throw Error(r(92));if(z(y)){if(1<y.length)throw Error(r(93));y=y[0]}m=y}m==null&&(m=""),f=m}m=gi(f),u.defaultValue=m,y=u.textContent,y===m&&y!==""&&y!==null&&(u.value=y)}function iu(u,f){if(f){var m=u.firstChild;if(m&&m===u.lastChild&&m.nodeType===3){m.nodeValue=f;return}}u.textContent=f}var M8=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function SO(u,f,m){var y=f.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?y?u.setProperty(f,""):f==="float"?u.cssFloat="":u[f]="":y?u.setProperty(f,m):typeof m!="number"||m===0||M8.has(f)?f==="float"?u.cssFloat=m:u[f]=(""+m).trim():u[f]=m+"px"}function CO(u,f,m){if(f!=null&&typeof f!="object")throw Error(r(62));if(u=u.style,m!=null){for(var y in m)!m.hasOwnProperty(y)||f!=null&&f.hasOwnProperty(y)||(y.indexOf("--")===0?u.setProperty(y,""):y==="float"?u.cssFloat="":u[y]="");for(var S in f)y=f[S],f.hasOwnProperty(S)&&m[S]!==y&&SO(u,S,y)}else for(var k in f)f.hasOwnProperty(k)&&SO(u,k,f[k])}function H0(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P8=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),F8=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gm(u){return F8.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var X0=null;function K0(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var au=null,su=null;function TO(u){var f=Jl(u);if(f&&(u=f.stateNode)){var m=u[zr]||null;t:switch(u=f.stateNode,f.type){case"input":if(G0(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),f=m.name,m.type==="radio"&&f!=null){for(m=u;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+yi(""+f)+'"][type="radio"]'),f=0;f<m.length;f++){var y=m[f];if(y!==u&&y.form===u.form){var S=y[zr]||null;if(!S)throw Error(r(90));G0(y,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(f=0;f<m.length;f++)y=m[f],y.form===u.form&&vO(y)}break t;case"textarea":xO(u,m.value,m.defaultValue);break t;case"select":f=m.value,f!=null&&ru(u,!!m.multiple,f,!1)}}}var Y0=!1;function $O(u,f,m){if(Y0)return u(f,m);Y0=!0;try{var y=u(f);return y}finally{if(Y0=!1,(au!==null||su!==null)&&(eg(),au&&(f=au,u=su,su=au=null,TO(f),u)))for(f=0;f<u.length;f++)TO(u[f])}}function gf(u,f){var m=u.stateNode;if(m===null)return null;var y=m[zr]||null;if(y===null)return null;m=y[f];t:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(u=u.type,y=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!y;break t;default:u=!1}if(u)return null;if(m&&typeof m!="function")throw Error(r(231,f,typeof m));return m}var Va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Z0=!1;if(Va)try{var yf={};Object.defineProperty(yf,"passive",{get:function(){Z0=!0}}),window.addEventListener("test",yf,yf),window.removeEventListener("test",yf,yf)}catch{Z0=!1}var Ns=null,Q0=null,ym=null;function AO(){if(ym)return ym;var u,f=Q0,m=f.length,y,S="value"in Ns?Ns.value:Ns.textContent,k=S.length;for(u=0;u<m&&f[u]===S[u];u++);var D=m-u;for(y=1;y<=D&&f[m-y]===S[k-y];y++);return ym=S.slice(u,1<y?1-y:void 0)}function vm(u){var f=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&f===13&&(u=13)):u=f,u===10&&(u=13),32<=u||u===13?u:0}function bm(){return!0}function kO(){return!1}function jr(u){function f(m,y,S,k,D){this._reactName=m,this._targetInst=S,this.type=y,this.nativeEvent=k,this.target=D,this.currentTarget=null;for(var L in u)u.hasOwnProperty(L)&&(m=u[L],this[L]=m?m(k):k[L]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?bm:kO,this.isPropagationStopped=kO,this}return h(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=bm)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=bm)},persist:function(){},isPersistent:bm}),f}var Mo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xm=jr(Mo),vf=h({},Mo,{view:0,detail:0}),L8=jr(vf),J0,tx,bf,wm=h({},vf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nx,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==bf&&(bf&&u.type==="mousemove"?(J0=u.screenX-bf.screenX,tx=u.screenY-bf.screenY):tx=J0=0,bf=u),J0)},movementY:function(u){return"movementY"in u?u.movementY:tx}}),EO=jr(wm),B8=h({},wm,{dataTransfer:0}),z8=jr(B8),j8=h({},vf,{relatedTarget:0}),ex=jr(j8),U8=h({},Mo,{animationName:0,elapsedTime:0,pseudoElement:0}),V8=jr(U8),W8=h({},Mo,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),G8=jr(W8),q8=h({},Mo,{data:0}),IO=jr(q8),H8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Y8(u){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(u):(u=K8[u])?!!f[u]:!1}function nx(){return Y8}var Z8=h({},vf,{key:function(u){if(u.key){var f=H8[u.key]||u.key;if(f!=="Unidentified")return f}return u.type==="keypress"?(u=vm(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?X8[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nx,charCode:function(u){return u.type==="keypress"?vm(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?vm(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Q8=jr(Z8),J8=h({},wm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),OO=jr(J8),tX=h({},vf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nx}),eX=jr(tX),nX=h({},Mo,{propertyName:0,elapsedTime:0,pseudoElement:0}),rX=jr(nX),iX=h({},wm,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),aX=jr(iX),sX=h({},Mo,{newState:0,oldState:0}),oX=jr(sX),lX=[9,13,27,32],rx=Va&&"CompositionEvent"in window,xf=null;Va&&"documentMode"in document&&(xf=document.documentMode);var uX=Va&&"TextEvent"in window&&!xf,NO=Va&&(!rx||xf&&8<xf&&11>=xf),_O=" ",RO=!1;function DO(u,f){switch(u){case"keyup":return lX.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function MO(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var ou=!1;function cX(u,f){switch(u){case"compositionend":return MO(f);case"keypress":return f.which!==32?null:(RO=!0,_O);case"textInput":return u=f.data,u===_O&&RO?null:u;default:return null}}function fX(u,f){if(ou)return u==="compositionend"||!rx&&DO(u,f)?(u=AO(),ym=Q0=Ns=null,ou=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return NO&&f.locale!=="ko"?null:f.data;default:return null}}var hX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PO(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f==="input"?!!hX[u.type]:f==="textarea"}function FO(u,f,m,y){au?su?su.push(y):su=[y]:au=y,f=og(f,"onChange"),0<f.length&&(m=new xm("onChange","change",null,m,y),u.push({event:m,listeners:f}))}var wf=null,Sf=null;function dX(u){yR(u,0)}function Sm(u){var f=mf(u);if(vO(f))return u}function LO(u,f){if(u==="change")return f}var BO=!1;if(Va){var ix;if(Va){var ax="oninput"in document;if(!ax){var zO=document.createElement("div");zO.setAttribute("oninput","return;"),ax=typeof zO.oninput=="function"}ix=ax}else ix=!1;BO=ix&&(!document.documentMode||9<document.documentMode)}function jO(){wf&&(wf.detachEvent("onpropertychange",UO),Sf=wf=null)}function UO(u){if(u.propertyName==="value"&&Sm(Sf)){var f=[];FO(f,Sf,u,K0(u)),$O(dX,f)}}function pX(u,f,m){u==="focusin"?(jO(),wf=f,Sf=m,wf.attachEvent("onpropertychange",UO)):u==="focusout"&&jO()}function mX(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Sm(Sf)}function gX(u,f){if(u==="click")return Sm(f)}function yX(u,f){if(u==="input"||u==="change")return Sm(f)}function vX(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var Qr=typeof Object.is=="function"?Object.is:vX;function Cf(u,f){if(Qr(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var m=Object.keys(u),y=Object.keys(f);if(m.length!==y.length)return!1;for(y=0;y<m.length;y++){var S=m[y];if(!gt.call(f,S)||!Qr(u[S],f[S]))return!1}return!0}function VO(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function WO(u,f){var m=VO(u);u=0;for(var y;m;){if(m.nodeType===3){if(y=u+m.textContent.length,u<=f&&y>=f)return{node:m,offset:f-u};u=y}t:{for(;m;){if(m.nextSibling){m=m.nextSibling;break t}m=m.parentNode}m=void 0}m=VO(m)}}function GO(u,f){return u&&f?u===f?!0:u&&u.nodeType===3?!1:f&&f.nodeType===3?GO(u,f.parentNode):"contains"in u?u.contains(f):u.compareDocumentPosition?!!(u.compareDocumentPosition(f)&16):!1:!1}function qO(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var f=mm(u.document);f instanceof u.HTMLIFrameElement;){try{var m=typeof f.contentWindow.location.href=="string"}catch{m=!1}if(m)u=f.contentWindow;else break;f=mm(u.document)}return f}function sx(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f&&(f==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||f==="textarea"||u.contentEditable==="true")}var bX=Va&&"documentMode"in document&&11>=document.documentMode,lu=null,ox=null,Tf=null,lx=!1;function HO(u,f,m){var y=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;lx||lu==null||lu!==mm(y)||(y=lu,"selectionStart"in y&&sx(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Tf&&Cf(Tf,y)||(Tf=y,y=og(ox,"onSelect"),0<y.length&&(f=new xm("onSelect","select",null,f,m),u.push({event:f,listeners:y}),f.target=lu)))}function Po(u,f){var m={};return m[u.toLowerCase()]=f.toLowerCase(),m["Webkit"+u]="webkit"+f,m["Moz"+u]="moz"+f,m}var uu={animationend:Po("Animation","AnimationEnd"),animationiteration:Po("Animation","AnimationIteration"),animationstart:Po("Animation","AnimationStart"),transitionrun:Po("Transition","TransitionRun"),transitionstart:Po("Transition","TransitionStart"),transitioncancel:Po("Transition","TransitionCancel"),transitionend:Po("Transition","TransitionEnd")},ux={},XO={};Va&&(XO=document.createElement("div").style,"AnimationEvent"in window||(delete uu.animationend.animation,delete uu.animationiteration.animation,delete uu.animationstart.animation),"TransitionEvent"in window||delete uu.transitionend.transition);function Fo(u){if(ux[u])return ux[u];if(!uu[u])return u;var f=uu[u],m;for(m in f)if(f.hasOwnProperty(m)&&m in XO)return ux[u]=f[m];return u}var KO=Fo("animationend"),YO=Fo("animationiteration"),ZO=Fo("animationstart"),xX=Fo("transitionrun"),wX=Fo("transitionstart"),SX=Fo("transitioncancel"),QO=Fo("transitionend"),JO=new Map,cx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cx.push("scrollEnd");function Wi(u,f){JO.set(u,f),Do(f,[u])}var tN=new WeakMap;function vi(u,f){if(typeof u=="object"&&u!==null){var m=tN.get(u);return m!==void 0?m:(f={value:u,source:f,stack:gO(f)},tN.set(u,f),f)}return{value:u,source:f,stack:gO(f)}}var bi=[],cu=0,fx=0;function Cm(){for(var u=cu,f=fx=cu=0;f<u;){var m=bi[f];bi[f++]=null;var y=bi[f];bi[f++]=null;var S=bi[f];bi[f++]=null;var k=bi[f];if(bi[f++]=null,y!==null&&S!==null){var D=y.pending;D===null?S.next=S:(S.next=D.next,D.next=S),y.pending=S}k!==0&&eN(m,S,k)}}function Tm(u,f,m,y){bi[cu++]=u,bi[cu++]=f,bi[cu++]=m,bi[cu++]=y,fx|=y,u.lanes|=y,u=u.alternate,u!==null&&(u.lanes|=y)}function hx(u,f,m,y){return Tm(u,f,m,y),$m(u)}function fu(u,f){return Tm(u,null,null,f),$m(u)}function eN(u,f,m){u.lanes|=m;var y=u.alternate;y!==null&&(y.lanes|=m);for(var S=!1,k=u.return;k!==null;)k.childLanes|=m,y=k.alternate,y!==null&&(y.childLanes|=m),k.tag===22&&(u=k.stateNode,u===null||u._visibility&1||(S=!0)),u=k,k=k.return;return u.tag===3?(k=u.stateNode,S&&f!==null&&(S=31-Dn(m),u=k.hiddenUpdates,y=u[S],y===null?u[S]=[f]:y.push(f),f.lane=m|536870912),k):null}function $m(u){if(50<Kf)throw Kf=0,v1=null,Error(r(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}var hu={};function CX(u,f,m,y){this.tag=u,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(u,f,m,y){return new CX(u,f,m,y)}function dx(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Wa(u,f){var m=u.alternate;return m===null?(m=Jr(u.tag,f,u.key,u.mode),m.elementType=u.elementType,m.type=u.type,m.stateNode=u.stateNode,m.alternate=u,u.alternate=m):(m.pendingProps=f,m.type=u.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=u.flags&65011712,m.childLanes=u.childLanes,m.lanes=u.lanes,m.child=u.child,m.memoizedProps=u.memoizedProps,m.memoizedState=u.memoizedState,m.updateQueue=u.updateQueue,f=u.dependencies,m.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},m.sibling=u.sibling,m.index=u.index,m.ref=u.ref,m.refCleanup=u.refCleanup,m}function nN(u,f){u.flags&=65011714;var m=u.alternate;return m===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=m.childLanes,u.lanes=m.lanes,u.child=m.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=m.memoizedProps,u.memoizedState=m.memoizedState,u.updateQueue=m.updateQueue,u.type=m.type,f=m.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function Am(u,f,m,y,S,k){var D=0;if(y=u,typeof u=="function")dx(u)&&(D=1);else if(typeof u=="string")D=$K(u,m,ot.current)?26:u==="html"||u==="head"||u==="body"?27:5;else t:switch(u){case _:return u=Jr(31,m,f,S),u.elementType=_,u.lanes=k,u;case v:return Lo(m.children,S,k,f);case x:D=8,S|=24;break;case b:return u=Jr(12,m,f,S|2),u.elementType=b,u.lanes=k,u;case A:return u=Jr(13,m,f,S),u.elementType=A,u.lanes=k,u;case E:return u=Jr(19,m,f,S),u.elementType=E,u.lanes=k,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case w:case T:D=10;break t;case C:D=9;break t;case $:D=11;break t;case O:D=14;break t;case N:D=16,y=null;break t}D=29,m=Error(r(130,u===null?"null":typeof u,"")),y=null}return f=Jr(D,m,f,S),f.elementType=u,f.type=y,f.lanes=k,f}function Lo(u,f,m,y){return u=Jr(7,u,y,f),u.lanes=m,u}function px(u,f,m){return u=Jr(6,u,null,f),u.lanes=m,u}function mx(u,f,m){return f=Jr(4,u.children!==null?u.children:[],u.key,f),f.lanes=m,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}var du=[],pu=0,km=null,Em=0,xi=[],wi=0,Bo=null,Ga=1,qa="";function zo(u,f){du[pu++]=Em,du[pu++]=km,km=u,Em=f}function rN(u,f,m){xi[wi++]=Ga,xi[wi++]=qa,xi[wi++]=Bo,Bo=u;var y=Ga;u=qa;var S=32-Dn(y)-1;y&=~(1<<S),m+=1;var k=32-Dn(f)+S;if(30<k){var D=S-S%5;k=(y&(1<<D)-1).toString(32),y>>=D,S-=D,Ga=1<<32-Dn(f)+S|m<<S|y,qa=k+u}else Ga=1<<k|m<<S|y,qa=u}function gx(u){u.return!==null&&(zo(u,1),rN(u,1,0))}function yx(u){for(;u===km;)km=du[--pu],du[pu]=null,Em=du[--pu],du[pu]=null;for(;u===Bo;)Bo=xi[--wi],xi[wi]=null,qa=xi[--wi],xi[wi]=null,Ga=xi[--wi],xi[wi]=null}var Ar=null,sn=null,$e=!1,jo=null,ha=!1,vx=Error(r(519));function Uo(u){var f=Error(r(418,""));throw kf(vi(f,u)),vx}function iN(u){var f=u.stateNode,m=u.type,y=u.memoizedProps;switch(f[pr]=u,f[zr]=y,m){case"dialog":ce("cancel",f),ce("close",f);break;case"iframe":case"object":case"embed":ce("load",f);break;case"video":case"audio":for(m=0;m<Zf.length;m++)ce(Zf[m],f);break;case"source":ce("error",f);break;case"img":case"image":case"link":ce("error",f),ce("load",f);break;case"details":ce("toggle",f);break;case"input":ce("invalid",f),bO(f,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0),pm(f);break;case"select":ce("invalid",f);break;case"textarea":ce("invalid",f),wO(f,y.value,y.defaultValue,y.children),pm(f)}m=y.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||f.textContent===""+m||y.suppressHydrationWarning===!0||wR(f.textContent,m)?(y.popover!=null&&(ce("beforetoggle",f),ce("toggle",f)),y.onScroll!=null&&ce("scroll",f),y.onScrollEnd!=null&&ce("scrollend",f),y.onClick!=null&&(f.onclick=lg),f=!0):f=!1,f||Uo(u)}function aN(u){for(Ar=u.return;Ar;)switch(Ar.tag){case 5:case 13:ha=!1;return;case 27:case 3:ha=!0;return;default:Ar=Ar.return}}function $f(u){if(u!==Ar)return!1;if(!$e)return aN(u),$e=!0,!1;var f=u.tag,m;if((m=f!==3&&f!==27)&&((m=f===5)&&(m=u.type,m=!(m!=="form"&&m!=="button")||D1(u.type,u.memoizedProps)),m=!m),m&&sn&&Uo(u),aN(u),f===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));t:{for(u=u.nextSibling,f=0;u;){if(u.nodeType===8)if(m=u.data,m==="/$"){if(f===0){sn=qi(u.nextSibling);break t}f--}else m!=="$"&&m!=="$!"&&m!=="$?"||f++;u=u.nextSibling}sn=null}}else f===27?(f=sn,Hs(u.type)?(u=L1,L1=null,sn=u):sn=f):sn=Ar?qi(u.stateNode.nextSibling):null;return!0}function Af(){sn=Ar=null,$e=!1}function sN(){var u=jo;return u!==null&&(Wr===null?Wr=u:Wr.push.apply(Wr,u),jo=null),u}function kf(u){jo===null?jo=[u]:jo.push(u)}var bx=G(null),Vo=null,Ha=null;function _s(u,f,m){Y(bx,f._currentValue),f._currentValue=m}function Xa(u){u._currentValue=bx.current,H(bx)}function xx(u,f,m){for(;u!==null;){var y=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,y!==null&&(y.childLanes|=f)):y!==null&&(y.childLanes&f)!==f&&(y.childLanes|=f),u===m)break;u=u.return}}function wx(u,f,m,y){var S=u.child;for(S!==null&&(S.return=u);S!==null;){var k=S.dependencies;if(k!==null){var D=S.child;k=k.firstContext;t:for(;k!==null;){var L=k;k=S;for(var K=0;K<f.length;K++)if(L.context===f[K]){k.lanes|=m,L=k.alternate,L!==null&&(L.lanes|=m),xx(k.return,m,u),y||(D=null);break t}k=L.next}}else if(S.tag===18){if(D=S.return,D===null)throw Error(r(341));D.lanes|=m,k=D.alternate,k!==null&&(k.lanes|=m),xx(D,m,u),D=null}else D=S.child;if(D!==null)D.return=S;else for(D=S;D!==null;){if(D===u){D=null;break}if(S=D.sibling,S!==null){S.return=D.return,D=S;break}D=D.return}S=D}}function Ef(u,f,m,y){u=null;for(var S=f,k=!1;S!==null;){if(!k){if((S.flags&524288)!==0)k=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var D=S.alternate;if(D===null)throw Error(r(387));if(D=D.memoizedProps,D!==null){var L=S.type;Qr(S.pendingProps.value,D.value)||(u!==null?u.push(L):u=[L])}}else if(S===It.current){if(D=S.alternate,D===null)throw Error(r(387));D.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(u!==null?u.push(rh):u=[rh])}S=S.return}u!==null&&wx(f,u,m,y),f.flags|=262144}function Im(u){for(u=u.firstContext;u!==null;){if(!Qr(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function Wo(u){Vo=u,Ha=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function mr(u){return oN(Vo,u)}function Om(u,f){return Vo===null&&Wo(u),oN(u,f)}function oN(u,f){var m=f._currentValue;if(f={context:f,memoizedValue:m,next:null},Ha===null){if(u===null)throw Error(r(308));Ha=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else Ha=Ha.next=f;return m}var TX=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(m,y){u.push(y)}};this.abort=function(){f.aborted=!0,u.forEach(function(m){return m()})}},$X=e.unstable_scheduleCallback,AX=e.unstable_NormalPriority,Mn={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sx(){return{controller:new TX,data:new Map,refCount:0}}function If(u){u.refCount--,u.refCount===0&&$X(AX,function(){u.controller.abort()})}var Of=null,Cx=0,mu=0,gu=null;function kX(u,f){if(Of===null){var m=Of=[];Cx=0,mu=$1(),gu={status:"pending",value:void 0,then:function(y){m.push(y)}}}return Cx++,f.then(lN,lN),f}function lN(){if(--Cx===0&&Of!==null){gu!==null&&(gu.status="fulfilled");var u=Of;Of=null,mu=0,gu=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function EX(u,f){var m=[],y={status:"pending",value:null,reason:null,then:function(S){m.push(S)}};return u.then(function(){y.status="fulfilled",y.value=f;for(var S=0;S<m.length;S++)(0,m[S])(f)},function(S){for(y.status="rejected",y.reason=S,S=0;S<m.length;S++)(0,m[S])(void 0)}),y}var uN=M.S;M.S=function(u,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&kX(u,f),uN!==null&&uN(u,f)};var Go=G(null);function Tx(){var u=Go.current;return u!==null?u:qe.pooledCache}function Nm(u,f){f===null?Y(Go,Go.current):Y(Go,f.pool)}function cN(){var u=Tx();return u===null?null:{parent:Mn._currentValue,pool:u}}var Nf=Error(r(460)),fN=Error(r(474)),_m=Error(r(542)),$x={then:function(){}};function hN(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Rm(){}function dN(u,f,m){switch(m=u[m],m===void 0?u.push(f):m!==f&&(f.then(Rm,Rm),f=m),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,mN(u),u;default:if(typeof f.status=="string")f.then(Rm,Rm);else{if(u=qe,u!==null&&100<u.shellSuspendCounter)throw Error(r(482));u=f,u.status="pending",u.then(function(y){if(f.status==="pending"){var S=f;S.status="fulfilled",S.value=y}},function(y){if(f.status==="pending"){var S=f;S.status="rejected",S.reason=y}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,mN(u),u}throw _f=f,Nf}}var _f=null;function pN(){if(_f===null)throw Error(r(459));var u=_f;return _f=null,u}function mN(u){if(u===Nf||u===_m)throw Error(r(483))}var Rs=!1;function Ax(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kx(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Ds(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Ms(u,f,m){var y=u.updateQueue;if(y===null)return null;if(y=y.shared,(Oe&2)!==0){var S=y.pending;return S===null?f.next=f:(f.next=S.next,S.next=f),y.pending=f,f=$m(u),eN(u,null,m),f}return Tm(u,y,f,m),$m(u)}function Rf(u,f,m){if(f=f.updateQueue,f!==null&&(f=f.shared,(m&4194048)!==0)){var y=f.lanes;y&=u.pendingLanes,m|=y,f.lanes=m,lO(u,m)}}function Ex(u,f){var m=u.updateQueue,y=u.alternate;if(y!==null&&(y=y.updateQueue,m===y)){var S=null,k=null;if(m=m.firstBaseUpdate,m!==null){do{var D={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};k===null?S=k=D:k=k.next=D,m=m.next}while(m!==null);k===null?S=k=f:k=k.next=f}else S=k=f;m={baseState:y.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:y.shared,callbacks:y.callbacks},u.updateQueue=m;return}u=m.lastBaseUpdate,u===null?m.firstBaseUpdate=f:u.next=f,m.lastBaseUpdate=f}var Ix=!1;function Df(){if(Ix){var u=gu;if(u!==null)throw u}}function Mf(u,f,m,y){Ix=!1;var S=u.updateQueue;Rs=!1;var k=S.firstBaseUpdate,D=S.lastBaseUpdate,L=S.shared.pending;if(L!==null){S.shared.pending=null;var K=L,lt=K.next;K.next=null,D===null?k=lt:D.next=lt,D=K;var bt=u.alternate;bt!==null&&(bt=bt.updateQueue,L=bt.lastBaseUpdate,L!==D&&(L===null?bt.firstBaseUpdate=lt:L.next=lt,bt.lastBaseUpdate=K))}if(k!==null){var wt=S.baseState;D=0,bt=lt=K=null,L=k;do{var ut=L.lane&-536870913,ft=ut!==L.lane;if(ft?(ve&ut)===ut:(y&ut)===ut){ut!==0&&ut===mu&&(Ix=!0),bt!==null&&(bt=bt.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});t:{var Qt=u,Gt=L;ut=f;var Pe=m;switch(Gt.tag){case 1:if(Qt=Gt.payload,typeof Qt=="function"){wt=Qt.call(Pe,wt,ut);break t}wt=Qt;break t;case 3:Qt.flags=Qt.flags&-65537|128;case 0:if(Qt=Gt.payload,ut=typeof Qt=="function"?Qt.call(Pe,wt,ut):Qt,ut==null)break t;wt=h({},wt,ut);break t;case 2:Rs=!0}}ut=L.callback,ut!==null&&(u.flags|=64,ft&&(u.flags|=8192),ft=S.callbacks,ft===null?S.callbacks=[ut]:ft.push(ut))}else ft={lane:ut,tag:L.tag,payload:L.payload,callback:L.callback,next:null},bt===null?(lt=bt=ft,K=wt):bt=bt.next=ft,D|=ut;if(L=L.next,L===null){if(L=S.shared.pending,L===null)break;ft=L,L=ft.next,ft.next=null,S.lastBaseUpdate=ft,S.shared.pending=null}}while(!0);bt===null&&(K=wt),S.baseState=K,S.firstBaseUpdate=lt,S.lastBaseUpdate=bt,k===null&&(S.shared.lanes=0),Vs|=D,u.lanes=D,u.memoizedState=wt}}function gN(u,f){if(typeof u!="function")throw Error(r(191,u));u.call(f)}function yN(u,f){var m=u.callbacks;if(m!==null)for(u.callbacks=null,u=0;u<m.length;u++)gN(m[u],f)}var yu=G(null),Dm=G(0);function vN(u,f){u=es,Y(Dm,u),Y(yu,f),es=u|f.baseLanes}function Ox(){Y(Dm,es),Y(yu,yu.current)}function Nx(){es=Dm.current,H(yu),H(Dm)}var Ps=0,ae=null,De=null,xn=null,Mm=!1,vu=!1,qo=!1,Pm=0,Pf=0,bu=null,IX=0;function mn(){throw Error(r(321))}function _x(u,f){if(f===null)return!1;for(var m=0;m<f.length&&m<u.length;m++)if(!Qr(u[m],f[m]))return!1;return!0}function Rx(u,f,m,y,S,k){return Ps=k,ae=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,M.H=u===null||u.memoizedState===null?e_:n_,qo=!1,k=m(y,S),qo=!1,vu&&(k=xN(f,m,y,S)),bN(u),k}function bN(u){M.H=Um;var f=De!==null&&De.next!==null;if(Ps=0,xn=De=ae=null,Mm=!1,Pf=0,bu=null,f)throw Error(r(300));u===null||Gn||(u=u.dependencies,u!==null&&Im(u)&&(Gn=!0))}function xN(u,f,m,y){ae=u;var S=0;do{if(vu&&(bu=null),Pf=0,vu=!1,25<=S)throw Error(r(301));if(S+=1,xn=De=null,u.updateQueue!=null){var k=u.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}M.H=PX,k=f(m,y)}while(vu);return k}function OX(){var u=M.H,f=u.useState()[0];return f=typeof f.then=="function"?Ff(f):f,u=u.useState()[0],(De!==null?De.memoizedState:null)!==u&&(ae.flags|=1024),f}function Dx(){var u=Pm!==0;return Pm=0,u}function Mx(u,f,m){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~m}function Px(u){if(Mm){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}Mm=!1}Ps=0,xn=De=ae=null,vu=!1,Pf=Pm=0,bu=null}function Ur(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?ae.memoizedState=xn=u:xn=xn.next=u,xn}function wn(){if(De===null){var u=ae.alternate;u=u!==null?u.memoizedState:null}else u=De.next;var f=xn===null?ae.memoizedState:xn.next;if(f!==null)xn=f,De=u;else{if(u===null)throw ae.alternate===null?Error(r(467)):Error(r(310));De=u,u={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},xn===null?ae.memoizedState=xn=u:xn=xn.next=u}return xn}function Fx(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ff(u){var f=Pf;return Pf+=1,bu===null&&(bu=[]),u=dN(bu,u,f),f=ae,(xn===null?f.memoizedState:xn.next)===null&&(f=f.alternate,M.H=f===null||f.memoizedState===null?e_:n_),u}function Fm(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Ff(u);if(u.$$typeof===T)return mr(u)}throw Error(r(438,String(u)))}function Lx(u){var f=null,m=ae.updateQueue;if(m!==null&&(f=m.memoCache),f==null){var y=ae.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(f={data:y.data.map(function(S){return S.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),m===null&&(m=Fx(),ae.updateQueue=m),m.memoCache=f,m=f.data[f.index],m===void 0)for(m=f.data[f.index]=Array(u),y=0;y<u;y++)m[y]=R;return f.index++,m}function Ka(u,f){return typeof f=="function"?f(u):f}function Lm(u){var f=wn();return Bx(f,De,u)}function Bx(u,f,m){var y=u.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=m;var S=u.baseQueue,k=y.pending;if(k!==null){if(S!==null){var D=S.next;S.next=k.next,k.next=D}f.baseQueue=S=k,y.pending=null}if(k=u.baseState,S===null)u.memoizedState=k;else{f=S.next;var L=D=null,K=null,lt=f,bt=!1;do{var wt=lt.lane&-536870913;if(wt!==lt.lane?(ve&wt)===wt:(Ps&wt)===wt){var ut=lt.revertLane;if(ut===0)K!==null&&(K=K.next={lane:0,revertLane:0,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null}),wt===mu&&(bt=!0);else if((Ps&ut)===ut){lt=lt.next,ut===mu&&(bt=!0);continue}else wt={lane:0,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},K===null?(L=K=wt,D=k):K=K.next=wt,ae.lanes|=ut,Vs|=ut;wt=lt.action,qo&&m(k,wt),k=lt.hasEagerState?lt.eagerState:m(k,wt)}else ut={lane:wt,revertLane:lt.revertLane,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},K===null?(L=K=ut,D=k):K=K.next=ut,ae.lanes|=wt,Vs|=wt;lt=lt.next}while(lt!==null&&lt!==f);if(K===null?D=k:K.next=L,!Qr(k,u.memoizedState)&&(Gn=!0,bt&&(m=gu,m!==null)))throw m;u.memoizedState=k,u.baseState=D,u.baseQueue=K,y.lastRenderedState=k}return S===null&&(y.lanes=0),[u.memoizedState,y.dispatch]}function zx(u){var f=wn(),m=f.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=u;var y=m.dispatch,S=m.pending,k=f.memoizedState;if(S!==null){m.pending=null;var D=S=S.next;do k=u(k,D.action),D=D.next;while(D!==S);Qr(k,f.memoizedState)||(Gn=!0),f.memoizedState=k,f.baseQueue===null&&(f.baseState=k),m.lastRenderedState=k}return[k,y]}function wN(u,f,m){var y=ae,S=wn(),k=$e;if(k){if(m===void 0)throw Error(r(407));m=m()}else m=f();var D=!Qr((De||S).memoizedState,m);D&&(S.memoizedState=m,Gn=!0),S=S.queue;var L=TN.bind(null,y,S,u);if(Lf(2048,8,L,[u]),S.getSnapshot!==f||D||xn!==null&&xn.memoizedState.tag&1){if(y.flags|=2048,xu(9,Bm(),CN.bind(null,y,S,m,f),null),qe===null)throw Error(r(349));k||(Ps&124)!==0||SN(y,f,m)}return m}function SN(u,f,m){u.flags|=16384,u={getSnapshot:f,value:m},f=ae.updateQueue,f===null?(f=Fx(),ae.updateQueue=f,f.stores=[u]):(m=f.stores,m===null?f.stores=[u]:m.push(u))}function CN(u,f,m,y){f.value=m,f.getSnapshot=y,$N(f)&&AN(u)}function TN(u,f,m){return m(function(){$N(f)&&AN(u)})}function $N(u){var f=u.getSnapshot;u=u.value;try{var m=f();return!Qr(u,m)}catch{return!0}}function AN(u){var f=fu(u,2);f!==null&&ii(f,u,2)}function jx(u){var f=Ur();if(typeof u=="function"){var m=u;if(u=m(),qo){er(!0);try{m()}finally{er(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ka,lastRenderedState:u},f}function kN(u,f,m,y){return u.baseState=m,Bx(u,De,typeof y=="function"?y:Ka)}function NX(u,f,m,y,S){if(jm(u))throw Error(r(485));if(u=f.action,u!==null){var k={payload:S,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){k.listeners.push(D)}};M.T!==null?m(!0):k.isTransition=!1,y(k),m=f.pending,m===null?(k.next=f.pending=k,EN(f,k)):(k.next=m.next,f.pending=m.next=k)}}function EN(u,f){var m=f.action,y=f.payload,S=u.state;if(f.isTransition){var k=M.T,D={};M.T=D;try{var L=m(S,y),K=M.S;K!==null&&K(D,L),IN(u,f,L)}catch(lt){Ux(u,f,lt)}finally{M.T=k}}else try{k=m(S,y),IN(u,f,k)}catch(lt){Ux(u,f,lt)}}function IN(u,f,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(y){ON(u,f,y)},function(y){return Ux(u,f,y)}):ON(u,f,m)}function ON(u,f,m){f.status="fulfilled",f.value=m,NN(f),u.state=m,f=u.pending,f!==null&&(m=f.next,m===f?u.pending=null:(m=m.next,f.next=m,EN(u,m)))}function Ux(u,f,m){var y=u.pending;if(u.pending=null,y!==null){y=y.next;do f.status="rejected",f.reason=m,NN(f),f=f.next;while(f!==y)}u.action=null}function NN(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function _N(u,f){return f}function RN(u,f){if($e){var m=qe.formState;if(m!==null){t:{var y=ae;if($e){if(sn){e:{for(var S=sn,k=ha;S.nodeType!==8;){if(!k){S=null;break e}if(S=qi(S.nextSibling),S===null){S=null;break e}}k=S.data,S=k==="F!"||k==="F"?S:null}if(S){sn=qi(S.nextSibling),y=S.data==="F!";break t}}Uo(y)}y=!1}y&&(f=m[0])}}return m=Ur(),m.memoizedState=m.baseState=f,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_N,lastRenderedState:f},m.queue=y,m=QN.bind(null,ae,y),y.dispatch=m,y=jx(!1),k=Hx.bind(null,ae,!1,y.queue),y=Ur(),S={state:f,dispatch:null,action:u,pending:null},y.queue=S,m=NX.bind(null,ae,S,k,m),S.dispatch=m,y.memoizedState=u,[f,m,!1]}function DN(u){var f=wn();return MN(f,De,u)}function MN(u,f,m){if(f=Bx(u,f,_N)[0],u=Lm(Ka)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var y=Ff(f)}catch(D){throw D===Nf?_m:D}else y=f;f=wn();var S=f.queue,k=S.dispatch;return m!==f.memoizedState&&(ae.flags|=2048,xu(9,Bm(),_X.bind(null,S,m),null)),[y,k,u]}function _X(u,f){u.action=f}function PN(u){var f=wn(),m=De;if(m!==null)return MN(f,m,u);wn(),f=f.memoizedState,m=wn();var y=m.queue.dispatch;return m.memoizedState=u,[f,y,!1]}function xu(u,f,m,y){return u={tag:u,create:m,deps:y,inst:f,next:null},f=ae.updateQueue,f===null&&(f=Fx(),ae.updateQueue=f),m=f.lastEffect,m===null?f.lastEffect=u.next=u:(y=m.next,m.next=u,u.next=y,f.lastEffect=u),u}function Bm(){return{destroy:void 0,resource:void 0}}function FN(){return wn().memoizedState}function zm(u,f,m,y){var S=Ur();y=y===void 0?null:y,ae.flags|=u,S.memoizedState=xu(1|f,Bm(),m,y)}function Lf(u,f,m,y){var S=wn();y=y===void 0?null:y;var k=S.memoizedState.inst;De!==null&&y!==null&&_x(y,De.memoizedState.deps)?S.memoizedState=xu(f,k,m,y):(ae.flags|=u,S.memoizedState=xu(1|f,k,m,y))}function LN(u,f){zm(8390656,8,u,f)}function BN(u,f){Lf(2048,8,u,f)}function zN(u,f){return Lf(4,2,u,f)}function jN(u,f){return Lf(4,4,u,f)}function UN(u,f){if(typeof f=="function"){u=u();var m=f(u);return function(){typeof m=="function"?m():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function VN(u,f,m){m=m!=null?m.concat([u]):null,Lf(4,4,UN.bind(null,f,u),m)}function Vx(){}function WN(u,f){var m=wn();f=f===void 0?null:f;var y=m.memoizedState;return f!==null&&_x(f,y[1])?y[0]:(m.memoizedState=[u,f],u)}function GN(u,f){var m=wn();f=f===void 0?null:f;var y=m.memoizedState;if(f!==null&&_x(f,y[1]))return y[0];if(y=u(),qo){er(!0);try{u()}finally{er(!1)}}return m.memoizedState=[y,f],y}function Wx(u,f,m){return m===void 0||(Ps&1073741824)!==0?u.memoizedState=f:(u.memoizedState=m,u=X_(),ae.lanes|=u,Vs|=u,m)}function qN(u,f,m,y){return Qr(m,f)?m:yu.current!==null?(u=Wx(u,m,y),Qr(u,f)||(Gn=!0),u):(Ps&42)===0?(Gn=!0,u.memoizedState=m):(u=X_(),ae.lanes|=u,Vs|=u,f)}function HN(u,f,m,y,S){var k=U.p;U.p=k!==0&&8>k?k:8;var D=M.T,L={};M.T=L,Hx(u,!1,f,m);try{var K=S(),lt=M.S;if(lt!==null&&lt(L,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var bt=EX(K,y);Bf(u,f,bt,ri(u))}else Bf(u,f,y,ri(u))}catch(wt){Bf(u,f,{then:function(){},status:"rejected",reason:wt},ri())}finally{U.p=k,M.T=D}}function RX(){}function Gx(u,f,m,y){if(u.tag!==5)throw Error(r(476));var S=XN(u).queue;HN(u,S,f,W,m===null?RX:function(){return KN(u),m(y)})}function XN(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ka,lastRenderedState:W},next:null};var m={};return f.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ka,lastRenderedState:m},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function KN(u){var f=XN(u).next.queue;Bf(u,f,{},ri())}function qx(){return mr(rh)}function YN(){return wn().memoizedState}function ZN(){return wn().memoizedState}function DX(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var m=ri();u=Ds(m);var y=Ms(f,u,m);y!==null&&(ii(y,f,m),Rf(y,f,m)),f={cache:Sx()},u.payload=f;return}f=f.return}}function MX(u,f,m){var y=ri();m={lane:y,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},jm(u)?JN(f,m):(m=hx(u,f,m,y),m!==null&&(ii(m,u,y),t_(m,f,y)))}function QN(u,f,m){var y=ri();Bf(u,f,m,y)}function Bf(u,f,m,y){var S={lane:y,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(jm(u))JN(f,S);else{var k=u.alternate;if(u.lanes===0&&(k===null||k.lanes===0)&&(k=f.lastRenderedReducer,k!==null))try{var D=f.lastRenderedState,L=k(D,m);if(S.hasEagerState=!0,S.eagerState=L,Qr(L,D))return Tm(u,f,S,0),qe===null&&Cm(),!1}catch{}finally{}if(m=hx(u,f,S,y),m!==null)return ii(m,u,y),t_(m,f,y),!0}return!1}function Hx(u,f,m,y){if(y={lane:2,revertLane:$1(),action:y,hasEagerState:!1,eagerState:null,next:null},jm(u)){if(f)throw Error(r(479))}else f=hx(u,m,y,2),f!==null&&ii(f,u,2)}function jm(u){var f=u.alternate;return u===ae||f!==null&&f===ae}function JN(u,f){vu=Mm=!0;var m=u.pending;m===null?f.next=f:(f.next=m.next,m.next=f),u.pending=f}function t_(u,f,m){if((m&4194048)!==0){var y=f.lanes;y&=u.pendingLanes,m|=y,f.lanes=m,lO(u,m)}}var Um={readContext:mr,use:Fm,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useLayoutEffect:mn,useInsertionEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useSyncExternalStore:mn,useId:mn,useHostTransitionStatus:mn,useFormState:mn,useActionState:mn,useOptimistic:mn,useMemoCache:mn,useCacheRefresh:mn},e_={readContext:mr,use:Fm,useCallback:function(u,f){return Ur().memoizedState=[u,f===void 0?null:f],u},useContext:mr,useEffect:LN,useImperativeHandle:function(u,f,m){m=m!=null?m.concat([u]):null,zm(4194308,4,UN.bind(null,f,u),m)},useLayoutEffect:function(u,f){return zm(4194308,4,u,f)},useInsertionEffect:function(u,f){zm(4,2,u,f)},useMemo:function(u,f){var m=Ur();f=f===void 0?null:f;var y=u();if(qo){er(!0);try{u()}finally{er(!1)}}return m.memoizedState=[y,f],y},useReducer:function(u,f,m){var y=Ur();if(m!==void 0){var S=m(f);if(qo){er(!0);try{m(f)}finally{er(!1)}}}else S=f;return y.memoizedState=y.baseState=S,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:S},y.queue=u,u=u.dispatch=MX.bind(null,ae,u),[y.memoizedState,u]},useRef:function(u){var f=Ur();return u={current:u},f.memoizedState=u},useState:function(u){u=jx(u);var f=u.queue,m=QN.bind(null,ae,f);return f.dispatch=m,[u.memoizedState,m]},useDebugValue:Vx,useDeferredValue:function(u,f){var m=Ur();return Wx(m,u,f)},useTransition:function(){var u=jx(!1);return u=HN.bind(null,ae,u.queue,!0,!1),Ur().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,m){var y=ae,S=Ur();if($e){if(m===void 0)throw Error(r(407));m=m()}else{if(m=f(),qe===null)throw Error(r(349));(ve&124)!==0||SN(y,f,m)}S.memoizedState=m;var k={value:m,getSnapshot:f};return S.queue=k,LN(TN.bind(null,y,k,u),[u]),y.flags|=2048,xu(9,Bm(),CN.bind(null,y,k,m,f),null),m},useId:function(){var u=Ur(),f=qe.identifierPrefix;if($e){var m=qa,y=Ga;m=(y&~(1<<32-Dn(y)-1)).toString(32)+m,f="«"+f+"R"+m,m=Pm++,0<m&&(f+="H"+m.toString(32)),f+="»"}else m=IX++,f="«"+f+"r"+m.toString(32)+"»";return u.memoizedState=f},useHostTransitionStatus:qx,useFormState:RN,useActionState:RN,useOptimistic:function(u){var f=Ur();f.memoizedState=f.baseState=u;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=m,f=Hx.bind(null,ae,!0,m),m.dispatch=f,[u,f]},useMemoCache:Lx,useCacheRefresh:function(){return Ur().memoizedState=DX.bind(null,ae)}},n_={readContext:mr,use:Fm,useCallback:WN,useContext:mr,useEffect:BN,useImperativeHandle:VN,useInsertionEffect:zN,useLayoutEffect:jN,useMemo:GN,useReducer:Lm,useRef:FN,useState:function(){return Lm(Ka)},useDebugValue:Vx,useDeferredValue:function(u,f){var m=wn();return qN(m,De.memoizedState,u,f)},useTransition:function(){var u=Lm(Ka)[0],f=wn().memoizedState;return[typeof u=="boolean"?u:Ff(u),f]},useSyncExternalStore:wN,useId:YN,useHostTransitionStatus:qx,useFormState:DN,useActionState:DN,useOptimistic:function(u,f){var m=wn();return kN(m,De,u,f)},useMemoCache:Lx,useCacheRefresh:ZN},PX={readContext:mr,use:Fm,useCallback:WN,useContext:mr,useEffect:BN,useImperativeHandle:VN,useInsertionEffect:zN,useLayoutEffect:jN,useMemo:GN,useReducer:zx,useRef:FN,useState:function(){return zx(Ka)},useDebugValue:Vx,useDeferredValue:function(u,f){var m=wn();return De===null?Wx(m,u,f):qN(m,De.memoizedState,u,f)},useTransition:function(){var u=zx(Ka)[0],f=wn().memoizedState;return[typeof u=="boolean"?u:Ff(u),f]},useSyncExternalStore:wN,useId:YN,useHostTransitionStatus:qx,useFormState:PN,useActionState:PN,useOptimistic:function(u,f){var m=wn();return De!==null?kN(m,De,u,f):(m.baseState=u,[u,m.queue.dispatch])},useMemoCache:Lx,useCacheRefresh:ZN},wu=null,zf=0;function Vm(u){var f=zf;return zf+=1,wu===null&&(wu=[]),dN(wu,u,f)}function jf(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function Wm(u,f){throw f.$$typeof===d?Error(r(525)):(u=Object.prototype.toString.call(f),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function r_(u){var f=u._init;return f(u._payload)}function i_(u){function f(it,Q){if(u){var at=it.deletions;at===null?(it.deletions=[Q],it.flags|=16):at.push(Q)}}function m(it,Q){if(!u)return null;for(;Q!==null;)f(it,Q),Q=Q.sibling;return null}function y(it){for(var Q=new Map;it!==null;)it.key!==null?Q.set(it.key,it):Q.set(it.index,it),it=it.sibling;return Q}function S(it,Q){return it=Wa(it,Q),it.index=0,it.sibling=null,it}function k(it,Q,at){return it.index=at,u?(at=it.alternate,at!==null?(at=at.index,at<Q?(it.flags|=67108866,Q):at):(it.flags|=67108866,Q)):(it.flags|=1048576,Q)}function D(it){return u&&it.alternate===null&&(it.flags|=67108866),it}function L(it,Q,at,xt){return Q===null||Q.tag!==6?(Q=px(at,it.mode,xt),Q.return=it,Q):(Q=S(Q,at),Q.return=it,Q)}function K(it,Q,at,xt){var Pt=at.type;return Pt===v?bt(it,Q,at.props.children,xt,at.key):Q!==null&&(Q.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===N&&r_(Pt)===Q.type)?(Q=S(Q,at.props),jf(Q,at),Q.return=it,Q):(Q=Am(at.type,at.key,at.props,null,it.mode,xt),jf(Q,at),Q.return=it,Q)}function lt(it,Q,at,xt){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==at.containerInfo||Q.stateNode.implementation!==at.implementation?(Q=mx(at,it.mode,xt),Q.return=it,Q):(Q=S(Q,at.children||[]),Q.return=it,Q)}function bt(it,Q,at,xt,Pt){return Q===null||Q.tag!==7?(Q=Lo(at,it.mode,xt,Pt),Q.return=it,Q):(Q=S(Q,at),Q.return=it,Q)}function wt(it,Q,at){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=px(""+Q,it.mode,at),Q.return=it,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case p:return at=Am(Q.type,Q.key,Q.props,null,it.mode,at),jf(at,Q),at.return=it,at;case g:return Q=mx(Q,it.mode,at),Q.return=it,Q;case N:var xt=Q._init;return Q=xt(Q._payload),wt(it,Q,at)}if(z(Q)||P(Q))return Q=Lo(Q,it.mode,at,null),Q.return=it,Q;if(typeof Q.then=="function")return wt(it,Vm(Q),at);if(Q.$$typeof===T)return wt(it,Om(it,Q),at);Wm(it,Q)}return null}function ut(it,Q,at,xt){var Pt=Q!==null?Q.key:null;if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Pt!==null?null:L(it,Q,""+at,xt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case p:return at.key===Pt?K(it,Q,at,xt):null;case g:return at.key===Pt?lt(it,Q,at,xt):null;case N:return Pt=at._init,at=Pt(at._payload),ut(it,Q,at,xt)}if(z(at)||P(at))return Pt!==null?null:bt(it,Q,at,xt,null);if(typeof at.then=="function")return ut(it,Q,Vm(at),xt);if(at.$$typeof===T)return ut(it,Q,Om(it,at),xt);Wm(it,at)}return null}function ft(it,Q,at,xt,Pt){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return it=it.get(at)||null,L(Q,it,""+xt,Pt);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case p:return it=it.get(xt.key===null?at:xt.key)||null,K(Q,it,xt,Pt);case g:return it=it.get(xt.key===null?at:xt.key)||null,lt(Q,it,xt,Pt);case N:var le=xt._init;return xt=le(xt._payload),ft(it,Q,at,xt,Pt)}if(z(xt)||P(xt))return it=it.get(at)||null,bt(Q,it,xt,Pt,null);if(typeof xt.then=="function")return ft(it,Q,at,Vm(xt),Pt);if(xt.$$typeof===T)return ft(it,Q,at,Om(Q,xt),Pt);Wm(Q,xt)}return null}function Qt(it,Q,at,xt){for(var Pt=null,le=null,zt=Q,Ht=Q=0,Hn=null;zt!==null&&Ht<at.length;Ht++){zt.index>Ht?(Hn=zt,zt=null):Hn=zt.sibling;var Se=ut(it,zt,at[Ht],xt);if(Se===null){zt===null&&(zt=Hn);break}u&&zt&&Se.alternate===null&&f(it,zt),Q=k(Se,Q,Ht),le===null?Pt=Se:le.sibling=Se,le=Se,zt=Hn}if(Ht===at.length)return m(it,zt),$e&&zo(it,Ht),Pt;if(zt===null){for(;Ht<at.length;Ht++)zt=wt(it,at[Ht],xt),zt!==null&&(Q=k(zt,Q,Ht),le===null?Pt=zt:le.sibling=zt,le=zt);return $e&&zo(it,Ht),Pt}for(zt=y(zt);Ht<at.length;Ht++)Hn=ft(zt,it,Ht,at[Ht],xt),Hn!==null&&(u&&Hn.alternate!==null&&zt.delete(Hn.key===null?Ht:Hn.key),Q=k(Hn,Q,Ht),le===null?Pt=Hn:le.sibling=Hn,le=Hn);return u&&zt.forEach(function(Qs){return f(it,Qs)}),$e&&zo(it,Ht),Pt}function Gt(it,Q,at,xt){if(at==null)throw Error(r(151));for(var Pt=null,le=null,zt=Q,Ht=Q=0,Hn=null,Se=at.next();zt!==null&&!Se.done;Ht++,Se=at.next()){zt.index>Ht?(Hn=zt,zt=null):Hn=zt.sibling;var Qs=ut(it,zt,Se.value,xt);if(Qs===null){zt===null&&(zt=Hn);break}u&&zt&&Qs.alternate===null&&f(it,zt),Q=k(Qs,Q,Ht),le===null?Pt=Qs:le.sibling=Qs,le=Qs,zt=Hn}if(Se.done)return m(it,zt),$e&&zo(it,Ht),Pt;if(zt===null){for(;!Se.done;Ht++,Se=at.next())Se=wt(it,Se.value,xt),Se!==null&&(Q=k(Se,Q,Ht),le===null?Pt=Se:le.sibling=Se,le=Se);return $e&&zo(it,Ht),Pt}for(zt=y(zt);!Se.done;Ht++,Se=at.next())Se=ft(zt,it,Ht,Se.value,xt),Se!==null&&(u&&Se.alternate!==null&&zt.delete(Se.key===null?Ht:Se.key),Q=k(Se,Q,Ht),le===null?Pt=Se:le.sibling=Se,le=Se);return u&&zt.forEach(function(FK){return f(it,FK)}),$e&&zo(it,Ht),Pt}function Pe(it,Q,at,xt){if(typeof at=="object"&&at!==null&&at.type===v&&at.key===null&&(at=at.props.children),typeof at=="object"&&at!==null){switch(at.$$typeof){case p:t:{for(var Pt=at.key;Q!==null;){if(Q.key===Pt){if(Pt=at.type,Pt===v){if(Q.tag===7){m(it,Q.sibling),xt=S(Q,at.props.children),xt.return=it,it=xt;break t}}else if(Q.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===N&&r_(Pt)===Q.type){m(it,Q.sibling),xt=S(Q,at.props),jf(xt,at),xt.return=it,it=xt;break t}m(it,Q);break}else f(it,Q);Q=Q.sibling}at.type===v?(xt=Lo(at.props.children,it.mode,xt,at.key),xt.return=it,it=xt):(xt=Am(at.type,at.key,at.props,null,it.mode,xt),jf(xt,at),xt.return=it,it=xt)}return D(it);case g:t:{for(Pt=at.key;Q!==null;){if(Q.key===Pt)if(Q.tag===4&&Q.stateNode.containerInfo===at.containerInfo&&Q.stateNode.implementation===at.implementation){m(it,Q.sibling),xt=S(Q,at.children||[]),xt.return=it,it=xt;break t}else{m(it,Q);break}else f(it,Q);Q=Q.sibling}xt=mx(at,it.mode,xt),xt.return=it,it=xt}return D(it);case N:return Pt=at._init,at=Pt(at._payload),Pe(it,Q,at,xt)}if(z(at))return Qt(it,Q,at,xt);if(P(at)){if(Pt=P(at),typeof Pt!="function")throw Error(r(150));return at=Pt.call(at),Gt(it,Q,at,xt)}if(typeof at.then=="function")return Pe(it,Q,Vm(at),xt);if(at.$$typeof===T)return Pe(it,Q,Om(it,at),xt);Wm(it,at)}return typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint"?(at=""+at,Q!==null&&Q.tag===6?(m(it,Q.sibling),xt=S(Q,at),xt.return=it,it=xt):(m(it,Q),xt=px(at,it.mode,xt),xt.return=it,it=xt),D(it)):m(it,Q)}return function(it,Q,at,xt){try{zf=0;var Pt=Pe(it,Q,at,xt);return wu=null,Pt}catch(zt){if(zt===Nf||zt===_m)throw zt;var le=Jr(29,zt,null,it.mode);return le.lanes=xt,le.return=it,le}finally{}}}var Su=i_(!0),a_=i_(!1),Si=G(null),da=null;function Fs(u){var f=u.alternate;Y(Pn,Pn.current&1),Y(Si,u),da===null&&(f===null||yu.current!==null||f.memoizedState!==null)&&(da=u)}function s_(u){if(u.tag===22){if(Y(Pn,Pn.current),Y(Si,u),da===null){var f=u.alternate;f!==null&&f.memoizedState!==null&&(da=u)}}else Ls()}function Ls(){Y(Pn,Pn.current),Y(Si,Si.current)}function Ya(u){H(Si),da===u&&(da=null),H(Pn)}var Pn=G(0);function Gm(u){for(var f=u;f!==null;){if(f.tag===13){var m=f.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||F1(m)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function Xx(u,f,m,y){f=u.memoizedState,m=m(y,f),m=m==null?f:h({},f,m),u.memoizedState=m,u.lanes===0&&(u.updateQueue.baseState=m)}var Kx={enqueueSetState:function(u,f,m){u=u._reactInternals;var y=ri(),S=Ds(y);S.payload=f,m!=null&&(S.callback=m),f=Ms(u,S,y),f!==null&&(ii(f,u,y),Rf(f,u,y))},enqueueReplaceState:function(u,f,m){u=u._reactInternals;var y=ri(),S=Ds(y);S.tag=1,S.payload=f,m!=null&&(S.callback=m),f=Ms(u,S,y),f!==null&&(ii(f,u,y),Rf(f,u,y))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var m=ri(),y=Ds(m);y.tag=2,f!=null&&(y.callback=f),f=Ms(u,y,m),f!==null&&(ii(f,u,m),Rf(f,u,m))}};function o_(u,f,m,y,S,k,D){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(y,k,D):f.prototype&&f.prototype.isPureReactComponent?!Cf(m,y)||!Cf(S,k):!0}function l_(u,f,m,y){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(m,y),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(m,y),f.state!==u&&Kx.enqueueReplaceState(f,f.state,null)}function Ho(u,f){var m=f;if("ref"in f){m={};for(var y in f)y!=="ref"&&(m[y]=f[y])}if(u=u.defaultProps){m===f&&(m=h({},m));for(var S in u)m[S]===void 0&&(m[S]=u[S])}return m}var qm=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function u_(u){qm(u)}function c_(u){console.error(u)}function f_(u){qm(u)}function Hm(u,f){try{var m=u.onUncaughtError;m(f.value,{componentStack:f.stack})}catch(y){setTimeout(function(){throw y})}}function h_(u,f,m){try{var y=u.onCaughtError;y(m.value,{componentStack:m.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function Yx(u,f,m){return m=Ds(m),m.tag=3,m.payload={element:null},m.callback=function(){Hm(u,f)},m}function d_(u){return u=Ds(u),u.tag=3,u}function p_(u,f,m,y){var S=m.type.getDerivedStateFromError;if(typeof S=="function"){var k=y.value;u.payload=function(){return S(k)},u.callback=function(){h_(f,m,y)}}var D=m.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(u.callback=function(){h_(f,m,y),typeof S!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var L=y.stack;this.componentDidCatch(y.value,{componentStack:L!==null?L:""})})}function FX(u,f,m,y,S){if(m.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(f=m.alternate,f!==null&&Ef(f,m,S,!0),m=Si.current,m!==null){switch(m.tag){case 13:return da===null?x1():m.alternate===null&&on===0&&(on=3),m.flags&=-257,m.flags|=65536,m.lanes=S,y===$x?m.flags|=16384:(f=m.updateQueue,f===null?m.updateQueue=new Set([y]):f.add(y),S1(u,y,S)),!1;case 22:return m.flags|=65536,y===$x?m.flags|=16384:(f=m.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([y])},m.updateQueue=f):(m=f.retryQueue,m===null?f.retryQueue=new Set([y]):m.add(y)),S1(u,y,S)),!1}throw Error(r(435,m.tag))}return S1(u,y,S),x1(),!1}if($e)return f=Si.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=S,y!==vx&&(u=Error(r(422),{cause:y}),kf(vi(u,m)))):(y!==vx&&(f=Error(r(423),{cause:y}),kf(vi(f,m))),u=u.current.alternate,u.flags|=65536,S&=-S,u.lanes|=S,y=vi(y,m),S=Yx(u.stateNode,y,S),Ex(u,S),on!==4&&(on=2)),!1;var k=Error(r(520),{cause:y});if(k=vi(k,m),Xf===null?Xf=[k]:Xf.push(k),on!==4&&(on=2),f===null)return!0;y=vi(y,m),m=f;do{switch(m.tag){case 3:return m.flags|=65536,u=S&-S,m.lanes|=u,u=Yx(m.stateNode,y,u),Ex(m,u),!1;case 1:if(f=m.type,k=m.stateNode,(m.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Ws===null||!Ws.has(k))))return m.flags|=65536,S&=-S,m.lanes|=S,S=d_(S),p_(S,u,m,y),Ex(m,S),!1}m=m.return}while(m!==null);return!1}var m_=Error(r(461)),Gn=!1;function nr(u,f,m,y){f.child=u===null?a_(f,null,m,y):Su(f,u.child,m,y)}function g_(u,f,m,y,S){m=m.render;var k=f.ref;if("ref"in y){var D={};for(var L in y)L!=="ref"&&(D[L]=y[L])}else D=y;return Wo(f),y=Rx(u,f,m,D,k,S),L=Dx(),u!==null&&!Gn?(Mx(u,f,S),Za(u,f,S)):($e&&L&&gx(f),f.flags|=1,nr(u,f,y,S),f.child)}function y_(u,f,m,y,S){if(u===null){var k=m.type;return typeof k=="function"&&!dx(k)&&k.defaultProps===void 0&&m.compare===null?(f.tag=15,f.type=k,v_(u,f,k,y,S)):(u=Am(m.type,null,y,f,f.mode,S),u.ref=f.ref,u.return=f,f.child=u)}if(k=u.child,!i1(u,S)){var D=k.memoizedProps;if(m=m.compare,m=m!==null?m:Cf,m(D,y)&&u.ref===f.ref)return Za(u,f,S)}return f.flags|=1,u=Wa(k,y),u.ref=f.ref,u.return=f,f.child=u}function v_(u,f,m,y,S){if(u!==null){var k=u.memoizedProps;if(Cf(k,y)&&u.ref===f.ref)if(Gn=!1,f.pendingProps=y=k,i1(u,S))(u.flags&131072)!==0&&(Gn=!0);else return f.lanes=u.lanes,Za(u,f,S)}return Zx(u,f,m,y,S)}function b_(u,f,m){var y=f.pendingProps,S=y.children,k=u!==null?u.memoizedState:null;if(y.mode==="hidden"){if((f.flags&128)!==0){if(y=k!==null?k.baseLanes|m:m,u!==null){for(S=f.child=u.child,k=0;S!==null;)k=k|S.lanes|S.childLanes,S=S.sibling;f.childLanes=k&~y}else f.childLanes=0,f.child=null;return x_(u,f,y,m)}if((m&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&Nm(f,k!==null?k.cachePool:null),k!==null?vN(f,k):Ox(),s_(f);else return f.lanes=f.childLanes=536870912,x_(u,f,k!==null?k.baseLanes|m:m,m)}else k!==null?(Nm(f,k.cachePool),vN(f,k),Ls(),f.memoizedState=null):(u!==null&&Nm(f,null),Ox(),Ls());return nr(u,f,S,m),f.child}function x_(u,f,m,y){var S=Tx();return S=S===null?null:{parent:Mn._currentValue,pool:S},f.memoizedState={baseLanes:m,cachePool:S},u!==null&&Nm(f,null),Ox(),s_(f),u!==null&&Ef(u,f,y,!0),null}function Xm(u,f){var m=f.ref;if(m===null)u!==null&&u.ref!==null&&(f.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(r(284));(u===null||u.ref!==m)&&(f.flags|=4194816)}}function Zx(u,f,m,y,S){return Wo(f),m=Rx(u,f,m,y,void 0,S),y=Dx(),u!==null&&!Gn?(Mx(u,f,S),Za(u,f,S)):($e&&y&&gx(f),f.flags|=1,nr(u,f,m,S),f.child)}function w_(u,f,m,y,S,k){return Wo(f),f.updateQueue=null,m=xN(f,y,m,S),bN(u),y=Dx(),u!==null&&!Gn?(Mx(u,f,k),Za(u,f,k)):($e&&y&&gx(f),f.flags|=1,nr(u,f,m,k),f.child)}function S_(u,f,m,y,S){if(Wo(f),f.stateNode===null){var k=hu,D=m.contextType;typeof D=="object"&&D!==null&&(k=mr(D)),k=new m(y,k),f.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=Kx,f.stateNode=k,k._reactInternals=f,k=f.stateNode,k.props=y,k.state=f.memoizedState,k.refs={},Ax(f),D=m.contextType,k.context=typeof D=="object"&&D!==null?mr(D):hu,k.state=f.memoizedState,D=m.getDerivedStateFromProps,typeof D=="function"&&(Xx(f,m,D,y),k.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(D=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),D!==k.state&&Kx.enqueueReplaceState(k,k.state,null),Mf(f,y,k,S),Df(),k.state=f.memoizedState),typeof k.componentDidMount=="function"&&(f.flags|=4194308),y=!0}else if(u===null){k=f.stateNode;var L=f.memoizedProps,K=Ho(m,L);k.props=K;var lt=k.context,bt=m.contextType;D=hu,typeof bt=="object"&&bt!==null&&(D=mr(bt));var wt=m.getDerivedStateFromProps;bt=typeof wt=="function"||typeof k.getSnapshotBeforeUpdate=="function",L=f.pendingProps!==L,bt||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(L||lt!==D)&&l_(f,k,y,D),Rs=!1;var ut=f.memoizedState;k.state=ut,Mf(f,y,k,S),Df(),lt=f.memoizedState,L||ut!==lt||Rs?(typeof wt=="function"&&(Xx(f,m,wt,y),lt=f.memoizedState),(K=Rs||o_(f,m,K,y,ut,lt,D))?(bt||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(f.flags|=4194308)):(typeof k.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=y,f.memoizedState=lt),k.props=y,k.state=lt,k.context=D,y=K):(typeof k.componentDidMount=="function"&&(f.flags|=4194308),y=!1)}else{k=f.stateNode,kx(u,f),D=f.memoizedProps,bt=Ho(m,D),k.props=bt,wt=f.pendingProps,ut=k.context,lt=m.contextType,K=hu,typeof lt=="object"&&lt!==null&&(K=mr(lt)),L=m.getDerivedStateFromProps,(lt=typeof L=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(D!==wt||ut!==K)&&l_(f,k,y,K),Rs=!1,ut=f.memoizedState,k.state=ut,Mf(f,y,k,S),Df();var ft=f.memoizedState;D!==wt||ut!==ft||Rs||u!==null&&u.dependencies!==null&&Im(u.dependencies)?(typeof L=="function"&&(Xx(f,m,L,y),ft=f.memoizedState),(bt=Rs||o_(f,m,bt,y,ut,ft,K)||u!==null&&u.dependencies!==null&&Im(u.dependencies))?(lt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(y,ft,K),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(y,ft,K)),typeof k.componentDidUpdate=="function"&&(f.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof k.componentDidUpdate!="function"||D===u.memoizedProps&&ut===u.memoizedState||(f.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||D===u.memoizedProps&&ut===u.memoizedState||(f.flags|=1024),f.memoizedProps=y,f.memoizedState=ft),k.props=y,k.state=ft,k.context=K,y=bt):(typeof k.componentDidUpdate!="function"||D===u.memoizedProps&&ut===u.memoizedState||(f.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||D===u.memoizedProps&&ut===u.memoizedState||(f.flags|=1024),y=!1)}return k=y,Xm(u,f),y=(f.flags&128)!==0,k||y?(k=f.stateNode,m=y&&typeof m.getDerivedStateFromError!="function"?null:k.render(),f.flags|=1,u!==null&&y?(f.child=Su(f,u.child,null,S),f.child=Su(f,null,m,S)):nr(u,f,m,S),f.memoizedState=k.state,u=f.child):u=Za(u,f,S),u}function C_(u,f,m,y){return Af(),f.flags|=256,nr(u,f,m,y),f.child}var Qx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jx(u){return{baseLanes:u,cachePool:cN()}}function t1(u,f,m){return u=u!==null?u.childLanes&~m:0,f&&(u|=Ci),u}function T_(u,f,m){var y=f.pendingProps,S=!1,k=(f.flags&128)!==0,D;if((D=k)||(D=u!==null&&u.memoizedState===null?!1:(Pn.current&2)!==0),D&&(S=!0,f.flags&=-129),D=(f.flags&32)!==0,f.flags&=-33,u===null){if($e){if(S?Fs(f):Ls(),$e){var L=sn,K;if(K=L){t:{for(K=L,L=ha;K.nodeType!==8;){if(!L){L=null;break t}if(K=qi(K.nextSibling),K===null){L=null;break t}}L=K}L!==null?(f.memoizedState={dehydrated:L,treeContext:Bo!==null?{id:Ga,overflow:qa}:null,retryLane:536870912,hydrationErrors:null},K=Jr(18,null,null,0),K.stateNode=L,K.return=f,f.child=K,Ar=f,sn=null,K=!0):K=!1}K||Uo(f)}if(L=f.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return F1(L)?f.lanes=32:f.lanes=536870912,null;Ya(f)}return L=y.children,y=y.fallback,S?(Ls(),S=f.mode,L=Km({mode:"hidden",children:L},S),y=Lo(y,S,m,null),L.return=f,y.return=f,L.sibling=y,f.child=L,S=f.child,S.memoizedState=Jx(m),S.childLanes=t1(u,D,m),f.memoizedState=Qx,y):(Fs(f),e1(f,L))}if(K=u.memoizedState,K!==null&&(L=K.dehydrated,L!==null)){if(k)f.flags&256?(Fs(f),f.flags&=-257,f=n1(u,f,m)):f.memoizedState!==null?(Ls(),f.child=u.child,f.flags|=128,f=null):(Ls(),S=y.fallback,L=f.mode,y=Km({mode:"visible",children:y.children},L),S=Lo(S,L,m,null),S.flags|=2,y.return=f,S.return=f,y.sibling=S,f.child=y,Su(f,u.child,null,m),y=f.child,y.memoizedState=Jx(m),y.childLanes=t1(u,D,m),f.memoizedState=Qx,f=S);else if(Fs(f),F1(L)){if(D=L.nextSibling&&L.nextSibling.dataset,D)var lt=D.dgst;D=lt,y=Error(r(419)),y.stack="",y.digest=D,kf({value:y,source:null,stack:null}),f=n1(u,f,m)}else if(Gn||Ef(u,f,m,!1),D=(m&u.childLanes)!==0,Gn||D){if(D=qe,D!==null&&(y=m&-m,y=(y&42)!==0?1:L0(y),y=(y&(D.suspendedLanes|m))!==0?0:y,y!==0&&y!==K.retryLane))throw K.retryLane=y,fu(u,y),ii(D,u,y),m_;L.data==="$?"||x1(),f=n1(u,f,m)}else L.data==="$?"?(f.flags|=192,f.child=u.child,f=null):(u=K.treeContext,sn=qi(L.nextSibling),Ar=f,$e=!0,jo=null,ha=!1,u!==null&&(xi[wi++]=Ga,xi[wi++]=qa,xi[wi++]=Bo,Ga=u.id,qa=u.overflow,Bo=f),f=e1(f,y.children),f.flags|=4096);return f}return S?(Ls(),S=y.fallback,L=f.mode,K=u.child,lt=K.sibling,y=Wa(K,{mode:"hidden",children:y.children}),y.subtreeFlags=K.subtreeFlags&65011712,lt!==null?S=Wa(lt,S):(S=Lo(S,L,m,null),S.flags|=2),S.return=f,y.return=f,y.sibling=S,f.child=y,y=S,S=f.child,L=u.child.memoizedState,L===null?L=Jx(m):(K=L.cachePool,K!==null?(lt=Mn._currentValue,K=K.parent!==lt?{parent:lt,pool:lt}:K):K=cN(),L={baseLanes:L.baseLanes|m,cachePool:K}),S.memoizedState=L,S.childLanes=t1(u,D,m),f.memoizedState=Qx,y):(Fs(f),m=u.child,u=m.sibling,m=Wa(m,{mode:"visible",children:y.children}),m.return=f,m.sibling=null,u!==null&&(D=f.deletions,D===null?(f.deletions=[u],f.flags|=16):D.push(u)),f.child=m,f.memoizedState=null,m)}function e1(u,f){return f=Km({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function Km(u,f){return u=Jr(22,u,null,f),u.lanes=0,u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},u}function n1(u,f,m){return Su(f,u.child,null,m),u=e1(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function $_(u,f,m){u.lanes|=f;var y=u.alternate;y!==null&&(y.lanes|=f),xx(u.return,f,m)}function r1(u,f,m,y,S){var k=u.memoizedState;k===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:y,tail:m,tailMode:S}:(k.isBackwards=f,k.rendering=null,k.renderingStartTime=0,k.last=y,k.tail=m,k.tailMode=S)}function A_(u,f,m){var y=f.pendingProps,S=y.revealOrder,k=y.tail;if(nr(u,f,y.children,m),y=Pn.current,(y&2)!==0)y=y&1|2,f.flags|=128;else{if(u!==null&&(u.flags&128)!==0)t:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&$_(u,m,f);else if(u.tag===19)$_(u,m,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break t;for(;u.sibling===null;){if(u.return===null||u.return===f)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}y&=1}switch(Y(Pn,y),S){case"forwards":for(m=f.child,S=null;m!==null;)u=m.alternate,u!==null&&Gm(u)===null&&(S=m),m=m.sibling;m=S,m===null?(S=f.child,f.child=null):(S=m.sibling,m.sibling=null),r1(f,!1,S,m,k);break;case"backwards":for(m=null,S=f.child,f.child=null;S!==null;){if(u=S.alternate,u!==null&&Gm(u)===null){f.child=S;break}u=S.sibling,S.sibling=m,m=S,S=u}r1(f,!0,m,null,k);break;case"together":r1(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Za(u,f,m){if(u!==null&&(f.dependencies=u.dependencies),Vs|=f.lanes,(m&f.childLanes)===0)if(u!==null){if(Ef(u,f,m,!1),(m&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(r(153));if(f.child!==null){for(u=f.child,m=Wa(u,u.pendingProps),f.child=m,m.return=f;u.sibling!==null;)u=u.sibling,m=m.sibling=Wa(u,u.pendingProps),m.return=f;m.sibling=null}return f.child}function i1(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&Im(u)))}function LX(u,f,m){switch(f.tag){case 3:$t(f,f.stateNode.containerInfo),_s(f,Mn,u.memoizedState.cache),Af();break;case 27:case 5:At(f);break;case 4:$t(f,f.stateNode.containerInfo);break;case 10:_s(f,f.type,f.memoizedProps.value);break;case 13:var y=f.memoizedState;if(y!==null)return y.dehydrated!==null?(Fs(f),f.flags|=128,null):(m&f.child.childLanes)!==0?T_(u,f,m):(Fs(f),u=Za(u,f,m),u!==null?u.sibling:null);Fs(f);break;case 19:var S=(u.flags&128)!==0;if(y=(m&f.childLanes)!==0,y||(Ef(u,f,m,!1),y=(m&f.childLanes)!==0),S){if(y)return A_(u,f,m);f.flags|=128}if(S=f.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),Y(Pn,Pn.current),y)break;return null;case 22:case 23:return f.lanes=0,b_(u,f,m);case 24:_s(f,Mn,u.memoizedState.cache)}return Za(u,f,m)}function k_(u,f,m){if(u!==null)if(u.memoizedProps!==f.pendingProps)Gn=!0;else{if(!i1(u,m)&&(f.flags&128)===0)return Gn=!1,LX(u,f,m);Gn=(u.flags&131072)!==0}else Gn=!1,$e&&(f.flags&1048576)!==0&&rN(f,Em,f.index);switch(f.lanes=0,f.tag){case 16:t:{u=f.pendingProps;var y=f.elementType,S=y._init;if(y=S(y._payload),f.type=y,typeof y=="function")dx(y)?(u=Ho(y,u),f.tag=1,f=S_(null,f,y,u,m)):(f.tag=0,f=Zx(null,f,y,u,m));else{if(y!=null){if(S=y.$$typeof,S===$){f.tag=11,f=g_(null,f,y,u,m);break t}else if(S===O){f.tag=14,f=y_(null,f,y,u,m);break t}}throw f=V(y)||y,Error(r(306,f,""))}}return f;case 0:return Zx(u,f,f.type,f.pendingProps,m);case 1:return y=f.type,S=Ho(y,f.pendingProps),S_(u,f,y,S,m);case 3:t:{if($t(f,f.stateNode.containerInfo),u===null)throw Error(r(387));y=f.pendingProps;var k=f.memoizedState;S=k.element,kx(u,f),Mf(f,y,null,m);var D=f.memoizedState;if(y=D.cache,_s(f,Mn,y),y!==k.cache&&wx(f,[Mn],m,!0),Df(),y=D.element,k.isDehydrated)if(k={element:y,isDehydrated:!1,cache:D.cache},f.updateQueue.baseState=k,f.memoizedState=k,f.flags&256){f=C_(u,f,y,m);break t}else if(y!==S){S=vi(Error(r(424)),f),kf(S),f=C_(u,f,y,m);break t}else{switch(u=f.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(sn=qi(u.firstChild),Ar=f,$e=!0,jo=null,ha=!0,m=a_(f,null,y,m),f.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling}else{if(Af(),y===S){f=Za(u,f,m);break t}nr(u,f,y,m)}f=f.child}return f;case 26:return Xm(u,f),u===null?(m=NR(f.type,null,f.pendingProps,null))?f.memoizedState=m:$e||(m=f.type,u=f.pendingProps,y=ug(yt.current).createElement(m),y[pr]=f,y[zr]=u,ir(y,m,u),Wn(y),f.stateNode=y):f.memoizedState=NR(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:return At(f),u===null&&$e&&(y=f.stateNode=ER(f.type,f.pendingProps,yt.current),Ar=f,ha=!0,S=sn,Hs(f.type)?(L1=S,sn=qi(y.firstChild)):sn=S),nr(u,f,f.pendingProps.children,m),Xm(u,f),u===null&&(f.flags|=4194304),f.child;case 5:return u===null&&$e&&((S=y=sn)&&(y=hK(y,f.type,f.pendingProps,ha),y!==null?(f.stateNode=y,Ar=f,sn=qi(y.firstChild),ha=!1,S=!0):S=!1),S||Uo(f)),At(f),S=f.type,k=f.pendingProps,D=u!==null?u.memoizedProps:null,y=k.children,D1(S,k)?y=null:D!==null&&D1(S,D)&&(f.flags|=32),f.memoizedState!==null&&(S=Rx(u,f,OX,null,null,m),rh._currentValue=S),Xm(u,f),nr(u,f,y,m),f.child;case 6:return u===null&&$e&&((u=m=sn)&&(m=dK(m,f.pendingProps,ha),m!==null?(f.stateNode=m,Ar=f,sn=null,u=!0):u=!1),u||Uo(f)),null;case 13:return T_(u,f,m);case 4:return $t(f,f.stateNode.containerInfo),y=f.pendingProps,u===null?f.child=Su(f,null,y,m):nr(u,f,y,m),f.child;case 11:return g_(u,f,f.type,f.pendingProps,m);case 7:return nr(u,f,f.pendingProps,m),f.child;case 8:return nr(u,f,f.pendingProps.children,m),f.child;case 12:return nr(u,f,f.pendingProps.children,m),f.child;case 10:return y=f.pendingProps,_s(f,f.type,y.value),nr(u,f,y.children,m),f.child;case 9:return S=f.type._context,y=f.pendingProps.children,Wo(f),S=mr(S),y=y(S),f.flags|=1,nr(u,f,y,m),f.child;case 14:return y_(u,f,f.type,f.pendingProps,m);case 15:return v_(u,f,f.type,f.pendingProps,m);case 19:return A_(u,f,m);case 31:return y=f.pendingProps,m=f.mode,y={mode:y.mode,children:y.children},u===null?(m=Km(y,m),m.ref=f.ref,f.child=m,m.return=f,f=m):(m=Wa(u.child,y),m.ref=f.ref,f.child=m,m.return=f,f=m),f;case 22:return b_(u,f,m);case 24:return Wo(f),y=mr(Mn),u===null?(S=Tx(),S===null&&(S=qe,k=Sx(),S.pooledCache=k,k.refCount++,k!==null&&(S.pooledCacheLanes|=m),S=k),f.memoizedState={parent:y,cache:S},Ax(f),_s(f,Mn,S)):((u.lanes&m)!==0&&(kx(u,f),Mf(f,null,null,m),Df()),S=u.memoizedState,k=f.memoizedState,S.parent!==y?(S={parent:y,cache:y},f.memoizedState=S,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=S),_s(f,Mn,y)):(y=k.cache,_s(f,Mn,y),y!==S.cache&&wx(f,[Mn],m,!0))),nr(u,f,f.pendingProps.children,m),f.child;case 29:throw f.pendingProps}throw Error(r(156,f.tag))}function Qa(u){u.flags|=4}function E_(u,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!PR(f)){if(f=Si.current,f!==null&&((ve&4194048)===ve?da!==null:(ve&62914560)!==ve&&(ve&536870912)===0||f!==da))throw _f=$x,fN;u.flags|=8192}}function Ym(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?sO():536870912,u.lanes|=f,Au|=f)}function Uf(u,f){if(!$e)switch(u.tailMode){case"hidden":f=u.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?u.tail=null:m.sibling=null;break;case"collapsed":m=u.tail;for(var y=null;m!==null;)m.alternate!==null&&(y=m),m=m.sibling;y===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:y.sibling=null}}function rn(u){var f=u.alternate!==null&&u.alternate.child===u.child,m=0,y=0;if(f)for(var S=u.child;S!==null;)m|=S.lanes|S.childLanes,y|=S.subtreeFlags&65011712,y|=S.flags&65011712,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)m|=S.lanes|S.childLanes,y|=S.subtreeFlags,y|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=y,u.childLanes=m,f}function BX(u,f,m){var y=f.pendingProps;switch(yx(f),f.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(f),null;case 1:return rn(f),null;case 3:return m=f.stateNode,y=null,u!==null&&(y=u.memoizedState.cache),f.memoizedState.cache!==y&&(f.flags|=2048),Xa(Mn),mt(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(u===null||u.child===null)&&($f(f)?Qa(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,sN())),rn(f),null;case 26:return m=f.memoizedState,u===null?(Qa(f),m!==null?(rn(f),E_(f,m)):(rn(f),f.flags&=-16777217)):m?m!==u.memoizedState?(Qa(f),rn(f),E_(f,m)):(rn(f),f.flags&=-16777217):(u.memoizedProps!==y&&Qa(f),rn(f),f.flags&=-16777217),null;case 27:kt(f),m=yt.current;var S=f.type;if(u!==null&&f.stateNode!=null)u.memoizedProps!==y&&Qa(f);else{if(!y){if(f.stateNode===null)throw Error(r(166));return rn(f),null}u=ot.current,$f(f)?iN(f):(u=ER(S,y,m),f.stateNode=u,Qa(f))}return rn(f),null;case 5:if(kt(f),m=f.type,u!==null&&f.stateNode!=null)u.memoizedProps!==y&&Qa(f);else{if(!y){if(f.stateNode===null)throw Error(r(166));return rn(f),null}if(u=ot.current,$f(f))iN(f);else{switch(S=ug(yt.current),u){case 1:u=S.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:u=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":u=S.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":u=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":u=S.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof y.is=="string"?S.createElement("select",{is:y.is}):S.createElement("select"),y.multiple?u.multiple=!0:y.size&&(u.size=y.size);break;default:u=typeof y.is=="string"?S.createElement(m,{is:y.is}):S.createElement(m)}}u[pr]=f,u[zr]=y;t:for(S=f.child;S!==null;){if(S.tag===5||S.tag===6)u.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===f)break t;for(;S.sibling===null;){if(S.return===null||S.return===f)break t;S=S.return}S.sibling.return=S.return,S=S.sibling}f.stateNode=u;t:switch(ir(u,m,y),m){case"button":case"input":case"select":case"textarea":u=!!y.autoFocus;break t;case"img":u=!0;break t;default:u=!1}u&&Qa(f)}}return rn(f),f.flags&=-16777217,null;case 6:if(u&&f.stateNode!=null)u.memoizedProps!==y&&Qa(f);else{if(typeof y!="string"&&f.stateNode===null)throw Error(r(166));if(u=yt.current,$f(f)){if(u=f.stateNode,m=f.memoizedProps,y=null,S=Ar,S!==null)switch(S.tag){case 27:case 5:y=S.memoizedProps}u[pr]=f,u=!!(u.nodeValue===m||y!==null&&y.suppressHydrationWarning===!0||wR(u.nodeValue,m)),u||Uo(f)}else u=ug(u).createTextNode(y),u[pr]=f,f.stateNode=u}return rn(f),null;case 13:if(y=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(S=$f(f),y!==null&&y.dehydrated!==null){if(u===null){if(!S)throw Error(r(318));if(S=f.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[pr]=f}else Af(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;rn(f),S=!1}else S=sN(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=S),S=!0;if(!S)return f.flags&256?(Ya(f),f):(Ya(f),null)}if(Ya(f),(f.flags&128)!==0)return f.lanes=m,f;if(m=y!==null,u=u!==null&&u.memoizedState!==null,m){y=f.child,S=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(S=y.alternate.memoizedState.cachePool.pool);var k=null;y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(k=y.memoizedState.cachePool.pool),k!==S&&(y.flags|=2048)}return m!==u&&m&&(f.child.flags|=8192),Ym(f,f.updateQueue),rn(f),null;case 4:return mt(),u===null&&I1(f.stateNode.containerInfo),rn(f),null;case 10:return Xa(f.type),rn(f),null;case 19:if(H(Pn),S=f.memoizedState,S===null)return rn(f),null;if(y=(f.flags&128)!==0,k=S.rendering,k===null)if(y)Uf(S,!1);else{if(on!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(k=Gm(u),k!==null){for(f.flags|=128,Uf(S,!1),u=k.updateQueue,f.updateQueue=u,Ym(f,u),f.subtreeFlags=0,u=m,m=f.child;m!==null;)nN(m,u),m=m.sibling;return Y(Pn,Pn.current&1|2),f.child}u=u.sibling}S.tail!==null&&qt()>Jm&&(f.flags|=128,y=!0,Uf(S,!1),f.lanes=4194304)}else{if(!y)if(u=Gm(k),u!==null){if(f.flags|=128,y=!0,u=u.updateQueue,f.updateQueue=u,Ym(f,u),Uf(S,!0),S.tail===null&&S.tailMode==="hidden"&&!k.alternate&&!$e)return rn(f),null}else 2*qt()-S.renderingStartTime>Jm&&m!==536870912&&(f.flags|=128,y=!0,Uf(S,!1),f.lanes=4194304);S.isBackwards?(k.sibling=f.child,f.child=k):(u=S.last,u!==null?u.sibling=k:f.child=k,S.last=k)}return S.tail!==null?(f=S.tail,S.rendering=f,S.tail=f.sibling,S.renderingStartTime=qt(),f.sibling=null,u=Pn.current,Y(Pn,y?u&1|2:u&1),f):(rn(f),null);case 22:case 23:return Ya(f),Nx(),y=f.memoizedState!==null,u!==null?u.memoizedState!==null!==y&&(f.flags|=8192):y&&(f.flags|=8192),y?(m&536870912)!==0&&(f.flags&128)===0&&(rn(f),f.subtreeFlags&6&&(f.flags|=8192)):rn(f),m=f.updateQueue,m!==null&&Ym(f,m.retryQueue),m=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==m&&(f.flags|=2048),u!==null&&H(Go),null;case 24:return m=null,u!==null&&(m=u.memoizedState.cache),f.memoizedState.cache!==m&&(f.flags|=2048),Xa(Mn),rn(f),null;case 25:return null;case 30:return null}throw Error(r(156,f.tag))}function zX(u,f){switch(yx(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return Xa(Mn),mt(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return kt(f),null;case 13:if(Ya(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(r(340));Af()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return H(Pn),null;case 4:return mt(),null;case 10:return Xa(f.type),null;case 22:case 23:return Ya(f),Nx(),u!==null&&H(Go),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return Xa(Mn),null;case 25:return null;default:return null}}function I_(u,f){switch(yx(f),f.tag){case 3:Xa(Mn),mt();break;case 26:case 27:case 5:kt(f);break;case 4:mt();break;case 13:Ya(f);break;case 19:H(Pn);break;case 10:Xa(f.type);break;case 22:case 23:Ya(f),Nx(),u!==null&&H(Go);break;case 24:Xa(Mn)}}function Vf(u,f){try{var m=f.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var S=y.next;m=S;do{if((m.tag&u)===u){y=void 0;var k=m.create,D=m.inst;y=k(),D.destroy=y}m=m.next}while(m!==S)}}catch(L){ze(f,f.return,L)}}function Bs(u,f,m){try{var y=f.updateQueue,S=y!==null?y.lastEffect:null;if(S!==null){var k=S.next;y=k;do{if((y.tag&u)===u){var D=y.inst,L=D.destroy;if(L!==void 0){D.destroy=void 0,S=f;var K=m,lt=L;try{lt()}catch(bt){ze(S,K,bt)}}}y=y.next}while(y!==k)}}catch(bt){ze(f,f.return,bt)}}function O_(u){var f=u.updateQueue;if(f!==null){var m=u.stateNode;try{yN(f,m)}catch(y){ze(u,u.return,y)}}}function N_(u,f,m){m.props=Ho(u.type,u.memoizedProps),m.state=u.memoizedState;try{m.componentWillUnmount()}catch(y){ze(u,f,y)}}function Wf(u,f){try{var m=u.ref;if(m!==null){switch(u.tag){case 26:case 27:case 5:var y=u.stateNode;break;case 30:y=u.stateNode;break;default:y=u.stateNode}typeof m=="function"?u.refCleanup=m(y):m.current=y}}catch(S){ze(u,f,S)}}function pa(u,f){var m=u.ref,y=u.refCleanup;if(m!==null)if(typeof y=="function")try{y()}catch(S){ze(u,f,S)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(S){ze(u,f,S)}else m.current=null}function __(u){var f=u.type,m=u.memoizedProps,y=u.stateNode;try{t:switch(f){case"button":case"input":case"select":case"textarea":m.autoFocus&&y.focus();break t;case"img":m.src?y.src=m.src:m.srcSet&&(y.srcset=m.srcSet)}}catch(S){ze(u,u.return,S)}}function a1(u,f,m){try{var y=u.stateNode;oK(y,u.type,m,f),y[zr]=f}catch(S){ze(u,u.return,S)}}function R_(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&Hs(u.type)||u.tag===4}function s1(u){t:for(;;){for(;u.sibling===null;){if(u.return===null||R_(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&Hs(u.type)||u.flags&2||u.child===null||u.tag===4)continue t;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function o1(u,f,m){var y=u.tag;if(y===5||y===6)u=u.stateNode,f?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(u,f):(f=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,f.appendChild(u),m=m._reactRootContainer,m!=null||f.onclick!==null||(f.onclick=lg));else if(y!==4&&(y===27&&Hs(u.type)&&(m=u.stateNode,f=null),u=u.child,u!==null))for(o1(u,f,m),u=u.sibling;u!==null;)o1(u,f,m),u=u.sibling}function Zm(u,f,m){var y=u.tag;if(y===5||y===6)u=u.stateNode,f?m.insertBefore(u,f):m.appendChild(u);else if(y!==4&&(y===27&&Hs(u.type)&&(m=u.stateNode),u=u.child,u!==null))for(Zm(u,f,m),u=u.sibling;u!==null;)Zm(u,f,m),u=u.sibling}function D_(u){var f=u.stateNode,m=u.memoizedProps;try{for(var y=u.type,S=f.attributes;S.length;)f.removeAttributeNode(S[0]);ir(f,y,m),f[pr]=u,f[zr]=m}catch(k){ze(u,u.return,k)}}var Ja=!1,gn=!1,l1=!1,M_=typeof WeakSet=="function"?WeakSet:Set,qn=null;function jX(u,f){if(u=u.containerInfo,_1=mg,u=qO(u),sx(u)){if("selectionStart"in u)var m={start:u.selectionStart,end:u.selectionEnd};else t:{m=(m=u.ownerDocument)&&m.defaultView||window;var y=m.getSelection&&m.getSelection();if(y&&y.rangeCount!==0){m=y.anchorNode;var S=y.anchorOffset,k=y.focusNode;y=y.focusOffset;try{m.nodeType,k.nodeType}catch{m=null;break t}var D=0,L=-1,K=-1,lt=0,bt=0,wt=u,ut=null;e:for(;;){for(var ft;wt!==m||S!==0&&wt.nodeType!==3||(L=D+S),wt!==k||y!==0&&wt.nodeType!==3||(K=D+y),wt.nodeType===3&&(D+=wt.nodeValue.length),(ft=wt.firstChild)!==null;)ut=wt,wt=ft;for(;;){if(wt===u)break e;if(ut===m&&++lt===S&&(L=D),ut===k&&++bt===y&&(K=D),(ft=wt.nextSibling)!==null)break;wt=ut,ut=wt.parentNode}wt=ft}m=L===-1||K===-1?null:{start:L,end:K}}else m=null}m=m||{start:0,end:0}}else m=null;for(R1={focusedElem:u,selectionRange:m},mg=!1,qn=f;qn!==null;)if(f=qn,u=f.child,(f.subtreeFlags&1024)!==0&&u!==null)u.return=f,qn=u;else for(;qn!==null;){switch(f=qn,k=f.alternate,u=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&k!==null){u=void 0,m=f,S=k.memoizedProps,k=k.memoizedState,y=m.stateNode;try{var Qt=Ho(m.type,S,m.elementType===m.type);u=y.getSnapshotBeforeUpdate(Qt,k),y.__reactInternalSnapshotBeforeUpdate=u}catch(Gt){ze(m,m.return,Gt)}}break;case 3:if((u&1024)!==0){if(u=f.stateNode.containerInfo,m=u.nodeType,m===9)P1(u);else if(m===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":P1(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(r(163))}if(u=f.sibling,u!==null){u.return=f.return,qn=u;break}qn=f.return}}function P_(u,f,m){var y=m.flags;switch(m.tag){case 0:case 11:case 15:zs(u,m),y&4&&Vf(5,m);break;case 1:if(zs(u,m),y&4)if(u=m.stateNode,f===null)try{u.componentDidMount()}catch(D){ze(m,m.return,D)}else{var S=Ho(m.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(S,f,u.__reactInternalSnapshotBeforeUpdate)}catch(D){ze(m,m.return,D)}}y&64&&O_(m),y&512&&Wf(m,m.return);break;case 3:if(zs(u,m),y&64&&(u=m.updateQueue,u!==null)){if(f=null,m.child!==null)switch(m.child.tag){case 27:case 5:f=m.child.stateNode;break;case 1:f=m.child.stateNode}try{yN(u,f)}catch(D){ze(m,m.return,D)}}break;case 27:f===null&&y&4&&D_(m);case 26:case 5:zs(u,m),f===null&&y&4&&__(m),y&512&&Wf(m,m.return);break;case 12:zs(u,m);break;case 13:zs(u,m),y&4&&B_(u,m),y&64&&(u=m.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(m=YX.bind(null,m),pK(u,m))));break;case 22:if(y=m.memoizedState!==null||Ja,!y){f=f!==null&&f.memoizedState!==null||gn,S=Ja;var k=gn;Ja=y,(gn=f)&&!k?js(u,m,(m.subtreeFlags&8772)!==0):zs(u,m),Ja=S,gn=k}break;case 30:break;default:zs(u,m)}}function F_(u){var f=u.alternate;f!==null&&(u.alternate=null,F_(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&j0(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var Qe=null,Vr=!1;function ts(u,f,m){for(m=m.child;m!==null;)L_(u,f,m),m=m.sibling}function L_(u,f,m){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Br,m)}catch{}switch(m.tag){case 26:gn||pa(m,f),ts(u,f,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:gn||pa(m,f);var y=Qe,S=Vr;Hs(m.type)&&(Qe=m.stateNode,Vr=!1),ts(u,f,m),Jf(m.stateNode),Qe=y,Vr=S;break;case 5:gn||pa(m,f);case 6:if(y=Qe,S=Vr,Qe=null,ts(u,f,m),Qe=y,Vr=S,Qe!==null)if(Vr)try{(Qe.nodeType===9?Qe.body:Qe.nodeName==="HTML"?Qe.ownerDocument.body:Qe).removeChild(m.stateNode)}catch(k){ze(m,f,k)}else try{Qe.removeChild(m.stateNode)}catch(k){ze(m,f,k)}break;case 18:Qe!==null&&(Vr?(u=Qe,AR(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,m.stateNode),oh(u)):AR(Qe,m.stateNode));break;case 4:y=Qe,S=Vr,Qe=m.stateNode.containerInfo,Vr=!0,ts(u,f,m),Qe=y,Vr=S;break;case 0:case 11:case 14:case 15:gn||Bs(2,m,f),gn||Bs(4,m,f),ts(u,f,m);break;case 1:gn||(pa(m,f),y=m.stateNode,typeof y.componentWillUnmount=="function"&&N_(m,f,y)),ts(u,f,m);break;case 21:ts(u,f,m);break;case 22:gn=(y=gn)||m.memoizedState!==null,ts(u,f,m),gn=y;break;default:ts(u,f,m)}}function B_(u,f){if(f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{oh(u)}catch(m){ze(f,f.return,m)}}function UX(u){switch(u.tag){case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new M_),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new M_),f;default:throw Error(r(435,u.tag))}}function u1(u,f){var m=UX(u);f.forEach(function(y){var S=ZX.bind(null,u,y);m.has(y)||(m.add(y),y.then(S,S))})}function ti(u,f){var m=f.deletions;if(m!==null)for(var y=0;y<m.length;y++){var S=m[y],k=u,D=f,L=D;t:for(;L!==null;){switch(L.tag){case 27:if(Hs(L.type)){Qe=L.stateNode,Vr=!1;break t}break;case 5:Qe=L.stateNode,Vr=!1;break t;case 3:case 4:Qe=L.stateNode.containerInfo,Vr=!0;break t}L=L.return}if(Qe===null)throw Error(r(160));L_(k,D,S),Qe=null,Vr=!1,k=S.alternate,k!==null&&(k.return=null),S.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)z_(f,u),f=f.sibling}var Gi=null;function z_(u,f){var m=u.alternate,y=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:ti(f,u),ei(u),y&4&&(Bs(3,u,u.return),Vf(3,u),Bs(5,u,u.return));break;case 1:ti(f,u),ei(u),y&512&&(gn||m===null||pa(m,m.return)),y&64&&Ja&&(u=u.updateQueue,u!==null&&(y=u.callbacks,y!==null&&(m=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=m===null?y:m.concat(y))));break;case 26:var S=Gi;if(ti(f,u),ei(u),y&512&&(gn||m===null||pa(m,m.return)),y&4){var k=m!==null?m.memoizedState:null;if(y=u.memoizedState,m===null)if(y===null)if(u.stateNode===null){t:{y=u.type,m=u.memoizedProps,S=S.ownerDocument||S;e:switch(y){case"title":k=S.getElementsByTagName("title")[0],(!k||k[pf]||k[pr]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=S.createElement(y),S.head.insertBefore(k,S.querySelector("head > title"))),ir(k,y,m),k[pr]=u,Wn(k),y=k;break t;case"link":var D=DR("link","href",S).get(y+(m.href||""));if(D){for(var L=0;L<D.length;L++)if(k=D[L],k.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&k.getAttribute("rel")===(m.rel==null?null:m.rel)&&k.getAttribute("title")===(m.title==null?null:m.title)&&k.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){D.splice(L,1);break e}}k=S.createElement(y),ir(k,y,m),S.head.appendChild(k);break;case"meta":if(D=DR("meta","content",S).get(y+(m.content||""))){for(L=0;L<D.length;L++)if(k=D[L],k.getAttribute("content")===(m.content==null?null:""+m.content)&&k.getAttribute("name")===(m.name==null?null:m.name)&&k.getAttribute("property")===(m.property==null?null:m.property)&&k.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&k.getAttribute("charset")===(m.charSet==null?null:m.charSet)){D.splice(L,1);break e}}k=S.createElement(y),ir(k,y,m),S.head.appendChild(k);break;default:throw Error(r(468,y))}k[pr]=u,Wn(k),y=k}u.stateNode=y}else MR(S,u.type,u.stateNode);else u.stateNode=RR(S,y,u.memoizedProps);else k!==y?(k===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):k.count--,y===null?MR(S,u.type,u.stateNode):RR(S,y,u.memoizedProps)):y===null&&u.stateNode!==null&&a1(u,u.memoizedProps,m.memoizedProps)}break;case 27:ti(f,u),ei(u),y&512&&(gn||m===null||pa(m,m.return)),m!==null&&y&4&&a1(u,u.memoizedProps,m.memoizedProps);break;case 5:if(ti(f,u),ei(u),y&512&&(gn||m===null||pa(m,m.return)),u.flags&32){S=u.stateNode;try{iu(S,"")}catch(ft){ze(u,u.return,ft)}}y&4&&u.stateNode!=null&&(S=u.memoizedProps,a1(u,S,m!==null?m.memoizedProps:S)),y&1024&&(l1=!0);break;case 6:if(ti(f,u),ei(u),y&4){if(u.stateNode===null)throw Error(r(162));y=u.memoizedProps,m=u.stateNode;try{m.nodeValue=y}catch(ft){ze(u,u.return,ft)}}break;case 3:if(hg=null,S=Gi,Gi=cg(f.containerInfo),ti(f,u),Gi=S,ei(u),y&4&&m!==null&&m.memoizedState.isDehydrated)try{oh(f.containerInfo)}catch(ft){ze(u,u.return,ft)}l1&&(l1=!1,j_(u));break;case 4:y=Gi,Gi=cg(u.stateNode.containerInfo),ti(f,u),ei(u),Gi=y;break;case 12:ti(f,u),ei(u);break;case 13:ti(f,u),ei(u),u.child.flags&8192&&u.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(m1=qt()),y&4&&(y=u.updateQueue,y!==null&&(u.updateQueue=null,u1(u,y)));break;case 22:S=u.memoizedState!==null;var K=m!==null&&m.memoizedState!==null,lt=Ja,bt=gn;if(Ja=lt||S,gn=bt||K,ti(f,u),gn=bt,Ja=lt,ei(u),y&8192)t:for(f=u.stateNode,f._visibility=S?f._visibility&-2:f._visibility|1,S&&(m===null||K||Ja||gn||Xo(u)),m=null,f=u;;){if(f.tag===5||f.tag===26){if(m===null){K=m=f;try{if(k=K.stateNode,S)D=k.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{L=K.stateNode;var wt=K.memoizedProps.style,ut=wt!=null&&wt.hasOwnProperty("display")?wt.display:null;L.style.display=ut==null||typeof ut=="boolean"?"":(""+ut).trim()}}catch(ft){ze(K,K.return,ft)}}}else if(f.tag===6){if(m===null){K=f;try{K.stateNode.nodeValue=S?"":K.memoizedProps}catch(ft){ze(K,K.return,ft)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break t;for(;f.sibling===null;){if(f.return===null||f.return===u)break t;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}y&4&&(y=u.updateQueue,y!==null&&(m=y.retryQueue,m!==null&&(y.retryQueue=null,u1(u,m))));break;case 19:ti(f,u),ei(u),y&4&&(y=u.updateQueue,y!==null&&(u.updateQueue=null,u1(u,y)));break;case 30:break;case 21:break;default:ti(f,u),ei(u)}}function ei(u){var f=u.flags;if(f&2){try{for(var m,y=u.return;y!==null;){if(R_(y)){m=y;break}y=y.return}if(m==null)throw Error(r(160));switch(m.tag){case 27:var S=m.stateNode,k=s1(u);Zm(u,k,S);break;case 5:var D=m.stateNode;m.flags&32&&(iu(D,""),m.flags&=-33);var L=s1(u);Zm(u,L,D);break;case 3:case 4:var K=m.stateNode.containerInfo,lt=s1(u);o1(u,lt,K);break;default:throw Error(r(161))}}catch(bt){ze(u,u.return,bt)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function j_(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;j_(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),u=u.sibling}}function zs(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)P_(u,f.alternate,f),f=f.sibling}function Xo(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:Bs(4,f,f.return),Xo(f);break;case 1:pa(f,f.return);var m=f.stateNode;typeof m.componentWillUnmount=="function"&&N_(f,f.return,m),Xo(f);break;case 27:Jf(f.stateNode);case 26:case 5:pa(f,f.return),Xo(f);break;case 22:f.memoizedState===null&&Xo(f);break;case 30:Xo(f);break;default:Xo(f)}u=u.sibling}}function js(u,f,m){for(m=m&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var y=f.alternate,S=u,k=f,D=k.flags;switch(k.tag){case 0:case 11:case 15:js(S,k,m),Vf(4,k);break;case 1:if(js(S,k,m),y=k,S=y.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(lt){ze(y,y.return,lt)}if(y=k,S=y.updateQueue,S!==null){var L=y.stateNode;try{var K=S.shared.hiddenCallbacks;if(K!==null)for(S.shared.hiddenCallbacks=null,S=0;S<K.length;S++)gN(K[S],L)}catch(lt){ze(y,y.return,lt)}}m&&D&64&&O_(k),Wf(k,k.return);break;case 27:D_(k);case 26:case 5:js(S,k,m),m&&y===null&&D&4&&__(k),Wf(k,k.return);break;case 12:js(S,k,m);break;case 13:js(S,k,m),m&&D&4&&B_(S,k);break;case 22:k.memoizedState===null&&js(S,k,m),Wf(k,k.return);break;case 30:break;default:js(S,k,m)}f=f.sibling}}function c1(u,f){var m=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==m&&(u!=null&&u.refCount++,m!=null&&If(m))}function f1(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&If(u))}function ma(u,f,m,y){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)U_(u,f,m,y),f=f.sibling}function U_(u,f,m,y){var S=f.flags;switch(f.tag){case 0:case 11:case 15:ma(u,f,m,y),S&2048&&Vf(9,f);break;case 1:ma(u,f,m,y);break;case 3:ma(u,f,m,y),S&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&If(u)));break;case 12:if(S&2048){ma(u,f,m,y),u=f.stateNode;try{var k=f.memoizedProps,D=k.id,L=k.onPostCommit;typeof L=="function"&&L(D,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(K){ze(f,f.return,K)}}else ma(u,f,m,y);break;case 13:ma(u,f,m,y);break;case 23:break;case 22:k=f.stateNode,D=f.alternate,f.memoizedState!==null?k._visibility&2?ma(u,f,m,y):Gf(u,f):k._visibility&2?ma(u,f,m,y):(k._visibility|=2,Cu(u,f,m,y,(f.subtreeFlags&10256)!==0)),S&2048&&c1(D,f);break;case 24:ma(u,f,m,y),S&2048&&f1(f.alternate,f);break;default:ma(u,f,m,y)}}function Cu(u,f,m,y,S){for(S=S&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var k=u,D=f,L=m,K=y,lt=D.flags;switch(D.tag){case 0:case 11:case 15:Cu(k,D,L,K,S),Vf(8,D);break;case 23:break;case 22:var bt=D.stateNode;D.memoizedState!==null?bt._visibility&2?Cu(k,D,L,K,S):Gf(k,D):(bt._visibility|=2,Cu(k,D,L,K,S)),S&&lt&2048&&c1(D.alternate,D);break;case 24:Cu(k,D,L,K,S),S&&lt&2048&&f1(D.alternate,D);break;default:Cu(k,D,L,K,S)}f=f.sibling}}function Gf(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var m=u,y=f,S=y.flags;switch(y.tag){case 22:Gf(m,y),S&2048&&c1(y.alternate,y);break;case 24:Gf(m,y),S&2048&&f1(y.alternate,y);break;default:Gf(m,y)}f=f.sibling}}var qf=8192;function Tu(u){if(u.subtreeFlags&qf)for(u=u.child;u!==null;)V_(u),u=u.sibling}function V_(u){switch(u.tag){case 26:Tu(u),u.flags&qf&&u.memoizedState!==null&&kK(Gi,u.memoizedState,u.memoizedProps);break;case 5:Tu(u);break;case 3:case 4:var f=Gi;Gi=cg(u.stateNode.containerInfo),Tu(u),Gi=f;break;case 22:u.memoizedState===null&&(f=u.alternate,f!==null&&f.memoizedState!==null?(f=qf,qf=16777216,Tu(u),qf=f):Tu(u));break;default:Tu(u)}}function W_(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function Hf(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var m=0;m<f.length;m++){var y=f[m];qn=y,q_(y,u)}W_(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)G_(u),u=u.sibling}function G_(u){switch(u.tag){case 0:case 11:case 15:Hf(u),u.flags&2048&&Bs(9,u,u.return);break;case 3:Hf(u);break;case 12:Hf(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&2&&(u.return===null||u.return.tag!==13)?(f._visibility&=-3,Qm(u)):Hf(u);break;default:Hf(u)}}function Qm(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var m=0;m<f.length;m++){var y=f[m];qn=y,q_(y,u)}W_(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:Bs(8,f,f.return),Qm(f);break;case 22:m=f.stateNode,m._visibility&2&&(m._visibility&=-3,Qm(f));break;default:Qm(f)}u=u.sibling}}function q_(u,f){for(;qn!==null;){var m=qn;switch(m.tag){case 0:case 11:case 15:Bs(8,m,f);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var y=m.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:If(m.memoizedState.cache)}if(y=m.child,y!==null)y.return=m,qn=y;else t:for(m=u;qn!==null;){y=qn;var S=y.sibling,k=y.return;if(F_(y),y===m){qn=null;break t}if(S!==null){S.return=k,qn=S;break t}qn=k}}}var VX={getCacheForType:function(u){var f=mr(Mn),m=f.data.get(u);return m===void 0&&(m=u(),f.data.set(u,m)),m}},WX=typeof WeakMap=="function"?WeakMap:Map,Oe=0,qe=null,ue=null,ve=0,Ne=0,ni=null,Us=!1,$u=!1,h1=!1,es=0,on=0,Vs=0,Ko=0,d1=0,Ci=0,Au=0,Xf=null,Wr=null,p1=!1,m1=0,Jm=1/0,tg=null,Ws=null,rr=0,Gs=null,ku=null,Eu=0,g1=0,y1=null,H_=null,Kf=0,v1=null;function ri(){if((Oe&2)!==0&&ve!==0)return ve&-ve;if(M.T!==null){var u=mu;return u!==0?u:$1()}return uO()}function X_(){Ci===0&&(Ci=(ve&536870912)===0||$e?aO():536870912);var u=Si.current;return u!==null&&(u.flags|=32),Ci}function ii(u,f,m){(u===qe&&(Ne===2||Ne===9)||u.cancelPendingCommit!==null)&&(Iu(u,0),qs(u,ve,Ci,!1)),df(u,m),((Oe&2)===0||u!==qe)&&(u===qe&&((Oe&2)===0&&(Ko|=m),on===4&&qs(u,ve,Ci,!1)),ga(u))}function K_(u,f,m){if((Oe&6)!==0)throw Error(r(327));var y=!m&&(f&124)===0&&(f&u.expiredLanes)===0||hf(u,f),S=y?HX(u,f):w1(u,f,!0),k=y;do{if(S===0){$u&&!y&&qs(u,f,0,!1);break}else{if(m=u.current.alternate,k&&!GX(m)){S=w1(u,f,!1),k=!1;continue}if(S===2){if(k=f,u.errorRecoveryDisabledLanes&k)var D=0;else D=u.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){f=D;t:{var L=u;S=Xf;var K=L.current.memoizedState.isDehydrated;if(K&&(Iu(L,D).flags|=256),D=w1(L,D,!1),D!==2){if(h1&&!K){L.errorRecoveryDisabledLanes|=k,Ko|=k,S=4;break t}k=Wr,Wr=S,k!==null&&(Wr===null?Wr=k:Wr.push.apply(Wr,k))}S=D}if(k=!1,S!==2)continue}}if(S===1){Iu(u,0),qs(u,f,0,!0);break}t:{switch(y=u,k=S,k){case 0:case 1:throw Error(r(345));case 4:if((f&4194048)!==f)break;case 6:qs(y,f,Ci,!Us);break t;case 2:Wr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((f&62914560)===f&&(S=m1+300-qt(),10<S)){if(qs(y,f,Ci,!Us),fm(y,0,!0)!==0)break t;y.timeoutHandle=TR(Y_.bind(null,y,m,Wr,tg,p1,f,Ci,Ko,Au,Us,k,2,-0,0),S);break t}Y_(y,m,Wr,tg,p1,f,Ci,Ko,Au,Us,k,0,-0,0)}}break}while(!0);ga(u)}function Y_(u,f,m,y,S,k,D,L,K,lt,bt,wt,ut,ft){if(u.timeoutHandle=-1,wt=f.subtreeFlags,(wt&8192||(wt&16785408)===16785408)&&(nh={stylesheets:null,count:0,unsuspend:AK},V_(f),wt=EK(),wt!==null)){u.cancelPendingCommit=wt(rR.bind(null,u,f,k,m,y,S,D,L,K,bt,1,ut,ft)),qs(u,k,D,!lt);return}rR(u,f,k,m,y,S,D,L,K)}function GX(u){for(var f=u;;){var m=f.tag;if((m===0||m===11||m===15)&&f.flags&16384&&(m=f.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var y=0;y<m.length;y++){var S=m[y],k=S.getSnapshot;S=S.value;try{if(!Qr(k(),S))return!1}catch{return!1}}if(m=f.child,f.subtreeFlags&16384&&m!==null)m.return=f,f=m;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function qs(u,f,m,y){f&=~d1,f&=~Ko,u.suspendedLanes|=f,u.pingedLanes&=~f,y&&(u.warmLanes|=f),y=u.expirationTimes;for(var S=f;0<S;){var k=31-Dn(S),D=1<<k;y[k]=-1,S&=~D}m!==0&&oO(u,m,f)}function eg(){return(Oe&6)===0?(Yf(0),!1):!0}function b1(){if(ue!==null){if(Ne===0)var u=ue.return;else u=ue,Ha=Vo=null,Px(u),wu=null,zf=0,u=ue;for(;u!==null;)I_(u.alternate,u),u=u.return;ue=null}}function Iu(u,f){var m=u.timeoutHandle;m!==-1&&(u.timeoutHandle=-1,uK(m)),m=u.cancelPendingCommit,m!==null&&(u.cancelPendingCommit=null,m()),b1(),qe=u,ue=m=Wa(u.current,null),ve=f,Ne=0,ni=null,Us=!1,$u=hf(u,f),h1=!1,Au=Ci=d1=Ko=Vs=on=0,Wr=Xf=null,p1=!1,(f&8)!==0&&(f|=f&32);var y=u.entangledLanes;if(y!==0)for(u=u.entanglements,y&=f;0<y;){var S=31-Dn(y),k=1<<S;f|=u[S],y&=~k}return es=f,Cm(),m}function Z_(u,f){ae=null,M.H=Um,f===Nf||f===_m?(f=pN(),Ne=3):f===fN?(f=pN(),Ne=4):Ne=f===m_?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,ni=f,ue===null&&(on=1,Hm(u,vi(f,u.current)))}function Q_(){var u=M.H;return M.H=Um,u===null?Um:u}function J_(){var u=M.A;return M.A=VX,u}function x1(){on=4,Us||(ve&4194048)!==ve&&Si.current!==null||($u=!0),(Vs&134217727)===0&&(Ko&134217727)===0||qe===null||qs(qe,ve,Ci,!1)}function w1(u,f,m){var y=Oe;Oe|=2;var S=Q_(),k=J_();(qe!==u||ve!==f)&&(tg=null,Iu(u,f)),f=!1;var D=on;t:do try{if(Ne!==0&&ue!==null){var L=ue,K=ni;switch(Ne){case 8:b1(),D=6;break t;case 3:case 2:case 9:case 6:Si.current===null&&(f=!0);var lt=Ne;if(Ne=0,ni=null,Ou(u,L,K,lt),m&&$u){D=0;break t}break;default:lt=Ne,Ne=0,ni=null,Ou(u,L,K,lt)}}qX(),D=on;break}catch(bt){Z_(u,bt)}while(!0);return f&&u.shellSuspendCounter++,Ha=Vo=null,Oe=y,M.H=S,M.A=k,ue===null&&(qe=null,ve=0,Cm()),D}function qX(){for(;ue!==null;)tR(ue)}function HX(u,f){var m=Oe;Oe|=2;var y=Q_(),S=J_();qe!==u||ve!==f?(tg=null,Jm=qt()+500,Iu(u,f)):$u=hf(u,f);t:do try{if(Ne!==0&&ue!==null){f=ue;var k=ni;e:switch(Ne){case 1:Ne=0,ni=null,Ou(u,f,k,1);break;case 2:case 9:if(hN(k)){Ne=0,ni=null,eR(f);break}f=function(){Ne!==2&&Ne!==9||qe!==u||(Ne=7),ga(u)},k.then(f,f);break t;case 3:Ne=7;break t;case 4:Ne=5;break t;case 7:hN(k)?(Ne=0,ni=null,eR(f)):(Ne=0,ni=null,Ou(u,f,k,7));break;case 5:var D=null;switch(ue.tag){case 26:D=ue.memoizedState;case 5:case 27:var L=ue;if(!D||PR(D)){Ne=0,ni=null;var K=L.sibling;if(K!==null)ue=K;else{var lt=L.return;lt!==null?(ue=lt,ng(lt)):ue=null}break e}}Ne=0,ni=null,Ou(u,f,k,5);break;case 6:Ne=0,ni=null,Ou(u,f,k,6);break;case 8:b1(),on=6;break t;default:throw Error(r(462))}}XX();break}catch(bt){Z_(u,bt)}while(!0);return Ha=Vo=null,M.H=y,M.A=S,Oe=m,ue!==null?0:(qe=null,ve=0,Cm(),on)}function XX(){for(;ue!==null&&!Zt();)tR(ue)}function tR(u){var f=k_(u.alternate,u,es);u.memoizedProps=u.pendingProps,f===null?ng(u):ue=f}function eR(u){var f=u,m=f.alternate;switch(f.tag){case 15:case 0:f=w_(m,f,f.pendingProps,f.type,void 0,ve);break;case 11:f=w_(m,f,f.pendingProps,f.type.render,f.ref,ve);break;case 5:Px(f);default:I_(m,f),f=ue=nN(f,es),f=k_(m,f,es)}u.memoizedProps=u.pendingProps,f===null?ng(u):ue=f}function Ou(u,f,m,y){Ha=Vo=null,Px(f),wu=null,zf=0;var S=f.return;try{if(FX(u,S,f,m,ve)){on=1,Hm(u,vi(m,u.current)),ue=null;return}}catch(k){if(S!==null)throw ue=S,k;on=1,Hm(u,vi(m,u.current)),ue=null;return}f.flags&32768?($e||y===1?u=!0:$u||(ve&536870912)!==0?u=!1:(Us=u=!0,(y===2||y===9||y===3||y===6)&&(y=Si.current,y!==null&&y.tag===13&&(y.flags|=16384))),nR(f,u)):ng(f)}function ng(u){var f=u;do{if((f.flags&32768)!==0){nR(f,Us);return}u=f.return;var m=BX(f.alternate,f,es);if(m!==null){ue=m;return}if(f=f.sibling,f!==null){ue=f;return}ue=f=u}while(f!==null);on===0&&(on=5)}function nR(u,f){do{var m=zX(u.alternate,u);if(m!==null){m.flags&=32767,ue=m;return}if(m=u.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!f&&(u=u.sibling,u!==null)){ue=u;return}ue=u=m}while(u!==null);on=6,ue=null}function rR(u,f,m,y,S,k,D,L,K){u.cancelPendingCommit=null;do rg();while(rr!==0);if((Oe&6)!==0)throw Error(r(327));if(f!==null){if(f===u.current)throw Error(r(177));if(k=f.lanes|f.childLanes,k|=fx,A8(u,m,k,D,L,K),u===qe&&(ue=qe=null,ve=0),ku=f,Gs=u,Eu=m,g1=k,y1=S,H_=y,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,QX(pn,function(){return lR(),null})):(u.callbackNode=null,u.callbackPriority=0),y=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||y){y=M.T,M.T=null,S=U.p,U.p=2,D=Oe,Oe|=4;try{jX(u,f,m)}finally{Oe=D,U.p=S,M.T=y}}rr=1,iR(),aR(),sR()}}function iR(){if(rr===1){rr=0;var u=Gs,f=ku,m=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||m){m=M.T,M.T=null;var y=U.p;U.p=2;var S=Oe;Oe|=4;try{z_(f,u);var k=R1,D=qO(u.containerInfo),L=k.focusedElem,K=k.selectionRange;if(D!==L&&L&&L.ownerDocument&&GO(L.ownerDocument.documentElement,L)){if(K!==null&&sx(L)){var lt=K.start,bt=K.end;if(bt===void 0&&(bt=lt),"selectionStart"in L)L.selectionStart=lt,L.selectionEnd=Math.min(bt,L.value.length);else{var wt=L.ownerDocument||document,ut=wt&&wt.defaultView||window;if(ut.getSelection){var ft=ut.getSelection(),Qt=L.textContent.length,Gt=Math.min(K.start,Qt),Pe=K.end===void 0?Gt:Math.min(K.end,Qt);!ft.extend&&Gt>Pe&&(D=Pe,Pe=Gt,Gt=D);var it=WO(L,Gt),Q=WO(L,Pe);if(it&&Q&&(ft.rangeCount!==1||ft.anchorNode!==it.node||ft.anchorOffset!==it.offset||ft.focusNode!==Q.node||ft.focusOffset!==Q.offset)){var at=wt.createRange();at.setStart(it.node,it.offset),ft.removeAllRanges(),Gt>Pe?(ft.addRange(at),ft.extend(Q.node,Q.offset)):(at.setEnd(Q.node,Q.offset),ft.addRange(at))}}}}for(wt=[],ft=L;ft=ft.parentNode;)ft.nodeType===1&&wt.push({element:ft,left:ft.scrollLeft,top:ft.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<wt.length;L++){var xt=wt[L];xt.element.scrollLeft=xt.left,xt.element.scrollTop=xt.top}}mg=!!_1,R1=_1=null}finally{Oe=S,U.p=y,M.T=m}}u.current=f,rr=2}}function aR(){if(rr===2){rr=0;var u=Gs,f=ku,m=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||m){m=M.T,M.T=null;var y=U.p;U.p=2;var S=Oe;Oe|=4;try{P_(u,f.alternate,f)}finally{Oe=S,U.p=y,M.T=m}}rr=3}}function sR(){if(rr===4||rr===3){rr=0,Wt();var u=Gs,f=ku,m=Eu,y=H_;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?rr=5:(rr=0,ku=Gs=null,oR(u,u.pendingLanes));var S=u.pendingLanes;if(S===0&&(Ws=null),B0(m),f=f.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Br,f,void 0,(f.current.flags&128)===128)}catch{}if(y!==null){f=M.T,S=U.p,U.p=2,M.T=null;try{for(var k=u.onRecoverableError,D=0;D<y.length;D++){var L=y[D];k(L.value,{componentStack:L.stack})}}finally{M.T=f,U.p=S}}(Eu&3)!==0&&rg(),ga(u),S=u.pendingLanes,(m&4194090)!==0&&(S&42)!==0?u===v1?Kf++:(Kf=0,v1=u):Kf=0,Yf(0)}}function oR(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,If(f)))}function rg(u){return iR(),aR(),sR(),lR()}function lR(){if(rr!==5)return!1;var u=Gs,f=g1;g1=0;var m=B0(Eu),y=M.T,S=U.p;try{U.p=32>m?32:m,M.T=null,m=y1,y1=null;var k=Gs,D=Eu;if(rr=0,ku=Gs=null,Eu=0,(Oe&6)!==0)throw Error(r(331));var L=Oe;if(Oe|=4,G_(k.current),U_(k,k.current,D,m),Oe=L,Yf(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Br,k)}catch{}return!0}finally{U.p=S,M.T=y,oR(u,f)}}function uR(u,f,m){f=vi(m,f),f=Yx(u.stateNode,f,2),u=Ms(u,f,2),u!==null&&(df(u,2),ga(u))}function ze(u,f,m){if(u.tag===3)uR(u,u,m);else for(;f!==null;){if(f.tag===3){uR(f,u,m);break}else if(f.tag===1){var y=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Ws===null||!Ws.has(y))){u=vi(m,u),m=d_(2),y=Ms(f,m,2),y!==null&&(p_(m,y,f,u),df(y,2),ga(y));break}}f=f.return}}function S1(u,f,m){var y=u.pingCache;if(y===null){y=u.pingCache=new WX;var S=new Set;y.set(f,S)}else S=y.get(f),S===void 0&&(S=new Set,y.set(f,S));S.has(m)||(h1=!0,S.add(m),u=KX.bind(null,u,f,m),f.then(u,u))}function KX(u,f,m){var y=u.pingCache;y!==null&&y.delete(f),u.pingedLanes|=u.suspendedLanes&m,u.warmLanes&=~m,qe===u&&(ve&m)===m&&(on===4||on===3&&(ve&62914560)===ve&&300>qt()-m1?(Oe&2)===0&&Iu(u,0):d1|=m,Au===ve&&(Au=0)),ga(u)}function cR(u,f){f===0&&(f=sO()),u=fu(u,f),u!==null&&(df(u,f),ga(u))}function YX(u){var f=u.memoizedState,m=0;f!==null&&(m=f.retryLane),cR(u,m)}function ZX(u,f){var m=0;switch(u.tag){case 13:var y=u.stateNode,S=u.memoizedState;S!==null&&(m=S.retryLane);break;case 19:y=u.stateNode;break;case 22:y=u.stateNode._retryCache;break;default:throw Error(r(314))}y!==null&&y.delete(f),cR(u,m)}function QX(u,f){return Ut(u,f)}var ig=null,Nu=null,C1=!1,ag=!1,T1=!1,Yo=0;function ga(u){u!==Nu&&u.next===null&&(Nu===null?ig=Nu=u:Nu=Nu.next=u),ag=!0,C1||(C1=!0,tK())}function Yf(u,f){if(!T1&&ag){T1=!0;do for(var m=!1,y=ig;y!==null;){if(u!==0){var S=y.pendingLanes;if(S===0)var k=0;else{var D=y.suspendedLanes,L=y.pingedLanes;k=(1<<31-Dn(42|u)+1)-1,k&=S&~(D&~L),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(m=!0,pR(y,k))}else k=ve,k=fm(y,y===qe?k:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(k&3)===0||hf(y,k)||(m=!0,pR(y,k));y=y.next}while(m);T1=!1}}function JX(){fR()}function fR(){ag=C1=!1;var u=0;Yo!==0&&(lK()&&(u=Yo),Yo=0);for(var f=qt(),m=null,y=ig;y!==null;){var S=y.next,k=hR(y,f);k===0?(y.next=null,m===null?ig=S:m.next=S,S===null&&(Nu=m)):(m=y,(u!==0||(k&3)!==0)&&(ag=!0)),y=S}Yf(u)}function hR(u,f){for(var m=u.suspendedLanes,y=u.pingedLanes,S=u.expirationTimes,k=u.pendingLanes&-62914561;0<k;){var D=31-Dn(k),L=1<<D,K=S[D];K===-1?((L&m)===0||(L&y)!==0)&&(S[D]=$8(L,f)):K<=f&&(u.expiredLanes|=L),k&=~L}if(f=qe,m=ve,m=fm(u,u===f?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),y=u.callbackNode,m===0||u===f&&(Ne===2||Ne===9)||u.cancelPendingCommit!==null)return y!==null&&y!==null&&Lt(y),u.callbackNode=null,u.callbackPriority=0;if((m&3)===0||hf(u,m)){if(f=m&-m,f===u.callbackPriority)return f;switch(y!==null&&Lt(y),B0(m)){case 2:case 8:m=Ge;break;case 32:m=pn;break;case 268435456:m=Fr;break;default:m=pn}return y=dR.bind(null,u),m=Ut(m,y),u.callbackPriority=f,u.callbackNode=m,f}return y!==null&&y!==null&&Lt(y),u.callbackPriority=2,u.callbackNode=null,2}function dR(u,f){if(rr!==0&&rr!==5)return u.callbackNode=null,u.callbackPriority=0,null;var m=u.callbackNode;if(rg()&&u.callbackNode!==m)return null;var y=ve;return y=fm(u,u===qe?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),y===0?null:(K_(u,y,f),hR(u,qt()),u.callbackNode!=null&&u.callbackNode===m?dR.bind(null,u):null)}function pR(u,f){if(rg())return null;K_(u,f,!0)}function tK(){cK(function(){(Oe&6)!==0?Ut(Rn,JX):fR()})}function $1(){return Yo===0&&(Yo=aO()),Yo}function mR(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:gm(""+u)}function gR(u,f){var m=f.ownerDocument.createElement("input");return m.name=f.name,m.value=f.value,u.id&&m.setAttribute("form",u.id),f.parentNode.insertBefore(m,f),u=new FormData(u),m.parentNode.removeChild(m),u}function eK(u,f,m,y,S){if(f==="submit"&&m&&m.stateNode===S){var k=mR((S[zr]||null).action),D=y.submitter;D&&(f=(f=D[zr]||null)?mR(f.formAction):D.getAttribute("formAction"),f!==null&&(k=f,D=null));var L=new xm("action","action",null,y,S);u.push({event:L,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(Yo!==0){var K=D?gR(S,D):new FormData(S);Gx(m,{pending:!0,data:K,method:S.method,action:k},null,K)}}else typeof k=="function"&&(L.preventDefault(),K=D?gR(S,D):new FormData(S),Gx(m,{pending:!0,data:K,method:S.method,action:k},k,K))},currentTarget:S}]})}}for(var A1=0;A1<cx.length;A1++){var k1=cx[A1],nK=k1.toLowerCase(),rK=k1[0].toUpperCase()+k1.slice(1);Wi(nK,"on"+rK)}Wi(KO,"onAnimationEnd"),Wi(YO,"onAnimationIteration"),Wi(ZO,"onAnimationStart"),Wi("dblclick","onDoubleClick"),Wi("focusin","onFocus"),Wi("focusout","onBlur"),Wi(xX,"onTransitionRun"),Wi(wX,"onTransitionStart"),Wi(SX,"onTransitionCancel"),Wi(QO,"onTransitionEnd"),eu("onMouseEnter",["mouseout","mouseover"]),eu("onMouseLeave",["mouseout","mouseover"]),eu("onPointerEnter",["pointerout","pointerover"]),eu("onPointerLeave",["pointerout","pointerover"]),Do("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Do("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Do("onBeforeInput",["compositionend","keypress","textInput","paste"]),Do("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Do("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Do("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iK=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Zf));function yR(u,f){f=(f&4)!==0;for(var m=0;m<u.length;m++){var y=u[m],S=y.event;y=y.listeners;t:{var k=void 0;if(f)for(var D=y.length-1;0<=D;D--){var L=y[D],K=L.instance,lt=L.currentTarget;if(L=L.listener,K!==k&&S.isPropagationStopped())break t;k=L,S.currentTarget=lt;try{k(S)}catch(bt){qm(bt)}S.currentTarget=null,k=K}else for(D=0;D<y.length;D++){if(L=y[D],K=L.instance,lt=L.currentTarget,L=L.listener,K!==k&&S.isPropagationStopped())break t;k=L,S.currentTarget=lt;try{k(S)}catch(bt){qm(bt)}S.currentTarget=null,k=K}}}}function ce(u,f){var m=f[z0];m===void 0&&(m=f[z0]=new Set);var y=u+"__bubble";m.has(y)||(vR(f,u,2,!1),m.add(y))}function E1(u,f,m){var y=0;f&&(y|=4),vR(m,u,y,f)}var sg="_reactListening"+Math.random().toString(36).slice(2);function I1(u){if(!u[sg]){u[sg]=!0,fO.forEach(function(m){m!=="selectionchange"&&(iK.has(m)||E1(m,!1,u),E1(m,!0,u))});var f=u.nodeType===9?u:u.ownerDocument;f===null||f[sg]||(f[sg]=!0,E1("selectionchange",!1,f))}}function vR(u,f,m,y){switch(UR(f)){case 2:var S=NK;break;case 8:S=_K;break;default:S=V1}m=S.bind(null,f,m,u),S=void 0,!Z0||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(S=!0),y?S!==void 0?u.addEventListener(f,m,{capture:!0,passive:S}):u.addEventListener(f,m,!0):S!==void 0?u.addEventListener(f,m,{passive:S}):u.addEventListener(f,m,!1)}function O1(u,f,m,y,S){var k=y;if((f&1)===0&&(f&2)===0&&y!==null)t:for(;;){if(y===null)return;var D=y.tag;if(D===3||D===4){var L=y.stateNode.containerInfo;if(L===S)break;if(D===4)for(D=y.return;D!==null;){var K=D.tag;if((K===3||K===4)&&D.stateNode.containerInfo===S)return;D=D.return}for(;L!==null;){if(D=Ql(L),D===null)return;if(K=D.tag,K===5||K===6||K===26||K===27){y=k=D;continue t}L=L.parentNode}}y=y.return}$O(function(){var lt=k,bt=K0(m),wt=[];t:{var ut=JO.get(u);if(ut!==void 0){var ft=xm,Qt=u;switch(u){case"keypress":if(vm(m)===0)break t;case"keydown":case"keyup":ft=Q8;break;case"focusin":Qt="focus",ft=ex;break;case"focusout":Qt="blur",ft=ex;break;case"beforeblur":case"afterblur":ft=ex;break;case"click":if(m.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=EO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=z8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=eX;break;case KO:case YO:case ZO:ft=V8;break;case QO:ft=rX;break;case"scroll":case"scrollend":ft=L8;break;case"wheel":ft=aX;break;case"copy":case"cut":case"paste":ft=G8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=OO;break;case"toggle":case"beforetoggle":ft=oX}var Gt=(f&4)!==0,Pe=!Gt&&(u==="scroll"||u==="scrollend"),it=Gt?ut!==null?ut+"Capture":null:ut;Gt=[];for(var Q=lt,at;Q!==null;){var xt=Q;if(at=xt.stateNode,xt=xt.tag,xt!==5&&xt!==26&&xt!==27||at===null||it===null||(xt=gf(Q,it),xt!=null&&Gt.push(Qf(Q,xt,at))),Pe)break;Q=Q.return}0<Gt.length&&(ut=new ft(ut,Qt,null,m,bt),wt.push({event:ut,listeners:Gt}))}}if((f&7)===0){t:{if(ut=u==="mouseover"||u==="pointerover",ft=u==="mouseout"||u==="pointerout",ut&&m!==X0&&(Qt=m.relatedTarget||m.fromElement)&&(Ql(Qt)||Qt[Zl]))break t;if((ft||ut)&&(ut=bt.window===bt?bt:(ut=bt.ownerDocument)?ut.defaultView||ut.parentWindow:window,ft?(Qt=m.relatedTarget||m.toElement,ft=lt,Qt=Qt?Ql(Qt):null,Qt!==null&&(Pe=a(Qt),Gt=Qt.tag,Qt!==Pe||Gt!==5&&Gt!==27&&Gt!==6)&&(Qt=null)):(ft=null,Qt=lt),ft!==Qt)){if(Gt=EO,xt="onMouseLeave",it="onMouseEnter",Q="mouse",(u==="pointerout"||u==="pointerover")&&(Gt=OO,xt="onPointerLeave",it="onPointerEnter",Q="pointer"),Pe=ft==null?ut:mf(ft),at=Qt==null?ut:mf(Qt),ut=new Gt(xt,Q+"leave",ft,m,bt),ut.target=Pe,ut.relatedTarget=at,xt=null,Ql(bt)===lt&&(Gt=new Gt(it,Q+"enter",Qt,m,bt),Gt.target=at,Gt.relatedTarget=Pe,xt=Gt),Pe=xt,ft&&Qt)e:{for(Gt=ft,it=Qt,Q=0,at=Gt;at;at=_u(at))Q++;for(at=0,xt=it;xt;xt=_u(xt))at++;for(;0<Q-at;)Gt=_u(Gt),Q--;for(;0<at-Q;)it=_u(it),at--;for(;Q--;){if(Gt===it||it!==null&&Gt===it.alternate)break e;Gt=_u(Gt),it=_u(it)}Gt=null}else Gt=null;ft!==null&&bR(wt,ut,ft,Gt,!1),Qt!==null&&Pe!==null&&bR(wt,Pe,Qt,Gt,!0)}}t:{if(ut=lt?mf(lt):window,ft=ut.nodeName&&ut.nodeName.toLowerCase(),ft==="select"||ft==="input"&&ut.type==="file")var Pt=LO;else if(PO(ut))if(BO)Pt=yX;else{Pt=mX;var le=pX}else ft=ut.nodeName,!ft||ft.toLowerCase()!=="input"||ut.type!=="checkbox"&&ut.type!=="radio"?lt&&H0(lt.elementType)&&(Pt=LO):Pt=gX;if(Pt&&(Pt=Pt(u,lt))){FO(wt,Pt,m,bt);break t}le&&le(u,ut,lt),u==="focusout"&&lt&&ut.type==="number"&&lt.memoizedProps.value!=null&&q0(ut,"number",ut.value)}switch(le=lt?mf(lt):window,u){case"focusin":(PO(le)||le.contentEditable==="true")&&(lu=le,ox=lt,Tf=null);break;case"focusout":Tf=ox=lu=null;break;case"mousedown":lx=!0;break;case"contextmenu":case"mouseup":case"dragend":lx=!1,HO(wt,m,bt);break;case"selectionchange":if(bX)break;case"keydown":case"keyup":HO(wt,m,bt)}var zt;if(rx)t:{switch(u){case"compositionstart":var Ht="onCompositionStart";break t;case"compositionend":Ht="onCompositionEnd";break t;case"compositionupdate":Ht="onCompositionUpdate";break t}Ht=void 0}else ou?DO(u,m)&&(Ht="onCompositionEnd"):u==="keydown"&&m.keyCode===229&&(Ht="onCompositionStart");Ht&&(NO&&m.locale!=="ko"&&(ou||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&ou&&(zt=AO()):(Ns=bt,Q0="value"in Ns?Ns.value:Ns.textContent,ou=!0)),le=og(lt,Ht),0<le.length&&(Ht=new IO(Ht,u,null,m,bt),wt.push({event:Ht,listeners:le}),zt?Ht.data=zt:(zt=MO(m),zt!==null&&(Ht.data=zt)))),(zt=uX?cX(u,m):fX(u,m))&&(Ht=og(lt,"onBeforeInput"),0<Ht.length&&(le=new IO("onBeforeInput","beforeinput",null,m,bt),wt.push({event:le,listeners:Ht}),le.data=zt)),eK(wt,u,lt,m,bt)}yR(wt,f)})}function Qf(u,f,m){return{instance:u,listener:f,currentTarget:m}}function og(u,f){for(var m=f+"Capture",y=[];u!==null;){var S=u,k=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||k===null||(S=gf(u,m),S!=null&&y.unshift(Qf(u,S,k)),S=gf(u,f),S!=null&&y.push(Qf(u,S,k))),u.tag===3)return y;u=u.return}return[]}function _u(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function bR(u,f,m,y,S){for(var k=f._reactName,D=[];m!==null&&m!==y;){var L=m,K=L.alternate,lt=L.stateNode;if(L=L.tag,K!==null&&K===y)break;L!==5&&L!==26&&L!==27||lt===null||(K=lt,S?(lt=gf(m,k),lt!=null&&D.unshift(Qf(m,lt,K))):S||(lt=gf(m,k),lt!=null&&D.push(Qf(m,lt,K)))),m=m.return}D.length!==0&&u.push({event:f,listeners:D})}var aK=/\r\n?/g,sK=/\u0000|\uFFFD/g;function xR(u){return(typeof u=="string"?u:""+u).replace(aK,`
`).replace(sK,"")}function wR(u,f){return f=xR(f),xR(u)===f}function lg(){}function Me(u,f,m,y,S,k){switch(m){case"children":typeof y=="string"?f==="body"||f==="textarea"&&y===""||iu(u,y):(typeof y=="number"||typeof y=="bigint")&&f!=="body"&&iu(u,""+y);break;case"className":dm(u,"class",y);break;case"tabIndex":dm(u,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":dm(u,m,y);break;case"style":CO(u,y,k);break;case"data":if(f!=="object"){dm(u,"data",y);break}case"src":case"href":if(y===""&&(f!=="a"||m!=="href")){u.removeAttribute(m);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){u.removeAttribute(m);break}y=gm(""+y),u.setAttribute(m,y);break;case"action":case"formAction":if(typeof y=="function"){u.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(m==="formAction"?(f!=="input"&&Me(u,f,"name",S.name,S,null),Me(u,f,"formEncType",S.formEncType,S,null),Me(u,f,"formMethod",S.formMethod,S,null),Me(u,f,"formTarget",S.formTarget,S,null)):(Me(u,f,"encType",S.encType,S,null),Me(u,f,"method",S.method,S,null),Me(u,f,"target",S.target,S,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){u.removeAttribute(m);break}y=gm(""+y),u.setAttribute(m,y);break;case"onClick":y!=null&&(u.onclick=lg);break;case"onScroll":y!=null&&ce("scroll",u);break;case"onScrollEnd":y!=null&&ce("scrollend",u);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(m=y.__html,m!=null){if(S.children!=null)throw Error(r(60));u.innerHTML=m}}break;case"multiple":u.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":u.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){u.removeAttribute("xlink:href");break}m=gm(""+y),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(m,""+y):u.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(m,""):u.removeAttribute(m);break;case"capture":case"download":y===!0?u.setAttribute(m,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?u.setAttribute(m,y):u.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?u.setAttribute(m,y):u.removeAttribute(m);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?u.removeAttribute(m):u.setAttribute(m,y);break;case"popover":ce("beforetoggle",u),ce("toggle",u),hm(u,"popover",y);break;case"xlinkActuate":Ua(u,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Ua(u,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Ua(u,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Ua(u,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Ua(u,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Ua(u,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Ua(u,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Ua(u,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Ua(u,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":hm(u,"is",y);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=P8.get(m)||m,hm(u,m,y))}}function N1(u,f,m,y,S,k){switch(m){case"style":CO(u,y,k);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(m=y.__html,m!=null){if(S.children!=null)throw Error(r(60));u.innerHTML=m}}break;case"children":typeof y=="string"?iu(u,y):(typeof y=="number"||typeof y=="bigint")&&iu(u,""+y);break;case"onScroll":y!=null&&ce("scroll",u);break;case"onScrollEnd":y!=null&&ce("scrollend",u);break;case"onClick":y!=null&&(u.onclick=lg);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hO.hasOwnProperty(m))t:{if(m[0]==="o"&&m[1]==="n"&&(S=m.endsWith("Capture"),f=m.slice(2,S?m.length-7:void 0),k=u[zr]||null,k=k!=null?k[m]:null,typeof k=="function"&&u.removeEventListener(f,k,S),typeof y=="function")){typeof k!="function"&&k!==null&&(m in u?u[m]=null:u.hasAttribute(m)&&u.removeAttribute(m)),u.addEventListener(f,y,S);break t}m in u?u[m]=y:y===!0?u.setAttribute(m,""):hm(u,m,y)}}}function ir(u,f,m){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ce("error",u),ce("load",u);var y=!1,S=!1,k;for(k in m)if(m.hasOwnProperty(k)){var D=m[k];if(D!=null)switch(k){case"src":y=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,f));default:Me(u,f,k,D,m,null)}}S&&Me(u,f,"srcSet",m.srcSet,m,null),y&&Me(u,f,"src",m.src,m,null);return;case"input":ce("invalid",u);var L=k=D=S=null,K=null,lt=null;for(y in m)if(m.hasOwnProperty(y)){var bt=m[y];if(bt!=null)switch(y){case"name":S=bt;break;case"type":D=bt;break;case"checked":K=bt;break;case"defaultChecked":lt=bt;break;case"value":k=bt;break;case"defaultValue":L=bt;break;case"children":case"dangerouslySetInnerHTML":if(bt!=null)throw Error(r(137,f));break;default:Me(u,f,y,bt,m,null)}}bO(u,k,L,K,lt,D,S,!1),pm(u);return;case"select":ce("invalid",u),y=D=k=null;for(S in m)if(m.hasOwnProperty(S)&&(L=m[S],L!=null))switch(S){case"value":k=L;break;case"defaultValue":D=L;break;case"multiple":y=L;default:Me(u,f,S,L,m,null)}f=k,m=D,u.multiple=!!y,f!=null?ru(u,!!y,f,!1):m!=null&&ru(u,!!y,m,!0);return;case"textarea":ce("invalid",u),k=S=y=null;for(D in m)if(m.hasOwnProperty(D)&&(L=m[D],L!=null))switch(D){case"value":y=L;break;case"defaultValue":S=L;break;case"children":k=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(r(91));break;default:Me(u,f,D,L,m,null)}wO(u,y,S,k),pm(u);return;case"option":for(K in m)if(m.hasOwnProperty(K)&&(y=m[K],y!=null))switch(K){case"selected":u.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:Me(u,f,K,y,m,null)}return;case"dialog":ce("beforetoggle",u),ce("toggle",u),ce("cancel",u),ce("close",u);break;case"iframe":case"object":ce("load",u);break;case"video":case"audio":for(y=0;y<Zf.length;y++)ce(Zf[y],u);break;case"image":ce("error",u),ce("load",u);break;case"details":ce("toggle",u);break;case"embed":case"source":case"link":ce("error",u),ce("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(lt in m)if(m.hasOwnProperty(lt)&&(y=m[lt],y!=null))switch(lt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,f));default:Me(u,f,lt,y,m,null)}return;default:if(H0(f)){for(bt in m)m.hasOwnProperty(bt)&&(y=m[bt],y!==void 0&&N1(u,f,bt,y,m,void 0));return}}for(L in m)m.hasOwnProperty(L)&&(y=m[L],y!=null&&Me(u,f,L,y,m,null))}function oK(u,f,m,y){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,k=null,D=null,L=null,K=null,lt=null,bt=null;for(ft in m){var wt=m[ft];if(m.hasOwnProperty(ft)&&wt!=null)switch(ft){case"checked":break;case"value":break;case"defaultValue":K=wt;default:y.hasOwnProperty(ft)||Me(u,f,ft,null,y,wt)}}for(var ut in y){var ft=y[ut];if(wt=m[ut],y.hasOwnProperty(ut)&&(ft!=null||wt!=null))switch(ut){case"type":k=ft;break;case"name":S=ft;break;case"checked":lt=ft;break;case"defaultChecked":bt=ft;break;case"value":D=ft;break;case"defaultValue":L=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(r(137,f));break;default:ft!==wt&&Me(u,f,ut,ft,y,wt)}}G0(u,D,L,K,lt,bt,k,S);return;case"select":ft=D=L=ut=null;for(k in m)if(K=m[k],m.hasOwnProperty(k)&&K!=null)switch(k){case"value":break;case"multiple":ft=K;default:y.hasOwnProperty(k)||Me(u,f,k,null,y,K)}for(S in y)if(k=y[S],K=m[S],y.hasOwnProperty(S)&&(k!=null||K!=null))switch(S){case"value":ut=k;break;case"defaultValue":L=k;break;case"multiple":D=k;default:k!==K&&Me(u,f,S,k,y,K)}f=L,m=D,y=ft,ut!=null?ru(u,!!m,ut,!1):!!y!=!!m&&(f!=null?ru(u,!!m,f,!0):ru(u,!!m,m?[]:"",!1));return;case"textarea":ft=ut=null;for(L in m)if(S=m[L],m.hasOwnProperty(L)&&S!=null&&!y.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Me(u,f,L,null,y,S)}for(D in y)if(S=y[D],k=m[D],y.hasOwnProperty(D)&&(S!=null||k!=null))switch(D){case"value":ut=S;break;case"defaultValue":ft=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(r(91));break;default:S!==k&&Me(u,f,D,S,y,k)}xO(u,ut,ft);return;case"option":for(var Qt in m)if(ut=m[Qt],m.hasOwnProperty(Qt)&&ut!=null&&!y.hasOwnProperty(Qt))switch(Qt){case"selected":u.selected=!1;break;default:Me(u,f,Qt,null,y,ut)}for(K in y)if(ut=y[K],ft=m[K],y.hasOwnProperty(K)&&ut!==ft&&(ut!=null||ft!=null))switch(K){case"selected":u.selected=ut&&typeof ut!="function"&&typeof ut!="symbol";break;default:Me(u,f,K,ut,y,ft)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Gt in m)ut=m[Gt],m.hasOwnProperty(Gt)&&ut!=null&&!y.hasOwnProperty(Gt)&&Me(u,f,Gt,null,y,ut);for(lt in y)if(ut=y[lt],ft=m[lt],y.hasOwnProperty(lt)&&ut!==ft&&(ut!=null||ft!=null))switch(lt){case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(r(137,f));break;default:Me(u,f,lt,ut,y,ft)}return;default:if(H0(f)){for(var Pe in m)ut=m[Pe],m.hasOwnProperty(Pe)&&ut!==void 0&&!y.hasOwnProperty(Pe)&&N1(u,f,Pe,void 0,y,ut);for(bt in y)ut=y[bt],ft=m[bt],!y.hasOwnProperty(bt)||ut===ft||ut===void 0&&ft===void 0||N1(u,f,bt,ut,y,ft);return}}for(var it in m)ut=m[it],m.hasOwnProperty(it)&&ut!=null&&!y.hasOwnProperty(it)&&Me(u,f,it,null,y,ut);for(wt in y)ut=y[wt],ft=m[wt],!y.hasOwnProperty(wt)||ut===ft||ut==null&&ft==null||Me(u,f,wt,ut,y,ft)}var _1=null,R1=null;function ug(u){return u.nodeType===9?u:u.ownerDocument}function SR(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function CR(u,f){if(u===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&f==="foreignObject"?0:u}function D1(u,f){return u==="textarea"||u==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var M1=null;function lK(){var u=window.event;return u&&u.type==="popstate"?u===M1?!1:(M1=u,!0):(M1=null,!1)}var TR=typeof setTimeout=="function"?setTimeout:void 0,uK=typeof clearTimeout=="function"?clearTimeout:void 0,$R=typeof Promise=="function"?Promise:void 0,cK=typeof queueMicrotask=="function"?queueMicrotask:typeof $R<"u"?function(u){return $R.resolve(null).then(u).catch(fK)}:TR;function fK(u){setTimeout(function(){throw u})}function Hs(u){return u==="head"}function AR(u,f){var m=f,y=0,S=0;do{var k=m.nextSibling;if(u.removeChild(m),k&&k.nodeType===8)if(m=k.data,m==="/$"){if(0<y&&8>y){m=y;var D=u.ownerDocument;if(m&1&&Jf(D.documentElement),m&2&&Jf(D.body),m&4)for(m=D.head,Jf(m),D=m.firstChild;D;){var L=D.nextSibling,K=D.nodeName;D[pf]||K==="SCRIPT"||K==="STYLE"||K==="LINK"&&D.rel.toLowerCase()==="stylesheet"||m.removeChild(D),D=L}}if(S===0){u.removeChild(k),oh(f);return}S--}else m==="$"||m==="$?"||m==="$!"?S++:y=m.charCodeAt(0)-48;else y=0;m=k}while(m);oh(f)}function P1(u){var f=u.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var m=f;switch(f=f.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":P1(m),j0(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}u.removeChild(m)}}function hK(u,f,m,y){for(;u.nodeType===1;){var S=m;if(u.nodeName.toLowerCase()!==f.toLowerCase()){if(!y&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(y){if(!u[pf])switch(f){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(k=u.getAttribute("rel"),k==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(k!==S.rel||u.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||u.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||u.getAttribute("title")!==(S.title==null?null:S.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(k=u.getAttribute("src"),(k!==(S.src==null?null:S.src)||u.getAttribute("type")!==(S.type==null?null:S.type)||u.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&k&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(f==="input"&&u.type==="hidden"){var k=S.name==null?null:""+S.name;if(S.type==="hidden"&&u.getAttribute("name")===k)return u}else return u;if(u=qi(u.nextSibling),u===null)break}return null}function dK(u,f,m){if(f==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!m||(u=qi(u.nextSibling),u===null))return null;return u}function F1(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState==="complete"}function pK(u,f){var m=u.ownerDocument;if(u.data!=="$?"||m.readyState==="complete")f();else{var y=function(){f(),m.removeEventListener("DOMContentLoaded",y)};m.addEventListener("DOMContentLoaded",y),u._reactRetry=y}}function qi(u){for(;u!=null;u=u.nextSibling){var f=u.nodeType;if(f===1||f===3)break;if(f===8){if(f=u.data,f==="$"||f==="$!"||f==="$?"||f==="F!"||f==="F")break;if(f==="/$")return null}}return u}var L1=null;function kR(u){u=u.previousSibling;for(var f=0;u;){if(u.nodeType===8){var m=u.data;if(m==="$"||m==="$!"||m==="$?"){if(f===0)return u;f--}else m==="/$"&&f++}u=u.previousSibling}return null}function ER(u,f,m){switch(f=ug(m),u){case"html":if(u=f.documentElement,!u)throw Error(r(452));return u;case"head":if(u=f.head,!u)throw Error(r(453));return u;case"body":if(u=f.body,!u)throw Error(r(454));return u;default:throw Error(r(451))}}function Jf(u){for(var f=u.attributes;f.length;)u.removeAttributeNode(f[0]);j0(u)}var Ti=new Map,IR=new Set;function cg(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var ns=U.d;U.d={f:mK,r:gK,D:yK,C:vK,L:bK,m:xK,X:SK,S:wK,M:CK};function mK(){var u=ns.f(),f=eg();return u||f}function gK(u){var f=Jl(u);f!==null&&f.tag===5&&f.type==="form"?KN(f):ns.r(u)}var Ru=typeof document>"u"?null:document;function OR(u,f,m){var y=Ru;if(y&&typeof f=="string"&&f){var S=yi(f);S='link[rel="'+u+'"][href="'+S+'"]',typeof m=="string"&&(S+='[crossorigin="'+m+'"]'),IR.has(S)||(IR.add(S),u={rel:u,crossOrigin:m,href:f},y.querySelector(S)===null&&(f=y.createElement("link"),ir(f,"link",u),Wn(f),y.head.appendChild(f)))}}function yK(u){ns.D(u),OR("dns-prefetch",u,null)}function vK(u,f){ns.C(u,f),OR("preconnect",u,f)}function bK(u,f,m){ns.L(u,f,m);var y=Ru;if(y&&u&&f){var S='link[rel="preload"][as="'+yi(f)+'"]';f==="image"&&m&&m.imageSrcSet?(S+='[imagesrcset="'+yi(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(S+='[imagesizes="'+yi(m.imageSizes)+'"]')):S+='[href="'+yi(u)+'"]';var k=S;switch(f){case"style":k=Du(u);break;case"script":k=Mu(u)}Ti.has(k)||(u=h({rel:"preload",href:f==="image"&&m&&m.imageSrcSet?void 0:u,as:f},m),Ti.set(k,u),y.querySelector(S)!==null||f==="style"&&y.querySelector(th(k))||f==="script"&&y.querySelector(eh(k))||(f=y.createElement("link"),ir(f,"link",u),Wn(f),y.head.appendChild(f)))}}function xK(u,f){ns.m(u,f);var m=Ru;if(m&&u){var y=f&&typeof f.as=="string"?f.as:"script",S='link[rel="modulepreload"][as="'+yi(y)+'"][href="'+yi(u)+'"]',k=S;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Mu(u)}if(!Ti.has(k)&&(u=h({rel:"modulepreload",href:u},f),Ti.set(k,u),m.querySelector(S)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(eh(k)))return}y=m.createElement("link"),ir(y,"link",u),Wn(y),m.head.appendChild(y)}}}function wK(u,f,m){ns.S(u,f,m);var y=Ru;if(y&&u){var S=tu(y).hoistableStyles,k=Du(u);f=f||"default";var D=S.get(k);if(!D){var L={loading:0,preload:null};if(D=y.querySelector(th(k)))L.loading=5;else{u=h({rel:"stylesheet",href:u,"data-precedence":f},m),(m=Ti.get(k))&&B1(u,m);var K=D=y.createElement("link");Wn(K),ir(K,"link",u),K._p=new Promise(function(lt,bt){K.onload=lt,K.onerror=bt}),K.addEventListener("load",function(){L.loading|=1}),K.addEventListener("error",function(){L.loading|=2}),L.loading|=4,fg(D,f,y)}D={type:"stylesheet",instance:D,count:1,state:L},S.set(k,D)}}}function SK(u,f){ns.X(u,f);var m=Ru;if(m&&u){var y=tu(m).hoistableScripts,S=Mu(u),k=y.get(S);k||(k=m.querySelector(eh(S)),k||(u=h({src:u,async:!0},f),(f=Ti.get(S))&&z1(u,f),k=m.createElement("script"),Wn(k),ir(k,"link",u),m.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},y.set(S,k))}}function CK(u,f){ns.M(u,f);var m=Ru;if(m&&u){var y=tu(m).hoistableScripts,S=Mu(u),k=y.get(S);k||(k=m.querySelector(eh(S)),k||(u=h({src:u,async:!0,type:"module"},f),(f=Ti.get(S))&&z1(u,f),k=m.createElement("script"),Wn(k),ir(k,"link",u),m.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},y.set(S,k))}}function NR(u,f,m,y){var S=(S=yt.current)?cg(S):null;if(!S)throw Error(r(446));switch(u){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(f=Du(m.href),m=tu(S).hoistableStyles,y=m.get(f),y||(y={type:"style",instance:null,count:0,state:null},m.set(f,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){u=Du(m.href);var k=tu(S).hoistableStyles,D=k.get(u);if(D||(S=S.ownerDocument||S,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(u,D),(k=S.querySelector(th(u)))&&!k._p&&(D.instance=k,D.state.loading=5),Ti.has(u)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Ti.set(u,m),k||TK(S,u,m,D.state))),f&&y===null)throw Error(r(528,""));return D}if(f&&y!==null)throw Error(r(529,""));return null;case"script":return f=m.async,m=m.src,typeof m=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=Mu(m),m=tu(S).hoistableScripts,y=m.get(f),y||(y={type:"script",instance:null,count:0,state:null},m.set(f,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,u))}}function Du(u){return'href="'+yi(u)+'"'}function th(u){return'link[rel="stylesheet"]['+u+"]"}function _R(u){return h({},u,{"data-precedence":u.precedence,precedence:null})}function TK(u,f,m,y){u.querySelector('link[rel="preload"][as="style"]['+f+"]")?y.loading=1:(f=u.createElement("link"),y.preload=f,f.addEventListener("load",function(){return y.loading|=1}),f.addEventListener("error",function(){return y.loading|=2}),ir(f,"link",m),Wn(f),u.head.appendChild(f))}function Mu(u){return'[src="'+yi(u)+'"]'}function eh(u){return"script[async]"+u}function RR(u,f,m){if(f.count++,f.instance===null)switch(f.type){case"style":var y=u.querySelector('style[data-href~="'+yi(m.href)+'"]');if(y)return f.instance=y,Wn(y),y;var S=h({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return y=(u.ownerDocument||u).createElement("style"),Wn(y),ir(y,"style",S),fg(y,m.precedence,u),f.instance=y;case"stylesheet":S=Du(m.href);var k=u.querySelector(th(S));if(k)return f.state.loading|=4,f.instance=k,Wn(k),k;y=_R(m),(S=Ti.get(S))&&B1(y,S),k=(u.ownerDocument||u).createElement("link"),Wn(k);var D=k;return D._p=new Promise(function(L,K){D.onload=L,D.onerror=K}),ir(k,"link",y),f.state.loading|=4,fg(k,m.precedence,u),f.instance=k;case"script":return k=Mu(m.src),(S=u.querySelector(eh(k)))?(f.instance=S,Wn(S),S):(y=m,(S=Ti.get(k))&&(y=h({},m),z1(y,S)),u=u.ownerDocument||u,S=u.createElement("script"),Wn(S),ir(S,"link",y),u.head.appendChild(S),f.instance=S);case"void":return null;default:throw Error(r(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(y=f.instance,f.state.loading|=4,fg(y,m.precedence,u));return f.instance}function fg(u,f,m){for(var y=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=y.length?y[y.length-1]:null,k=S,D=0;D<y.length;D++){var L=y[D];if(L.dataset.precedence===f)k=L;else if(k!==S)break}k?k.parentNode.insertBefore(u,k.nextSibling):(f=m.nodeType===9?m.head:m,f.insertBefore(u,f.firstChild))}function B1(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.title==null&&(u.title=f.title)}function z1(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.integrity==null&&(u.integrity=f.integrity)}var hg=null;function DR(u,f,m){if(hg===null){var y=new Map,S=hg=new Map;S.set(m,y)}else S=hg,y=S.get(m),y||(y=new Map,S.set(m,y));if(y.has(u))return y;for(y.set(u,null),m=m.getElementsByTagName(u),S=0;S<m.length;S++){var k=m[S];if(!(k[pf]||k[pr]||u==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var D=k.getAttribute(f)||"";D=u+D;var L=y.get(D);L?L.push(k):y.set(D,[k])}}return y}function MR(u,f,m){u=u.ownerDocument||u,u.head.insertBefore(m,f==="title"?u.querySelector("head > title"):null)}function $K(u,f,m){if(m===1||f.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return u=f.disabled,typeof f.precedence=="string"&&u==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function PR(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}var nh=null;function AK(){}function kK(u,f,m){if(nh===null)throw Error(r(475));var y=nh;if(f.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var S=Du(m.href),k=u.querySelector(th(S));if(k){u=k._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(y.count++,y=dg.bind(y),u.then(y,y)),f.state.loading|=4,f.instance=k,Wn(k);return}k=u.ownerDocument||u,m=_R(m),(S=Ti.get(S))&&B1(m,S),k=k.createElement("link"),Wn(k);var D=k;D._p=new Promise(function(L,K){D.onload=L,D.onerror=K}),ir(k,"link",m),f.instance=k}y.stylesheets===null&&(y.stylesheets=new Map),y.stylesheets.set(f,u),(u=f.state.preload)&&(f.state.loading&3)===0&&(y.count++,f=dg.bind(y),u.addEventListener("load",f),u.addEventListener("error",f))}}function EK(){if(nh===null)throw Error(r(475));var u=nh;return u.stylesheets&&u.count===0&&j1(u,u.stylesheets),0<u.count?function(f){var m=setTimeout(function(){if(u.stylesheets&&j1(u,u.stylesheets),u.unsuspend){var y=u.unsuspend;u.unsuspend=null,y()}},6e4);return u.unsuspend=f,function(){u.unsuspend=null,clearTimeout(m)}}:null}function dg(){if(this.count--,this.count===0){if(this.stylesheets)j1(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var pg=null;function j1(u,f){u.stylesheets=null,u.unsuspend!==null&&(u.count++,pg=new Map,f.forEach(IK,u),pg=null,dg.call(u))}function IK(u,f){if(!(f.state.loading&4)){var m=pg.get(u);if(m)var y=m.get(null);else{m=new Map,pg.set(u,m);for(var S=u.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<S.length;k++){var D=S[k];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(m.set(D.dataset.precedence,D),y=D)}y&&m.set(null,y)}S=f.instance,D=S.getAttribute("data-precedence"),k=m.get(D)||y,k===y&&m.set(null,S),m.set(D,S),this.count++,y=dg.bind(this),S.addEventListener("load",y),S.addEventListener("error",y),k?k.parentNode.insertBefore(S,k.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(S,u.firstChild)),f.state.loading|=4}}var rh={$$typeof:T,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function OK(u,f,m,y,S,k,D,L){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=F0(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=F0(0),this.hiddenUpdates=F0(null),this.identifierPrefix=y,this.onUncaughtError=S,this.onCaughtError=k,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function FR(u,f,m,y,S,k,D,L,K,lt,bt,wt){return u=new OK(u,f,m,D,L,K,lt,wt),f=1,k===!0&&(f|=24),k=Jr(3,null,null,f),u.current=k,k.stateNode=u,f=Sx(),f.refCount++,u.pooledCache=f,f.refCount++,k.memoizedState={element:y,isDehydrated:m,cache:f},Ax(k),u}function LR(u){return u?(u=hu,u):hu}function BR(u,f,m,y,S,k){S=LR(S),y.context===null?y.context=S:y.pendingContext=S,y=Ds(f),y.payload={element:m},k=k===void 0?null:k,k!==null&&(y.callback=k),m=Ms(u,y,f),m!==null&&(ii(m,u,f),Rf(m,u,f))}function zR(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var m=u.retryLane;u.retryLane=m!==0&&m<f?m:f}}function U1(u,f){zR(u,f),(u=u.alternate)&&zR(u,f)}function jR(u){if(u.tag===13){var f=fu(u,67108864);f!==null&&ii(f,u,67108864),U1(u,67108864)}}var mg=!0;function NK(u,f,m,y){var S=M.T;M.T=null;var k=U.p;try{U.p=2,V1(u,f,m,y)}finally{U.p=k,M.T=S}}function _K(u,f,m,y){var S=M.T;M.T=null;var k=U.p;try{U.p=8,V1(u,f,m,y)}finally{U.p=k,M.T=S}}function V1(u,f,m,y){if(mg){var S=W1(y);if(S===null)O1(u,f,y,gg,m),VR(u,y);else if(DK(S,u,f,m,y))y.stopPropagation();else if(VR(u,y),f&4&&-1<RK.indexOf(u)){for(;S!==null;){var k=Jl(S);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var D=ja(k.pendingLanes);if(D!==0){var L=k;for(L.pendingLanes|=2,L.entangledLanes|=2;D;){var K=1<<31-Dn(D);L.entanglements[1]|=K,D&=~K}ga(k),(Oe&6)===0&&(Jm=qt()+500,Yf(0))}}break;case 13:L=fu(k,2),L!==null&&ii(L,k,2),eg(),U1(k,2)}if(k=W1(y),k===null&&O1(u,f,y,gg,m),k===S)break;S=k}S!==null&&y.stopPropagation()}else O1(u,f,y,null,m)}}function W1(u){return u=K0(u),G1(u)}var gg=null;function G1(u){if(gg=null,u=Ql(u),u!==null){var f=a(u);if(f===null)u=null;else{var m=f.tag;if(m===13){if(u=s(f),u!==null)return u;u=null}else if(m===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;u=null}else f!==u&&(u=null)}}return gg=u,null}function UR(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fe()){case Rn:return 2;case Ge:return 8;case pn:case nn:return 32;case Fr:return 268435456;default:return 32}default:return 32}}var q1=!1,Xs=null,Ks=null,Ys=null,ih=new Map,ah=new Map,Zs=[],RK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function VR(u,f){switch(u){case"focusin":case"focusout":Xs=null;break;case"dragenter":case"dragleave":Ks=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":ih.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":ah.delete(f.pointerId)}}function sh(u,f,m,y,S,k){return u===null||u.nativeEvent!==k?(u={blockedOn:f,domEventName:m,eventSystemFlags:y,nativeEvent:k,targetContainers:[S]},f!==null&&(f=Jl(f),f!==null&&jR(f)),u):(u.eventSystemFlags|=y,f=u.targetContainers,S!==null&&f.indexOf(S)===-1&&f.push(S),u)}function DK(u,f,m,y,S){switch(f){case"focusin":return Xs=sh(Xs,u,f,m,y,S),!0;case"dragenter":return Ks=sh(Ks,u,f,m,y,S),!0;case"mouseover":return Ys=sh(Ys,u,f,m,y,S),!0;case"pointerover":var k=S.pointerId;return ih.set(k,sh(ih.get(k)||null,u,f,m,y,S)),!0;case"gotpointercapture":return k=S.pointerId,ah.set(k,sh(ah.get(k)||null,u,f,m,y,S)),!0}return!1}function WR(u){var f=Ql(u.target);if(f!==null){var m=a(f);if(m!==null){if(f=m.tag,f===13){if(f=s(m),f!==null){u.blockedOn=f,k8(u.priority,function(){if(m.tag===13){var y=ri();y=L0(y);var S=fu(m,y);S!==null&&ii(S,m,y),U1(m,y)}});return}}else if(f===3&&m.stateNode.current.memoizedState.isDehydrated){u.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}u.blockedOn=null}function yg(u){if(u.blockedOn!==null)return!1;for(var f=u.targetContainers;0<f.length;){var m=W1(u.nativeEvent);if(m===null){m=u.nativeEvent;var y=new m.constructor(m.type,m);X0=y,m.target.dispatchEvent(y),X0=null}else return f=Jl(m),f!==null&&jR(f),u.blockedOn=m,!1;f.shift()}return!0}function GR(u,f,m){yg(u)&&m.delete(f)}function MK(){q1=!1,Xs!==null&&yg(Xs)&&(Xs=null),Ks!==null&&yg(Ks)&&(Ks=null),Ys!==null&&yg(Ys)&&(Ys=null),ih.forEach(GR),ah.forEach(GR)}function vg(u,f){u.blockedOn===f&&(u.blockedOn=null,q1||(q1=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,MK)))}var bg=null;function qR(u){bg!==u&&(bg=u,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){bg===u&&(bg=null);for(var f=0;f<u.length;f+=3){var m=u[f],y=u[f+1],S=u[f+2];if(typeof y!="function"){if(G1(y||m)===null)continue;break}var k=Jl(m);k!==null&&(u.splice(f,3),f-=3,Gx(k,{pending:!0,data:S,method:m.method,action:y},y,S))}}))}function oh(u){function f(K){return vg(K,u)}Xs!==null&&vg(Xs,u),Ks!==null&&vg(Ks,u),Ys!==null&&vg(Ys,u),ih.forEach(f),ah.forEach(f);for(var m=0;m<Zs.length;m++){var y=Zs[m];y.blockedOn===u&&(y.blockedOn=null)}for(;0<Zs.length&&(m=Zs[0],m.blockedOn===null);)WR(m),m.blockedOn===null&&Zs.shift();if(m=(u.ownerDocument||u).$$reactFormReplay,m!=null)for(y=0;y<m.length;y+=3){var S=m[y],k=m[y+1],D=S[zr]||null;if(typeof k=="function")D||qR(m);else if(D){var L=null;if(k&&k.hasAttribute("formAction")){if(S=k,D=k[zr]||null)L=D.formAction;else if(G1(S)!==null)continue}else L=D.action;typeof L=="function"?m[y+1]=L:(m.splice(y,3),y-=3),qR(m)}}}function H1(u){this._internalRoot=u}xg.prototype.render=H1.prototype.render=function(u){var f=this._internalRoot;if(f===null)throw Error(r(409));var m=f.current,y=ri();BR(m,y,u,f,null,null)},xg.prototype.unmount=H1.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var f=u.containerInfo;BR(u.current,2,null,u,null,null),eg(),f[Zl]=null}};function xg(u){this._internalRoot=u}xg.prototype.unstable_scheduleHydration=function(u){if(u){var f=uO();u={blockedOn:null,target:u,priority:f};for(var m=0;m<Zs.length&&f!==0&&f<Zs[m].priority;m++);Zs.splice(m,0,u),m===0&&WR(u)}};var HR=t.version;if(HR!=="19.1.0")throw Error(r(527,HR,"19.1.0"));U.findDOMNode=function(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=l(f),u=u!==null?c(u):null,u=u===null?null:u.stateNode,u};var PK={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wg.isDisabled&&wg.supportsFiber)try{Br=wg.inject(PK),an=wg}catch{}}return uh.createRoot=function(u,f){if(!i(u))throw Error(r(299));var m=!1,y="",S=u_,k=c_,D=f_,L=null;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(y=f.identifierPrefix),f.onUncaughtError!==void 0&&(S=f.onUncaughtError),f.onCaughtError!==void 0&&(k=f.onCaughtError),f.onRecoverableError!==void 0&&(D=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(L=f.unstable_transitionCallbacks)),f=FR(u,1,!1,null,null,m,y,S,k,D,L,null),u[Zl]=f.current,I1(u),new H1(f)},uh.hydrateRoot=function(u,f,m){if(!i(u))throw Error(r(299));var y=!1,S="",k=u_,D=c_,L=f_,K=null,lt=null;return m!=null&&(m.unstable_strictMode===!0&&(y=!0),m.identifierPrefix!==void 0&&(S=m.identifierPrefix),m.onUncaughtError!==void 0&&(k=m.onUncaughtError),m.onCaughtError!==void 0&&(D=m.onCaughtError),m.onRecoverableError!==void 0&&(L=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(K=m.unstable_transitionCallbacks),m.formState!==void 0&&(lt=m.formState)),f=FR(u,1,!0,f,m??null,y,S,k,D,L,K,lt),f.context=LR(null),m=f.current,y=ri(),y=L0(y),S=Ds(y),S.callback=null,Ms(m,S,y),m=y,f.current.lanes=m,df(f,m),ga(f),u[Zl]=f.current,I1(u),new xg(f)},uh.version="19.1.0",uh}var rD;function YK(){if(rD)return Y1.exports;rD=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Y1.exports=KK(),Y1.exports}var ZK=YK();const QK=({assets:e,returns:t,cov:n,setAssets:r,setReturns:i,setCov:a})=>Kt.jsxs("div",{children:[Kt.jsx("h4",{children:"Asset Names (comma separated)"}),Kt.jsx("input",{type:"text",value:e.join(","),onChange:s=>r(s.target.value.split(",").map(o=>o.trim())),style:{width:"100%"}}),Kt.jsx("h4",{children:"Expected Returns (comma separated)"}),Kt.jsx("input",{type:"text",value:t.join(","),onChange:s=>i(s.target.value.split(",").map(o=>parseFloat(o))),style:{width:"100%"}}),Kt.jsx("h4",{children:"Covariance Matrix (CSV, one row per line)"}),Kt.jsx("textarea",{value:n.map(s=>s.join(",")).join(`
`),onChange:s=>a(s.target.value.split(`
`).map(o=>o.split(",").map(l=>parseFloat(l)))),style:{width:"100%",minHeight:80}})]}),JK=({objective:e,setObjective:t})=>Kt.jsxs("div",{children:[Kt.jsx("label",{children:"Optimization Objective: "}),Kt.jsxs("select",{value:e,onChange:n=>t(n.target.value),children:[Kt.jsx("option",{value:"min_vol",children:"Min Volatility"}),Kt.jsx("option",{value:"max_sharpe",children:"Max Sharpe"}),Kt.jsx("option",{value:"max_div",children:"Max Diversification"})]})]}),tw=[{key:"noShort",label:"No Shorting",fields:[]},{key:"sumToOne",label:"Sum to One",fields:[]},{key:"bounds",label:"Per-Asset Bounds",fields:["minVec","maxVec"]},{key:"groupMax",label:"Group Max",fields:["groupIdx","max"]},{key:"groupMin",label:"Group Min",fields:["groupIdx","min"]},{key:"maxWeight",label:"Max Weight",fields:["max"]},{key:"betweenMinusOneAndOne",label:"Between -1 and 1",fields:[]},{key:"sumToTarget",label:"Sum to Target",fields:["target"]},{key:"minWeight",label:"Min Weight",fields:["min"]},{key:"turnover",label:"Turnover",fields:["prevW","maxTurnover"]},{key:"riskBudget",label:"Risk Budget",fields:["cov","maxFraction"]}],t7=({constraints:e,setConstraints:t})=>{const[n,r]=Tt.useState(tw[0].key),[i,a]=Tt.useState({}),s=()=>{let c;if(n==="noShort"||n==="sumToOne")c={key:n};else if(n==="bounds")c={key:"bounds",minVec:i.minVec??"",maxVec:i.maxVec??""};else if(n==="groupMax")c={key:"groupMax",groupIdx:i.groupIdx??"",max:i.max??""};else if(n==="groupMin")c={key:"groupMin",groupIdx:i.groupIdx??"",min:i.min??""};else if(n==="maxWeight")c={key:"maxWeight",max:i.max??""};else if(n==="betweenMinusOneAndOne")c={key:"betweenMinusOneAndOne"};else if(n==="sumToTarget")c={key:"sumToTarget",target:i.target??""};else if(n==="minWeight")c={key:"minWeight",min:i.min??""};else if(n==="turnover")c={key:"turnover",prevW:i.prevW??"",maxTurnover:i.maxTurnover??""};else if(n==="riskBudget")c={key:"riskBudget",cov:i.cov??"",maxFraction:i.maxFraction??""};else return;t([...e,c]),a({})},o=c=>{t(e.filter((h,d)=>d!==c))},l=()=>{var h;return(((h=tw.find(d=>d.key===n))==null?void 0:h.fields)||[]).map(d=>Kt.jsx("input",{type:"text",placeholder:d,value:i[d]||"",onChange:p=>a({...i,[d]:p.target.value}),style:{marginRight:8}},d))};return Kt.jsxs("div",{style:{margin:"16px 0"},children:[Kt.jsx("h4",{children:"Constraints"}),Kt.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[Kt.jsx("select",{value:n,onChange:c=>{r(c.target.value),a({})},children:tw.map(c=>Kt.jsx("option",{value:c.key,children:c.label},c.key))}),l(),Kt.jsx("button",{onClick:s,children:"Add Constraint"})]}),Kt.jsx("ul",{children:e.map((c,h)=>Kt.jsxs("li",{style:{marginBottom:4},children:[c.key==="noShort"&&"No Shorting",c.key==="sumToOne"&&"Sum to One",c.key==="bounds"&&`Per-Asset Bounds: min=[${c.minVec}], max=[${c.maxVec}]`,c.key==="groupMax"&&`Group Max: idx=[${c.groupIdx}], max=${c.max}`,c.key==="groupMin"&&`Group Min: idx=[${c.groupIdx}], min=${c.min}`,c.key==="maxWeight"&&`Max Weight: ${c.max}`,c.key==="betweenMinusOneAndOne"&&"Between -1 and 1",c.key==="sumToTarget"&&`Sum to Target: ${c.target}`,c.key==="minWeight"&&`Min Weight: ${c.min}`,c.key==="turnover"&&`Turnover: prevW=[${c.prevW}], maxTurnover=${c.maxTurnover}`,c.key==="riskBudget"&&`Risk Budget: cov=${c.cov}, maxFraction=${c.maxFraction}`,Kt.jsx("button",{onClick:()=>o(h),style:{marginLeft:8},children:"Remove"})]},h))})]})};function _4(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=_4(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Ce(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=_4(e))&&(r&&(r+=" "),r+=t);return r}var ew,iD;function Zr(){if(iD)return ew;iD=1;var e=Array.isArray;return ew=e,ew}var nw,aD;function R4(){if(aD)return nw;aD=1;var e=typeof Sg=="object"&&Sg&&Sg.Object===Object&&Sg;return nw=e,nw}var rw,sD;function La(){if(sD)return rw;sD=1;var e=R4(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return rw=n,rw}var iw,oD;function Dd(){if(oD)return iw;oD=1;var e=La(),t=e.Symbol;return iw=t,iw}var aw,lD;function e7(){if(lD)return aw;lD=1;var e=Dd(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,i=e?e.toStringTag:void 0;function a(s){var o=n.call(s,i),l=s[i];try{s[i]=void 0;var c=!0}catch{}var h=r.call(s);return c&&(o?s[i]=l:delete s[i]),h}return aw=a,aw}var sw,uD;function n7(){if(uD)return sw;uD=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return sw=n,sw}var ow,cD;function Cs(){if(cD)return ow;cD=1;var e=Dd(),t=e7(),n=n7(),r="[object Null]",i="[object Undefined]",a=e?e.toStringTag:void 0;function s(o){return o==null?o===void 0?i:r:a&&a in Object(o)?t(o):n(o)}return ow=s,ow}var lw,fD;function Ts(){if(fD)return lw;fD=1;function e(t){return t!=null&&typeof t=="object"}return lw=e,lw}var uw,hD;function Lc(){if(hD)return uw;hD=1;var e=Cs(),t=Ts(),n="[object Symbol]";function r(i){return typeof i=="symbol"||t(i)&&e(i)==n}return uw=r,uw}var cw,dD;function wA(){if(dD)return cw;dD=1;var e=Zr(),t=Lc(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(a,s){if(e(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||t(a)?!0:r.test(a)||!n.test(a)||s!=null&&a in Object(s)}return cw=i,cw}var fw,pD;function bo(){if(pD)return fw;pD=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return fw=e,fw}var hw,mD;function SA(){if(mD)return hw;mD=1;var e=Cs(),t=bo(),n="[object AsyncFunction]",r="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!t(o))return!1;var l=e(o);return l==r||l==i||l==n||l==a}return hw=s,hw}var dw,gD;function r7(){if(gD)return dw;gD=1;var e=La(),t=e["__core-js_shared__"];return dw=t,dw}var pw,yD;function i7(){if(yD)return pw;yD=1;var e=r7(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return pw=n,pw}var mw,vD;function D4(){if(vD)return mw;vD=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return mw=n,mw}var gw,bD;function a7(){if(bD)return gw;bD=1;var e=SA(),t=i7(),n=bo(),r=D4(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,c=o.hasOwnProperty,h=RegExp("^"+l.call(c).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!n(p)||t(p))return!1;var g=e(p)?h:a;return g.test(r(p))}return gw=d,gw}var yw,xD;function s7(){if(xD)return yw;xD=1;function e(t,n){return t==null?void 0:t[n]}return yw=e,yw}var vw,wD;function Fl(){if(wD)return vw;wD=1;var e=a7(),t=s7();function n(r,i){var a=t(r,i);return e(a)?a:void 0}return vw=n,vw}var bw,SD;function kv(){if(SD)return bw;SD=1;var e=Fl(),t=e(Object,"create");return bw=t,bw}var xw,CD;function o7(){if(CD)return xw;CD=1;var e=kv();function t(){this.__data__=e?e(null):{},this.size=0}return xw=t,xw}var ww,TD;function l7(){if(TD)return ww;TD=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return ww=e,ww}var Sw,$D;function u7(){if($D)return Sw;$D=1;var e=kv(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function i(a){var s=this.__data__;if(e){var o=s[a];return o===t?void 0:o}return r.call(s,a)?s[a]:void 0}return Sw=i,Sw}var Cw,AD;function c7(){if(AD)return Cw;AD=1;var e=kv(),t=Object.prototype,n=t.hasOwnProperty;function r(i){var a=this.__data__;return e?a[i]!==void 0:n.call(a,i)}return Cw=r,Cw}var Tw,kD;function f7(){if(kD)return Tw;kD=1;var e=kv(),t="__lodash_hash_undefined__";function n(r,i){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=e&&i===void 0?t:i,this}return Tw=n,Tw}var $w,ED;function h7(){if(ED)return $w;ED=1;var e=o7(),t=l7(),n=u7(),r=c7(),i=f7();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=i,$w=a,$w}var Aw,ID;function d7(){if(ID)return Aw;ID=1;function e(){this.__data__=[],this.size=0}return Aw=e,Aw}var kw,OD;function CA(){if(OD)return kw;OD=1;function e(t,n){return t===n||t!==t&&n!==n}return kw=e,kw}var Ew,ND;function Ev(){if(ND)return Ew;ND=1;var e=CA();function t(n,r){for(var i=n.length;i--;)if(e(n[i][0],r))return i;return-1}return Ew=t,Ew}var Iw,_D;function p7(){if(_D)return Iw;_D=1;var e=Ev(),t=Array.prototype,n=t.splice;function r(i){var a=this.__data__,s=e(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():n.call(a,s,1),--this.size,!0}return Iw=r,Iw}var Ow,RD;function m7(){if(RD)return Ow;RD=1;var e=Ev();function t(n){var r=this.__data__,i=e(r,n);return i<0?void 0:r[i][1]}return Ow=t,Ow}var Nw,DD;function g7(){if(DD)return Nw;DD=1;var e=Ev();function t(n){return e(this.__data__,n)>-1}return Nw=t,Nw}var _w,MD;function y7(){if(MD)return _w;MD=1;var e=Ev();function t(n,r){var i=this.__data__,a=e(i,n);return a<0?(++this.size,i.push([n,r])):i[a][1]=r,this}return _w=t,_w}var Rw,PD;function Iv(){if(PD)return Rw;PD=1;var e=d7(),t=p7(),n=m7(),r=g7(),i=y7();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=i,Rw=a,Rw}var Dw,FD;function TA(){if(FD)return Dw;FD=1;var e=Fl(),t=La(),n=e(t,"Map");return Dw=n,Dw}var Mw,LD;function v7(){if(LD)return Mw;LD=1;var e=h7(),t=Iv(),n=TA();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Mw=r,Mw}var Pw,BD;function b7(){if(BD)return Pw;BD=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Pw=e,Pw}var Fw,zD;function Ov(){if(zD)return Fw;zD=1;var e=b7();function t(n,r){var i=n.__data__;return e(r)?i[typeof r=="string"?"string":"hash"]:i.map}return Fw=t,Fw}var Lw,jD;function x7(){if(jD)return Lw;jD=1;var e=Ov();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return Lw=t,Lw}var Bw,UD;function w7(){if(UD)return Bw;UD=1;var e=Ov();function t(n){return e(this,n).get(n)}return Bw=t,Bw}var zw,VD;function S7(){if(VD)return zw;VD=1;var e=Ov();function t(n){return e(this,n).has(n)}return zw=t,zw}var jw,WD;function C7(){if(WD)return jw;WD=1;var e=Ov();function t(n,r){var i=e(this,n),a=i.size;return i.set(n,r),this.size+=i.size==a?0:1,this}return jw=t,jw}var Uw,GD;function $A(){if(GD)return Uw;GD=1;var e=v7(),t=x7(),n=w7(),r=S7(),i=C7();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=n,a.prototype.has=r,a.prototype.set=i,Uw=a,Uw}var Vw,qD;function M4(){if(qD)return Vw;qD=1;var e=$A(),t="Expected a function";function n(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var c=r.apply(this,s);return a.cache=l.set(o,c)||l,c};return a.cache=new(n.Cache||e),a}return n.Cache=e,Vw=n,Vw}var Ww,HD;function T7(){if(HD)return Ww;HD=1;var e=M4(),t=500;function n(r){var i=e(r,function(s){return a.size===t&&a.clear(),s}),a=i.cache;return i}return Ww=n,Ww}var Gw,XD;function $7(){if(XD)return Gw;XD=1;var e=T7(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(t,function(s,o,l,c){a.push(l?c.replace(n,"$1"):o||s)}),a});return Gw=r,Gw}var qw,KD;function AA(){if(KD)return qw;KD=1;function e(t,n){for(var r=-1,i=t==null?0:t.length,a=Array(i);++r<i;)a[r]=n(t[r],r,t);return a}return qw=e,qw}var Hw,YD;function A7(){if(YD)return Hw;YD=1;var e=Dd(),t=AA(),n=Zr(),r=Lc(),i=e?e.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(n(o))return t(o,s)+"";if(r(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return Hw=s,Hw}var Xw,ZD;function P4(){if(ZD)return Xw;ZD=1;var e=A7();function t(n){return n==null?"":e(n)}return Xw=t,Xw}var Kw,QD;function F4(){if(QD)return Kw;QD=1;var e=Zr(),t=wA(),n=$7(),r=P4();function i(a,s){return e(a)?a:t(a,s)?[a]:n(r(a))}return Kw=i,Kw}var Yw,JD;function Nv(){if(JD)return Yw;JD=1;var e=Lc();function t(n){if(typeof n=="string"||e(n))return n;var r=n+"";return r=="0"&&1/n==-1/0?"-0":r}return Yw=t,Yw}var Zw,tM;function kA(){if(tM)return Zw;tM=1;var e=F4(),t=Nv();function n(r,i){i=e(i,r);for(var a=0,s=i.length;r!=null&&a<s;)r=r[t(i[a++])];return a&&a==s?r:void 0}return Zw=n,Zw}var Qw,eM;function L4(){if(eM)return Qw;eM=1;var e=kA();function t(n,r,i){var a=n==null?void 0:e(n,r);return a===void 0?i:a}return Qw=t,Qw}var k7=L4();const Di=Be(k7);var Jw,nM;function E7(){if(nM)return Jw;nM=1;function e(t){return t==null}return Jw=e,Jw}var I7=E7();const he=Be(I7);var tS,rM;function O7(){if(rM)return tS;rM=1;var e=Cs(),t=Zr(),n=Ts(),r="[object String]";function i(a){return typeof a=="string"||!t(a)&&n(a)&&e(a)==r}return tS=i,tS}var N7=O7();const vl=Be(N7);var _7=SA();const se=Be(_7);var R7=bo();const Bc=Be(R7);var eS={exports:{}},Ae={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iM;function D7(){if(iM)return Ae;iM=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),s=Symbol.for("react.context"),o=Symbol.for("react.server_context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),v;v=Symbol.for("react.module.reference");function x(b){if(typeof b=="object"&&b!==null){var w=b.$$typeof;switch(w){case e:switch(b=b.type,b){case n:case i:case r:case c:case h:return b;default:switch(b=b&&b.$$typeof,b){case o:case s:case l:case p:case d:case a:return b;default:return w}}case t:return w}}}return Ae.ContextConsumer=s,Ae.ContextProvider=a,Ae.Element=e,Ae.ForwardRef=l,Ae.Fragment=n,Ae.Lazy=p,Ae.Memo=d,Ae.Portal=t,Ae.Profiler=i,Ae.StrictMode=r,Ae.Suspense=c,Ae.SuspenseList=h,Ae.isAsyncMode=function(){return!1},Ae.isConcurrentMode=function(){return!1},Ae.isContextConsumer=function(b){return x(b)===s},Ae.isContextProvider=function(b){return x(b)===a},Ae.isElement=function(b){return typeof b=="object"&&b!==null&&b.$$typeof===e},Ae.isForwardRef=function(b){return x(b)===l},Ae.isFragment=function(b){return x(b)===n},Ae.isLazy=function(b){return x(b)===p},Ae.isMemo=function(b){return x(b)===d},Ae.isPortal=function(b){return x(b)===t},Ae.isProfiler=function(b){return x(b)===i},Ae.isStrictMode=function(b){return x(b)===r},Ae.isSuspense=function(b){return x(b)===c},Ae.isSuspenseList=function(b){return x(b)===h},Ae.isValidElementType=function(b){return typeof b=="string"||typeof b=="function"||b===n||b===i||b===r||b===c||b===h||b===g||typeof b=="object"&&b!==null&&(b.$$typeof===p||b.$$typeof===d||b.$$typeof===a||b.$$typeof===s||b.$$typeof===l||b.$$typeof===v||b.getModuleId!==void 0)},Ae.typeOf=x,Ae}var aM;function M7(){return aM||(aM=1,eS.exports=D7()),eS.exports}var P7=M7(),nS,sM;function B4(){if(sM)return nS;sM=1;var e=Cs(),t=Ts(),n="[object Number]";function r(i){return typeof i=="number"||t(i)&&e(i)==n}return nS=r,nS}var rS,oM;function F7(){if(oM)return rS;oM=1;var e=B4();function t(n){return e(n)&&n!=+n}return rS=t,rS}var L7=F7();const Md=Be(L7);var B7=B4();const z7=Be(B7);var ra=function(t){return t===0?0:t>0?1:-1},ol=function(t){return vl(t)&&t.indexOf("%")===t.length-1},Ot=function(t){return z7(t)&&!Md(t)},zn=function(t){return Ot(t)||vl(t)},j7=0,Pd=function(t){var n=++j7;return"".concat(t||"").concat(n)},bl=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ot(t)&&!vl(t))return r;var a;if(ol(t)){var s=t.indexOf("%");a=n*parseFloat(t.slice(0,s))/100}else a=+t;return Md(a)&&(a=r),i&&a>n&&(a=n),a},eo=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},U7=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,r={},i=0;i<n;i++)if(!r[t[i]])r[t[i]]=!0;else return!0;return!1},Ji=function(t,n){return Ot(t)&&Ot(n)?function(r){return t+r*(n-t)}:function(){return n}};function iy(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Di(r,t))===n})}var V7=function(t,n){return Ot(t)&&Ot(n)?t-n:vl(t)&&vl(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function Ku(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function b$(e){"@babel/helpers - typeof";return b$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b$(e)}var W7=["viewBox","children"],G7=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],lM=["points","pathLength"],iS={svg:W7,polygon:lM,polyline:lM},EA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],ay=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(Tt.isValidElement(t)&&(r=t.props),!Bc(r))return null;var i={};return Object.keys(r).forEach(function(a){EA.includes(a)&&(i[a]=n||function(s){return r[a](r,s)})}),i},q7=function(t,n,r){return function(i){return t(n,r,i),null}},sy=function(t,n,r){if(!Bc(t)||b$(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(a){var s=t[a];EA.includes(a)&&typeof s=="function"&&(i||(i={}),i[a]=q7(s,n,r))}),i},H7=["children"],X7=["children"];function uM(e,t){if(e==null)return{};var n=K7(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function K7(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function x$(e){"@babel/helpers - typeof";return x$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x$(e)}var cM={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},cs=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},fM=null,aS=null,IA=function e(t){if(t===fM&&Array.isArray(aS))return aS;var n=[];return Tt.Children.forEach(t,function(r){he(r)||(P7.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),aS=n,fM=t,n};function Mi(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(i){return cs(i)}):r=[cs(t)],IA(e).forEach(function(i){var a=Di(i,"type.displayName")||Di(i,"type.name");r.indexOf(a)!==-1&&n.push(i)}),n}function oi(e,t){var n=Mi(e,t);return n&&n[0]}var hM=function(t){if(!t||!t.props)return!1;var n=t.props,r=n.width,i=n.height;return!(!Ot(r)||r<=0||!Ot(i)||i<=0)},Y7=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Z7=function(t){return t&&t.type&&vl(t.type)&&Y7.indexOf(t.type)>=0},Q7=function(t){return t&&x$(t)==="object"&&"clipDot"in t},J7=function(t,n,r,i){var a,s=(a=iS==null?void 0:iS[i])!==null&&a!==void 0?a:[];return n.startsWith("data-")||!se(t)&&(i&&s.includes(n)||G7.includes(n))||r&&EA.includes(n)},pe=function(t,n,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(Tt.isValidElement(t)&&(i=t.props),!Bc(i))return null;var a={};return Object.keys(i).forEach(function(s){var o;J7((o=i)===null||o===void 0?void 0:o[s],s,n,r)&&(a[s]=i[s])}),a},w$=function e(t,n){if(t===n)return!0;var r=Tt.Children.count(t);if(r!==Tt.Children.count(n))return!1;if(r===0)return!0;if(r===1)return dM(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var i=0;i<r;i++){var a=t[i],s=n[i];if(Array.isArray(a)||Array.isArray(s)){if(!e(a,s))return!1}else if(!dM(a,s))return!1}return!0},dM=function(t,n){if(he(t)&&he(n))return!0;if(!he(t)&&!he(n)){var r=t.props||{},i=r.children,a=uM(r,H7),s=n.props||{},o=s.children,l=uM(s,X7);return i&&o?Ku(a,l)&&w$(i,o):!i&&!o?Ku(a,l):!1}return!1},pM=function(t,n){var r=[],i={};return IA(t).forEach(function(a,s){if(Z7(a))r.push(a);else if(a){var o=cs(a.type),l=n[o]||{},c=l.handler,h=l.once;if(c&&(!h||!i[o])){var d=c(a,o,s);r.push(d),i[o]=!0}}}),r},t9=function(t){var n=t&&t.type;return n&&cM[n]?cM[n]:null},e9=function(t,n){return IA(n).indexOf(t)},n9=["children","width","height","viewBox","className","style","title","desc"];function S$(){return S$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S$.apply(this,arguments)}function r9(e,t){if(e==null)return{};var n=i9(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function i9(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function C$(e){var t=e.children,n=e.width,r=e.height,i=e.viewBox,a=e.className,s=e.style,o=e.title,l=e.desc,c=r9(e,n9),h=i||{width:n,height:r,x:0,y:0},d=Ce("recharts-surface",a);return et.createElement("svg",S$({},pe(c,!0,"svg"),{className:d,width:n,height:r,style:s,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height)}),et.createElement("title",null,o),et.createElement("desc",null,l),t)}var a9=["children","className"];function T$(){return T$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T$.apply(this,arguments)}function s9(e,t){if(e==null)return{};var n=o9(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function o9(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var yn=et.forwardRef(function(e,t){var n=e.children,r=e.className,i=s9(e,a9),a=Ce("recharts-layer",r);return et.createElement("g",T$({className:a},pe(i,!0),{ref:t}),n)}),fs=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a]},sS,mM;function l9(){if(mM)return sS;mM=1;function e(t,n,r){var i=-1,a=t.length;n<0&&(n=-n>a?0:a+n),r=r>a?a:r,r<0&&(r+=a),a=n>r?0:r-n>>>0,n>>>=0;for(var s=Array(a);++i<a;)s[i]=t[i+n];return s}return sS=e,sS}var oS,gM;function u9(){if(gM)return oS;gM=1;var e=l9();function t(n,r,i){var a=n.length;return i=i===void 0?a:i,!r&&i>=a?n:e(n,r,i)}return oS=t,oS}var lS,yM;function z4(){if(yM)return lS;yM=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+e+i+a+"]");function l(c){return o.test(c)}return lS=l,lS}var uS,vM;function c9(){if(vM)return uS;vM=1;function e(t){return t.split("")}return uS=e,uS}var cS,bM;function f9(){if(bM)return cS;bM=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,a="\\ufe0e\\ufe0f",s="["+e+"]",o="["+i+"]",l="\\ud83c[\\udffb-\\udfff]",c="(?:"+o+"|"+l+")",h="[^"+e+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",g="\\u200d",v=c+"?",x="["+a+"]?",b="(?:"+g+"(?:"+[h,d,p].join("|")+")"+x+v+")*",w=x+v+b,C="(?:"+[h+o+"?",o,d,p,s].join("|")+")",T=RegExp(l+"(?="+l+")|"+C+w,"g");function $(A){return A.match(T)||[]}return cS=$,cS}var fS,xM;function h9(){if(xM)return fS;xM=1;var e=c9(),t=z4(),n=f9();function r(i){return t(i)?n(i):e(i)}return fS=r,fS}var hS,wM;function d9(){if(wM)return hS;wM=1;var e=u9(),t=z4(),n=h9(),r=P4();function i(a){return function(s){s=r(s);var o=t(s)?n(s):void 0,l=o?o[0]:s.charAt(0),c=o?e(o,1).join(""):s.slice(1);return l[a]()+c}}return hS=i,hS}var dS,SM;function p9(){if(SM)return dS;SM=1;var e=d9(),t=e("toUpperCase");return dS=t,dS}var m9=p9();const _v=Be(m9);function He(e){return function(){return e}}const j4=Math.cos,oy=Math.sin,ca=Math.sqrt,ly=Math.PI,Rv=2*ly,$$=Math.PI,A$=2*$$,tl=1e-6,g9=A$-tl;function U4(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function y9(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return U4;const n=10**t;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class v9{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?U4:y9(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,a,s){this._append`C${+t},${+n},${+r},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(t,n,r,i,a){if(t=+t,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,l=r-t,c=i-n,h=s-t,d=o-n,p=h*h+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(p>tl)if(!(Math.abs(d*l-c*h)>tl)||!a)this._append`L${this._x1=t},${this._y1=n}`;else{let g=r-s,v=i-o,x=l*l+c*c,b=g*g+v*v,w=Math.sqrt(x),C=Math.sqrt(p),T=a*Math.tan(($$-Math.acos((x+p-b)/(2*w*C)))/2),$=T/C,A=T/w;Math.abs($-1)>tl&&this._append`L${t+$*h},${n+$*d}`,this._append`A${a},${a},0,0,${+(d*g>h*v)},${this._x1=t+A*l},${this._y1=n+A*c}`}}arc(t,n,r,i,a,s){if(t=+t,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),c=t+o,h=n+l,d=1^s,p=s?i-a:a-i;this._x1===null?this._append`M${c},${h}`:(Math.abs(this._x1-c)>tl||Math.abs(this._y1-h)>tl)&&this._append`L${c},${h}`,r&&(p<0&&(p=p%A$+A$),p>g9?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=h}`:p>tl&&this._append`A${r},${r},0,${+(p>=$$)},${d},${this._x1=t+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function OA(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new v9(t)}function NA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function V4(e){this._context=e}V4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Dv(e){return new V4(e)}function W4(e){return e[0]}function G4(e){return e[1]}function q4(e,t){var n=He(!0),r=null,i=Dv,a=null,s=OA(o);e=typeof e=="function"?e:e===void 0?W4:He(e),t=typeof t=="function"?t:t===void 0?G4:He(t);function o(l){var c,h=(l=NA(l)).length,d,p=!1,g;for(r==null&&(a=i(g=s())),c=0;c<=h;++c)!(c<h&&n(d=l[c],c,l))===p&&((p=!p)?a.lineStart():a.lineEnd()),p&&a.point(+e(d,c,l),+t(d,c,l));if(g)return a=null,g+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:He(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:He(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:He(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(a=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=a=null:a=i(r=l),o):r},o}function Cg(e,t,n){var r=null,i=He(!0),a=null,s=Dv,o=null,l=OA(c);e=typeof e=="function"?e:e===void 0?W4:He(+e),t=typeof t=="function"?t:He(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?G4:He(+n);function c(d){var p,g,v,x=(d=NA(d)).length,b,w=!1,C,T=new Array(x),$=new Array(x);for(a==null&&(o=s(C=l())),p=0;p<=x;++p){if(!(p<x&&i(b=d[p],p,d))===w)if(w=!w)g=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=p-1;v>=g;--v)o.point(T[v],$[v]);o.lineEnd(),o.areaEnd()}w&&(T[p]=+e(b,p,d),$[p]=+t(b,p,d),o.point(r?+r(b,p,d):T[p],n?+n(b,p,d):$[p]))}if(C)return o=null,C+""||null}function h(){return q4().defined(i).curve(s).context(a)}return c.x=function(d){return arguments.length?(e=typeof d=="function"?d:He(+d),r=null,c):e},c.x0=function(d){return arguments.length?(e=typeof d=="function"?d:He(+d),c):e},c.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:He(+d),c):r},c.y=function(d){return arguments.length?(t=typeof d=="function"?d:He(+d),n=null,c):t},c.y0=function(d){return arguments.length?(t=typeof d=="function"?d:He(+d),c):t},c.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:He(+d),c):n},c.lineX0=c.lineY0=function(){return h().x(e).y(t)},c.lineY1=function(){return h().x(e).y(n)},c.lineX1=function(){return h().x(r).y(t)},c.defined=function(d){return arguments.length?(i=typeof d=="function"?d:He(!!d),c):i},c.curve=function(d){return arguments.length?(s=d,a!=null&&(o=s(a)),c):s},c.context=function(d){return arguments.length?(d==null?a=o=null:o=s(a=d),c):a},c}class H4{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function b9(e){return new H4(e,!0)}function x9(e){return new H4(e,!1)}const _A={draw(e,t){const n=ca(t/ly);e.moveTo(n,0),e.arc(0,0,n,0,Rv)}},w9={draw(e,t){const n=ca(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},X4=ca(1/3),S9=X4*2,C9={draw(e,t){const n=ca(t/S9),r=n*X4;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},T9={draw(e,t){const n=ca(t),r=-n/2;e.rect(r,r,n,n)}},$9=.8908130915292852,K4=oy(ly/10)/oy(7*ly/10),A9=oy(Rv/10)*K4,k9=-j4(Rv/10)*K4,E9={draw(e,t){const n=ca(t*$9),r=A9*n,i=k9*n;e.moveTo(0,-n),e.lineTo(r,i);for(let a=1;a<5;++a){const s=Rv*a/5,o=j4(s),l=oy(s);e.lineTo(l*n,-o*n),e.lineTo(o*r-l*i,l*r+o*i)}e.closePath()}},pS=ca(3),I9={draw(e,t){const n=-ca(t/(pS*3));e.moveTo(0,n*2),e.lineTo(-pS*n,-n),e.lineTo(pS*n,-n),e.closePath()}},$i=-.5,Ai=ca(3)/2,k$=1/ca(12),O9=(k$/2+1)*3,N9={draw(e,t){const n=ca(t/O9),r=n/2,i=n*k$,a=r,s=n*k$+n,o=-a,l=s;e.moveTo(r,i),e.lineTo(a,s),e.lineTo(o,l),e.lineTo($i*r-Ai*i,Ai*r+$i*i),e.lineTo($i*a-Ai*s,Ai*a+$i*s),e.lineTo($i*o-Ai*l,Ai*o+$i*l),e.lineTo($i*r+Ai*i,$i*i-Ai*r),e.lineTo($i*a+Ai*s,$i*s-Ai*a),e.lineTo($i*o+Ai*l,$i*l-Ai*o),e.closePath()}};function _9(e,t){let n=null,r=OA(i);e=typeof e=="function"?e:He(e||_A),t=typeof t=="function"?t:He(t===void 0?64:+t);function i(){let a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:He(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:He(+a),i):t},i.context=function(a){return arguments.length?(n=a??null,i):n},i}function uy(){}function cy(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Y4(e){this._context=e}Y4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:cy(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:cy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function R9(e){return new Y4(e)}function Z4(e){this._context=e}Z4.prototype={areaStart:uy,areaEnd:uy,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:cy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function D9(e){return new Z4(e)}function Q4(e){this._context=e}Q4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:cy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function M9(e){return new Q4(e)}function J4(e){this._context=e}J4.prototype={areaStart:uy,areaEnd:uy,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function P9(e){return new J4(e)}function CM(e){return e<0?-1:1}function TM(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),o=(a*i+s*r)/(r+i);return(CM(a)+CM(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function $M(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function mS(e,t,n){var r=e._x0,i=e._y0,a=e._x1,s=e._y1,o=(a-r)/3;e._context.bezierCurveTo(r+o,i+o*t,a-o,s-o*n,a,s)}function fy(e){this._context=e}fy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:mS(this,this._t0,$M(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,mS(this,$M(this,n=TM(this,e,t)),n);break;default:mS(this,this._t0,n=TM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function tj(e){this._context=new ej(e)}(tj.prototype=Object.create(fy.prototype)).point=function(e,t){fy.prototype.point.call(this,t,e)};function ej(e){this._context=e}ej.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function F9(e){return new fy(e)}function L9(e){return new tj(e)}function nj(e){this._context=e}nj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=AM(e),i=AM(t),a=0,s=1;s<n;++a,++s)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function AM(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),s=new Array(n);for(i[0]=0,a[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function B9(e){return new nj(e)}function Mv(e,t){this._context=e,this._t=t}Mv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function z9(e){return new Mv(e,.5)}function j9(e){return new Mv(e,0)}function U9(e){return new Mv(e,1)}function ac(e,t){if((s=e.length)>1)for(var n=1,r,i,a=e[t[0]],s,o=a.length;n<s;++n)for(i=a,a=e[t[n]],r=0;r<o;++r)a[r][1]+=a[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function E$(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function V9(e,t){return e[t]}function W9(e){const t=[];return t.key=e,t}function G9(){var e=He([]),t=E$,n=ac,r=V9;function i(a){var s=Array.from(e.apply(this,arguments),W9),o,l=s.length,c=-1,h;for(const d of a)for(o=0,++c;o<l;++o)(s[o][c]=[0,+r(d,s[o].key,c,a)]).data=d;for(o=0,h=NA(t(s));o<l;++o)s[h[o]].index=o;return n(s,h),s}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:He(Array.from(a)),i):e},i.value=function(a){return arguments.length?(r=typeof a=="function"?a:He(+a),i):r},i.order=function(a){return arguments.length?(t=a==null?E$:typeof a=="function"?a:He(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(n=a??ac,i):n},i}function q9(e,t){if((r=e.length)>0){for(var n,r,i=0,a=e[0].length,s;i<a;++i){for(s=n=0;n<r;++n)s+=e[n][i][1]||0;if(s)for(n=0;n<r;++n)e[n][i][1]/=s}ac(e,t)}}function H9(e,t){if((i=e.length)>0){for(var n=0,r=e[t[0]],i,a=r.length;n<a;++n){for(var s=0,o=0;s<i;++s)o+=e[s][n][1]||0;r[n][1]+=r[n][0]=-o/2}ac(e,t)}}function X9(e,t){if(!(!((s=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var n=0,r=1,i,a,s;r<a;++r){for(var o=0,l=0,c=0;o<s;++o){for(var h=e[t[o]],d=h[r][1]||0,p=h[r-1][1]||0,g=(d-p)/2,v=0;v<o;++v){var x=e[t[v]],b=x[r][1]||0,w=x[r-1][1]||0;g+=b-w}l+=d,c+=g*d}i[r-1][1]+=i[r-1][0]=n,l&&(n-=c/l)}i[r-1][1]+=i[r-1][0]=n,ac(e,t)}}function Bh(e){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(e)}var K9=["type","size","sizeType"];function I$(){return I$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I$.apply(this,arguments)}function kM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function EM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kM(Object(n),!0).forEach(function(r){Y9(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Y9(e,t,n){return t=Z9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z9(e){var t=Q9(e,"string");return Bh(t)=="symbol"?t:t+""}function Q9(e,t){if(Bh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Bh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J9(e,t){if(e==null)return{};var n=tY(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function tY(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var rj={symbolCircle:_A,symbolCross:w9,symbolDiamond:C9,symbolSquare:T9,symbolStar:E9,symbolTriangle:I9,symbolWye:N9},eY=Math.PI/180,nY=function(t){var n="symbol".concat(_v(t));return rj[n]||_A},rY=function(t,n,r){if(n==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*eY;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},iY=function(t,n){rj["symbol".concat(_v(t))]=n},RA=function(t){var n=t.type,r=n===void 0?"circle":n,i=t.size,a=i===void 0?64:i,s=t.sizeType,o=s===void 0?"area":s,l=J9(t,K9),c=EM(EM({},l),{},{type:r,size:a,sizeType:o}),h=function(){var b=nY(r),w=_9().type(b).size(rY(a,o,r));return w()},d=c.className,p=c.cx,g=c.cy,v=pe(c,!0);return p===+p&&g===+g&&a===+a?et.createElement("path",I$({},v,{className:Ce("recharts-symbols",d),transform:"translate(".concat(p,", ").concat(g,")"),d:h()})):null};RA.registerSymbol=iY;function sc(e){"@babel/helpers - typeof";return sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sc(e)}function O$(){return O$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O$.apply(this,arguments)}function IM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function aY(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IM(Object(n),!0).forEach(function(r){zh(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function sY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oY(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,aj(r.key),r)}}function lY(e,t,n){return t&&oY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uY(e,t,n){return t=hy(t),cY(e,ij()?Reflect.construct(t,n||[],hy(e).constructor):t.apply(e,n))}function cY(e,t){if(t&&(sc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fY(e)}function fY(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ij(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ij=function(){return!!e})()}function hy(e){return hy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hy(e)}function hY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N$(e,t)}function N$(e,t){return N$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},N$(e,t)}function zh(e,t,n){return t=aj(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aj(e){var t=dY(e,"string");return sc(t)=="symbol"?t:t+""}function dY(e,t){if(sc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(sc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Hi=32,DA=function(e){function t(){return sY(this,t),uY(this,t,arguments)}return hY(t,e),lY(t,[{key:"renderIcon",value:function(r){var i=this.props.inactiveColor,a=Hi/2,s=Hi/6,o=Hi/3,l=r.inactive?i:r.color;if(r.type==="plainline")return et.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:a,x2:Hi,y2:a,className:"recharts-legend-icon"});if(r.type==="line")return et.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Hi,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(r.type==="rect")return et.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Hi/8,"h").concat(Hi,"v").concat(Hi*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(et.isValidElement(r.legendIcon)){var c=aY({},r);return delete c.legendIcon,et.cloneElement(r.legendIcon,c)}return et.createElement(RA,{fill:l,cx:a,cy:a,size:Hi,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,i=this.props,a=i.payload,s=i.iconSize,o=i.layout,l=i.formatter,c=i.inactiveColor,h={x:0,y:0,width:Hi,height:Hi},d={display:o==="horizontal"?"inline-block":"block",marginRight:10},p={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(g,v){var x=g.formatter||l,b=Ce(zh(zh({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",g.inactive));if(g.type==="none")return null;var w=se(g.value)?null:g.value;fs(!se(g.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var C=g.inactive?c:g.color;return et.createElement("li",O$({className:b,style:d,key:"legend-item-".concat(v)},sy(r.props,g,v)),et.createElement(C$,{width:s,height:s,viewBox:h,style:p},r.renderIcon(g)),et.createElement("span",{className:"recharts-legend-item-text",style:{color:C}},x?x(w,g,v):w))})}},{key:"render",value:function(){var r=this.props,i=r.payload,a=r.layout,s=r.align;if(!i||!i.length)return null;var o={padding:0,margin:0,textAlign:a==="horizontal"?s:"left"};return et.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}])}(Tt.PureComponent);zh(DA,"displayName","Legend");zh(DA,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var gS,OM;function pY(){if(OM)return gS;OM=1;var e=Iv();function t(){this.__data__=new e,this.size=0}return gS=t,gS}var yS,NM;function mY(){if(NM)return yS;NM=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return yS=e,yS}var vS,_M;function gY(){if(_M)return vS;_M=1;function e(t){return this.__data__.get(t)}return vS=e,vS}var bS,RM;function yY(){if(RM)return bS;RM=1;function e(t){return this.__data__.has(t)}return bS=e,bS}var xS,DM;function vY(){if(DM)return xS;DM=1;var e=Iv(),t=TA(),n=$A(),r=200;function i(a,s){var o=this.__data__;if(o instanceof e){var l=o.__data__;if(!t||l.length<r-1)return l.push([a,s]),this.size=++o.size,this;o=this.__data__=new n(l)}return o.set(a,s),this.size=o.size,this}return xS=i,xS}var wS,MM;function sj(){if(MM)return wS;MM=1;var e=Iv(),t=pY(),n=mY(),r=gY(),i=yY(),a=vY();function s(o){var l=this.__data__=new e(o);this.size=l.size}return s.prototype.clear=t,s.prototype.delete=n,s.prototype.get=r,s.prototype.has=i,s.prototype.set=a,wS=s,wS}var SS,PM;function bY(){if(PM)return SS;PM=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return SS=t,SS}var CS,FM;function xY(){if(FM)return CS;FM=1;function e(t){return this.__data__.has(t)}return CS=e,CS}var TS,LM;function oj(){if(LM)return TS;LM=1;var e=$A(),t=bY(),n=xY();function r(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new e;++a<s;)this.add(i[a])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,TS=r,TS}var $S,BM;function lj(){if(BM)return $S;BM=1;function e(t,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(n(t[r],r,t))return!0;return!1}return $S=e,$S}var AS,zM;function uj(){if(zM)return AS;zM=1;function e(t,n){return t.has(n)}return AS=e,AS}var kS,jM;function cj(){if(jM)return kS;jM=1;var e=oj(),t=lj(),n=uj(),r=1,i=2;function a(s,o,l,c,h,d){var p=l&r,g=s.length,v=o.length;if(g!=v&&!(p&&v>g))return!1;var x=d.get(s),b=d.get(o);if(x&&b)return x==o&&b==s;var w=-1,C=!0,T=l&i?new e:void 0;for(d.set(s,o),d.set(o,s);++w<g;){var $=s[w],A=o[w];if(c)var E=p?c(A,$,w,o,s,d):c($,A,w,s,o,d);if(E!==void 0){if(E)continue;C=!1;break}if(T){if(!t(o,function(O,N){if(!n(T,N)&&($===O||h($,O,l,c,d)))return T.push(N)})){C=!1;break}}else if(!($===A||h($,A,l,c,d))){C=!1;break}}return d.delete(s),d.delete(o),C}return kS=a,kS}var ES,UM;function wY(){if(UM)return ES;UM=1;var e=La(),t=e.Uint8Array;return ES=t,ES}var IS,VM;function SY(){if(VM)return IS;VM=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(i,a){r[++n]=[a,i]}),r}return IS=e,IS}var OS,WM;function MA(){if(WM)return OS;WM=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(i){r[++n]=i}),r}return OS=e,OS}var NS,GM;function CY(){if(GM)return NS;GM=1;var e=Dd(),t=wY(),n=CA(),r=cj(),i=SY(),a=MA(),s=1,o=2,l="[object Boolean]",c="[object Date]",h="[object Error]",d="[object Map]",p="[object Number]",g="[object RegExp]",v="[object Set]",x="[object String]",b="[object Symbol]",w="[object ArrayBuffer]",C="[object DataView]",T=e?e.prototype:void 0,$=T?T.valueOf:void 0;function A(E,O,N,_,R,I,P){switch(N){case C:if(E.byteLength!=O.byteLength||E.byteOffset!=O.byteOffset)return!1;E=E.buffer,O=O.buffer;case w:return!(E.byteLength!=O.byteLength||!I(new t(E),new t(O)));case l:case c:case p:return n(+E,+O);case h:return E.name==O.name&&E.message==O.message;case g:case x:return E==O+"";case d:var B=i;case v:var V=_&s;if(B||(B=a),E.size!=O.size&&!V)return!1;var z=P.get(E);if(z)return z==O;_|=o,P.set(E,O);var M=r(B(E),B(O),_,R,I,P);return P.delete(E),M;case b:if($)return $.call(E)==$.call(O)}return!1}return NS=A,NS}var _S,qM;function fj(){if(qM)return _S;qM=1;function e(t,n){for(var r=-1,i=n.length,a=t.length;++r<i;)t[a+r]=n[r];return t}return _S=e,_S}var RS,HM;function TY(){if(HM)return RS;HM=1;var e=fj(),t=Zr();function n(r,i,a){var s=i(r);return t(r)?s:e(s,a(r))}return RS=n,RS}var DS,XM;function $Y(){if(XM)return DS;XM=1;function e(t,n){for(var r=-1,i=t==null?0:t.length,a=0,s=[];++r<i;){var o=t[r];n(o,r,t)&&(s[a++]=o)}return s}return DS=e,DS}var MS,KM;function AY(){if(KM)return MS;KM=1;function e(){return[]}return MS=e,MS}var PS,YM;function kY(){if(YM)return PS;YM=1;var e=$Y(),t=AY(),n=Object.prototype,r=n.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),e(i(s),function(o){return r.call(s,o)}))}:t;return PS=a,PS}var FS,ZM;function EY(){if(ZM)return FS;ZM=1;function e(t,n){for(var r=-1,i=Array(t);++r<t;)i[r]=n(r);return i}return FS=e,FS}var LS,QM;function IY(){if(QM)return LS;QM=1;var e=Cs(),t=Ts(),n="[object Arguments]";function r(i){return t(i)&&e(i)==n}return LS=r,LS}var BS,JM;function PA(){if(JM)return BS;JM=1;var e=IY(),t=Ts(),n=Object.prototype,r=n.hasOwnProperty,i=n.propertyIsEnumerable,a=e(function(){return arguments}())?e:function(s){return t(s)&&r.call(s,"callee")&&!i.call(s,"callee")};return BS=a,BS}var Ch={exports:{}},zS,tP;function OY(){if(tP)return zS;tP=1;function e(){return!1}return zS=e,zS}Ch.exports;var eP;function hj(){return eP||(eP=1,function(e,t){var n=La(),r=OY(),i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===i,o=s?n.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||r;e.exports=c}(Ch,Ch.exports)),Ch.exports}var jS,nP;function FA(){if(nP)return jS;nP=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,i){var a=typeof r;return i=i??e,!!i&&(a=="number"||a!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<i}return jS=n,jS}var US,rP;function LA(){if(rP)return US;rP=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return US=t,US}var VS,iP;function NY(){if(iP)return VS;iP=1;var e=Cs(),t=LA(),n=Ts(),r="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",l="[object Function]",c="[object Map]",h="[object Number]",d="[object Object]",p="[object RegExp]",g="[object Set]",v="[object String]",x="[object WeakMap]",b="[object ArrayBuffer]",w="[object DataView]",C="[object Float32Array]",T="[object Float64Array]",$="[object Int8Array]",A="[object Int16Array]",E="[object Int32Array]",O="[object Uint8Array]",N="[object Uint8ClampedArray]",_="[object Uint16Array]",R="[object Uint32Array]",I={};I[C]=I[T]=I[$]=I[A]=I[E]=I[O]=I[N]=I[_]=I[R]=!0,I[r]=I[i]=I[b]=I[a]=I[w]=I[s]=I[o]=I[l]=I[c]=I[h]=I[d]=I[p]=I[g]=I[v]=I[x]=!1;function P(B){return n(B)&&t(B.length)&&!!I[e(B)]}return VS=P,VS}var WS,aP;function dj(){if(aP)return WS;aP=1;function e(t){return function(n){return t(n)}}return WS=e,WS}var Th={exports:{}};Th.exports;var sP;function _Y(){return sP||(sP=1,function(e,t){var n=R4(),r=t&&!t.nodeType&&t,i=r&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===r,s=a&&n.process,o=function(){try{var l=i&&i.require&&i.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}}();e.exports=o}(Th,Th.exports)),Th.exports}var GS,oP;function pj(){if(oP)return GS;oP=1;var e=NY(),t=dj(),n=_Y(),r=n&&n.isTypedArray,i=r?t(r):e;return GS=i,GS}var qS,lP;function RY(){if(lP)return qS;lP=1;var e=EY(),t=PA(),n=Zr(),r=hj(),i=FA(),a=pj(),s=Object.prototype,o=s.hasOwnProperty;function l(c,h){var d=n(c),p=!d&&t(c),g=!d&&!p&&r(c),v=!d&&!p&&!g&&a(c),x=d||p||g||v,b=x?e(c.length,String):[],w=b.length;for(var C in c)(h||o.call(c,C))&&!(x&&(C=="length"||g&&(C=="offset"||C=="parent")||v&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||i(C,w)))&&b.push(C);return b}return qS=l,qS}var HS,uP;function DY(){if(uP)return HS;uP=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,i=typeof r=="function"&&r.prototype||e;return n===i}return HS=t,HS}var XS,cP;function mj(){if(cP)return XS;cP=1;function e(t,n){return function(r){return t(n(r))}}return XS=e,XS}var KS,fP;function MY(){if(fP)return KS;fP=1;var e=mj(),t=e(Object.keys,Object);return KS=t,KS}var YS,hP;function PY(){if(hP)return YS;hP=1;var e=DY(),t=MY(),n=Object.prototype,r=n.hasOwnProperty;function i(a){if(!e(a))return t(a);var s=[];for(var o in Object(a))r.call(a,o)&&o!="constructor"&&s.push(o);return s}return YS=i,YS}var ZS,dP;function Fd(){if(dP)return ZS;dP=1;var e=SA(),t=LA();function n(r){return r!=null&&t(r.length)&&!e(r)}return ZS=n,ZS}var QS,pP;function Pv(){if(pP)return QS;pP=1;var e=RY(),t=PY(),n=Fd();function r(i){return n(i)?e(i):t(i)}return QS=r,QS}var JS,mP;function FY(){if(mP)return JS;mP=1;var e=TY(),t=kY(),n=Pv();function r(i){return e(i,n,t)}return JS=r,JS}var tC,gP;function LY(){if(gP)return tC;gP=1;var e=FY(),t=1,n=Object.prototype,r=n.hasOwnProperty;function i(a,s,o,l,c,h){var d=o&t,p=e(a),g=p.length,v=e(s),x=v.length;if(g!=x&&!d)return!1;for(var b=g;b--;){var w=p[b];if(!(d?w in s:r.call(s,w)))return!1}var C=h.get(a),T=h.get(s);if(C&&T)return C==s&&T==a;var $=!0;h.set(a,s),h.set(s,a);for(var A=d;++b<g;){w=p[b];var E=a[w],O=s[w];if(l)var N=d?l(O,E,w,s,a,h):l(E,O,w,a,s,h);if(!(N===void 0?E===O||c(E,O,o,l,h):N)){$=!1;break}A||(A=w=="constructor")}if($&&!A){var _=a.constructor,R=s.constructor;_!=R&&"constructor"in a&&"constructor"in s&&!(typeof _=="function"&&_ instanceof _&&typeof R=="function"&&R instanceof R)&&($=!1)}return h.delete(a),h.delete(s),$}return tC=i,tC}var eC,yP;function BY(){if(yP)return eC;yP=1;var e=Fl(),t=La(),n=e(t,"DataView");return eC=n,eC}var nC,vP;function zY(){if(vP)return nC;vP=1;var e=Fl(),t=La(),n=e(t,"Promise");return nC=n,nC}var rC,bP;function gj(){if(bP)return rC;bP=1;var e=Fl(),t=La(),n=e(t,"Set");return rC=n,rC}var iC,xP;function jY(){if(xP)return iC;xP=1;var e=Fl(),t=La(),n=e(t,"WeakMap");return iC=n,iC}var aC,wP;function UY(){if(wP)return aC;wP=1;var e=BY(),t=TA(),n=zY(),r=gj(),i=jY(),a=Cs(),s=D4(),o="[object Map]",l="[object Object]",c="[object Promise]",h="[object Set]",d="[object WeakMap]",p="[object DataView]",g=s(e),v=s(t),x=s(n),b=s(r),w=s(i),C=a;return(e&&C(new e(new ArrayBuffer(1)))!=p||t&&C(new t)!=o||n&&C(n.resolve())!=c||r&&C(new r)!=h||i&&C(new i)!=d)&&(C=function(T){var $=a(T),A=$==l?T.constructor:void 0,E=A?s(A):"";if(E)switch(E){case g:return p;case v:return o;case x:return c;case b:return h;case w:return d}return $}),aC=C,aC}var sC,SP;function VY(){if(SP)return sC;SP=1;var e=sj(),t=cj(),n=CY(),r=LY(),i=UY(),a=Zr(),s=hj(),o=pj(),l=1,c="[object Arguments]",h="[object Array]",d="[object Object]",p=Object.prototype,g=p.hasOwnProperty;function v(x,b,w,C,T,$){var A=a(x),E=a(b),O=A?h:i(x),N=E?h:i(b);O=O==c?d:O,N=N==c?d:N;var _=O==d,R=N==d,I=O==N;if(I&&s(x)){if(!s(b))return!1;A=!0,_=!1}if(I&&!_)return $||($=new e),A||o(x)?t(x,b,w,C,T,$):n(x,b,O,w,C,T,$);if(!(w&l)){var P=_&&g.call(x,"__wrapped__"),B=R&&g.call(b,"__wrapped__");if(P||B){var V=P?x.value():x,z=B?b.value():b;return $||($=new e),T(V,z,w,C,$)}}return I?($||($=new e),r(x,b,w,C,T,$)):!1}return sC=v,sC}var oC,CP;function BA(){if(CP)return oC;CP=1;var e=VY(),t=Ts();function n(r,i,a,s,o){return r===i?!0:r==null||i==null||!t(r)&&!t(i)?r!==r&&i!==i:e(r,i,a,s,n,o)}return oC=n,oC}var lC,TP;function WY(){if(TP)return lC;TP=1;var e=sj(),t=BA(),n=1,r=2;function i(a,s,o,l){var c=o.length,h=c,d=!l;if(a==null)return!h;for(a=Object(a);c--;){var p=o[c];if(d&&p[2]?p[1]!==a[p[0]]:!(p[0]in a))return!1}for(;++c<h;){p=o[c];var g=p[0],v=a[g],x=p[1];if(d&&p[2]){if(v===void 0&&!(g in a))return!1}else{var b=new e;if(l)var w=l(v,x,g,a,s,b);if(!(w===void 0?t(x,v,n|r,l,b):w))return!1}}return!0}return lC=i,lC}var uC,$P;function yj(){if($P)return uC;$P=1;var e=bo();function t(n){return n===n&&!e(n)}return uC=t,uC}var cC,AP;function GY(){if(AP)return cC;AP=1;var e=yj(),t=Pv();function n(r){for(var i=t(r),a=i.length;a--;){var s=i[a],o=r[s];i[a]=[s,o,e(o)]}return i}return cC=n,cC}var fC,kP;function vj(){if(kP)return fC;kP=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return fC=e,fC}var hC,EP;function qY(){if(EP)return hC;EP=1;var e=WY(),t=GY(),n=vj();function r(i){var a=t(i);return a.length==1&&a[0][2]?n(a[0][0],a[0][1]):function(s){return s===i||e(s,i,a)}}return hC=r,hC}var dC,IP;function HY(){if(IP)return dC;IP=1;function e(t,n){return t!=null&&n in Object(t)}return dC=e,dC}var pC,OP;function XY(){if(OP)return pC;OP=1;var e=F4(),t=PA(),n=Zr(),r=FA(),i=LA(),a=Nv();function s(o,l,c){l=e(l,o);for(var h=-1,d=l.length,p=!1;++h<d;){var g=a(l[h]);if(!(p=o!=null&&c(o,g)))break;o=o[g]}return p||++h!=d?p:(d=o==null?0:o.length,!!d&&i(d)&&r(g,d)&&(n(o)||t(o)))}return pC=s,pC}var mC,NP;function KY(){if(NP)return mC;NP=1;var e=HY(),t=XY();function n(r,i){return r!=null&&t(r,i,e)}return mC=n,mC}var gC,_P;function YY(){if(_P)return gC;_P=1;var e=BA(),t=L4(),n=KY(),r=wA(),i=yj(),a=vj(),s=Nv(),o=1,l=2;function c(h,d){return r(h)&&i(d)?a(s(h),d):function(p){var g=t(p,h);return g===void 0&&g===d?n(p,h):e(d,g,o|l)}}return gC=c,gC}var yC,RP;function zc(){if(RP)return yC;RP=1;function e(t){return t}return yC=e,yC}var vC,DP;function ZY(){if(DP)return vC;DP=1;function e(t){return function(n){return n==null?void 0:n[t]}}return vC=e,vC}var bC,MP;function QY(){if(MP)return bC;MP=1;var e=kA();function t(n){return function(r){return e(r,n)}}return bC=t,bC}var xC,PP;function JY(){if(PP)return xC;PP=1;var e=ZY(),t=QY(),n=wA(),r=Nv();function i(a){return n(a)?e(r(a)):t(a)}return xC=i,xC}var wC,FP;function xo(){if(FP)return wC;FP=1;var e=qY(),t=YY(),n=zc(),r=Zr(),i=JY();function a(s){return typeof s=="function"?s:s==null?n:typeof s=="object"?r(s)?t(s[0],s[1]):e(s):i(s)}return wC=a,wC}var SC,LP;function bj(){if(LP)return SC;LP=1;function e(t,n,r,i){for(var a=t.length,s=r+(i?1:-1);i?s--:++s<a;)if(n(t[s],s,t))return s;return-1}return SC=e,SC}var CC,BP;function tZ(){if(BP)return CC;BP=1;function e(t){return t!==t}return CC=e,CC}var TC,zP;function eZ(){if(zP)return TC;zP=1;function e(t,n,r){for(var i=r-1,a=t.length;++i<a;)if(t[i]===n)return i;return-1}return TC=e,TC}var $C,jP;function nZ(){if(jP)return $C;jP=1;var e=bj(),t=tZ(),n=eZ();function r(i,a,s){return a===a?n(i,a,s):e(i,t,s)}return $C=r,$C}var AC,UP;function rZ(){if(UP)return AC;UP=1;var e=nZ();function t(n,r){var i=n==null?0:n.length;return!!i&&e(n,r,0)>-1}return AC=t,AC}var kC,VP;function iZ(){if(VP)return kC;VP=1;function e(t,n,r){for(var i=-1,a=t==null?0:t.length;++i<a;)if(r(n,t[i]))return!0;return!1}return kC=e,kC}var EC,WP;function aZ(){if(WP)return EC;WP=1;function e(){}return EC=e,EC}var IC,GP;function sZ(){if(GP)return IC;GP=1;var e=gj(),t=aZ(),n=MA(),r=1/0,i=e&&1/n(new e([,-0]))[1]==r?function(a){return new e(a)}:t;return IC=i,IC}var OC,qP;function oZ(){if(qP)return OC;qP=1;var e=oj(),t=rZ(),n=iZ(),r=uj(),i=sZ(),a=MA(),s=200;function o(l,c,h){var d=-1,p=t,g=l.length,v=!0,x=[],b=x;if(h)v=!1,p=n;else if(g>=s){var w=c?null:i(l);if(w)return a(w);v=!1,p=r,b=new e}else b=c?[]:x;t:for(;++d<g;){var C=l[d],T=c?c(C):C;if(C=h||C!==0?C:0,v&&T===T){for(var $=b.length;$--;)if(b[$]===T)continue t;c&&b.push(T),x.push(C)}else p(b,T,h)||(b!==x&&b.push(T),x.push(C))}return x}return OC=o,OC}var NC,HP;function lZ(){if(HP)return NC;HP=1;var e=xo(),t=oZ();function n(r,i){return r&&r.length?t(r,e(i,2)):[]}return NC=n,NC}var uZ=lZ();const XP=Be(uZ);function xj(e,t,n){return t===!0?XP(e,n):se(t)?XP(e,t):e}function oc(e){"@babel/helpers - typeof";return oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oc(e)}var cZ=["ref"];function KP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function rs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KP(Object(n),!0).forEach(function(r){Fv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KP(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Sj(r.key),r)}}function hZ(e,t,n){return t&&YP(e.prototype,t),n&&YP(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function dZ(e,t,n){return t=dy(t),pZ(e,wj()?Reflect.construct(t,n||[],dy(e).constructor):t.apply(e,n))}function pZ(e,t){if(t&&(oc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mZ(e)}function mZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wj=function(){return!!e})()}function dy(e){return dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dy(e)}function gZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_$(e,t)}function _$(e,t){return _$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},_$(e,t)}function Fv(e,t,n){return t=Sj(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sj(e){var t=yZ(e,"string");return oc(t)=="symbol"?t:t+""}function yZ(e,t){if(oc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(oc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function vZ(e,t){if(e==null)return{};var n=bZ(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bZ(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function xZ(e){return e.value}function wZ(e,t){if(et.isValidElement(e))return et.cloneElement(e,t);if(typeof e=="function")return et.createElement(e,t);t.ref;var n=vZ(t,cZ);return et.createElement(DA,n)}var ZP=1,Yu=function(e){function t(){var n;fZ(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=dZ(this,t,[].concat(i)),Fv(n,"lastBoundingBox",{width:-1,height:-1}),n}return gZ(t,e),hZ(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>ZP||Math.abs(i.height-this.lastBoundingBox.height)>ZP)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,r&&r(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?rs({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var i=this.props,a=i.layout,s=i.align,o=i.verticalAlign,l=i.margin,c=i.chartWidth,h=i.chartHeight,d,p;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(s==="center"&&a==="vertical"){var g=this.getBBoxSnapshot();d={left:((c||0)-g.width)/2}}else d=s==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(o==="middle"){var v=this.getBBoxSnapshot();p={top:((h||0)-v.height)/2}}else p=o==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return rs(rs({},d),p)}},{key:"render",value:function(){var r=this,i=this.props,a=i.content,s=i.width,o=i.height,l=i.wrapperStyle,c=i.payloadUniqBy,h=i.payload,d=rs(rs({position:"absolute",width:s||"auto",height:o||"auto"},this.getDefaultPosition(l)),l);return et.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(g){r.wrapperNode=g}},wZ(a,rs(rs({},this.props),{},{payload:xj(h,c,xZ)})))}}],[{key:"getWithHeight",value:function(r,i){var a=rs(rs({},this.defaultProps),r.props),s=a.layout;return s==="vertical"&&Ot(r.props.height)?{height:r.props.height}:s==="horizontal"?{width:r.props.width||i}:null}}])}(Tt.PureComponent);Fv(Yu,"displayName","Legend");Fv(Yu,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var _C,QP;function SZ(){if(QP)return _C;QP=1;var e=Dd(),t=PA(),n=Zr(),r=e?e.isConcatSpreadable:void 0;function i(a){return n(a)||t(a)||!!(r&&a&&a[r])}return _C=i,_C}var RC,JP;function Cj(){if(JP)return RC;JP=1;var e=fj(),t=SZ();function n(r,i,a,s,o){var l=-1,c=r.length;for(a||(a=t),o||(o=[]);++l<c;){var h=r[l];i>0&&a(h)?i>1?n(h,i-1,a,s,o):e(o,h):s||(o[o.length]=h)}return o}return RC=n,RC}var DC,t3;function CZ(){if(t3)return DC;t3=1;function e(t){return function(n,r,i){for(var a=-1,s=Object(n),o=i(n),l=o.length;l--;){var c=o[t?l:++a];if(r(s[c],c,s)===!1)break}return n}}return DC=e,DC}var MC,e3;function TZ(){if(e3)return MC;e3=1;var e=CZ(),t=e();return MC=t,MC}var PC,n3;function Tj(){if(n3)return PC;n3=1;var e=TZ(),t=Pv();function n(r,i){return r&&e(r,i,t)}return PC=n,PC}var FC,r3;function $Z(){if(r3)return FC;r3=1;var e=Fd();function t(n,r){return function(i,a){if(i==null)return i;if(!e(i))return n(i,a);for(var s=i.length,o=r?s:-1,l=Object(i);(r?o--:++o<s)&&a(l[o],o,l)!==!1;);return i}}return FC=t,FC}var LC,i3;function zA(){if(i3)return LC;i3=1;var e=Tj(),t=$Z(),n=t(e);return LC=n,LC}var BC,a3;function $j(){if(a3)return BC;a3=1;var e=zA(),t=Fd();function n(r,i){var a=-1,s=t(r)?Array(r.length):[];return e(r,function(o,l,c){s[++a]=i(o,l,c)}),s}return BC=n,BC}var zC,s3;function AZ(){if(s3)return zC;s3=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return zC=e,zC}var jC,o3;function kZ(){if(o3)return jC;o3=1;var e=Lc();function t(n,r){if(n!==r){var i=n!==void 0,a=n===null,s=n===n,o=e(n),l=r!==void 0,c=r===null,h=r===r,d=e(r);if(!c&&!d&&!o&&n>r||o&&l&&h&&!c&&!d||a&&l&&h||!i&&h||!s)return 1;if(!a&&!o&&!d&&n<r||d&&i&&s&&!a&&!o||c&&i&&s||!l&&s||!h)return-1}return 0}return jC=t,jC}var UC,l3;function EZ(){if(l3)return UC;l3=1;var e=kZ();function t(n,r,i){for(var a=-1,s=n.criteria,o=r.criteria,l=s.length,c=i.length;++a<l;){var h=e(s[a],o[a]);if(h){if(a>=c)return h;var d=i[a];return h*(d=="desc"?-1:1)}}return n.index-r.index}return UC=t,UC}var VC,u3;function IZ(){if(u3)return VC;u3=1;var e=AA(),t=kA(),n=xo(),r=$j(),i=AZ(),a=dj(),s=EZ(),o=zc(),l=Zr();function c(h,d,p){d.length?d=e(d,function(x){return l(x)?function(b){return t(b,x.length===1?x[0]:x)}:x}):d=[o];var g=-1;d=e(d,a(n));var v=r(h,function(x,b,w){var C=e(d,function(T){return T(x)});return{criteria:C,index:++g,value:x}});return i(v,function(x,b){return s(x,b,p)})}return VC=c,VC}var WC,c3;function OZ(){if(c3)return WC;c3=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return WC=e,WC}var GC,f3;function NZ(){if(f3)return GC;f3=1;var e=OZ(),t=Math.max;function n(r,i,a){return i=t(i===void 0?r.length-1:i,0),function(){for(var s=arguments,o=-1,l=t(s.length-i,0),c=Array(l);++o<l;)c[o]=s[i+o];o=-1;for(var h=Array(i+1);++o<i;)h[o]=s[o];return h[i]=a(c),e(r,this,h)}}return GC=n,GC}var qC,h3;function _Z(){if(h3)return qC;h3=1;function e(t){return function(){return t}}return qC=e,qC}var HC,d3;function Aj(){if(d3)return HC;d3=1;var e=Fl(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return HC=t,HC}var XC,p3;function RZ(){if(p3)return XC;p3=1;var e=_Z(),t=Aj(),n=zc(),r=t?function(i,a){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(a),writable:!0})}:n;return XC=r,XC}var KC,m3;function DZ(){if(m3)return KC;m3=1;var e=800,t=16,n=Date.now;function r(i){var a=0,s=0;return function(){var o=n(),l=t-(o-s);if(s=o,l>0){if(++a>=e)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return KC=r,KC}var YC,g3;function MZ(){if(g3)return YC;g3=1;var e=RZ(),t=DZ(),n=t(e);return YC=n,YC}var ZC,y3;function PZ(){if(y3)return ZC;y3=1;var e=zc(),t=NZ(),n=MZ();function r(i,a){return n(t(i,a,e),i+"")}return ZC=r,ZC}var QC,v3;function Lv(){if(v3)return QC;v3=1;var e=CA(),t=Fd(),n=FA(),r=bo();function i(a,s,o){if(!r(o))return!1;var l=typeof s;return(l=="number"?t(o)&&n(s,o.length):l=="string"&&s in o)?e(o[s],a):!1}return QC=i,QC}var JC,b3;function FZ(){if(b3)return JC;b3=1;var e=Cj(),t=IZ(),n=PZ(),r=Lv(),i=n(function(a,s){if(a==null)return[];var o=s.length;return o>1&&r(a,s[0],s[1])?s=[]:o>2&&r(s[0],s[1],s[2])&&(s=[s[0]]),t(a,e(s,1),[])});return JC=i,JC}var LZ=FZ();const jA=Be(LZ);function jh(e){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jh(e)}function R$(){return R$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},R$.apply(this,arguments)}function BZ(e,t){return VZ(e)||UZ(e,t)||jZ(e,t)||zZ()}function zZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jZ(e,t){if(e){if(typeof e=="string")return x3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x3(e,t)}}function x3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UZ(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function VZ(e){if(Array.isArray(e))return e}function w3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function tT(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w3(Object(n),!0).forEach(function(r){WZ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w3(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WZ(e,t,n){return t=GZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GZ(e){var t=qZ(e,"string");return jh(t)=="symbol"?t:t+""}function qZ(e,t){if(jh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(jh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HZ(e){return Array.isArray(e)&&zn(e[0])&&zn(e[1])?e.join(" ~ "):e}var XZ=function(t){var n=t.separator,r=n===void 0?" : ":n,i=t.contentStyle,a=i===void 0?{}:i,s=t.itemStyle,o=s===void 0?{}:s,l=t.labelStyle,c=l===void 0?{}:l,h=t.payload,d=t.formatter,p=t.itemSorter,g=t.wrapperClassName,v=t.labelClassName,x=t.label,b=t.labelFormatter,w=t.accessibilityLayer,C=w===void 0?!1:w,T=function(){if(h&&h.length){var P={padding:0,margin:0},B=(p?jA(h,p):h).map(function(V,z){if(V.type==="none")return null;var M=tT({display:"block",paddingTop:4,paddingBottom:4,color:V.color||"#000"},o),U=V.formatter||d||HZ,W=V.value,q=V.name,F=W,G=q;if(U&&F!=null&&G!=null){var H=U(W,q,V,z,h);if(Array.isArray(H)){var Y=BZ(H,2);F=Y[0],G=Y[1]}else F=H}return et.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:M},zn(G)?et.createElement("span",{className:"recharts-tooltip-item-name"},G):null,zn(G)?et.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,et.createElement("span",{className:"recharts-tooltip-item-value"},F),et.createElement("span",{className:"recharts-tooltip-item-unit"},V.unit||""))});return et.createElement("ul",{className:"recharts-tooltip-item-list",style:P},B)}return null},$=tT({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),A=tT({margin:0},c),E=!he(x),O=E?x:"",N=Ce("recharts-default-tooltip",g),_=Ce("recharts-tooltip-label",v);E&&b&&h!==void 0&&h!==null&&(O=b(x,h));var R=C?{role:"status","aria-live":"assertive"}:{};return et.createElement("div",R$({className:N,style:$},R),et.createElement("p",{className:_,style:A},et.isValidElement(O)?O:"".concat(O)),T())};function Uh(e){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uh(e)}function Tg(e,t,n){return t=KZ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KZ(e){var t=YZ(e,"string");return Uh(t)=="symbol"?t:t+""}function YZ(e,t){if(Uh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Uh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ch="recharts-tooltip-wrapper",ZZ={visibility:"hidden"};function QZ(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return Ce(ch,Tg(Tg(Tg(Tg({},"".concat(ch,"-right"),Ot(n)&&t&&Ot(t.x)&&n>=t.x),"".concat(ch,"-left"),Ot(n)&&t&&Ot(t.x)&&n<t.x),"".concat(ch,"-bottom"),Ot(r)&&t&&Ot(t.y)&&r>=t.y),"".concat(ch,"-top"),Ot(r)&&t&&Ot(t.y)&&r<t.y))}function S3(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,i=e.offsetTopLeft,a=e.position,s=e.reverseDirection,o=e.tooltipDimension,l=e.viewBox,c=e.viewBoxDimension;if(a&&Ot(a[r]))return a[r];var h=n[r]-o-i,d=n[r]+i;if(t[r])return s[r]?h:d;if(s[r]){var p=h,g=l[r];return p<g?Math.max(d,l[r]):Math.max(h,l[r])}var v=d+o,x=l[r]+c;return v>x?Math.max(h,l[r]):Math.max(d,l[r])}function JZ(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function tQ(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,i=e.position,a=e.reverseDirection,s=e.tooltipBox,o=e.useTranslate3d,l=e.viewBox,c,h,d;return s.height>0&&s.width>0&&n?(h=S3({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),d=S3({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),c=JZ({translateX:h,translateY:d,useTranslate3d:o})):c=ZZ,{cssProperties:c,cssClasses:QZ({translateX:h,translateY:d,coordinate:n})}}function lc(e){"@babel/helpers - typeof";return lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lc(e)}function C3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function T3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C3(Object(n),!0).forEach(function(r){M$(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C3(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function eQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ej(r.key),r)}}function rQ(e,t,n){return t&&nQ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iQ(e,t,n){return t=py(t),aQ(e,kj()?Reflect.construct(t,n||[],py(e).constructor):t.apply(e,n))}function aQ(e,t){if(t&&(lc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sQ(e)}function sQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kj=function(){return!!e})()}function py(e){return py=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},py(e)}function oQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D$(e,t)}function D$(e,t){return D$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},D$(e,t)}function M$(e,t,n){return t=Ej(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ej(e){var t=lQ(e,"string");return lc(t)=="symbol"?t:t+""}function lQ(e,t){if(lc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(lc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $3=1,uQ=function(e){function t(){var n;eQ(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=iQ(this,t,[].concat(i)),M$(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),M$(n,"handleKeyDown",function(s){if(s.key==="Escape"){var o,l,c,h;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(l=n.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&o!==void 0?o:0,y:(c=(h=n.props.coordinate)===null||h===void 0?void 0:h.y)!==null&&c!==void 0?c:0}})}}),n}return oQ(t,e),rQ(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>$3||Math.abs(r.height-this.state.lastBoundingBox.height)>$3)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,i=this.props,a=i.active,s=i.allowEscapeViewBox,o=i.animationDuration,l=i.animationEasing,c=i.children,h=i.coordinate,d=i.hasPayload,p=i.isAnimationActive,g=i.offset,v=i.position,x=i.reverseDirection,b=i.useTranslate3d,w=i.viewBox,C=i.wrapperStyle,T=tQ({allowEscapeViewBox:s,coordinate:h,offsetTopLeft:g,position:v,reverseDirection:x,tooltipBox:this.state.lastBoundingBox,useTranslate3d:b,viewBox:w}),$=T.cssClasses,A=T.cssProperties,E=T3(T3({transition:p&&a?"transform ".concat(o,"ms ").concat(l):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&d?"visible":"hidden",position:"absolute",top:0,left:0},C);return et.createElement("div",{tabIndex:-1,className:$,style:E,ref:function(N){r.wrapperNode=N}},c)}}])}(Tt.PureComponent),cQ=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},jc={isSsr:cQ()};function uc(e){"@babel/helpers - typeof";return uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uc(e)}function A3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function k3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?A3(Object(n),!0).forEach(function(r){UA(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A3(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hQ(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Oj(r.key),r)}}function dQ(e,t,n){return t&&hQ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pQ(e,t,n){return t=my(t),mQ(e,Ij()?Reflect.construct(t,n||[],my(e).constructor):t.apply(e,n))}function mQ(e,t){if(t&&(uc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gQ(e)}function gQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ij(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ij=function(){return!!e})()}function my(e){return my=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},my(e)}function yQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P$(e,t)}function P$(e,t){return P$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},P$(e,t)}function UA(e,t,n){return t=Oj(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oj(e){var t=vQ(e,"string");return uc(t)=="symbol"?t:t+""}function vQ(e,t){if(uc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(uc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function bQ(e){return e.dataKey}function xQ(e,t){return et.isValidElement(e)?et.cloneElement(e,t):typeof e=="function"?et.createElement(e,t):et.createElement(XZ,t)}var va=function(e){function t(){return fQ(this,t),pQ(this,t,arguments)}return yQ(t,e),dQ(t,[{key:"render",value:function(){var r=this,i=this.props,a=i.active,s=i.allowEscapeViewBox,o=i.animationDuration,l=i.animationEasing,c=i.content,h=i.coordinate,d=i.filterNull,p=i.isAnimationActive,g=i.offset,v=i.payload,x=i.payloadUniqBy,b=i.position,w=i.reverseDirection,C=i.useTranslate3d,T=i.viewBox,$=i.wrapperStyle,A=v??[];d&&A.length&&(A=xj(v.filter(function(O){return O.value!=null&&(O.hide!==!0||r.props.includeHidden)}),x,bQ));var E=A.length>0;return et.createElement(uQ,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:p,active:a,coordinate:h,hasPayload:E,offset:g,position:b,reverseDirection:w,useTranslate3d:C,viewBox:T,wrapperStyle:$},xQ(c,k3(k3({},this.props),{},{payload:A})))}}])}(Tt.PureComponent);UA(va,"displayName","Tooltip");UA(va,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!jc.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var eT,E3;function wQ(){if(E3)return eT;E3=1;var e=La(),t=function(){return e.Date.now()};return eT=t,eT}var nT,I3;function SQ(){if(I3)return nT;I3=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return nT=t,nT}var rT,O3;function CQ(){if(O3)return rT;O3=1;var e=SQ(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return rT=n,rT}var iT,N3;function Nj(){if(N3)return iT;N3=1;var e=CQ(),t=bo(),n=Lc(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(n(c))return r;if(t(c)){var h=typeof c.valueOf=="function"?c.valueOf():c;c=t(h)?h+"":h}if(typeof c!="string")return c===0?c:+c;c=e(c);var d=a.test(c);return d||s.test(c)?o(c.slice(2),d?2:8):i.test(c)?r:+c}return iT=l,iT}var aT,_3;function TQ(){if(_3)return aT;_3=1;var e=bo(),t=wQ(),n=Nj(),r="Expected a function",i=Math.max,a=Math.min;function s(o,l,c){var h,d,p,g,v,x,b=0,w=!1,C=!1,T=!0;if(typeof o!="function")throw new TypeError(r);l=n(l)||0,e(c)&&(w=!!c.leading,C="maxWait"in c,p=C?i(n(c.maxWait)||0,l):p,T="trailing"in c?!!c.trailing:T);function $(B){var V=h,z=d;return h=d=void 0,b=B,g=o.apply(z,V),g}function A(B){return b=B,v=setTimeout(N,l),w?$(B):g}function E(B){var V=B-x,z=B-b,M=l-V;return C?a(M,p-z):M}function O(B){var V=B-x,z=B-b;return x===void 0||V>=l||V<0||C&&z>=p}function N(){var B=t();if(O(B))return _(B);v=setTimeout(N,E(B))}function _(B){return v=void 0,T&&h?$(B):(h=d=void 0,g)}function R(){v!==void 0&&clearTimeout(v),b=0,h=x=d=v=void 0}function I(){return v===void 0?g:_(t())}function P(){var B=t(),V=O(B);if(h=arguments,d=this,x=B,V){if(v===void 0)return A(x);if(C)return clearTimeout(v),v=setTimeout(N,l),$(x)}return v===void 0&&(v=setTimeout(N,l)),g}return P.cancel=R,P.flush=I,P}return aT=s,aT}var sT,R3;function $Q(){if(R3)return sT;R3=1;var e=TQ(),t=bo(),n="Expected a function";function r(i,a,s){var o=!0,l=!0;if(typeof i!="function")throw new TypeError(n);return t(s)&&(o="leading"in s?!!s.leading:o,l="trailing"in s?!!s.trailing:l),e(i,a,{leading:o,maxWait:a,trailing:l})}return sT=r,sT}var AQ=$Q();const _j=Be(AQ);function Vh(e){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vh(e)}function D3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function $g(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D3(Object(n),!0).forEach(function(r){kQ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D3(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function kQ(e,t,n){return t=EQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EQ(e){var t=IQ(e,"string");return Vh(t)=="symbol"?t:t+""}function IQ(e,t){if(Vh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Vh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OQ(e,t){return DQ(e)||RQ(e,t)||_Q(e,t)||NQ()}function NQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Q(e,t){if(e){if(typeof e=="string")return M3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M3(e,t)}}function M3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function RQ(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function DQ(e){if(Array.isArray(e))return e}var MQ=Tt.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,i=r===void 0?{width:-1,height:-1}:r,a=e.width,s=a===void 0?"100%":a,o=e.height,l=o===void 0?"100%":o,c=e.minWidth,h=c===void 0?0:c,d=e.minHeight,p=e.maxHeight,g=e.children,v=e.debounce,x=v===void 0?0:v,b=e.id,w=e.className,C=e.onResize,T=e.style,$=T===void 0?{}:T,A=Tt.useRef(null),E=Tt.useRef();E.current=C,Tt.useImperativeHandle(t,function(){return Object.defineProperty(A.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),A.current},configurable:!0})});var O=Tt.useState({containerWidth:i.width,containerHeight:i.height}),N=OQ(O,2),_=N[0],R=N[1],I=Tt.useCallback(function(B,V){R(function(z){var M=Math.round(B),U=Math.round(V);return z.containerWidth===M&&z.containerHeight===U?z:{containerWidth:M,containerHeight:U}})},[]);Tt.useEffect(function(){var B=function(q){var F,G=q[0].contentRect,H=G.width,Y=G.height;I(H,Y),(F=E.current)===null||F===void 0||F.call(E,H,Y)};x>0&&(B=_j(B,x,{trailing:!0,leading:!1}));var V=new ResizeObserver(B),z=A.current.getBoundingClientRect(),M=z.width,U=z.height;return I(M,U),V.observe(A.current),function(){V.disconnect()}},[I,x]);var P=Tt.useMemo(function(){var B=_.containerWidth,V=_.containerHeight;if(B<0||V<0)return null;fs(ol(s)||ol(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,l),fs(!n||n>0,"The aspect(%s) must be greater than zero.",n);var z=ol(s)?B:s,M=ol(l)?V:l;n&&n>0&&(z?M=z/n:M&&(z=M*n),p&&M>p&&(M=p)),fs(z>0||M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,z,M,s,l,h,d,n);var U=!Array.isArray(g)&&cs(g.type).endsWith("Chart");return et.Children.map(g,function(W){return et.isValidElement(W)?Tt.cloneElement(W,$g({width:z,height:M},U?{style:$g({height:"100%",width:"100%",maxHeight:M,maxWidth:z},W.props.style)}:{})):W})},[n,g,l,p,d,h,_,s]);return et.createElement("div",{id:b?"".concat(b):void 0,className:Ce("recharts-responsive-container",w),style:$g($g({},$),{},{width:s,height:l,minWidth:h,minHeight:d,maxHeight:p}),ref:A},P)}),Rj=function(t){return null};Rj.displayName="Cell";function Wh(e){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wh(e)}function P3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function F$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?P3(Object(n),!0).forEach(function(r){PQ(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P3(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function PQ(e,t,n){return t=FQ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FQ(e){var t=LQ(e,"string");return Wh(t)=="symbol"?t:t+""}function LQ(e,t){if(Wh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Wh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fu={widthCache:{},cacheCount:0},BQ=2e3,zQ={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},F3="recharts_measurement_span";function jQ(e){var t=F$({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var _h=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||jc.isSsr)return{width:0,height:0};var r=jQ(n),i=JSON.stringify({text:t,copyStyle:r});if(Fu.widthCache[i])return Fu.widthCache[i];try{var a=document.getElementById(F3);a||(a=document.createElement("span"),a.setAttribute("id",F3),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=F$(F$({},zQ),r);Object.assign(a.style,s),a.textContent="".concat(t);var o=a.getBoundingClientRect(),l={width:o.width,height:o.height};return Fu.widthCache[i]=l,++Fu.cacheCount>BQ&&(Fu.cacheCount=0,Fu.widthCache={}),l}catch{return{width:0,height:0}}},UQ=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Gh(e){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gh(e)}function gy(e,t){return qQ(e)||GQ(e,t)||WQ(e,t)||VQ()}function VQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WQ(e,t){if(e){if(typeof e=="string")return L3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L3(e,t)}}function L3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function GQ(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function qQ(e){if(Array.isArray(e))return e}function HQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,KQ(r.key),r)}}function XQ(e,t,n){return t&&B3(e.prototype,t),n&&B3(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function KQ(e){var t=YQ(e,"string");return Gh(t)=="symbol"?t:t+""}function YQ(e,t){if(Gh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Gh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var z3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,j3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ZQ=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,QQ=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Dj={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},JQ=Object.keys(Dj),qu="NaN";function tJ(e,t){return e*Dj[t]}var Ag=function(){function e(t,n){HQ(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!ZQ.test(n)&&(this.num=NaN,this.unit=""),JQ.includes(n)&&(this.num=tJ(t,n),this.unit="px")}return XQ(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,i=(r=QQ.exec(n))!==null&&r!==void 0?r:[],a=gy(i,3),s=a[1],o=a[2];return new e(parseFloat(s),o??"")}}])}();function Mj(e){if(e.includes(qu))return qu;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=z3.exec(t))!==null&&n!==void 0?n:[],i=gy(r,4),a=i[1],s=i[2],o=i[3],l=Ag.parse(a??""),c=Ag.parse(o??""),h=s==="*"?l.multiply(c):l.divide(c);if(h.isNaN())return qu;t=t.replace(z3,h.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,p=(d=j3.exec(t))!==null&&d!==void 0?d:[],g=gy(p,4),v=g[1],x=g[2],b=g[3],w=Ag.parse(v??""),C=Ag.parse(b??""),T=x==="+"?w.add(C):w.subtract(C);if(T.isNaN())return qu;t=t.replace(j3,T.toString())}return t}var U3=/\(([^()]*)\)/;function eJ(e){for(var t=e;t.includes("(");){var n=U3.exec(t),r=gy(n,2),i=r[1];t=t.replace(U3,Mj(i))}return t}function nJ(e){var t=e.replace(/\s+/g,"");return t=eJ(t),t=Mj(t),t}function rJ(e){try{return nJ(e)}catch{return qu}}function oT(e){var t=rJ(e.slice(5,-1));return t===qu?"":t}var iJ=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],aJ=["dx","dy","angle","className","breakAll"];function L$(){return L$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L$.apply(this,arguments)}function V3(e,t){if(e==null)return{};var n=sJ(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function sJ(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function W3(e,t){return cJ(e)||uJ(e,t)||lJ(e,t)||oJ()}function oJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lJ(e,t){if(e){if(typeof e=="string")return G3(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G3(e,t)}}function G3(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uJ(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function cJ(e){if(Array.isArray(e))return e}var Pj=/[ \f\n\r\t\v\u2028\u2029]+/,Fj=function(t){var n=t.children,r=t.breakAll,i=t.style;try{var a=[];he(n)||(r?a=n.toString().split(""):a=n.toString().split(Pj));var s=a.map(function(l){return{word:l,width:_h(l,i).width}}),o=r?0:_h(" ",i).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},fJ=function(t,n,r,i,a){var s=t.maxLines,o=t.children,l=t.style,c=t.breakAll,h=Ot(s),d=o,p=function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return z.reduce(function(M,U){var W=U.word,q=U.width,F=M[M.length-1];if(F&&(i==null||a||F.width+q+r<Number(i)))F.words.push(W),F.width+=q+r;else{var G={words:[W],width:q};M.push(G)}return M},[])},g=p(n),v=function(z){return z.reduce(function(M,U){return M.width>U.width?M:U})};if(!h)return g;for(var x="…",b=function(z){var M=d.slice(0,z),U=Fj({breakAll:c,style:l,children:M+x}).wordsWithComputedWidth,W=p(U),q=W.length>s||v(W).width>Number(i);return[q,W]},w=0,C=d.length-1,T=0,$;w<=C&&T<=d.length-1;){var A=Math.floor((w+C)/2),E=A-1,O=b(E),N=W3(O,2),_=N[0],R=N[1],I=b(A),P=W3(I,1),B=P[0];if(!_&&!B&&(w=A+1),_&&B&&(C=A-1),!_&&B){$=R;break}T++}return $||g},q3=function(t){var n=he(t)?[]:t.toString().split(Pj);return[{words:n}]},hJ=function(t){var n=t.width,r=t.scaleToFit,i=t.children,a=t.style,s=t.breakAll,o=t.maxLines;if((n||r)&&!jc.isSsr){var l,c,h=Fj({breakAll:s,children:i,style:a});if(h){var d=h.wordsWithComputedWidth,p=h.spaceWidth;l=d,c=p}else return q3(i);return fJ({breakAll:s,children:i,maxLines:o,style:a},l,c,n,r)}return q3(i)},H3="#808080",yy=function(t){var n=t.x,r=n===void 0?0:n,i=t.y,a=i===void 0?0:i,s=t.lineHeight,o=s===void 0?"1em":s,l=t.capHeight,c=l===void 0?"0.71em":l,h=t.scaleToFit,d=h===void 0?!1:h,p=t.textAnchor,g=p===void 0?"start":p,v=t.verticalAnchor,x=v===void 0?"end":v,b=t.fill,w=b===void 0?H3:b,C=V3(t,iJ),T=Tt.useMemo(function(){return hJ({breakAll:C.breakAll,children:C.children,maxLines:C.maxLines,scaleToFit:d,style:C.style,width:C.width})},[C.breakAll,C.children,C.maxLines,d,C.style,C.width]),$=C.dx,A=C.dy,E=C.angle,O=C.className,N=C.breakAll,_=V3(C,aJ);if(!zn(r)||!zn(a))return null;var R=r+(Ot($)?$:0),I=a+(Ot(A)?A:0),P;switch(x){case"start":P=oT("calc(".concat(c,")"));break;case"middle":P=oT("calc(".concat((T.length-1)/2," * -").concat(o," + (").concat(c," / 2))"));break;default:P=oT("calc(".concat(T.length-1," * -").concat(o,")"));break}var B=[];if(d){var V=T[0].width,z=C.width;B.push("scale(".concat((Ot(z)?z/V:1)/V,")"))}return E&&B.push("rotate(".concat(E,", ").concat(R,", ").concat(I,")")),B.length&&(_.transform=B.join(" ")),et.createElement("text",L$({},pe(_,!0),{x:R,y:I,className:Ce("recharts-text",O),textAnchor:g,fill:w.includes("url")?H3:w}),T.map(function(M,U){var W=M.words.join(N?"":" ");return et.createElement("tspan",{x:R,dy:U===0?P:o,key:"".concat(W,"-").concat(U)},W)}))};function so(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function dJ(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function VA(e){let t,n,r;e.length!==2?(t=so,n=(o,l)=>so(e(o),l),r=(o,l)=>e(o)-l):(t=e===so||e===dJ?e:pJ,n=e,r=e);function i(o,l,c=0,h=o.length){if(c<h){if(t(l,l)!==0)return h;do{const d=c+h>>>1;n(o[d],l)<0?c=d+1:h=d}while(c<h)}return c}function a(o,l,c=0,h=o.length){if(c<h){if(t(l,l)!==0)return h;do{const d=c+h>>>1;n(o[d],l)<=0?c=d+1:h=d}while(c<h)}return c}function s(o,l,c=0,h=o.length){const d=i(o,l,c,h-1);return d>c&&r(o[d-1],l)>-r(o[d],l)?d-1:d}return{left:i,center:s,right:a}}function pJ(){return 0}function Lj(e){return e===null?NaN:+e}function*mJ(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const gJ=VA(so),Ld=gJ.right;VA(Lj).center;class X3 extends Map{constructor(t,n=bJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(K3(this,t))}has(t){return super.has(K3(this,t))}set(t,n){return super.set(yJ(this,t),n)}delete(t){return super.delete(vJ(this,t))}}function K3({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function yJ({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function vJ({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function bJ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function xJ(e=so){if(e===so)return Bj;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function Bj(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const wJ=Math.sqrt(50),SJ=Math.sqrt(10),CJ=Math.sqrt(2);function vy(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),s=a>=wJ?10:a>=SJ?5:a>=CJ?2:1;let o,l,c;return i<0?(c=Math.pow(10,-i)/s,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*s,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=n&&n<2?vy(e,t,n*2):[o,l,c]}function B$(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,a,s]=r?vy(t,e,n):vy(e,t,n);if(!(a>=i))return[];const o=a-i+1,l=new Array(o);if(r)if(s<0)for(let c=0;c<o;++c)l[c]=(a-c)/-s;else for(let c=0;c<o;++c)l[c]=(a-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(i+c)/-s;else for(let c=0;c<o;++c)l[c]=(i+c)*s;return l}function z$(e,t,n){return t=+t,e=+e,n=+n,vy(e,t,n)[2]}function j$(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?z$(t,e,n):z$(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Y3(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function Z3(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function zj(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?Bj:xJ(i);r>n;){if(r-n>600){const l=r-n+1,c=t-n+1,h=Math.log(l),d=.5*Math.exp(2*h/3),p=.5*Math.sqrt(h*d*(l-d)/l)*(c-l/2<0?-1:1),g=Math.max(n,Math.floor(t-c*d/l+p)),v=Math.min(r,Math.floor(t+(l-c)*d/l+p));zj(e,t,g,v,i)}const a=e[t];let s=n,o=r;for(fh(e,n,t),i(e[r],a)>0&&fh(e,n,r);s<o;){for(fh(e,s,o),++s,--o;i(e[s],a)<0;)++s;for(;i(e[o],a)>0;)--o}i(e[n],a)===0?fh(e,n,o):(++o,fh(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function fh(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function TJ(e,t,n){if(e=Float64Array.from(mJ(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Z3(e);if(t>=1)return Y3(e);var r,i=(r-1)*t,a=Math.floor(i),s=Y3(zj(e,a).subarray(0,a+1)),o=Z3(e.subarray(a+1));return s+(o-s)*(i-a)}}function $J(e,t,n=Lj){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),s=+n(e[a],a,e),o=+n(e[a+1],a+1,e);return s+(o-s)*(i-a)}}function AJ(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);++r<i;)a[r]=e+r*n;return a}function zi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function $s(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const U$=Symbol("implicit");function WA(){var e=new X3,t=[],n=[],r=U$;function i(a){let s=e.get(a);if(s===void 0){if(r!==U$)return r;e.set(a,s=t.push(a)-1)}return n[s%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new X3;for(const s of a)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return WA(t,n).unknown(r)},zi.apply(i,arguments),i}function qh(){var e=WA().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,a,s,o=!1,l=0,c=0,h=.5;delete e.unknown;function d(){var p=t().length,g=i<r,v=g?i:r,x=g?r:i;a=(x-v)/Math.max(1,p-l+c*2),o&&(a=Math.floor(a)),v+=(x-v-a*(p-l))*h,s=a*(1-l),o&&(v=Math.round(v),s=Math.round(s));var b=AJ(p).map(function(w){return v+a*w});return n(g?b.reverse():b)}return e.domain=function(p){return arguments.length?(t(p),d()):t()},e.range=function(p){return arguments.length?([r,i]=p,r=+r,i=+i,d()):[r,i]},e.rangeRound=function(p){return[r,i]=p,r=+r,i=+i,o=!0,d()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(p){return arguments.length?(o=!!p,d()):o},e.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),d()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),d()):l},e.paddingOuter=function(p){return arguments.length?(c=+p,d()):c},e.align=function(p){return arguments.length?(h=Math.max(0,Math.min(1,p)),d()):h},e.copy=function(){return qh(t(),[r,i]).round(o).paddingInner(l).paddingOuter(c).align(h)},zi.apply(d(),arguments)}function jj(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return jj(t())},e}function Rh(){return jj(qh.apply(null,arguments).paddingInner(1))}function GA(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Uj(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Bd(){}var Hh=.7,by=1/Hh,Zu="\\s*([+-]?\\d+)\\s*",Xh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kJ=/^#([0-9a-f]{3,8})$/,EJ=new RegExp(`^rgb\\(${Zu},${Zu},${Zu}\\)$`),IJ=new RegExp(`^rgb\\(${$a},${$a},${$a}\\)$`),OJ=new RegExp(`^rgba\\(${Zu},${Zu},${Zu},${Xh}\\)$`),NJ=new RegExp(`^rgba\\(${$a},${$a},${$a},${Xh}\\)$`),_J=new RegExp(`^hsl\\(${Xh},${$a},${$a}\\)$`),RJ=new RegExp(`^hsla\\(${Xh},${$a},${$a},${Xh}\\)$`),Q3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};GA(Bd,Kh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:J3,formatHex:J3,formatHex8:DJ,formatHsl:MJ,formatRgb:tF,toString:tF});function J3(){return this.rgb().formatHex()}function DJ(){return this.rgb().formatHex8()}function MJ(){return Vj(this).formatHsl()}function tF(){return this.rgb().formatRgb()}function Kh(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=kJ.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?eF(t):n===3?new Hr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?kg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?kg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=EJ.exec(e))?new Hr(t[1],t[2],t[3],1):(t=IJ.exec(e))?new Hr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=OJ.exec(e))?kg(t[1],t[2],t[3],t[4]):(t=NJ.exec(e))?kg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_J.exec(e))?iF(t[1],t[2]/100,t[3]/100,1):(t=RJ.exec(e))?iF(t[1],t[2]/100,t[3]/100,t[4]):Q3.hasOwnProperty(e)?eF(Q3[e]):e==="transparent"?new Hr(NaN,NaN,NaN,0):null}function eF(e){return new Hr(e>>16&255,e>>8&255,e&255,1)}function kg(e,t,n,r){return r<=0&&(e=t=n=NaN),new Hr(e,t,n,r)}function PJ(e){return e instanceof Bd||(e=Kh(e)),e?(e=e.rgb(),new Hr(e.r,e.g,e.b,e.opacity)):new Hr}function V$(e,t,n,r){return arguments.length===1?PJ(e):new Hr(e,t,n,r??1)}function Hr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}GA(Hr,V$,Uj(Bd,{brighter(e){return e=e==null?by:Math.pow(by,e),new Hr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Hh:Math.pow(Hh,e),new Hr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Hr(dl(this.r),dl(this.g),dl(this.b),xy(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nF,formatHex:nF,formatHex8:FJ,formatRgb:rF,toString:rF}));function nF(){return`#${ll(this.r)}${ll(this.g)}${ll(this.b)}`}function FJ(){return`#${ll(this.r)}${ll(this.g)}${ll(this.b)}${ll((isNaN(this.opacity)?1:this.opacity)*255)}`}function rF(){const e=xy(this.opacity);return`${e===1?"rgb(":"rgba("}${dl(this.r)}, ${dl(this.g)}, ${dl(this.b)}${e===1?")":`, ${e})`}`}function xy(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function dl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ll(e){return e=dl(e),(e<16?"0":"")+e.toString(16)}function iF(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new na(e,t,n,r)}function Vj(e){if(e instanceof na)return new na(e.h,e.s,e.l,e.opacity);if(e instanceof Bd||(e=Kh(e)),!e)return new na;if(e instanceof na)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),s=NaN,o=a-i,l=(a+i)/2;return o?(t===a?s=(n-r)/o+(n<r)*6:n===a?s=(r-t)/o+2:s=(t-n)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new na(s,o,l,e.opacity)}function LJ(e,t,n,r){return arguments.length===1?Vj(e):new na(e,t,n,r??1)}function na(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}GA(na,LJ,Uj(Bd,{brighter(e){return e=e==null?by:Math.pow(by,e),new na(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Hh:Math.pow(Hh,e),new na(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Hr(lT(e>=240?e-240:e+120,i,r),lT(e,i,r),lT(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new na(aF(this.h),Eg(this.s),Eg(this.l),xy(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xy(this.opacity);return`${e===1?"hsl(":"hsla("}${aF(this.h)}, ${Eg(this.s)*100}%, ${Eg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function aF(e){return e=(e||0)%360,e<0?e+360:e}function Eg(e){return Math.max(0,Math.min(1,e||0))}function lT(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const qA=e=>()=>e;function BJ(e,t){return function(n){return e+n*t}}function zJ(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function jJ(e){return(e=+e)==1?Wj:function(t,n){return n-t?zJ(t,n,e):qA(isNaN(t)?n:t)}}function Wj(e,t){var n=t-e;return n?BJ(e,n):qA(isNaN(e)?t:e)}const sF=function e(t){var n=jJ(t);function r(i,a){var s=n((i=V$(i)).r,(a=V$(a)).r),o=n(i.g,a.g),l=n(i.b,a.b),c=Wj(i.opacity,a.opacity);return function(h){return i.r=s(h),i.g=o(h),i.b=l(h),i.opacity=c(h),i+""}}return r.gamma=e,r}(1);function UJ(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function VJ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function WJ(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),s;for(s=0;s<r;++s)i[s]=Uc(e[s],t[s]);for(;s<n;++s)a[s]=t[s];return function(o){for(s=0;s<r;++s)a[s]=i[s](o);return a}}function GJ(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function wy(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function qJ(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Uc(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var W$=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uT=new RegExp(W$.source,"g");function HJ(e){return function(){return e}}function XJ(e){return function(t){return e(t)+""}}function KJ(e,t){var n=W$.lastIndex=uT.lastIndex=0,r,i,a,s=-1,o=[],l=[];for(e=e+"",t=t+"";(r=W$.exec(e))&&(i=uT.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),o[s]?o[s]+=a:o[++s]=a),(r=r[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:wy(r,i)})),n=uT.lastIndex;return n<t.length&&(a=t.slice(n),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?XJ(l[0].x):HJ(t):(t=l.length,function(c){for(var h=0,d;h<t;++h)o[(d=l[h]).i]=d.x(c);return o.join("")})}function Uc(e,t){var n=typeof t,r;return t==null||n==="boolean"?qA(t):(n==="number"?wy:n==="string"?(r=Kh(t))?(t=r,sF):KJ:t instanceof Kh?sF:t instanceof Date?GJ:VJ(t)?UJ:Array.isArray(t)?WJ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?qJ:wy)(e,t)}function HA(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function YJ(e,t){t===void 0&&(t=e,e=Uc);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(s){var o=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return a[o](s-o)}}function ZJ(e){return function(){return e}}function Sy(e){return+e}var oF=[0,1];function Nr(e){return e}function G$(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:ZJ(isNaN(t)?NaN:.5)}function QJ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function JJ(e,t,n){var r=e[0],i=e[1],a=t[0],s=t[1];return i<r?(r=G$(i,r),a=n(s,a)):(r=G$(r,i),a=n(a,s)),function(o){return a(r(o))}}function ttt(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=G$(e[s],e[s+1]),a[s]=n(t[s],t[s+1]);return function(o){var l=Ld(e,o,1,r)-1;return a[l](i[l](o))}}function zd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Bv(){var e=oF,t=oF,n=Uc,r,i,a,s=Nr,o,l,c;function h(){var p=Math.min(e.length,t.length);return s!==Nr&&(s=QJ(e[0],e[p-1])),o=p>2?ttt:JJ,l=c=null,d}function d(p){return p==null||isNaN(p=+p)?a:(l||(l=o(e.map(r),t,n)))(r(s(p)))}return d.invert=function(p){return s(i((c||(c=o(t,e.map(r),wy)))(p)))},d.domain=function(p){return arguments.length?(e=Array.from(p,Sy),h()):e.slice()},d.range=function(p){return arguments.length?(t=Array.from(p),h()):t.slice()},d.rangeRound=function(p){return t=Array.from(p),n=HA,h()},d.clamp=function(p){return arguments.length?(s=p?!0:Nr,h()):s!==Nr},d.interpolate=function(p){return arguments.length?(n=p,h()):n},d.unknown=function(p){return arguments.length?(a=p,d):a},function(p,g){return r=p,i=g,h()}}function XA(){return Bv()(Nr,Nr)}function ett(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Cy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function cc(e){return e=Cy(Math.abs(e)),e?e[1]:NaN}function ntt(e,t){return function(n,r){for(var i=n.length,a=[],s=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),a.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=e[s=(s+1)%e.length];return a.reverse().join(t)}}function rtt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var itt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yh(e){if(!(t=itt.exec(e)))throw new Error("invalid format: "+e);var t;return new KA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Yh.prototype=KA.prototype;function KA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}KA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function att(e){t:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break t;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Gj;function stt(e,t){var n=Cy(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Gj=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return a===s?r:a>s?r+new Array(a-s+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Cy(e,Math.max(0,t+a-1))[0]}function lF(e,t){var n=Cy(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const uF={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ett,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>lF(e*100,t),r:lF,s:stt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function cF(e){return e}var fF=Array.prototype.map,hF=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ott(e){var t=e.grouping===void 0||e.thousands===void 0?cF:ntt(fF.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?cF:rtt(fF.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(d){d=Yh(d);var p=d.fill,g=d.align,v=d.sign,x=d.symbol,b=d.zero,w=d.width,C=d.comma,T=d.precision,$=d.trim,A=d.type;A==="n"?(C=!0,A="g"):uF[A]||(T===void 0&&(T=12),$=!0,A="g"),(b||p==="0"&&g==="=")&&(b=!0,p="0",g="=");var E=x==="$"?n:x==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",O=x==="$"?r:/[%p]/.test(A)?s:"",N=uF[A],_=/[defgprs%]/.test(A);T=T===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,T)):Math.max(0,Math.min(20,T));function R(I){var P=E,B=O,V,z,M;if(A==="c")B=N(I)+B,I="";else{I=+I;var U=I<0||1/I<0;if(I=isNaN(I)?l:N(Math.abs(I),T),$&&(I=att(I)),U&&+I==0&&v!=="+"&&(U=!1),P=(U?v==="("?v:o:v==="-"||v==="("?"":v)+P,B=(A==="s"?hF[8+Gj/3]:"")+B+(U&&v==="("?")":""),_){for(V=-1,z=I.length;++V<z;)if(M=I.charCodeAt(V),48>M||M>57){B=(M===46?i+I.slice(V+1):I.slice(V))+B,I=I.slice(0,V);break}}}C&&!b&&(I=t(I,1/0));var W=P.length+I.length+B.length,q=W<w?new Array(w-W+1).join(p):"";switch(C&&b&&(I=t(q+I,q.length?w-B.length:1/0),q=""),g){case"<":I=P+I+B+q;break;case"=":I=P+q+I+B;break;case"^":I=q.slice(0,W=q.length>>1)+P+I+B+q.slice(W);break;default:I=q+P+I+B;break}return a(I)}return R.toString=function(){return d+""},R}function h(d,p){var g=c((d=Yh(d),d.type="f",d)),v=Math.max(-8,Math.min(8,Math.floor(cc(p)/3)))*3,x=Math.pow(10,-v),b=hF[8+v/3];return function(w){return g(x*w)+b}}return{format:c,formatPrefix:h}}var Ig,YA,qj;ltt({thousands:",",grouping:[3],currency:["$",""]});function ltt(e){return Ig=ott(e),YA=Ig.format,qj=Ig.formatPrefix,Ig}function utt(e){return Math.max(0,-cc(Math.abs(e)))}function ctt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(cc(t)/3)))*3-cc(Math.abs(e)))}function ftt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,cc(t)-cc(e))+1}function Hj(e,t,n,r){var i=j$(e,t,n),a;switch(r=Yh(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=ctt(i,s))&&(r.precision=a),qj(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=ftt(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=utt(i))&&(r.precision=a-(r.type==="%")*2);break}}return YA(r)}function wo(e){var t=e.domain;return e.ticks=function(n){var r=t();return B$(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Hj(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,s=r[i],o=r[a],l,c,h=10;for(o<s&&(c=s,s=o,o=c,c=i,i=a,a=c);h-- >0;){if(c=z$(s,o,n),c===l)return r[i]=s,r[a]=o,t(r);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;l=c}return e},e}function Ty(){var e=XA();return e.copy=function(){return zd(e,Ty())},zi.apply(e,arguments),wo(e)}function Xj(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Sy),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Xj(e).unknown(t)},e=arguments.length?Array.from(e,Sy):[0,1],wo(n)}function Kj(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],s;return a<i&&(s=n,n=r,r=s,s=i,i=a,a=s),e[n]=t.floor(i),e[r]=t.ceil(a),e}function dF(e){return Math.log(e)}function pF(e){return Math.exp(e)}function htt(e){return-Math.log(-e)}function dtt(e){return-Math.exp(-e)}function ptt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mtt(e){return e===10?ptt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function gtt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function mF(e){return(t,n)=>-e(-t,n)}function ZA(e){const t=e(dF,pF),n=t.domain;let r=10,i,a;function s(){return i=gtt(r),a=mtt(r),n()[0]<0?(i=mF(i),a=mF(a),e(htt,dtt)):e(dF,pF),t}return t.base=function(o){return arguments.length?(r=+o,s()):r},t.domain=function(o){return arguments.length?(n(o),s()):n()},t.ticks=o=>{const l=n();let c=l[0],h=l[l.length-1];const d=h<c;d&&([c,h]=[h,c]);let p=i(c),g=i(h),v,x;const b=o==null?10:+o;let w=[];if(!(r%1)&&g-p<b){if(p=Math.floor(p),g=Math.ceil(g),c>0){for(;p<=g;++p)for(v=1;v<r;++v)if(x=p<0?v/a(-p):v*a(p),!(x<c)){if(x>h)break;w.push(x)}}else for(;p<=g;++p)for(v=r-1;v>=1;--v)if(x=p>0?v/a(-p):v*a(p),!(x<c)){if(x>h)break;w.push(x)}w.length*2<b&&(w=B$(c,h,b))}else w=B$(p,g,Math.min(g-p,b)).map(a);return d?w.reverse():w},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Yh(l)).precision==null&&(l.trim=!0),l=YA(l)),o===1/0)return l;const c=Math.max(1,r*o/t.ticks().length);return h=>{let d=h/a(Math.round(i(h)));return d*r<r-.5&&(d*=r),d<=c?l(h):""}},t.nice=()=>n(Kj(n(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),t}function Yj(){const e=ZA(Bv()).domain([1,10]);return e.copy=()=>zd(e,Yj()).base(e.base()),zi.apply(e,arguments),e}function gF(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function yF(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function QA(e){var t=1,n=e(gF(t),yF(t));return n.constant=function(r){return arguments.length?e(gF(t=+r),yF(t)):t},wo(n)}function Zj(){var e=QA(Bv());return e.copy=function(){return zd(e,Zj()).constant(e.constant())},zi.apply(e,arguments)}function vF(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ytt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function vtt(e){return e<0?-e*e:e*e}function JA(e){var t=e(Nr,Nr),n=1;function r(){return n===1?e(Nr,Nr):n===.5?e(ytt,vtt):e(vF(n),vF(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},wo(t)}function tk(){var e=JA(Bv());return e.copy=function(){return zd(e,tk()).exponent(e.exponent())},zi.apply(e,arguments),e}function btt(){return tk.apply(null,arguments).exponent(.5)}function bF(e){return Math.sign(e)*e*e}function xtt(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Qj(){var e=XA(),t=[0,1],n=!1,r;function i(a){var s=xtt(e(a));return isNaN(s)?r:n?Math.round(s):s}return i.invert=function(a){return e.invert(bF(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,Sy)).map(bF)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(n=!!a,i):n},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return Qj(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},zi.apply(i,arguments),wo(i)}function Jj(){var e=[],t=[],n=[],r;function i(){var s=0,o=Math.max(1,t.length);for(n=new Array(o-1);++s<o;)n[s-1]=$J(e,s/o);return a}function a(s){return s==null||isNaN(s=+s)?r:t[Ld(n,s)]}return a.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(so),i()},a.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},a.unknown=function(s){return arguments.length?(r=s,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return Jj().domain(e).range(t).unknown(r)},zi.apply(a,arguments)}function tU(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function s(l){return l!=null&&l<=l?i[Ld(r,l,0,n)]:a}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*t-(l-n)*e)/(n+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},s.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},s.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,r[0]]:c>=n?[r[n-1],t]:[r[c-1],r[c]]},s.unknown=function(l){return arguments.length&&(a=l),s},s.thresholds=function(){return r.slice()},s.copy=function(){return tU().domain([e,t]).range(i).unknown(a)},zi.apply(wo(s),arguments)}function eU(){var e=[.5],t=[0,1],n,r=1;function i(a){return a!=null&&a<=a?t[Ld(e,a,0,r)]:n}return i.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var s=t.indexOf(a);return[e[s-1],e[s]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return eU().domain(e).range(t).unknown(n)},zi.apply(i,arguments)}const cT=new Date,fT=new Date;function Un(e,t,n,r){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(t(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const l=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return l;let c;do l.push(c=new Date(+a)),t(a,o),e(a);while(c<a&&a<s);return l},i.filter=a=>Un(s=>{if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!a(s););else for(;--o>=0;)for(;t(s,1),!a(s););}),n&&(i.count=(a,s)=>(cT.setTime(+a),fT.setTime(+s),e(cT),e(fT),Math.floor(n(cT,fT))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?s=>r(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const $y=Un(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);$y.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Un(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):$y);$y.range;const ss=1e3,Ni=ss*60,os=Ni*60,ps=os*24,ek=ps*7,xF=ps*30,hT=ps*365,ul=Un(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ss)},(e,t)=>(t-e)/ss,e=>e.getUTCSeconds());ul.range;const nk=Un(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ss)},(e,t)=>{e.setTime(+e+t*Ni)},(e,t)=>(t-e)/Ni,e=>e.getMinutes());nk.range;const rk=Un(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ni)},(e,t)=>(t-e)/Ni,e=>e.getUTCMinutes());rk.range;const ik=Un(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ss-e.getMinutes()*Ni)},(e,t)=>{e.setTime(+e+t*os)},(e,t)=>(t-e)/os,e=>e.getHours());ik.range;const ak=Un(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*os)},(e,t)=>(t-e)/os,e=>e.getUTCHours());ak.range;const jd=Un(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ni)/ps,e=>e.getDate()-1);jd.range;const zv=Un(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ps,e=>e.getUTCDate()-1);zv.range;const nU=Un(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ps,e=>Math.floor(e/ps));nU.range;function Ll(e){return Un(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ni)/ek)}const jv=Ll(0),Ay=Ll(1),wtt=Ll(2),Stt=Ll(3),fc=Ll(4),Ctt=Ll(5),Ttt=Ll(6);jv.range;Ay.range;wtt.range;Stt.range;fc.range;Ctt.range;Ttt.range;function Bl(e){return Un(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/ek)}const Uv=Bl(0),ky=Bl(1),$tt=Bl(2),Att=Bl(3),hc=Bl(4),ktt=Bl(5),Ett=Bl(6);Uv.range;ky.range;$tt.range;Att.range;hc.range;ktt.range;Ett.range;const sk=Un(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());sk.range;const ok=Un(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());ok.range;const ms=Un(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ms.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Un(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});ms.range;const gs=Un(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());gs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Un(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});gs.range;function rU(e,t,n,r,i,a){const s=[[ul,1,ss],[ul,5,5*ss],[ul,15,15*ss],[ul,30,30*ss],[a,1,Ni],[a,5,5*Ni],[a,15,15*Ni],[a,30,30*Ni],[i,1,os],[i,3,3*os],[i,6,6*os],[i,12,12*os],[r,1,ps],[r,2,2*ps],[n,1,ek],[t,1,xF],[t,3,3*xF],[e,1,hT]];function o(c,h,d){const p=h<c;p&&([c,h]=[h,c]);const g=d&&typeof d.range=="function"?d:l(c,h,d),v=g?g.range(c,+h+1):[];return p?v.reverse():v}function l(c,h,d){const p=Math.abs(h-c)/d,g=VA(([,,b])=>b).right(s,p);if(g===s.length)return e.every(j$(c/hT,h/hT,d));if(g===0)return $y.every(Math.max(j$(c,h,d),1));const[v,x]=s[p/s[g-1][2]<s[g][2]/p?g-1:g];return v.every(x)}return[o,l]}const[Itt,Ott]=rU(gs,ok,Uv,nU,ak,rk),[Ntt,_tt]=rU(ms,sk,jv,jd,ik,nk);function dT(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function pT(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function hh(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Rtt(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,c=dh(i),h=ph(i),d=dh(a),p=ph(a),g=dh(s),v=ph(s),x=dh(o),b=ph(o),w=dh(l),C=ph(l),T={a:U,A:W,b:q,B:F,c:null,d:AF,e:AF,f:net,g:det,G:met,H:Jtt,I:tet,j:eet,L:iU,m:ret,M:iet,p:G,q:H,Q:IF,s:OF,S:aet,u:set,U:oet,V:uet,w:cet,W:fet,x:null,X:null,y:het,Y:pet,Z:get,"%":EF},$={a:Y,A:ot,b:ht,B:yt,c:null,d:kF,e:kF,f:xet,g:Net,G:Ret,H:yet,I:vet,j:bet,L:sU,m:wet,M:Cet,p:It,q:$t,Q:IF,s:OF,S:Tet,u:$et,U:Aet,V:ket,w:Eet,W:Iet,x:null,X:null,y:Oet,Y:_et,Z:Det,"%":EF},A={a:R,A:I,b:P,B,c:V,d:TF,e:TF,f:Ktt,g:CF,G:SF,H:$F,I:$F,j:Gtt,L:Xtt,m:Wtt,M:qtt,p:_,q:Vtt,Q:Ztt,s:Qtt,S:Htt,u:Ltt,U:Btt,V:ztt,w:Ftt,W:jtt,x:z,X:M,y:CF,Y:SF,Z:Utt,"%":Ytt};T.x=E(n,T),T.X=E(r,T),T.c=E(t,T),$.x=E(n,$),$.X=E(r,$),$.c=E(t,$);function E(mt,At){return function(kt){var gt=[],Ut=-1,Lt=0,Zt=mt.length,Wt,qt,fe;for(kt instanceof Date||(kt=new Date(+kt));++Ut<Zt;)mt.charCodeAt(Ut)===37&&(gt.push(mt.slice(Lt,Ut)),(qt=wF[Wt=mt.charAt(++Ut)])!=null?Wt=mt.charAt(++Ut):qt=Wt==="e"?" ":"0",(fe=At[Wt])&&(Wt=fe(kt,qt)),gt.push(Wt),Lt=Ut+1);return gt.push(mt.slice(Lt,Ut)),gt.join("")}}function O(mt,At){return function(kt){var gt=hh(1900,void 0,1),Ut=N(gt,mt,kt+="",0),Lt,Zt;if(Ut!=kt.length)return null;if("Q"in gt)return new Date(gt.Q);if("s"in gt)return new Date(gt.s*1e3+("L"in gt?gt.L:0));if(At&&!("Z"in gt)&&(gt.Z=0),"p"in gt&&(gt.H=gt.H%12+gt.p*12),gt.m===void 0&&(gt.m="q"in gt?gt.q:0),"V"in gt){if(gt.V<1||gt.V>53)return null;"w"in gt||(gt.w=1),"Z"in gt?(Lt=pT(hh(gt.y,0,1)),Zt=Lt.getUTCDay(),Lt=Zt>4||Zt===0?ky.ceil(Lt):ky(Lt),Lt=zv.offset(Lt,(gt.V-1)*7),gt.y=Lt.getUTCFullYear(),gt.m=Lt.getUTCMonth(),gt.d=Lt.getUTCDate()+(gt.w+6)%7):(Lt=dT(hh(gt.y,0,1)),Zt=Lt.getDay(),Lt=Zt>4||Zt===0?Ay.ceil(Lt):Ay(Lt),Lt=jd.offset(Lt,(gt.V-1)*7),gt.y=Lt.getFullYear(),gt.m=Lt.getMonth(),gt.d=Lt.getDate()+(gt.w+6)%7)}else("W"in gt||"U"in gt)&&("w"in gt||(gt.w="u"in gt?gt.u%7:"W"in gt?1:0),Zt="Z"in gt?pT(hh(gt.y,0,1)).getUTCDay():dT(hh(gt.y,0,1)).getDay(),gt.m=0,gt.d="W"in gt?(gt.w+6)%7+gt.W*7-(Zt+5)%7:gt.w+gt.U*7-(Zt+6)%7);return"Z"in gt?(gt.H+=gt.Z/100|0,gt.M+=gt.Z%100,pT(gt)):dT(gt)}}function N(mt,At,kt,gt){for(var Ut=0,Lt=At.length,Zt=kt.length,Wt,qt;Ut<Lt;){if(gt>=Zt)return-1;if(Wt=At.charCodeAt(Ut++),Wt===37){if(Wt=At.charAt(Ut++),qt=A[Wt in wF?At.charAt(Ut++):Wt],!qt||(gt=qt(mt,kt,gt))<0)return-1}else if(Wt!=kt.charCodeAt(gt++))return-1}return gt}function _(mt,At,kt){var gt=c.exec(At.slice(kt));return gt?(mt.p=h.get(gt[0].toLowerCase()),kt+gt[0].length):-1}function R(mt,At,kt){var gt=g.exec(At.slice(kt));return gt?(mt.w=v.get(gt[0].toLowerCase()),kt+gt[0].length):-1}function I(mt,At,kt){var gt=d.exec(At.slice(kt));return gt?(mt.w=p.get(gt[0].toLowerCase()),kt+gt[0].length):-1}function P(mt,At,kt){var gt=w.exec(At.slice(kt));return gt?(mt.m=C.get(gt[0].toLowerCase()),kt+gt[0].length):-1}function B(mt,At,kt){var gt=x.exec(At.slice(kt));return gt?(mt.m=b.get(gt[0].toLowerCase()),kt+gt[0].length):-1}function V(mt,At,kt){return N(mt,t,At,kt)}function z(mt,At,kt){return N(mt,n,At,kt)}function M(mt,At,kt){return N(mt,r,At,kt)}function U(mt){return s[mt.getDay()]}function W(mt){return a[mt.getDay()]}function q(mt){return l[mt.getMonth()]}function F(mt){return o[mt.getMonth()]}function G(mt){return i[+(mt.getHours()>=12)]}function H(mt){return 1+~~(mt.getMonth()/3)}function Y(mt){return s[mt.getUTCDay()]}function ot(mt){return a[mt.getUTCDay()]}function ht(mt){return l[mt.getUTCMonth()]}function yt(mt){return o[mt.getUTCMonth()]}function It(mt){return i[+(mt.getUTCHours()>=12)]}function $t(mt){return 1+~~(mt.getUTCMonth()/3)}return{format:function(mt){var At=E(mt+="",T);return At.toString=function(){return mt},At},parse:function(mt){var At=O(mt+="",!1);return At.toString=function(){return mt},At},utcFormat:function(mt){var At=E(mt+="",$);return At.toString=function(){return mt},At},utcParse:function(mt){var At=O(mt+="",!0);return At.toString=function(){return mt},At}}}var wF={"-":"",_:" ",0:"0"},Zn=/^\s*\d+/,Dtt=/^%/,Mtt=/[\\^$*+?|[\]().{}]/g;function Te(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function Ptt(e){return e.replace(Mtt,"\\$&")}function dh(e){return new RegExp("^(?:"+e.map(Ptt).join("|")+")","i")}function ph(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Ftt(e,t,n){var r=Zn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ltt(e,t,n){var r=Zn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Btt(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ztt(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function jtt(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function SF(e,t,n){var r=Zn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function CF(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Utt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Vtt(e,t,n){var r=Zn.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Wtt(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function TF(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Gtt(e,t,n){var r=Zn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function $F(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function qtt(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Htt(e,t,n){var r=Zn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Xtt(e,t,n){var r=Zn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Ktt(e,t,n){var r=Zn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ytt(e,t,n){var r=Dtt.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Ztt(e,t,n){var r=Zn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Qtt(e,t,n){var r=Zn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function AF(e,t){return Te(e.getDate(),t,2)}function Jtt(e,t){return Te(e.getHours(),t,2)}function tet(e,t){return Te(e.getHours()%12||12,t,2)}function eet(e,t){return Te(1+jd.count(ms(e),e),t,3)}function iU(e,t){return Te(e.getMilliseconds(),t,3)}function net(e,t){return iU(e,t)+"000"}function ret(e,t){return Te(e.getMonth()+1,t,2)}function iet(e,t){return Te(e.getMinutes(),t,2)}function aet(e,t){return Te(e.getSeconds(),t,2)}function set(e){var t=e.getDay();return t===0?7:t}function oet(e,t){return Te(jv.count(ms(e)-1,e),t,2)}function aU(e){var t=e.getDay();return t>=4||t===0?fc(e):fc.ceil(e)}function uet(e,t){return e=aU(e),Te(fc.count(ms(e),e)+(ms(e).getDay()===4),t,2)}function cet(e){return e.getDay()}function fet(e,t){return Te(Ay.count(ms(e)-1,e),t,2)}function het(e,t){return Te(e.getFullYear()%100,t,2)}function det(e,t){return e=aU(e),Te(e.getFullYear()%100,t,2)}function pet(e,t){return Te(e.getFullYear()%1e4,t,4)}function met(e,t){var n=e.getDay();return e=n>=4||n===0?fc(e):fc.ceil(e),Te(e.getFullYear()%1e4,t,4)}function get(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Te(t/60|0,"0",2)+Te(t%60,"0",2)}function kF(e,t){return Te(e.getUTCDate(),t,2)}function yet(e,t){return Te(e.getUTCHours(),t,2)}function vet(e,t){return Te(e.getUTCHours()%12||12,t,2)}function bet(e,t){return Te(1+zv.count(gs(e),e),t,3)}function sU(e,t){return Te(e.getUTCMilliseconds(),t,3)}function xet(e,t){return sU(e,t)+"000"}function wet(e,t){return Te(e.getUTCMonth()+1,t,2)}function Cet(e,t){return Te(e.getUTCMinutes(),t,2)}function Tet(e,t){return Te(e.getUTCSeconds(),t,2)}function $et(e){var t=e.getUTCDay();return t===0?7:t}function Aet(e,t){return Te(Uv.count(gs(e)-1,e),t,2)}function oU(e){var t=e.getUTCDay();return t>=4||t===0?hc(e):hc.ceil(e)}function ket(e,t){return e=oU(e),Te(hc.count(gs(e),e)+(gs(e).getUTCDay()===4),t,2)}function Eet(e){return e.getUTCDay()}function Iet(e,t){return Te(ky.count(gs(e)-1,e),t,2)}function Oet(e,t){return Te(e.getUTCFullYear()%100,t,2)}function Net(e,t){return e=oU(e),Te(e.getUTCFullYear()%100,t,2)}function _et(e,t){return Te(e.getUTCFullYear()%1e4,t,4)}function Ret(e,t){var n=e.getUTCDay();return e=n>=4||n===0?hc(e):hc.ceil(e),Te(e.getUTCFullYear()%1e4,t,4)}function Det(){return"+0000"}function EF(){return"%"}function IF(e){return+e}function OF(e){return Math.floor(+e/1e3)}var Lu,lU,uU;Met({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Met(e){return Lu=Rtt(e),lU=Lu.format,Lu.parse,uU=Lu.utcFormat,Lu.utcParse,Lu}function Pet(e){return new Date(e)}function Fet(e){return e instanceof Date?+e:+new Date(+e)}function lk(e,t,n,r,i,a,s,o,l,c){var h=XA(),d=h.invert,p=h.domain,g=c(".%L"),v=c(":%S"),x=c("%I:%M"),b=c("%I %p"),w=c("%a %d"),C=c("%b %d"),T=c("%B"),$=c("%Y");function A(E){return(l(E)<E?g:o(E)<E?v:s(E)<E?x:a(E)<E?b:r(E)<E?i(E)<E?w:C:n(E)<E?T:$)(E)}return h.invert=function(E){return new Date(d(E))},h.domain=function(E){return arguments.length?p(Array.from(E,Fet)):p().map(Pet)},h.ticks=function(E){var O=p();return e(O[0],O[O.length-1],E??10)},h.tickFormat=function(E,O){return O==null?A:c(O)},h.nice=function(E){var O=p();return(!E||typeof E.range!="function")&&(E=t(O[0],O[O.length-1],E??10)),E?p(Kj(O,E)):h},h.copy=function(){return zd(h,lk(e,t,n,r,i,a,s,o,l,c))},h}function Let(){return zi.apply(lk(Ntt,_tt,ms,sk,jv,jd,ik,nk,ul,lU).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Bet(){return zi.apply(lk(Itt,Ott,gs,ok,Uv,zv,ak,rk,ul,uU).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Vv(){var e=0,t=1,n,r,i,a,s=Nr,o=!1,l;function c(d){return d==null||isNaN(d=+d)?l:s(i===0?.5:(d=(a(d)-n)*i,o?Math.max(0,Math.min(1,d)):d))}c.domain=function(d){return arguments.length?([e,t]=d,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),c):[e,t]},c.clamp=function(d){return arguments.length?(o=!!d,c):o},c.interpolator=function(d){return arguments.length?(s=d,c):s};function h(d){return function(p){var g,v;return arguments.length?([g,v]=p,s=d(g,v),c):[s(0),s(1)]}}return c.range=h(Uc),c.rangeRound=h(HA),c.unknown=function(d){return arguments.length?(l=d,c):l},function(d){return a=d,n=d(e),r=d(t),i=n===r?0:1/(r-n),c}}function So(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function cU(){var e=wo(Vv()(Nr));return e.copy=function(){return So(e,cU())},$s.apply(e,arguments)}function fU(){var e=ZA(Vv()).domain([1,10]);return e.copy=function(){return So(e,fU()).base(e.base())},$s.apply(e,arguments)}function hU(){var e=QA(Vv());return e.copy=function(){return So(e,hU()).constant(e.constant())},$s.apply(e,arguments)}function uk(){var e=JA(Vv());return e.copy=function(){return So(e,uk()).exponent(e.exponent())},$s.apply(e,arguments)}function zet(){return uk.apply(null,arguments).exponent(.5)}function dU(){var e=[],t=Nr;function n(r){if(r!=null&&!isNaN(r=+r))return t((Ld(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let i of r)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(so),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,i)=>t(i/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(i,a)=>TJ(e,a/r))},n.copy=function(){return dU(t).domain(e)},$s.apply(n,arguments)}function Wv(){var e=0,t=.5,n=1,r=1,i,a,s,o,l,c=Nr,h,d=!1,p;function g(x){return isNaN(x=+x)?p:(x=.5+((x=+h(x))-a)*(r*x<r*a?o:l),c(d?Math.max(0,Math.min(1,x)):x))}g.domain=function(x){return arguments.length?([e,t,n]=x,i=h(e=+e),a=h(t=+t),s=h(n=+n),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),r=a<i?-1:1,g):[e,t,n]},g.clamp=function(x){return arguments.length?(d=!!x,g):d},g.interpolator=function(x){return arguments.length?(c=x,g):c};function v(x){return function(b){var w,C,T;return arguments.length?([w,C,T]=b,c=YJ(x,[w,C,T]),g):[c(0),c(.5),c(1)]}}return g.range=v(Uc),g.rangeRound=v(HA),g.unknown=function(x){return arguments.length?(p=x,g):p},function(x){return h=x,i=x(e),a=x(t),s=x(n),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),r=a<i?-1:1,g}}function pU(){var e=wo(Wv()(Nr));return e.copy=function(){return So(e,pU())},$s.apply(e,arguments)}function mU(){var e=ZA(Wv()).domain([.1,1,10]);return e.copy=function(){return So(e,mU()).base(e.base())},$s.apply(e,arguments)}function gU(){var e=QA(Wv());return e.copy=function(){return So(e,gU()).constant(e.constant())},$s.apply(e,arguments)}function ck(){var e=JA(Wv());return e.copy=function(){return So(e,ck()).exponent(e.exponent())},$s.apply(e,arguments)}function jet(){return ck.apply(null,arguments).exponent(.5)}const NF=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:qh,scaleDiverging:pU,scaleDivergingLog:mU,scaleDivergingPow:ck,scaleDivergingSqrt:jet,scaleDivergingSymlog:gU,scaleIdentity:Xj,scaleImplicit:U$,scaleLinear:Ty,scaleLog:Yj,scaleOrdinal:WA,scalePoint:Rh,scalePow:tk,scaleQuantile:Jj,scaleQuantize:tU,scaleRadial:Qj,scaleSequential:cU,scaleSequentialLog:fU,scaleSequentialPow:uk,scaleSequentialQuantile:dU,scaleSequentialSqrt:zet,scaleSequentialSymlog:hU,scaleSqrt:btt,scaleSymlog:Zj,scaleThreshold:eU,scaleTime:Let,scaleUtc:Bet,tickFormat:Hj},Symbol.toStringTag,{value:"Module"}));var mT,_F;function yU(){if(_F)return mT;_F=1;var e=Lc();function t(n,r,i){for(var a=-1,s=n.length;++a<s;){var o=n[a],l=r(o);if(l!=null&&(c===void 0?l===l&&!e(l):i(l,c)))var c=l,h=o}return h}return mT=t,mT}var gT,RF;function Uet(){if(RF)return gT;RF=1;function e(t,n){return t>n}return gT=e,gT}var yT,DF;function Vet(){if(DF)return yT;DF=1;var e=yU(),t=Uet(),n=zc();function r(i){return i&&i.length?e(i,n,t):void 0}return yT=r,yT}var Wet=Vet();const Gv=Be(Wet);var vT,MF;function Get(){if(MF)return vT;MF=1;function e(t,n){return t<n}return vT=e,vT}var bT,PF;function qet(){if(PF)return bT;PF=1;var e=yU(),t=Get(),n=zc();function r(i){return i&&i.length?e(i,n,t):void 0}return bT=r,bT}var Het=qet();const qv=Be(Het);var xT,FF;function Xet(){if(FF)return xT;FF=1;var e=AA(),t=xo(),n=$j(),r=Zr();function i(a,s){var o=r(a)?e:n;return o(a,t(s,3))}return xT=i,xT}var wT,LF;function Ket(){if(LF)return wT;LF=1;var e=Cj(),t=Xet();function n(r,i){return e(t(r,i),1)}return wT=n,wT}var Yet=Ket();const Zet=Be(Yet);var ST,BF;function Qet(){if(BF)return ST;BF=1;var e=BA();function t(n,r){return e(n,r)}return ST=t,ST}var Jet=Qet();const Hv=Be(Jet);var Vc=1e9,tnt={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},hk,Je=!0,Fi="[DecimalError] ",pl=Fi+"Invalid argument: ",fk=Fi+"Exponent out of range: ",Wc=Math.floor,el=Math.pow,ent=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,li,Xn=1e7,Xe=7,vU=9007199254740991,Ey=Wc(vU/Xe),Dt={};Dt.absoluteValue=Dt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Dt.comparedTo=Dt.cmp=function(e){var t,n,r,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(r=a.d.length,i=e.d.length,t=0,n=r<i?r:i;t<n;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return r===i?0:r>i^a.s<0?1:-1};Dt.decimalPlaces=Dt.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Xe;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Dt.dividedBy=Dt.div=function(e){return hs(this,new this.constructor(e))};Dt.dividedToIntegerBy=Dt.idiv=function(e){var t=this,n=t.constructor;return Ve(hs(t,new n(e),0,1),n.precision)};Dt.equals=Dt.eq=function(e){return!this.cmp(e)};Dt.exponent=function(){return kn(this)};Dt.greaterThan=Dt.gt=function(e){return this.cmp(e)>0};Dt.greaterThanOrEqualTo=Dt.gte=function(e){return this.cmp(e)>=0};Dt.isInteger=Dt.isint=function(){return this.e>this.d.length-2};Dt.isNegative=Dt.isneg=function(){return this.s<0};Dt.isPositive=Dt.ispos=function(){return this.s>0};Dt.isZero=function(){return this.s===0};Dt.lessThan=Dt.lt=function(e){return this.cmp(e)<0};Dt.lessThanOrEqualTo=Dt.lte=function(e){return this.cmp(e)<1};Dt.logarithm=Dt.log=function(e){var t,n=this,r=n.constructor,i=r.precision,a=i+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(li))throw Error(Fi+"NaN");if(n.s<1)throw Error(Fi+(n.s?"NaN":"-Infinity"));return n.eq(li)?new r(0):(Je=!1,t=hs(Zh(n,a),Zh(e,a),a),Je=!0,Ve(t,i))};Dt.minus=Dt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?wU(t,e):bU(t,(e.s=-e.s,e))};Dt.modulo=Dt.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(e=new r(e),!e.s)throw Error(Fi+"NaN");return n.s?(Je=!1,t=hs(n,e,0,1).times(e),Je=!0,n.minus(t)):Ve(new r(n),i)};Dt.naturalExponential=Dt.exp=function(){return xU(this)};Dt.naturalLogarithm=Dt.ln=function(){return Zh(this)};Dt.negated=Dt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Dt.plus=Dt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?bU(t,e):wU(t,(e.s=-e.s,e))};Dt.precision=Dt.sd=function(e){var t,n,r,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(pl+e);if(t=kn(i)+1,r=i.d.length-1,n=r*Xe+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};Dt.squareRoot=Dt.sqrt=function(){var e,t,n,r,i,a,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(Fi+"NaN")}for(e=kn(o),Je=!1,i=Math.sqrt(+o),i==0||i==1/0?(t=Ca(o.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=Wc((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new l(t)):r=new l(i.toString()),n=l.precision,i=s=n+3;;)if(a=r,r=a.plus(hs(o,a,s+2)).times(.5),Ca(a.d).slice(0,s)===(t=Ca(r.d)).slice(0,s)){if(t=t.slice(s-3,s+1),i==s&&t=="4999"){if(Ve(a,n+1,0),a.times(a).eq(o)){r=a;break}}else if(t!="9999")break;s+=4}return Je=!0,Ve(r,n)};Dt.times=Dt.mul=function(e){var t,n,r,i,a,s,o,l,c,h=this,d=h.constructor,p=h.d,g=(e=new d(e)).d;if(!h.s||!e.s)return new d(0);for(e.s*=h.s,n=h.e+e.e,l=p.length,c=g.length,l<c&&(a=p,p=g,g=a,s=l,l=c,c=s),a=[],s=l+c,r=s;r--;)a.push(0);for(r=c;--r>=0;){for(t=0,i=l+r;i>r;)o=a[i]+g[r]*p[i-r-1]+t,a[i--]=o%Xn|0,t=o/Xn|0;a[i]=(a[i]+t)%Xn|0}for(;!a[--s];)a.pop();return t?++n:a.shift(),e.d=a,e.e=n,Je?Ve(e,d.precision):e};Dt.toDecimalPlaces=Dt.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(_a(e,0,Vc),t===void 0?t=r.rounding:_a(t,0,8),Ve(n,e+kn(n)+1,t))};Dt.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=xl(r,!0):(_a(e,0,Vc),t===void 0?t=i.rounding:_a(t,0,8),r=Ve(new i(r),e+1,t),n=xl(r,!0,e+1)),n};Dt.toFixed=function(e,t){var n,r,i=this,a=i.constructor;return e===void 0?xl(i):(_a(e,0,Vc),t===void 0?t=a.rounding:_a(t,0,8),r=Ve(new a(i),e+kn(i)+1,t),n=xl(r.abs(),!1,e+kn(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};Dt.toInteger=Dt.toint=function(){var e=this,t=e.constructor;return Ve(new t(e),kn(e)+1,t.rounding)};Dt.toNumber=function(){return+this};Dt.toPower=Dt.pow=function(e){var t,n,r,i,a,s,o=this,l=o.constructor,c=12,h=+(e=new l(e));if(!e.s)return new l(li);if(o=new l(o),!o.s){if(e.s<1)throw Error(Fi+"Infinity");return o}if(o.eq(li))return o;if(r=l.precision,e.eq(li))return Ve(o,r);if(t=e.e,n=e.d.length-1,s=t>=n,a=o.s,s){if((n=h<0?-h:h)<=vU){for(i=new l(li),t=Math.ceil(r/Xe+4),Je=!1;n%2&&(i=i.times(o),jF(i.d,t)),n=Wc(n/2),n!==0;)o=o.times(o),jF(o.d,t);return Je=!0,e.s<0?new l(li).div(i):Ve(i,r)}}else if(a<0)throw Error(Fi+"NaN");return a=a<0&&e.d[Math.max(t,n)]&1?-1:1,o.s=1,Je=!1,i=e.times(Zh(o,r+c)),Je=!0,i=xU(i),i.s=a,i};Dt.toPrecision=function(e,t){var n,r,i=this,a=i.constructor;return e===void 0?(n=kn(i),r=xl(i,n<=a.toExpNeg||n>=a.toExpPos)):(_a(e,1,Vc),t===void 0?t=a.rounding:_a(t,0,8),i=Ve(new a(i),e,t),n=kn(i),r=xl(i,e<=n||n<=a.toExpNeg,e)),r};Dt.toSignificantDigits=Dt.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(_a(e,1,Vc),t===void 0?t=r.rounding:_a(t,0,8)),Ve(new r(n),e,t)};Dt.toString=Dt.valueOf=Dt.val=Dt.toJSON=Dt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=kn(e),n=e.constructor;return xl(e,t<=n.toExpNeg||t>=n.toExpPos)};function bU(e,t){var n,r,i,a,s,o,l,c,h=e.constructor,d=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),Je?Ve(t,d):t;if(l=e.d,c=t.d,s=e.e,i=t.e,l=l.slice(),a=s-i,a){for(a<0?(r=l,a=-a,o=c.length):(r=c,i=s,o=l.length),s=Math.ceil(d/Xe),o=s>o?s+1:o+1,a>o&&(a=o,r.length=1),r.reverse();a--;)r.push(0);r.reverse()}for(o=l.length,a=c.length,o-a<0&&(a=o,r=c,c=l,l=r),n=0;a;)n=(l[--a]=l[a]+c[a]+n)/Xn|0,l[a]%=Xn;for(n&&(l.unshift(n),++i),o=l.length;l[--o]==0;)l.pop();return t.d=l,t.e=i,Je?Ve(t,d):t}function _a(e,t,n){if(e!==~~e||e<t||e>n)throw Error(pl+e)}function Ca(e){var t,n,r,i=e.length-1,a="",s=e[0];if(i>0){for(a+=s,t=1;t<i;t++)r=e[t]+"",n=Xe-r.length,n&&(a+=Js(n)),a+=r;s=e[t],r=s+"",n=Xe-r.length,n&&(a+=Js(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var hs=function(){function e(r,i){var a,s=0,o=r.length;for(r=r.slice();o--;)a=r[o]*i+s,r[o]=a%Xn|0,s=a/Xn|0;return s&&r.unshift(s),r}function t(r,i,a,s){var o,l;if(a!=s)l=a>s?1:-1;else for(o=l=0;o<a;o++)if(r[o]!=i[o]){l=r[o]>i[o]?1:-1;break}return l}function n(r,i,a){for(var s=0;a--;)r[a]-=s,s=r[a]<i[a]?1:0,r[a]=s*Xn+r[a]-i[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,a,s){var o,l,c,h,d,p,g,v,x,b,w,C,T,$,A,E,O,N,_=r.constructor,R=r.s==i.s?1:-1,I=r.d,P=i.d;if(!r.s)return new _(r);if(!i.s)throw Error(Fi+"Division by zero");for(l=r.e-i.e,O=P.length,A=I.length,g=new _(R),v=g.d=[],c=0;P[c]==(I[c]||0);)++c;if(P[c]>(I[c]||0)&&--l,a==null?C=a=_.precision:s?C=a+(kn(r)-kn(i))+1:C=a,C<0)return new _(0);if(C=C/Xe+2|0,c=0,O==1)for(h=0,P=P[0],C++;(c<A||h)&&C--;c++)T=h*Xn+(I[c]||0),v[c]=T/P|0,h=T%P|0;else{for(h=Xn/(P[0]+1)|0,h>1&&(P=e(P,h),I=e(I,h),O=P.length,A=I.length),$=O,x=I.slice(0,O),b=x.length;b<O;)x[b++]=0;N=P.slice(),N.unshift(0),E=P[0],P[1]>=Xn/2&&++E;do h=0,o=t(P,x,O,b),o<0?(w=x[0],O!=b&&(w=w*Xn+(x[1]||0)),h=w/E|0,h>1?(h>=Xn&&(h=Xn-1),d=e(P,h),p=d.length,b=x.length,o=t(d,x,p,b),o==1&&(h--,n(d,O<p?N:P,p))):(h==0&&(o=h=1),d=P.slice()),p=d.length,p<b&&d.unshift(0),n(x,d,b),o==-1&&(b=x.length,o=t(P,x,O,b),o<1&&(h++,n(x,O<b?N:P,b))),b=x.length):o===0&&(h++,x=[0]),v[c++]=h,o&&x[0]?x[b++]=I[$]||0:(x=[I[$]],b=1);while(($++<A||x[0]!==void 0)&&C--)}return v[0]||v.shift(),g.e=l,Ve(g,s?a+kn(g)+1:a)}}();function xU(e,t){var n,r,i,a,s,o,l=0,c=0,h=e.constructor,d=h.precision;if(kn(e)>16)throw Error(fk+kn(e));if(!e.s)return new h(li);for(Je=!1,o=d,s=new h(.03125);e.abs().gte(.1);)e=e.times(s),c+=5;for(r=Math.log(el(2,c))/Math.LN10*2+5|0,o+=r,n=i=a=new h(li),h.precision=o;;){if(i=Ve(i.times(e),o),n=n.times(++l),s=a.plus(hs(i,n,o)),Ca(s.d).slice(0,o)===Ca(a.d).slice(0,o)){for(;c--;)a=Ve(a.times(a),o);return h.precision=d,t==null?(Je=!0,Ve(a,d)):a}a=s}}function kn(e){for(var t=e.e*Xe,n=e.d[0];n>=10;n/=10)t++;return t}function CT(e,t,n){if(t>e.LN10.sd())throw Je=!0,n&&(e.precision=n),Error(Fi+"LN10 precision limit exceeded");return Ve(new e(e.LN10),t)}function Js(e){for(var t="";e--;)t+="0";return t}function Zh(e,t){var n,r,i,a,s,o,l,c,h,d=1,p=10,g=e,v=g.d,x=g.constructor,b=x.precision;if(g.s<1)throw Error(Fi+(g.s?"NaN":"-Infinity"));if(g.eq(li))return new x(0);if(t==null?(Je=!1,c=b):c=t,g.eq(10))return t==null&&(Je=!0),CT(x,c);if(c+=p,x.precision=c,n=Ca(v),r=n.charAt(0),a=kn(g),Math.abs(a)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)g=g.times(e),n=Ca(g.d),r=n.charAt(0),d++;a=kn(g),r>1?(g=new x("0."+n),a++):g=new x(r+"."+n.slice(1))}else return l=CT(x,c+2,b).times(a+""),g=Zh(new x(r+"."+n.slice(1)),c-p).plus(l),x.precision=b,t==null?(Je=!0,Ve(g,b)):g;for(o=s=g=hs(g.minus(li),g.plus(li),c),h=Ve(g.times(g),c),i=3;;){if(s=Ve(s.times(h),c),l=o.plus(hs(s,new x(i),c)),Ca(l.d).slice(0,c)===Ca(o.d).slice(0,c))return o=o.times(2),a!==0&&(o=o.plus(CT(x,c+2,b).times(a+""))),o=hs(o,new x(d),c),x.precision=b,t==null?(Je=!0,Ve(o,b)):o;o=l,i+=2}}function zF(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(r,i),t){if(i-=r,n=n-r-1,e.e=Wc(n/Xe),e.d=[],r=(n+1)%Xe,n<0&&(r+=Xe),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=Xe;r<i;)e.d.push(+t.slice(r,r+=Xe));t=t.slice(r),r=Xe-t.length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),Je&&(e.e>Ey||e.e<-Ey))throw Error(fk+n)}else e.s=0,e.e=0,e.d=[0];return e}function Ve(e,t,n){var r,i,a,s,o,l,c,h,d=e.d;for(s=1,a=d[0];a>=10;a/=10)s++;if(r=t-s,r<0)r+=Xe,i=t,c=d[h=0];else{if(h=Math.ceil((r+1)/Xe),a=d.length,h>=a)return e;for(c=a=d[h],s=1;a>=10;a/=10)s++;r%=Xe,i=r-Xe+s}if(n!==void 0&&(a=el(10,s-i-1),o=c/a%10|0,l=t<0||d[h+1]!==void 0||c%a,l=n<4?(o||l)&&(n==0||n==(e.s<0?3:2)):o>5||o==5&&(n==4||l||n==6&&(r>0?i>0?c/el(10,s-i):0:d[h-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return l?(a=kn(e),d.length=1,t=t-a-1,d[0]=el(10,(Xe-t%Xe)%Xe),e.e=Wc(-t/Xe)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=h,a=1,h--):(d.length=h+1,a=el(10,Xe-r),d[h]=i>0?(c/el(10,s-i)%el(10,i)|0)*a:0),l)for(;;)if(h==0){(d[0]+=a)==Xn&&(d[0]=1,++e.e);break}else{if(d[h]+=a,d[h]!=Xn)break;d[h--]=0,a=1}for(r=d.length;d[--r]===0;)d.pop();if(Je&&(e.e>Ey||e.e<-Ey))throw Error(fk+kn(e));return e}function wU(e,t){var n,r,i,a,s,o,l,c,h,d,p=e.constructor,g=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Je?Ve(t,g):t;if(l=e.d,d=t.d,r=t.e,c=e.e,l=l.slice(),s=c-r,s){for(h=s<0,h?(n=l,s=-s,o=d.length):(n=d,r=c,o=l.length),i=Math.max(Math.ceil(g/Xe),o)+2,s>i&&(s=i,n.length=1),n.reverse(),i=s;i--;)n.push(0);n.reverse()}else{for(i=l.length,o=d.length,h=i<o,h&&(o=i),i=0;i<o;i++)if(l[i]!=d[i]){h=l[i]<d[i];break}s=0}for(h&&(n=l,l=d,d=n,t.s=-t.s),o=l.length,i=d.length-o;i>0;--i)l[o++]=0;for(i=d.length;i>s;){if(l[--i]<d[i]){for(a=i;a&&l[--a]===0;)l[a]=Xn-1;--l[a],l[i]+=Xn}l[i]-=d[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(t.d=l,t.e=r,Je?Ve(t,g):t):new p(0)}function xl(e,t,n){var r,i=kn(e),a=Ca(e.d),s=a.length;return t?(n&&(r=n-s)>0?a=a.charAt(0)+"."+a.slice(1)+Js(r):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Js(-i-1)+a,n&&(r=n-s)>0&&(a+=Js(r))):i>=s?(a+=Js(i+1-s),n&&(r=n-i-1)>0&&(a=a+"."+Js(r))):((r=i+1)<s&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(a+="."),a+=Js(r))),e.s<0?"-"+a:a}function jF(e,t){if(e.length>t)return e.length=t,!0}function SU(e){var t,n,r;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(pl+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return zF(s,a.toString())}else if(typeof a!="string")throw Error(pl+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,ent.test(a))zF(s,a);else throw Error(pl+a)}if(i.prototype=Dt,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=SU,i.config=i.set=nnt,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function nnt(e){if(!e||typeof e!="object")throw Error(Fi+"Object expected");var t,n,r,i=["precision",1,Vc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((r=e[n=i[t]])!==void 0)if(Wc(r)===r&&r>=i[t+1]&&r<=i[t+2])this[n]=r;else throw Error(pl+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(pl+n+": "+r);return this}var hk=SU(tnt);li=new hk(1);const Fe=hk;function rnt(e){return ont(e)||snt(e)||ant(e)||int()}function int(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ant(e,t){if(e){if(typeof e=="string")return q$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q$(e,t)}}function snt(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function ont(e){if(Array.isArray(e))return q$(e)}function q$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lnt=function(t){return t},CU={},TU=function(t){return t===CU},UF=function(t){return function n(){return arguments.length===0||arguments.length===1&&TU(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},unt=function e(t,n){return t===1?n:UF(function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var s=i.filter(function(o){return o!==CU}).length;return s>=t?n.apply(void 0,i):e(t-s,UF(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var h=i.map(function(d){return TU(d)?l.shift():d});return n.apply(void 0,rnt(h).concat(l))}))})},Xv=function(t){return unt(t.length,t)},H$=function(t,n){for(var r=[],i=t;i<n;++i)r[i-t]=i;return r},cnt=Xv(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),fnt=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return lnt;var i=n.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce(function(o,l){return l(o)},a.apply(void 0,arguments))}},X$=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},$U=function(t){var n=null,r=null;return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n&&a.every(function(o,l){return o===n[l]})||(n=a,r=t.apply(void 0,a)),r}};function hnt(e){var t;return e===0?t=1:t=Math.floor(new Fe(e).abs().log(10).toNumber())+1,t}function dnt(e,t,n){for(var r=new Fe(e),i=0,a=[];r.lt(t)&&i<1e5;)a.push(r.toNumber()),r=r.add(n),i++;return a}var pnt=Xv(function(e,t,n){var r=+e,i=+t;return r+n*(i-r)}),mnt=Xv(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),gnt=Xv(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const Kv={rangeStep:dnt,getDigitCount:hnt,interpolateNumber:pnt,uninterpolateNumber:mnt,uninterpolateTruncation:gnt};function K$(e){return bnt(e)||vnt(e)||AU(e)||ynt()}function ynt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vnt(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function bnt(e){if(Array.isArray(e))return Y$(e)}function Qh(e,t){return Snt(e)||wnt(e,t)||AU(e,t)||xnt()}function xnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AU(e,t){if(e){if(typeof e=="string")return Y$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y$(e,t)}}function Y$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wnt(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,i=!1,a=void 0;try{for(var s=e[Symbol.iterator](),o;!(r=(o=s.next()).done)&&(n.push(o.value),!(t&&n.length===t));r=!0);}catch(l){i=!0,a=l}finally{try{!r&&s.return!=null&&s.return()}finally{if(i)throw a}}return n}}function Snt(e){if(Array.isArray(e))return e}function kU(e){var t=Qh(e,2),n=t[0],r=t[1],i=n,a=r;return n>r&&(i=r,a=n),[i,a]}function EU(e,t,n){if(e.lte(0))return new Fe(0);var r=Kv.getDigitCount(e.toNumber()),i=new Fe(10).pow(r),a=e.div(i),s=r!==1?.05:.1,o=new Fe(Math.ceil(a.div(s).toNumber())).add(n).mul(s),l=o.mul(i);return t?l:new Fe(Math.ceil(l))}function Cnt(e,t,n){var r=1,i=new Fe(e);if(!i.isint()&&n){var a=Math.abs(e);a<1?(r=new Fe(10).pow(Kv.getDigitCount(e)-1),i=new Fe(Math.floor(i.div(r).toNumber())).mul(r)):a>1&&(i=new Fe(Math.floor(e)))}else e===0?i=new Fe(Math.floor((t-1)/2)):n||(i=new Fe(Math.floor(e)));var s=Math.floor((t-1)/2),o=fnt(cnt(function(l){return i.add(new Fe(l-s).mul(r)).toNumber()}),H$);return o(0,t)}function IU(e,t,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new Fe(0),tickMin:new Fe(0),tickMax:new Fe(0)};var a=EU(new Fe(t).sub(e).div(n-1),r,i),s;e<=0&&t>=0?s=new Fe(0):(s=new Fe(e).add(t).div(2),s=s.sub(new Fe(s).mod(a)));var o=Math.ceil(s.sub(e).div(a).toNumber()),l=Math.ceil(new Fe(t).sub(s).div(a).toNumber()),c=o+l+1;return c>n?IU(e,t,n,r,i+1):(c<n&&(l=t>0?l+(n-c):l,o=t>0?o:o+(n-c)),{step:a,tickMin:s.sub(new Fe(o).mul(a)),tickMax:s.add(new Fe(l).mul(a))})}function Tnt(e){var t=Qh(e,2),n=t[0],r=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(i,2),o=kU([n,r]),l=Qh(o,2),c=l[0],h=l[1];if(c===-1/0||h===1/0){var d=h===1/0?[c].concat(K$(H$(0,i-1).map(function(){return 1/0}))):[].concat(K$(H$(0,i-1).map(function(){return-1/0})),[h]);return n>r?X$(d):d}if(c===h)return Cnt(c,i,a);var p=IU(c,h,s,a),g=p.step,v=p.tickMin,x=p.tickMax,b=Kv.rangeStep(v,x.add(new Fe(.1).mul(g)),g);return n>r?X$(b):b}function $nt(e,t){var n=Qh(e,2),r=n[0],i=n[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=kU([r,i]),o=Qh(s,2),l=o[0],c=o[1];if(l===-1/0||c===1/0)return[r,i];if(l===c)return[l];var h=Math.max(t,2),d=EU(new Fe(c).sub(l).div(h-1),a,0),p=[].concat(K$(Kv.rangeStep(new Fe(l),new Fe(c).sub(new Fe(.99).mul(d)),d)),[c]);return r>i?X$(p):p}var Ant=$U(Tnt),knt=$U($nt),Ent="Invariant failed";function wl(e,t){throw new Error(Ent)}var Int=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function dc(e){"@babel/helpers - typeof";return dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dc(e)}function Iy(){return Iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Iy.apply(this,arguments)}function Ont(e,t){return Dnt(e)||Rnt(e,t)||_nt(e,t)||Nnt()}function Nnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nt(e,t){if(e){if(typeof e=="string")return VF(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VF(e,t)}}function VF(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rnt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function Dnt(e){if(Array.isArray(e))return e}function Mnt(e,t){if(e==null)return{};var n=Pnt(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pnt(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Fnt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lnt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_U(r.key),r)}}function Bnt(e,t,n){return t&&Lnt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function znt(e,t,n){return t=Oy(t),jnt(e,OU()?Reflect.construct(t,n||[],Oy(e).constructor):t.apply(e,n))}function jnt(e,t){if(t&&(dc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Unt(e)}function Unt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OU=function(){return!!e})()}function Oy(e){return Oy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Oy(e)}function Vnt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z$(e,t)}function Z$(e,t){return Z$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Z$(e,t)}function NU(e,t,n){return t=_U(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _U(e){var t=Wnt(e,"string");return dc(t)=="symbol"?t:t+""}function Wnt(e,t){if(dc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(dc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ud=function(e){function t(){return Fnt(this,t),znt(this,t,arguments)}return Vnt(t,e),Bnt(t,[{key:"render",value:function(){var r=this.props,i=r.offset,a=r.layout,s=r.width,o=r.dataKey,l=r.data,c=r.dataPointFormatter,h=r.xAxis,d=r.yAxis,p=Mnt(r,Int),g=pe(p,!1);this.props.direction==="x"&&h.type!=="number"&&wl();var v=l.map(function(x){var b=c(x,o),w=b.x,C=b.y,T=b.value,$=b.errorVal;if(!$)return null;var A=[],E,O;if(Array.isArray($)){var N=Ont($,2);E=N[0],O=N[1]}else E=O=$;if(a==="vertical"){var _=h.scale,R=C+i,I=R+s,P=R-s,B=_(T-E),V=_(T+O);A.push({x1:V,y1:I,x2:V,y2:P}),A.push({x1:B,y1:R,x2:V,y2:R}),A.push({x1:B,y1:I,x2:B,y2:P})}else if(a==="horizontal"){var z=d.scale,M=w+i,U=M-s,W=M+s,q=z(T-E),F=z(T+O);A.push({x1:U,y1:F,x2:W,y2:F}),A.push({x1:M,y1:q,x2:M,y2:F}),A.push({x1:U,y1:q,x2:W,y2:q})}return et.createElement(yn,Iy({className:"recharts-errorBar",key:"bar-".concat(A.map(function(G){return"".concat(G.x1,"-").concat(G.x2,"-").concat(G.y1,"-").concat(G.y2)}))},g),A.map(function(G){return et.createElement("line",Iy({},G,{key:"line-".concat(G.x1,"-").concat(G.x2,"-").concat(G.y1,"-").concat(G.y2)}))}))});return et.createElement(yn,{className:"recharts-errorBars"},v)}}])}(et.Component);NU(Ud,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});NU(Ud,"displayName","ErrorBar");function Jh(e){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jh(e)}function WF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Zo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WF(Object(n),!0).forEach(function(r){Gnt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WF(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Gnt(e,t,n){return t=qnt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qnt(e){var t=Hnt(e,"string");return Jh(t)=="symbol"?t:t+""}function Hnt(e,t){if(Jh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Jh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RU=function(t){var n=t.children,r=t.formattedGraphicalItems,i=t.legendWidth,a=t.legendContent,s=oi(n,Yu);if(!s)return null;var o=Yu.defaultProps,l=o!==void 0?Zo(Zo({},o),s.props):{},c;return s.props&&s.props.payload?c=s.props&&s.props.payload:a==="children"?c=(r||[]).reduce(function(h,d){var p=d.item,g=d.props,v=g.sectors||g.data||[];return h.concat(v.map(function(x){return{type:s.props.iconType||p.props.legendType,value:x.name,color:x.fill,payload:x}}))},[]):c=(r||[]).map(function(h){var d=h.item,p=d.type.defaultProps,g=p!==void 0?Zo(Zo({},p),d.props):{},v=g.dataKey,x=g.name,b=g.legendType,w=g.hide;return{inactive:w,dataKey:v,type:l.iconType||b||"square",color:dk(d),value:x||v,payload:g}}),Zo(Zo(Zo({},l),Yu.getWithHeight(s,i)),{},{payload:c,item:s})};function td(e){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},td(e)}function GF(e){return Znt(e)||Ynt(e)||Knt(e)||Xnt()}function Xnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Knt(e,t){if(e){if(typeof e=="string")return Q$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q$(e,t)}}function Ynt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Znt(e){if(Array.isArray(e))return Q$(e)}function Q$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qF(Object(n),!0).forEach(function(r){Qu(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qF(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Qu(e,t,n){return t=Qnt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qnt(e){var t=Jnt(e,"string");return td(t)=="symbol"?t:t+""}function Jnt(e,t){if(td(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(td(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hi(e,t,n){return he(e)||he(t)?n:zn(t)?Di(e,t,n):se(t)?t(e):n}function Dh(e,t,n,r){var i=Zet(e,function(o){return hi(o,t)});if(n==="number"){var a=i.filter(function(o){return Ot(o)||parseFloat(o)});return a.length?[qv(a),Gv(a)]:[1/0,-1/0]}var s=r?i.filter(function(o){return!he(o)}):i;return s.map(function(o){return zn(o)||o instanceof Date?o:""})}var trt=function(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=-1,o=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(o<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var l=a.range,c=0;c<o;c++){var h=c>0?i[c-1].coordinate:i[o-1].coordinate,d=i[c].coordinate,p=c>=o-1?i[0].coordinate:i[c+1].coordinate,g=void 0;if(ra(d-h)!==ra(p-d)){var v=[];if(ra(p-d)===ra(l[1]-l[0])){g=p;var x=d+l[1]-l[0];v[0]=Math.min(x,(x+h)/2),v[1]=Math.max(x,(x+h)/2)}else{g=h;var b=p+l[1]-l[0];v[0]=Math.min(d,(b+d)/2),v[1]=Math.max(d,(b+d)/2)}var w=[Math.min(d,(g+d)/2),Math.max(d,(g+d)/2)];if(t>w[0]&&t<=w[1]||t>=v[0]&&t<=v[1]){s=i[c].index;break}}else{var C=Math.min(h,p),T=Math.max(h,p);if(t>(C+d)/2&&t<=(T+d)/2){s=i[c].index;break}}}else for(var $=0;$<o;$++)if($===0&&t<=(r[$].coordinate+r[$+1].coordinate)/2||$>0&&$<o-1&&t>(r[$].coordinate+r[$-1].coordinate)/2&&t<=(r[$].coordinate+r[$+1].coordinate)/2||$===o-1&&t>(r[$].coordinate+r[$-1].coordinate)/2){s=r[$].index;break}return s},dk=function(t){var n,r=t,i=r.type.displayName,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?ln(ln({},t.type.defaultProps),t.props):t.props,s=a.stroke,o=a.fill,l;switch(i){case"Line":l=s;break;case"Area":case"Radar":l=s&&s!=="none"?s:o;break;default:l=o;break}return l},ert=function(t){var n=t.barSize,r=t.totalSize,i=t.stackGroups,a=i===void 0?{}:i;if(!a)return{};for(var s={},o=Object.keys(a),l=0,c=o.length;l<c;l++)for(var h=a[o[l]].stackGroups,d=Object.keys(h),p=0,g=d.length;p<g;p++){var v=h[d[p]],x=v.items,b=v.cateAxisId,w=x.filter(function(O){return cs(O.type).indexOf("Bar")>=0});if(w&&w.length){var C=w[0].type.defaultProps,T=C!==void 0?ln(ln({},C),w[0].props):w[0].props,$=T.barSize,A=T[b];s[A]||(s[A]=[]);var E=he($)?n:$;s[A].push({item:w[0],stackList:w.slice(1),barSize:he(E)?void 0:bl(E,r,0)})}}return s},nrt=function(t){var n=t.barGap,r=t.barCategoryGap,i=t.bandSize,a=t.sizeList,s=a===void 0?[]:a,o=t.maxBarSize,l=s.length;if(l<1)return null;var c=bl(n,i,0,!0),h,d=[];if(s[0].barSize===+s[0].barSize){var p=!1,g=i/l,v=s.reduce(function($,A){return $+A.barSize||0},0);v+=(l-1)*c,v>=i&&(v-=(l-1)*c,c=0),v>=i&&g>0&&(p=!0,g*=.9,v=l*g);var x=(i-v)/2>>0,b={offset:x-c,size:0};h=s.reduce(function($,A){var E={item:A.item,position:{offset:b.offset+b.size+c,size:p?g:A.barSize}},O=[].concat(GF($),[E]);return b=O[O.length-1].position,A.stackList&&A.stackList.length&&A.stackList.forEach(function(N){O.push({item:N,position:b})}),O},d)}else{var w=bl(r,i,0,!0);i-2*w-(l-1)*c<=0&&(c=0);var C=(i-2*w-(l-1)*c)/l;C>1&&(C>>=0);var T=o===+o?Math.min(C,o):C;h=s.reduce(function($,A,E){var O=[].concat(GF($),[{item:A.item,position:{offset:w+(C+c)*E+(C-T)/2,size:T}}]);return A.stackList&&A.stackList.length&&A.stackList.forEach(function(N){O.push({item:N,position:O[O.length-1].position})}),O},d)}return h},rrt=function(t,n,r,i){var a=r.children,s=r.width,o=r.margin,l=s-(o.left||0)-(o.right||0),c=RU({children:a,legendWidth:l});if(c){var h=i||{},d=h.width,p=h.height,g=c.align,v=c.verticalAlign,x=c.layout;if((x==="vertical"||x==="horizontal"&&v==="middle")&&g!=="center"&&Ot(t[g]))return ln(ln({},t),{},Qu({},g,t[g]+(d||0)));if((x==="horizontal"||x==="vertical"&&g==="center")&&v!=="middle"&&Ot(t[v]))return ln(ln({},t),{},Qu({},v,t[v]+(p||0)))}return t},irt=function(t,n,r){return he(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},DU=function(t,n,r,i,a){var s=n.props.children,o=Mi(s,Ud).filter(function(c){return irt(i,a,c.props.direction)});if(o&&o.length){var l=o.map(function(c){return c.props.dataKey});return t.reduce(function(c,h){var d=hi(h,r);if(he(d))return c;var p=Array.isArray(d)?[qv(d),Gv(d)]:[d,d],g=l.reduce(function(v,x){var b=hi(h,x,0),w=p[0]-Math.abs(Array.isArray(b)?b[0]:b),C=p[1]+Math.abs(Array.isArray(b)?b[1]:b);return[Math.min(w,v[0]),Math.max(C,v[1])]},[1/0,-1/0]);return[Math.min(g[0],c[0]),Math.max(g[1],c[1])]},[1/0,-1/0])}return null},art=function(t,n,r,i,a){var s=n.map(function(o){return DU(t,o,r,a,i)}).filter(function(o){return!he(o)});return s&&s.length?s.reduce(function(o,l){return[Math.min(o[0],l[0]),Math.max(o[1],l[1])]},[1/0,-1/0]):null},MU=function(t,n,r,i,a){var s=n.map(function(l){var c=l.props.dataKey;return r==="number"&&c&&DU(t,l,c,i)||Dh(t,c,r,a)});if(r==="number")return s.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]);var o={};return s.reduce(function(l,c){for(var h=0,d=c.length;h<d;h++)o[c[h]]||(o[c[h]]=!0,l.push(c[h]));return l},[])},PU=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},FU=function(t,n,r,i){if(i)return t.map(function(l){return l.coordinate});var a,s,o=t.map(function(l){return l.coordinate===n&&(a=!0),l.coordinate===r&&(s=!0),l.coordinate});return a||o.push(n),s||o.push(r),o},ls=function(t,n,r){if(!t)return null;var i=t.scale,a=t.duplicateDomain,s=t.type,o=t.range,l=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,c=(n||r)&&s==="category"&&i.bandwidth?i.bandwidth()/l:0;if(c=t.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?ra(o[0]-o[1])*2*c:c,n&&(t.ticks||t.niceTicks)){var h=(t.ticks||t.niceTicks).map(function(d){var p=a?a.indexOf(d):d;return{coordinate:i(p)+c,value:d,offset:c}});return h.filter(function(d){return!Md(d.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(d,p){return{coordinate:i(d)+c,value:d,index:p,offset:c}}):i.ticks&&!r?i.ticks(t.tickCount).map(function(d){return{coordinate:i(d)+c,value:d,offset:c}}):i.domain().map(function(d,p){return{coordinate:i(d)+c,value:a?a[d]:d,index:p,offset:c}})},TT=new WeakMap,Og=function(t,n){if(typeof n!="function")return t;TT.has(t)||TT.set(t,new WeakMap);var r=TT.get(t);if(r.has(n))return r.get(n);var i=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,i),i},srt=function(t,n,r){var i=t.scale,a=t.type,s=t.layout,o=t.axisType;if(i==="auto")return s==="radial"&&o==="radiusAxis"?{scale:qh(),realScaleType:"band"}:s==="radial"&&o==="angleAxis"?{scale:Ty(),realScaleType:"linear"}:a==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:Rh(),realScaleType:"point"}:a==="category"?{scale:qh(),realScaleType:"band"}:{scale:Ty(),realScaleType:"linear"};if(vl(i)){var l="scale".concat(_v(i));return{scale:(NF[l]||Rh)(),realScaleType:NF[l]?l:"point"}}return se(i)?{scale:i}:{scale:Rh(),realScaleType:"point"}},HF=1e-4,ort=function(t){var n=t.domain();if(!(!n||n.length<=2)){var r=n.length,i=t.range(),a=Math.min(i[0],i[1])-HF,s=Math.max(i[0],i[1])+HF,o=t(n[0]),l=t(n[r-1]);(o<a||o>s||l<a||l>s)&&t.domain([n[0],n[r-1]])}},lrt=function(t,n){if(!t)return null;for(var r=0,i=t.length;r<i;r++)if(t[r].item===n)return t[r].position;return null},urt=function(t,n){if(!n||n.length!==2||!Ot(n[0])||!Ot(n[1]))return t;var r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]),a=[t[0],t[1]];return(!Ot(t[0])||t[0]<r)&&(a[0]=r),(!Ot(t[1])||t[1]>i)&&(a[1]=i),a[0]>i&&(a[0]=i),a[1]<r&&(a[1]=r),a},crt=function(t){var n=t.length;if(!(n<=0))for(var r=0,i=t[0].length;r<i;++r)for(var a=0,s=0,o=0;o<n;++o){var l=Md(t[o][r][1])?t[o][r][0]:t[o][r][1];l>=0?(t[o][r][0]=a,t[o][r][1]=a+l,a=t[o][r][1]):(t[o][r][0]=s,t[o][r][1]=s+l,s=t[o][r][1])}},frt=function(t){var n=t.length;if(!(n<=0))for(var r=0,i=t[0].length;r<i;++r)for(var a=0,s=0;s<n;++s){var o=Md(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1]):(t[s][r][0]=0,t[s][r][1]=0)}},hrt={sign:crt,expand:q9,none:ac,silhouette:H9,wiggle:X9,positive:frt},drt=function(t,n,r){var i=n.map(function(o){return o.props.dataKey}),a=hrt[r],s=G9().keys(i).value(function(o,l){return+hi(o,l,0)}).order(E$).offset(a);return s(t)},prt=function(t,n,r,i,a,s){if(!t)return null;var o=s?n.reverse():n,l={},c=o.reduce(function(d,p){var g,v=(g=p.type)!==null&&g!==void 0&&g.defaultProps?ln(ln({},p.type.defaultProps),p.props):p.props,x=v.stackId,b=v.hide;if(b)return d;var w=v[r],C=d[w]||{hasStack:!1,stackGroups:{}};if(zn(x)){var T=C.stackGroups[x]||{numericAxisId:r,cateAxisId:i,items:[]};T.items.push(p),C.hasStack=!0,C.stackGroups[x]=T}else C.stackGroups[Pd("_stackId_")]={numericAxisId:r,cateAxisId:i,items:[p]};return ln(ln({},d),{},Qu({},w,C))},l),h={};return Object.keys(c).reduce(function(d,p){var g=c[p];if(g.hasStack){var v={};g.stackGroups=Object.keys(g.stackGroups).reduce(function(x,b){var w=g.stackGroups[b];return ln(ln({},x),{},Qu({},b,{numericAxisId:r,cateAxisId:i,items:w.items,stackedData:drt(t,w.items,a)}))},v)}return ln(ln({},d),{},Qu({},p,g))},h)},mrt=function(t,n){var r=n.realScaleType,i=n.type,a=n.tickCount,s=n.originalDomain,o=n.allowDecimals,l=r||n.scale;if(l!=="auto"&&l!=="linear")return null;if(a&&i==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var c=t.domain();if(!c.length)return null;var h=Ant(c,a,o);return t.domain([qv(h),Gv(h)]),{niceTicks:h}}if(a&&i==="number"){var d=t.domain(),p=knt(d,a,o);return{niceTicks:p}}return null};function XF(e){var t=e.axis,n=e.ticks,r=e.bandSize,i=e.entry,a=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!he(i[t.dataKey])){var o=iy(n,"value",i[t.dataKey]);if(o)return o.coordinate+r/2}return n[a]?n[a].coordinate+r/2:null}var l=hi(i,he(s)?t.dataKey:s);return he(l)?null:t.scale(l)}var KF=function(t){var n=t.axis,r=t.ticks,i=t.offset,a=t.bandSize,s=t.entry,o=t.index;if(n.type==="category")return r[o]?r[o].coordinate+i:null;var l=hi(s,n.dataKey,n.domain[o]);return he(l)?null:n.scale(l)-a/2+i},grt=function(t){var n=t.numericAxis,r=n.scale.domain();if(n.type==="number"){var i=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return i<=0&&a>=0?0:a<0?a:i}return r[0]},yrt=function(t,n){var r,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?ln(ln({},t.type.defaultProps),t.props):t.props,a=i.stackId;if(zn(a)){var s=n[a];if(s){var o=s.items.indexOf(t);return o>=0?s.stackedData[o]:null}}return null},vrt=function(t){return t.reduce(function(n,r){return[qv(r.concat([n[0]]).filter(Ot)),Gv(r.concat([n[1]]).filter(Ot))]},[1/0,-1/0])},LU=function(t,n,r){return Object.keys(t).reduce(function(i,a){var s=t[a],o=s.stackedData,l=o.reduce(function(c,h){var d=vrt(h.slice(n,r+1));return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},YF=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ZF=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,J$=function(t,n,r){if(se(t))return t(n,r);if(!Array.isArray(t))return n;var i=[];if(Ot(t[0]))i[0]=r?t[0]:Math.min(t[0],n[0]);else if(YF.test(t[0])){var a=+YF.exec(t[0])[1];i[0]=n[0]-a}else se(t[0])?i[0]=t[0](n[0]):i[0]=n[0];if(Ot(t[1]))i[1]=r?t[1]:Math.max(t[1],n[1]);else if(ZF.test(t[1])){var s=+ZF.exec(t[1])[1];i[1]=n[1]+s}else se(t[1])?i[1]=t[1](n[1]):i[1]=n[1];return i},Ny=function(t,n,r){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!r||i>0)return i}if(t&&n&&n.length>=2){for(var a=jA(n,function(d){return d.coordinate}),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],h=a[o-1];s=Math.min((c.coordinate||0)-(h.coordinate||0),s)}return s===1/0?0:s}return r?void 0:0},QF=function(t,n,r){return!t||!t.length||Hv(t,Di(r,"type.defaultProps.domain"))?n:t},BU=function(t,n){var r=t.type.defaultProps?ln(ln({},t.type.defaultProps),t.props):t.props,i=r.dataKey,a=r.name,s=r.unit,o=r.formatter,l=r.tooltipType,c=r.chartType,h=r.hide;return ln(ln({},pe(t,!1)),{},{dataKey:i,unit:s,formatter:o,name:a||i,color:dk(t),value:hi(n,i),type:l,payload:n,chartType:c,hide:h})};function ed(e){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ed(e)}function JF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function tL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JF(Object(n),!0).forEach(function(r){brt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JF(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function brt(e,t,n){return t=xrt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xrt(e){var t=wrt(e,"string");return ed(t)=="symbol"?t:t+""}function wrt(e,t){if(ed(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ed(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _y=Math.PI/180,Srt=function(t){return t*180/Math.PI},or=function(t,n,r,i){return{x:t+Math.cos(-_y*i)*r,y:n+Math.sin(-_y*i)*r}},Crt=function(t,n){var r=t.x,i=t.y,a=n.x,s=n.y;return Math.sqrt(Math.pow(r-a,2)+Math.pow(i-s,2))},Trt=function(t,n){var r=t.x,i=t.y,a=n.cx,s=n.cy,o=Crt({x:r,y:i},{x:a,y:s});if(o<=0)return{radius:o};var l=(r-a)/o,c=Math.acos(l);return i>s&&(c=2*Math.PI-c),{radius:o,angle:Srt(c),angleInRadian:c}},$rt=function(t){var n=t.startAngle,r=t.endAngle,i=Math.floor(n/360),a=Math.floor(r/360),s=Math.min(i,a);return{startAngle:n-s*360,endAngle:r-s*360}},Art=function(t,n){var r=n.startAngle,i=n.endAngle,a=Math.floor(r/360),s=Math.floor(i/360),o=Math.min(a,s);return t+o*360},eL=function(t,n){var r=t.x,i=t.y,a=Trt({x:r,y:i},n),s=a.radius,o=a.angle,l=n.innerRadius,c=n.outerRadius;if(s<l||s>c)return!1;if(s===0)return!0;var h=$rt(n),d=h.startAngle,p=h.endAngle,g=o,v;if(d<=p){for(;g>p;)g-=360;for(;g<d;)g+=360;v=g>=d&&g<=p}else{for(;g>d;)g-=360;for(;g<p;)g+=360;v=g>=p&&g<=d}return v?tL(tL({},n),{},{radius:s,angle:Art(g,n)}):null};function nd(e){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nd(e)}var krt=["offset"];function Ert(e){return _rt(e)||Nrt(e)||Ort(e)||Irt()}function Irt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ort(e,t){if(e){if(typeof e=="string")return t2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t2(e,t)}}function Nrt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _rt(e){if(Array.isArray(e))return t2(e)}function t2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rrt(e,t){if(e==null)return{};var n=Drt(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Drt(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function nL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Fn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nL(Object(n),!0).forEach(function(r){Mrt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Mrt(e,t,n){return t=Prt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Prt(e){var t=Frt(e,"string");return nd(t)=="symbol"?t:t+""}function Frt(e,t){if(nd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(nd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rd(){return rd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rd.apply(this,arguments)}var Lrt=function(t){var n=t.value,r=t.formatter,i=he(t.children)?n:t.children;return se(r)?r(i):i},Brt=function(t,n){var r=ra(n-t),i=Math.min(Math.abs(n-t),360);return r*i},zrt=function(t,n,r){var i=t.position,a=t.viewBox,s=t.offset,o=t.className,l=a,c=l.cx,h=l.cy,d=l.innerRadius,p=l.outerRadius,g=l.startAngle,v=l.endAngle,x=l.clockWise,b=(d+p)/2,w=Brt(g,v),C=w>=0?1:-1,T,$;i==="insideStart"?(T=g+C*s,$=x):i==="insideEnd"?(T=v-C*s,$=!x):i==="end"&&(T=v+C*s,$=x),$=w<=0?$:!$;var A=or(c,h,b,T),E=or(c,h,b,T+($?1:-1)*359),O="M".concat(A.x,",").concat(A.y,`
    A`).concat(b,",").concat(b,",0,1,").concat($?0:1,`,
    `).concat(E.x,",").concat(E.y),N=he(t.id)?Pd("recharts-radial-line-"):t.id;return et.createElement("text",rd({},r,{dominantBaseline:"central",className:Ce("recharts-radial-bar-label",o)}),et.createElement("defs",null,et.createElement("path",{id:N,d:O})),et.createElement("textPath",{xlinkHref:"#".concat(N)},n))},jrt=function(t){var n=t.viewBox,r=t.offset,i=t.position,a=n,s=a.cx,o=a.cy,l=a.innerRadius,c=a.outerRadius,h=a.startAngle,d=a.endAngle,p=(h+d)/2;if(i==="outside"){var g=or(s,o,c+r,p),v=g.x,x=g.y;return{x:v,y:x,textAnchor:v>=s?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"end"};var b=(l+c)/2,w=or(s,o,b,p),C=w.x,T=w.y;return{x:C,y:T,textAnchor:"middle",verticalAnchor:"middle"}},Urt=function(t){var n=t.viewBox,r=t.parentViewBox,i=t.offset,a=t.position,s=n,o=s.x,l=s.y,c=s.width,h=s.height,d=h>=0?1:-1,p=d*i,g=d>0?"end":"start",v=d>0?"start":"end",x=c>=0?1:-1,b=x*i,w=x>0?"end":"start",C=x>0?"start":"end";if(a==="top"){var T={x:o+c/2,y:l-d*i,textAnchor:"middle",verticalAnchor:g};return Fn(Fn({},T),r?{height:Math.max(l-r.y,0),width:c}:{})}if(a==="bottom"){var $={x:o+c/2,y:l+h+p,textAnchor:"middle",verticalAnchor:v};return Fn(Fn({},$),r?{height:Math.max(r.y+r.height-(l+h),0),width:c}:{})}if(a==="left"){var A={x:o-b,y:l+h/2,textAnchor:w,verticalAnchor:"middle"};return Fn(Fn({},A),r?{width:Math.max(A.x-r.x,0),height:h}:{})}if(a==="right"){var E={x:o+c+b,y:l+h/2,textAnchor:C,verticalAnchor:"middle"};return Fn(Fn({},E),r?{width:Math.max(r.x+r.width-E.x,0),height:h}:{})}var O=r?{width:c,height:h}:{};return a==="insideLeft"?Fn({x:o+b,y:l+h/2,textAnchor:C,verticalAnchor:"middle"},O):a==="insideRight"?Fn({x:o+c-b,y:l+h/2,textAnchor:w,verticalAnchor:"middle"},O):a==="insideTop"?Fn({x:o+c/2,y:l+p,textAnchor:"middle",verticalAnchor:v},O):a==="insideBottom"?Fn({x:o+c/2,y:l+h-p,textAnchor:"middle",verticalAnchor:g},O):a==="insideTopLeft"?Fn({x:o+b,y:l+p,textAnchor:C,verticalAnchor:v},O):a==="insideTopRight"?Fn({x:o+c-b,y:l+p,textAnchor:w,verticalAnchor:v},O):a==="insideBottomLeft"?Fn({x:o+b,y:l+h-p,textAnchor:C,verticalAnchor:g},O):a==="insideBottomRight"?Fn({x:o+c-b,y:l+h-p,textAnchor:w,verticalAnchor:g},O):Bc(a)&&(Ot(a.x)||ol(a.x))&&(Ot(a.y)||ol(a.y))?Fn({x:o+bl(a.x,c),y:l+bl(a.y,h),textAnchor:"end",verticalAnchor:"end"},O):Fn({x:o+c/2,y:l+h/2,textAnchor:"middle",verticalAnchor:"middle"},O)},Vrt=function(t){return"cx"in t&&Ot(t.cx)};function br(e){var t=e.offset,n=t===void 0?5:t,r=Rrt(e,krt),i=Fn({offset:n},r),a=i.viewBox,s=i.position,o=i.value,l=i.children,c=i.content,h=i.className,d=h===void 0?"":h,p=i.textBreakAll;if(!a||he(o)&&he(l)&&!Tt.isValidElement(c)&&!se(c))return null;if(Tt.isValidElement(c))return Tt.cloneElement(c,i);var g;if(se(c)){if(g=Tt.createElement(c,i),Tt.isValidElement(g))return g}else g=Lrt(i);var v=Vrt(a),x=pe(i,!0);if(v&&(s==="insideStart"||s==="insideEnd"||s==="end"))return zrt(i,g,x);var b=v?jrt(i):Urt(i);return et.createElement(yy,rd({className:Ce("recharts-label",d)},x,b,{breakAll:p}),g)}br.displayName="Label";var zU=function(t){var n=t.cx,r=t.cy,i=t.angle,a=t.startAngle,s=t.endAngle,o=t.r,l=t.radius,c=t.innerRadius,h=t.outerRadius,d=t.x,p=t.y,g=t.top,v=t.left,x=t.width,b=t.height,w=t.clockWise,C=t.labelViewBox;if(C)return C;if(Ot(x)&&Ot(b)){if(Ot(d)&&Ot(p))return{x:d,y:p,width:x,height:b};if(Ot(g)&&Ot(v))return{x:g,y:v,width:x,height:b}}return Ot(d)&&Ot(p)?{x:d,y:p,width:0,height:0}:Ot(n)&&Ot(r)?{cx:n,cy:r,startAngle:a||i||0,endAngle:s||i||0,innerRadius:c||0,outerRadius:h||l||o||0,clockWise:w}:t.viewBox?t.viewBox:{}},Wrt=function(t,n){return t?t===!0?et.createElement(br,{key:"label-implicit",viewBox:n}):zn(t)?et.createElement(br,{key:"label-implicit",viewBox:n,value:t}):Tt.isValidElement(t)?t.type===br?Tt.cloneElement(t,{key:"label-implicit",viewBox:n}):et.createElement(br,{key:"label-implicit",content:t,viewBox:n}):se(t)?et.createElement(br,{key:"label-implicit",content:t,viewBox:n}):Bc(t)?et.createElement(br,rd({viewBox:n},t,{key:"label-implicit"})):null:null},Grt=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var i=t.children,a=zU(t),s=Mi(i,br).map(function(l,c){return Tt.cloneElement(l,{viewBox:n||a,key:"label-".concat(c)})});if(!r)return s;var o=Wrt(t.label,n||a);return[o].concat(Ert(s))};br.parseViewBox=zU;br.renderCallByParent=Grt;var $T,rL;function qrt(){if(rL)return $T;rL=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return $T=e,$T}var Hrt=qrt();const Xrt=Be(Hrt);function id(e){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},id(e)}var Krt=["valueAccessor"],Yrt=["data","dataKey","clockWise","id","textBreakAll"];function Zrt(e){return eit(e)||tit(e)||Jrt(e)||Qrt()}function Qrt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jrt(e,t){if(e){if(typeof e=="string")return e2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e2(e,t)}}function tit(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eit(e){if(Array.isArray(e))return e2(e)}function e2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ry(){return Ry=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ry.apply(this,arguments)}function iL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function aL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iL(Object(n),!0).forEach(function(r){nit(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nit(e,t,n){return t=rit(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rit(e){var t=iit(e,"string");return id(t)=="symbol"?t:t+""}function iit(e,t){if(id(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(id(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sL(e,t){if(e==null)return{};var n=ait(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ait(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var sit=function(t){return Array.isArray(t.value)?Xrt(t.value):t.value};function oo(e){var t=e.valueAccessor,n=t===void 0?sit:t,r=sL(e,Krt),i=r.data,a=r.dataKey,s=r.clockWise,o=r.id,l=r.textBreakAll,c=sL(r,Yrt);return!i||!i.length?null:et.createElement(yn,{className:"recharts-label-list"},i.map(function(h,d){var p=he(a)?n(h,d):hi(h&&h.payload,a),g=he(o)?{}:{id:"".concat(o,"-").concat(d)};return et.createElement(br,Ry({},pe(h,!0),c,g,{parentViewBox:h.parentViewBox,value:p,textBreakAll:l,viewBox:br.parseViewBox(he(s)?h:aL(aL({},h),{},{clockWise:s})),key:"label-".concat(d),index:d}))}))}oo.displayName="LabelList";function oit(e,t){return e?e===!0?et.createElement(oo,{key:"labelList-implicit",data:t}):et.isValidElement(e)||se(e)?et.createElement(oo,{key:"labelList-implicit",data:t,content:e}):Bc(e)?et.createElement(oo,Ry({data:t},e,{key:"labelList-implicit"})):null:null}function lit(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,i=Mi(r,oo).map(function(s,o){return Tt.cloneElement(s,{data:t,key:"labelList-".concat(o)})});if(!n)return i;var a=oit(e.label,t);return[a].concat(Zrt(i))}oo.renderCallByParent=lit;function ad(e){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ad(e)}function n2(){return n2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n2.apply(this,arguments)}function oL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function lL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oL(Object(n),!0).forEach(function(r){uit(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function uit(e,t,n){return t=cit(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cit(e){var t=fit(e,"string");return ad(t)=="symbol"?t:t+""}function fit(e,t){if(ad(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ad(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hit=function(t,n){var r=ra(n-t),i=Math.min(Math.abs(n-t),359.999);return r*i},Ng=function(t){var n=t.cx,r=t.cy,i=t.radius,a=t.angle,s=t.sign,o=t.isExternal,l=t.cornerRadius,c=t.cornerIsExternal,h=l*(o?1:-1)+i,d=Math.asin(l/h)/_y,p=c?a:a+s*d,g=or(n,r,h,p),v=or(n,r,i,p),x=c?a-s*d:a,b=or(n,r,h*Math.cos(d*_y),x);return{center:g,circleTangency:v,lineTangency:b,theta:d}},jU=function(t){var n=t.cx,r=t.cy,i=t.innerRadius,a=t.outerRadius,s=t.startAngle,o=t.endAngle,l=hit(s,o),c=s+l,h=or(n,r,a,s),d=or(n,r,a,c),p="M ".concat(h.x,",").concat(h.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(s>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(i>0){var g=or(n,r,i,s),v=or(n,r,i,c);p+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(s<=c),`,
            `).concat(g.x,",").concat(g.y," Z")}else p+="L ".concat(n,",").concat(r," Z");return p},dit=function(t){var n=t.cx,r=t.cy,i=t.innerRadius,a=t.outerRadius,s=t.cornerRadius,o=t.forceCornerRadius,l=t.cornerIsExternal,c=t.startAngle,h=t.endAngle,d=ra(h-c),p=Ng({cx:n,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),g=p.circleTangency,v=p.lineTangency,x=p.theta,b=Ng({cx:n,cy:r,radius:a,angle:h,sign:-d,cornerRadius:s,cornerIsExternal:l}),w=b.circleTangency,C=b.lineTangency,T=b.theta,$=l?Math.abs(c-h):Math.abs(c-h)-x-T;if($<0)return o?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):jU({cx:n,cy:r,innerRadius:i,outerRadius:a,startAngle:c,endAngle:h});var A="M ".concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(g.x,",").concat(g.y,`
    A`).concat(a,",").concat(a,",0,").concat(+($>180),",").concat(+(d<0),",").concat(w.x,",").concat(w.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(C.x,",").concat(C.y,`
  `);if(i>0){var E=Ng({cx:n,cy:r,radius:i,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),O=E.circleTangency,N=E.lineTangency,_=E.theta,R=Ng({cx:n,cy:r,radius:i,angle:h,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),I=R.circleTangency,P=R.lineTangency,B=R.theta,V=l?Math.abs(c-h):Math.abs(c-h)-_-B;if(V<0&&s===0)return"".concat(A,"L").concat(n,",").concat(r,"Z");A+="L".concat(P.x,",").concat(P.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(I.x,",").concat(I.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(V>180),",").concat(+(d>0),",").concat(O.x,",").concat(O.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else A+="L".concat(n,",").concat(r,"Z");return A},pit={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},UU=function(t){var n=lL(lL({},pit),t),r=n.cx,i=n.cy,a=n.innerRadius,s=n.outerRadius,o=n.cornerRadius,l=n.forceCornerRadius,c=n.cornerIsExternal,h=n.startAngle,d=n.endAngle,p=n.className;if(s<a||h===d)return null;var g=Ce("recharts-sector",p),v=s-a,x=bl(o,v,0,!0),b;return x>0&&Math.abs(h-d)<360?b=dit({cx:r,cy:i,innerRadius:a,outerRadius:s,cornerRadius:Math.min(x,v/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:h,endAngle:d}):b=jU({cx:r,cy:i,innerRadius:a,outerRadius:s,startAngle:h,endAngle:d}),et.createElement("path",n2({},pe(n,!0),{className:g,d:b,role:"img"}))};function sd(e){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(e)}function r2(){return r2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r2.apply(this,arguments)}function uL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function cL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uL(Object(n),!0).forEach(function(r){mit(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mit(e,t,n){return t=git(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function git(e){var t=yit(e,"string");return sd(t)=="symbol"?t:t+""}function yit(e,t){if(sd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(sd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fL={curveBasisClosed:D9,curveBasisOpen:M9,curveBasis:R9,curveBumpX:b9,curveBumpY:x9,curveLinearClosed:P9,curveLinear:Dv,curveMonotoneX:F9,curveMonotoneY:L9,curveNatural:B9,curveStep:z9,curveStepAfter:U9,curveStepBefore:j9},_g=function(t){return t.x===+t.x&&t.y===+t.y},mh=function(t){return t.x},gh=function(t){return t.y},vit=function(t,n){if(se(t))return t;var r="curve".concat(_v(t));return(r==="curveMonotone"||r==="curveBump")&&n?fL["".concat(r).concat(n==="vertical"?"Y":"X")]:fL[r]||Dv},bit=function(t){var n=t.type,r=n===void 0?"linear":n,i=t.points,a=i===void 0?[]:i,s=t.baseLine,o=t.layout,l=t.connectNulls,c=l===void 0?!1:l,h=vit(r,o),d=c?a.filter(function(x){return _g(x)}):a,p;if(Array.isArray(s)){var g=c?s.filter(function(x){return _g(x)}):s,v=d.map(function(x,b){return cL(cL({},x),{},{base:g[b]})});return o==="vertical"?p=Cg().y(gh).x1(mh).x0(function(x){return x.base.x}):p=Cg().x(mh).y1(gh).y0(function(x){return x.base.y}),p.defined(_g).curve(h),p(v)}return o==="vertical"&&Ot(s)?p=Cg().y(gh).x1(mh).x0(s):Ot(s)?p=Cg().x(mh).y1(gh).y0(s):p=q4().x(mh).y(gh),p.defined(_g).curve(h),p(d)},i2=function(t){var n=t.className,r=t.points,i=t.path,a=t.pathRef;if((!r||!r.length)&&!i)return null;var s=r&&r.length?bit(t):i;return et.createElement("path",r2({},pe(t,!1),ay(t),{className:Ce("recharts-curve",n),d:s,ref:a}))},AT={exports:{}},kT,hL;function xit(){if(hL)return kT;hL=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return kT=e,kT}var ET,dL;function wit(){if(dL)return ET;dL=1;var e=xit();function t(){}function n(){}return n.resetWarningCache=t,ET=function(){function r(s,o,l,c,h,d){if(d!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function i(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:t};return a.PropTypes=a,a},ET}var pL;function Sit(){return pL||(pL=1,AT.exports=wit()()),AT.exports}var Cit=Sit();const ke=Be(Cit);var Tit=Object.getOwnPropertyNames,$it=Object.getOwnPropertySymbols,Ait=Object.prototype.hasOwnProperty;function mL(e,t){return function(r,i,a){return e(r,i,a)&&t(r,i,a)}}function Rg(e){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return e(n,r,i);var a=i.cache,s=a.get(n),o=a.get(r);if(s&&o)return s===r&&o===n;a.set(n,r),a.set(r,n);var l=e(n,r,i);return a.delete(n),a.delete(r),l}}function gL(e){return Tit(e).concat($it(e))}var kit=Object.hasOwn||function(e,t){return Ait.call(e,t)};function zl(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Eit="__v",Iit="__o",Oit="_owner",yL=Object.getOwnPropertyDescriptor,vL=Object.keys;function Nit(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function _it(e,t){return zl(e.getTime(),t.getTime())}function Rit(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Dit(e,t){return e===t}function bL(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var i=new Array(r),a=e.entries(),s,o,l=0;(s=a.next())&&!s.done;){for(var c=t.entries(),h=!1,d=0;(o=c.next())&&!o.done;){if(i[d]){d++;continue}var p=s.value,g=o.value;if(n.equals(p[0],g[0],l,d,e,t,n)&&n.equals(p[1],g[1],p[0],g[0],e,t,n)){h=i[d]=!0;break}d++}if(!h)return!1;l++}return!0}var Mit=zl;function Pit(e,t,n){var r=vL(e),i=r.length;if(vL(t).length!==i)return!1;for(;i-- >0;)if(!VU(e,t,n,r[i]))return!1;return!0}function yh(e,t,n){var r=gL(e),i=r.length;if(gL(t).length!==i)return!1;for(var a,s,o;i-- >0;)if(a=r[i],!VU(e,t,n,a)||(s=yL(e,a),o=yL(t,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function Fit(e,t){return zl(e.valueOf(),t.valueOf())}function Lit(e,t){return e.source===t.source&&e.flags===t.flags}function xL(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var i=new Array(r),a=e.values(),s,o;(s=a.next())&&!s.done;){for(var l=t.values(),c=!1,h=0;(o=l.next())&&!o.done;){if(!i[h]&&n.equals(s.value,o.value,s.value,o.value,e,t,n)){c=i[h]=!0;break}h++}if(!c)return!1}return!0}function Bit(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function zit(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function VU(e,t,n,r){return(r===Oit||r===Iit||r===Eit)&&(e.$$typeof||t.$$typeof)?!0:kit(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}var jit="[object Arguments]",Uit="[object Boolean]",Vit="[object Date]",Wit="[object Error]",Git="[object Map]",qit="[object Number]",Hit="[object Object]",Xit="[object RegExp]",Kit="[object Set]",Yit="[object String]",Zit="[object URL]",Qit=Array.isArray,wL=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,SL=Object.assign,Jit=Object.prototype.toString.call.bind(Object.prototype.toString);function tat(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areErrorsEqual,i=e.areFunctionsEqual,a=e.areMapsEqual,s=e.areNumbersEqual,o=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,h=e.areSetsEqual,d=e.areTypedArraysEqual,p=e.areUrlsEqual;return function(v,x,b){if(v===x)return!0;if(v==null||x==null)return!1;var w=typeof v;if(w!==typeof x)return!1;if(w!=="object")return w==="number"?s(v,x,b):w==="function"?i(v,x,b):!1;var C=v.constructor;if(C!==x.constructor)return!1;if(C===Object)return o(v,x,b);if(Qit(v))return t(v,x,b);if(wL!=null&&wL(v))return d(v,x,b);if(C===Date)return n(v,x,b);if(C===RegExp)return c(v,x,b);if(C===Map)return a(v,x,b);if(C===Set)return h(v,x,b);var T=Jit(v);return T===Vit?n(v,x,b):T===Xit?c(v,x,b):T===Git?a(v,x,b):T===Kit?h(v,x,b):T===Hit?typeof v.then!="function"&&typeof x.then!="function"&&o(v,x,b):T===Zit?p(v,x,b):T===Wit?r(v,x,b):T===jit?o(v,x,b):T===Uit||T===qit||T===Yit?l(v,x,b):!1}}function eat(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,i={areArraysEqual:r?yh:Nit,areDatesEqual:_it,areErrorsEqual:Rit,areFunctionsEqual:Dit,areMapsEqual:r?mL(bL,yh):bL,areNumbersEqual:Mit,areObjectsEqual:r?yh:Pit,arePrimitiveWrappersEqual:Fit,areRegExpsEqual:Lit,areSetsEqual:r?mL(xL,yh):xL,areTypedArraysEqual:r?yh:Bit,areUrlsEqual:zit};if(n&&(i=SL({},i,n(i))),t){var a=Rg(i.areArraysEqual),s=Rg(i.areMapsEqual),o=Rg(i.areObjectsEqual),l=Rg(i.areSetsEqual);i=SL({},i,{areArraysEqual:a,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:l})}return i}function nat(e){return function(t,n,r,i,a,s,o){return e(t,n,o)}}function rat(e){var t=e.circular,n=e.comparator,r=e.createState,i=e.equals,a=e.strict;if(r)return function(l,c){var h=r(),d=h.cache,p=d===void 0?t?new WeakMap:void 0:d,g=h.meta;return n(l,c,{cache:p,equals:i,meta:g,strict:a})};if(t)return function(l,c){return n(l,c,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var s={cache:void 0,equals:i,meta:void 0,strict:a};return function(l,c){return n(l,c,s)}}var iat=Co();Co({strict:!0});Co({circular:!0});Co({circular:!0,strict:!0});Co({createInternalComparator:function(){return zl}});Co({strict:!0,createInternalComparator:function(){return zl}});Co({circular:!0,createInternalComparator:function(){return zl}});Co({circular:!0,createInternalComparator:function(){return zl},strict:!0});function Co(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,i=e.createState,a=e.strict,s=a===void 0?!1:a,o=eat(e),l=tat(o),c=r?r(l):nat(l);return rat({circular:n,comparator:l,createState:i,equals:c,strict:s})}function aat(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function CL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function i(a){n<0&&(n=a),a-n>t?(e(a),n=-1):aat(i)};requestAnimationFrame(r)}function a2(e){"@babel/helpers - typeof";return a2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a2(e)}function sat(e){return cat(e)||uat(e)||lat(e)||oat()}function oat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lat(e,t){if(e){if(typeof e=="string")return TL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TL(e,t)}}function TL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cat(e){if(Array.isArray(e))return e}function fat(){var e={},t=function(){return null},n=!1,r=function i(a){if(!n){if(Array.isArray(a)){if(!a.length)return;var s=a,o=sat(s),l=o[0],c=o.slice(1);if(typeof l=="number"){CL(i.bind(null,c),l);return}i(l),CL(i.bind(null,c));return}a2(a)==="object"&&(e=a,t(e)),typeof a=="function"&&a()}};return{stop:function(){n=!0},start:function(a){n=!1,r(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function od(e){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},od(e)}function $L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function AL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$L(Object(n),!0).forEach(function(r){WU(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$L(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WU(e,t,n){return t=hat(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hat(e){var t=dat(e,"string");return od(t)==="symbol"?t:String(t)}function dat(e,t){if(od(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(od(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pat=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(r,i){return r.filter(function(a){return i.includes(a)})})},mat=function(t){return t},gat=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},Mh=function(t,n){return Object.keys(n).reduce(function(r,i){return AL(AL({},r),{},WU({},i,t(i,n[i])))},{})},kL=function(t,n,r){return t.map(function(i){return"".concat(gat(i)," ").concat(n,"ms ").concat(r)}).join(",")};function yat(e,t){return xat(e)||bat(e,t)||GU(e,t)||vat()}function vat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bat(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function xat(e){if(Array.isArray(e))return e}function wat(e){return Tat(e)||Cat(e)||GU(e)||Sat()}function Sat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GU(e,t){if(e){if(typeof e=="string")return s2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s2(e,t)}}function Cat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tat(e){if(Array.isArray(e))return s2(e)}function s2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dy=1e-4,qU=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},HU=function(t,n){return t.map(function(r,i){return r*Math.pow(n,i)}).reduce(function(r,i){return r+i})},EL=function(t,n){return function(r){var i=qU(t,n);return HU(i,r)}},$at=function(t,n){return function(r){var i=qU(t,n),a=[].concat(wat(i.map(function(s,o){return s*o}).slice(1)),[0]);return HU(a,r)}},IL=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],a=n[1],s=n[2],o=n[3];if(n.length===1)switch(n[0]){case"linear":i=0,a=0,s=1,o=1;break;case"ease":i=.25,a=.1,s=.25,o=1;break;case"ease-in":i=.42,a=0,s=1,o=1;break;case"ease-out":i=.42,a=0,s=.58,o=1;break;case"ease-in-out":i=0,a=0,s=.58,o=1;break;default:{var l=n[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var c=l[1].split(")")[0].split(",").map(function(b){return parseFloat(b)}),h=yat(c,4);i=h[0],a=h[1],s=h[2],o=h[3]}}}var d=EL(i,s),p=EL(a,o),g=$at(i,s),v=function(w){return w>1?1:w<0?0:w},x=function(w){for(var C=w>1?1:w,T=C,$=0;$<8;++$){var A=d(T)-C,E=g(T);if(Math.abs(A-C)<Dy||E<Dy)return p(T);T=v(T-A/E)}return p(T)};return x.isStepper=!1,x},Aat=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,r=n===void 0?100:n,i=t.damping,a=i===void 0?8:i,s=t.dt,o=s===void 0?17:s,l=function(h,d,p){var g=-(h-d)*r,v=p*a,x=p+(g-v)*o/1e3,b=p*o/1e3+h;return Math.abs(b-d)<Dy&&Math.abs(x)<Dy?[d,0]:[b,x]};return l.isStepper=!0,l.dt=o,l},kat=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return IL(i);case"spring":return Aat();default:if(i.split("(")[0]==="cubic-bezier")return IL(i)}return typeof i=="function"?i:null};function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function OL(e){return Oat(e)||Iat(e)||XU(e)||Eat()}function Eat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Oat(e){if(Array.isArray(e))return l2(e)}function NL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ar(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NL(Object(n),!0).forEach(function(r){o2(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function o2(e,t,n){return t=Nat(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nat(e){var t=_at(e,"string");return ld(t)==="symbol"?t:String(t)}function _at(e,t){if(ld(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ld(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rat(e,t){return Pat(e)||Mat(e,t)||XU(e,t)||Dat()}function Dat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XU(e,t){if(e){if(typeof e=="string")return l2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l2(e,t)}}function l2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mat(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function Pat(e){if(Array.isArray(e))return e}var My=function(t,n,r){return t+(n-t)*r},u2=function(t){var n=t.from,r=t.to;return n!==r},Fat=function e(t,n,r){var i=Mh(function(a,s){if(u2(s)){var o=t(s.from,s.to,s.velocity),l=Rat(o,2),c=l[0],h=l[1];return ar(ar({},s),{},{from:c,velocity:h})}return s},n);return r<1?Mh(function(a,s){return u2(s)?ar(ar({},s),{},{velocity:My(s.velocity,i[a].velocity,r),from:My(s.from,i[a].from,r)}):s},n):e(t,i,r-1)};const Lat=function(e,t,n,r,i){var a=pat(e,t),s=a.reduce(function(b,w){return ar(ar({},b),{},o2({},w,[e[w],t[w]]))},{}),o=a.reduce(function(b,w){return ar(ar({},b),{},o2({},w,{from:e[w],velocity:0,to:t[w]}))},{}),l=-1,c,h,d=function(){return null},p=function(){return Mh(function(w,C){return C.from},o)},g=function(){return!Object.values(o).filter(u2).length},v=function(w){c||(c=w);var C=w-c,T=C/n.dt;o=Fat(n,o,T),i(ar(ar(ar({},e),t),p())),c=w,g()||(l=requestAnimationFrame(d))},x=function(w){h||(h=w);var C=(w-h)/r,T=Mh(function(A,E){return My.apply(void 0,OL(E).concat([n(C)]))},s);if(i(ar(ar(ar({},e),t),T)),C<1)l=requestAnimationFrame(d);else{var $=Mh(function(A,E){return My.apply(void 0,OL(E).concat([n(1)]))},s);i(ar(ar(ar({},e),t),$))}};return d=n.isStepper?v:x,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(l)}}};function pc(e){"@babel/helpers - typeof";return pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pc(e)}var Bat=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function zat(e,t){if(e==null)return{};var n=jat(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function jat(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function IT(e){return Gat(e)||Wat(e)||Vat(e)||Uat()}function Uat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vat(e,t){if(e){if(typeof e=="string")return c2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c2(e,t)}}function Wat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gat(e){if(Array.isArray(e))return c2(e)}function c2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Xi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_L(Object(n),!0).forEach(function(r){$h(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_L(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $h(e,t,n){return t=KU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qat(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hat(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,KU(r.key),r)}}function Xat(e,t,n){return t&&Hat(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function KU(e){var t=Kat(e,"string");return pc(t)==="symbol"?t:String(t)}function Kat(e,t){if(pc(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(pc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yat(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f2(e,t)}function f2(e,t){return f2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},f2(e,t)}function Zat(e){var t=Qat();return function(){var r=Py(e),i;if(t){var a=Py(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return h2(this,i)}}function h2(e,t){if(t&&(pc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d2(e)}function d2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qat(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Py(e){return Py=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Py(e)}var ys=function(e){Yat(n,e);var t=Zat(n);function n(r,i){var a;qat(this,n),a=t.call(this,r,i);var s=a.props,o=s.isActive,l=s.attributeName,c=s.from,h=s.to,d=s.steps,p=s.children,g=s.duration;if(a.handleStyleChange=a.handleStyleChange.bind(d2(a)),a.changeStyle=a.changeStyle.bind(d2(a)),!o||g<=0)return a.state={style:{}},typeof p=="function"&&(a.state={style:h}),h2(a);if(d&&d.length)a.state={style:d[0].style};else if(c){if(typeof p=="function")return a.state={style:c},h2(a);a.state={style:l?$h({},l,c):c}}else a.state={style:{}};return a}return Xat(n,[{key:"componentDidMount",value:function(){var i=this.props,a=i.isActive,s=i.canBegin;this.mounted=!0,!(!a||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var a=this.props,s=a.isActive,o=a.canBegin,l=a.attributeName,c=a.shouldReAnimate,h=a.to,d=a.from,p=this.state.style;if(o){if(!s){var g={style:l?$h({},l,h):h};this.state&&p&&(l&&p[l]!==h||!l&&p!==h)&&this.setState(g);return}if(!(iat(i.to,h)&&i.canBegin&&i.isActive)){var v=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var x=v||c?d:i.to;if(this.state&&p){var b={style:l?$h({},l,x):x};(l&&p[l]!==x||!l&&p!==x)&&this.setState(b)}this.runAnimation(Xi(Xi({},this.props),{},{from:x,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var a=this,s=i.from,o=i.to,l=i.duration,c=i.easing,h=i.begin,d=i.onAnimationEnd,p=i.onAnimationStart,g=Lat(s,o,kat(c),l,this.changeStyle),v=function(){a.stopJSAnimation=g()};this.manager.start([p,h,v,l,d])}},{key:"runStepAnimation",value:function(i){var a=this,s=i.steps,o=i.begin,l=i.onAnimationStart,c=s[0],h=c.style,d=c.duration,p=d===void 0?0:d,g=function(x,b,w){if(w===0)return x;var C=b.duration,T=b.easing,$=T===void 0?"ease":T,A=b.style,E=b.properties,O=b.onAnimationEnd,N=w>0?s[w-1]:b,_=E||Object.keys(A);if(typeof $=="function"||$==="spring")return[].concat(IT(x),[a.runJSAnimation.bind(a,{from:N.style,to:A,duration:C,easing:$}),C]);var R=kL(_,C,$),I=Xi(Xi(Xi({},N.style),A),{},{transition:R});return[].concat(IT(x),[I,C,O]).filter(mat)};return this.manager.start([l].concat(IT(s.reduce(g,[h,Math.max(p,o)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=fat());var a=i.begin,s=i.duration,o=i.attributeName,l=i.to,c=i.easing,h=i.onAnimationStart,d=i.onAnimationEnd,p=i.steps,g=i.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof c=="function"||typeof g=="function"||c==="spring"){this.runJSAnimation(i);return}if(p.length>1){this.runStepAnimation(i);return}var x=o?$h({},o,l):l,b=kL(Object.keys(x),s,c);v.start([h,a,Xi(Xi({},x),{},{transition:b}),s,d])}},{key:"render",value:function(){var i=this.props,a=i.children;i.begin;var s=i.duration;i.attributeName,i.easing;var o=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var l=zat(i,Bat),c=Tt.Children.count(a),h=this.state.style;if(typeof a=="function")return a(h);if(!o||c===0||s<=0)return a;var d=function(g){var v=g.props,x=v.style,b=x===void 0?{}:x,w=v.className,C=Tt.cloneElement(g,Xi(Xi({},l),{},{style:Xi(Xi({},b),h),className:w}));return C};return c===1?d(Tt.Children.only(a)):et.createElement("div",null,Tt.Children.map(a,function(p){return d(p)}))}}]),n}(Tt.PureComponent);ys.displayName="Animate";ys.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ys.propTypes={from:ke.oneOfType([ke.object,ke.string]),to:ke.oneOfType([ke.object,ke.string]),attributeName:ke.string,duration:ke.number,begin:ke.number,easing:ke.oneOfType([ke.string,ke.func]),steps:ke.arrayOf(ke.shape({duration:ke.number.isRequired,style:ke.object.isRequired,easing:ke.oneOfType([ke.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ke.func]),properties:ke.arrayOf("string"),onAnimationEnd:ke.func})),children:ke.oneOfType([ke.node,ke.func]),isActive:ke.bool,canBegin:ke.bool,onAnimationEnd:ke.func,shouldReAnimate:ke.bool,onAnimationStart:ke.func,onAnimationReStart:ke.func};function ud(e){"@babel/helpers - typeof";return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ud(e)}function Fy(){return Fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fy.apply(this,arguments)}function Jat(e,t){return rst(e)||nst(e,t)||est(e,t)||tst()}function tst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function est(e,t){if(e){if(typeof e=="string")return RL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RL(e,t)}}function RL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nst(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function rst(e){if(Array.isArray(e))return e}function DL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ML(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DL(Object(n),!0).forEach(function(r){ist(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ist(e,t,n){return t=ast(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ast(e){var t=sst(e,"string");return ud(t)=="symbol"?t:t+""}function sst(e,t){if(ud(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ud(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PL=function(t,n,r,i,a){var s=Math.min(Math.abs(r)/2,Math.abs(i)/2),o=i>=0?1:-1,l=r>=0?1:-1,c=i>=0&&r>=0||i<0&&r<0?1:0,h;if(s>0&&a instanceof Array){for(var d=[0,0,0,0],p=0,g=4;p<g;p++)d[p]=a[p]>s?s:a[p];h="M".concat(t,",").concat(n+o*d[0]),d[0]>0&&(h+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(t+l*d[0],",").concat(n)),h+="L ".concat(t+r-l*d[1],",").concat(n),d[1]>0&&(h+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(t+r,",").concat(n+o*d[1])),h+="L ".concat(t+r,",").concat(n+i-o*d[2]),d[2]>0&&(h+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(t+r-l*d[2],",").concat(n+i)),h+="L ".concat(t+l*d[3],",").concat(n+i),d[3]>0&&(h+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(n+i-o*d[3])),h+="Z"}else if(s>0&&a===+a&&a>0){var v=Math.min(s,a);h="M ".concat(t,",").concat(n+o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(t+l*v,",").concat(n,`
            L `).concat(t+r-l*v,",").concat(n,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(t+r,",").concat(n+o*v,`
            L `).concat(t+r,",").concat(n+i-o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(t+r-l*v,",").concat(n+i,`
            L `).concat(t+l*v,",").concat(n+i,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(t,",").concat(n+i-o*v," Z")}else h="M ".concat(t,",").concat(n," h ").concat(r," v ").concat(i," h ").concat(-r," Z");return h},ost=function(t,n){if(!t||!n)return!1;var r=t.x,i=t.y,a=n.x,s=n.y,o=n.width,l=n.height;if(Math.abs(o)>0&&Math.abs(l)>0){var c=Math.min(a,a+o),h=Math.max(a,a+o),d=Math.min(s,s+l),p=Math.max(s,s+l);return r>=c&&r<=h&&i>=d&&i<=p}return!1},lst={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},pk=function(t){var n=ML(ML({},lst),t),r=Tt.useRef(),i=Tt.useState(-1),a=Jat(i,2),s=a[0],o=a[1];Tt.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var $=r.current.getTotalLength();$&&o($)}catch{}},[]);var l=n.x,c=n.y,h=n.width,d=n.height,p=n.radius,g=n.className,v=n.animationEasing,x=n.animationDuration,b=n.animationBegin,w=n.isAnimationActive,C=n.isUpdateAnimationActive;if(l!==+l||c!==+c||h!==+h||d!==+d||h===0||d===0)return null;var T=Ce("recharts-rectangle",g);return C?et.createElement(ys,{canBegin:s>0,from:{width:h,height:d,x:l,y:c},to:{width:h,height:d,x:l,y:c},duration:x,animationEasing:v,isActive:C},function($){var A=$.width,E=$.height,O=$.x,N=$.y;return et.createElement(ys,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:b,duration:x,isActive:w,easing:v},et.createElement("path",Fy({},pe(n,!0),{className:T,d:PL(O,N,A,E,p),ref:r})))}):et.createElement("path",Fy({},pe(n,!0),{className:T,d:PL(l,c,h,d,p)}))};function p2(){return p2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p2.apply(this,arguments)}var mk=function(t){var n=t.cx,r=t.cy,i=t.r,a=t.className,s=Ce("recharts-dot",a);return n===+n&&r===+r&&i===+i?et.createElement("circle",p2({},pe(t,!1),ay(t),{className:s,cx:n,cy:r,r:i})):null};function cd(e){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(e)}var ust=["x","y","top","left","width","height","className"];function m2(){return m2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m2.apply(this,arguments)}function FL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function cst(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(n),!0).forEach(function(r){fst(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fst(e,t,n){return t=hst(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hst(e){var t=dst(e,"string");return cd(t)=="symbol"?t:t+""}function dst(e,t){if(cd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(cd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pst(e,t){if(e==null)return{};var n=mst(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mst(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var gst=function(t,n,r,i,a,s){return"M".concat(t,",").concat(a,"v").concat(i,"M").concat(s,",").concat(n,"h").concat(r)},yst=function(t){var n=t.x,r=n===void 0?0:n,i=t.y,a=i===void 0?0:i,s=t.top,o=s===void 0?0:s,l=t.left,c=l===void 0?0:l,h=t.width,d=h===void 0?0:h,p=t.height,g=p===void 0?0:p,v=t.className,x=pst(t,ust),b=cst({x:r,y:a,top:o,left:c,width:d,height:g},x);return!Ot(r)||!Ot(a)||!Ot(d)||!Ot(g)||!Ot(o)||!Ot(c)?null:et.createElement("path",m2({},pe(b,!0),{className:Ce("recharts-cross",v),d:gst(r,a,d,g,o,c)}))},OT,LL;function vst(){if(LL)return OT;LL=1;var e=mj(),t=e(Object.getPrototypeOf,Object);return OT=t,OT}var NT,BL;function bst(){if(BL)return NT;BL=1;var e=Cs(),t=vst(),n=Ts(),r="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,l=s.call(Object);function c(h){if(!n(h)||e(h)!=r)return!1;var d=t(h);if(d===null)return!0;var p=o.call(d,"constructor")&&d.constructor;return typeof p=="function"&&p instanceof p&&s.call(p)==l}return NT=c,NT}var xst=bst();const wst=Be(xst);var _T,zL;function Sst(){if(zL)return _T;zL=1;var e=Cs(),t=Ts(),n="[object Boolean]";function r(i){return i===!0||i===!1||t(i)&&e(i)==n}return _T=r,_T}var Cst=Sst();const Tst=Be(Cst);function fd(e){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fd(e)}function Ly(){return Ly=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ly.apply(this,arguments)}function $st(e,t){return Ist(e)||Est(e,t)||kst(e,t)||Ast()}function Ast(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kst(e,t){if(e){if(typeof e=="string")return jL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jL(e,t)}}function jL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Est(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function Ist(e){if(Array.isArray(e))return e}function UL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function VL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?UL(Object(n),!0).forEach(function(r){Ost(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Ost(e,t,n){return t=Nst(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nst(e){var t=_st(e,"string");return fd(t)=="symbol"?t:t+""}function _st(e,t){if(fd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(fd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WL=function(t,n,r,i,a){var s=r-i,o;return o="M ".concat(t,",").concat(n),o+="L ".concat(t+r,",").concat(n),o+="L ".concat(t+r-s/2,",").concat(n+a),o+="L ".concat(t+r-s/2-i,",").concat(n+a),o+="L ".concat(t,",").concat(n," Z"),o},Rst={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Dst=function(t){var n=VL(VL({},Rst),t),r=Tt.useRef(),i=Tt.useState(-1),a=$st(i,2),s=a[0],o=a[1];Tt.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var T=r.current.getTotalLength();T&&o(T)}catch{}},[]);var l=n.x,c=n.y,h=n.upperWidth,d=n.lowerWidth,p=n.height,g=n.className,v=n.animationEasing,x=n.animationDuration,b=n.animationBegin,w=n.isUpdateAnimationActive;if(l!==+l||c!==+c||h!==+h||d!==+d||p!==+p||h===0&&d===0||p===0)return null;var C=Ce("recharts-trapezoid",g);return w?et.createElement(ys,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:p,x:l,y:c},to:{upperWidth:h,lowerWidth:d,height:p,x:l,y:c},duration:x,animationEasing:v,isActive:w},function(T){var $=T.upperWidth,A=T.lowerWidth,E=T.height,O=T.x,N=T.y;return et.createElement(ys,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:b,duration:x,easing:v},et.createElement("path",Ly({},pe(n,!0),{className:C,d:WL(O,N,$,A,E),ref:r})))}):et.createElement("g",null,et.createElement("path",Ly({},pe(n,!0),{className:C,d:WL(l,c,h,d,p)})))},Mst=["option","shapeType","propTransformer","activeClassName","isActive"];function hd(e){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hd(e)}function Pst(e,t){if(e==null)return{};var n=Fst(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Fst(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function GL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function By(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GL(Object(n),!0).forEach(function(r){Lst(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Lst(e,t,n){return t=Bst(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bst(e){var t=zst(e,"string");return hd(t)=="symbol"?t:t+""}function zst(e,t){if(hd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(hd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jst(e,t){return By(By({},t),e)}function Ust(e,t){return e==="symbols"}function qL(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return et.createElement(pk,n);case"trapezoid":return et.createElement(Dst,n);case"sector":return et.createElement(UU,n);case"symbols":if(Ust(t))return et.createElement(RA,n);break;default:return null}}function Vst(e){return Tt.isValidElement(e)?e.props:e}function Wst(e){var t=e.option,n=e.shapeType,r=e.propTransformer,i=r===void 0?jst:r,a=e.activeClassName,s=a===void 0?"recharts-active-shape":a,o=e.isActive,l=Pst(e,Mst),c;if(Tt.isValidElement(t))c=Tt.cloneElement(t,By(By({},l),Vst(t)));else if(se(t))c=t(l);else if(wst(t)&&!Tst(t)){var h=i(t,l);c=et.createElement(qL,{shapeType:n,elementProps:h})}else{var d=l;c=et.createElement(qL,{shapeType:n,elementProps:d})}return o?et.createElement(yn,{className:s},c):c}function Yv(e,t){return t!=null&&"trapezoids"in e.props}function Zv(e,t){return t!=null&&"sectors"in e.props}function dd(e,t){return t!=null&&"points"in e.props}function Gst(e,t){var n,r,i=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,a=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return i&&a}function qst(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function Hst(e,t){var n=e.x===t.x,r=e.y===t.y,i=e.z===t.z;return n&&r&&i}function Xst(e,t){var n;return Yv(e,t)?n=Gst:Zv(e,t)?n=qst:dd(e,t)&&(n=Hst),n}function Kst(e,t){var n;return Yv(e,t)?n="trapezoids":Zv(e,t)?n="sectors":dd(e,t)&&(n="points"),n}function Yst(e,t){if(Yv(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(Zv(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return dd(e,t)?t.payload:{}}function Zst(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,i=Kst(n,t),a=Yst(n,t),s=r.filter(function(l,c){var h=Hv(a,l),d=n.props[i].filter(function(v){var x=Xst(n,t);return x(v,t)}),p=n.props[i].indexOf(d[d.length-1]),g=c===p;return h&&g}),o=r.indexOf(s[s.length-1]);return o}var RT,HL;function Qst(){if(HL)return RT;HL=1;var e=Math.ceil,t=Math.max;function n(r,i,a,s){for(var o=-1,l=t(e((i-r)/(a||1)),0),c=Array(l);l--;)c[s?l:++o]=r,r+=a;return c}return RT=n,RT}var DT,XL;function YU(){if(XL)return DT;XL=1;var e=Nj(),t=1/0,n=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-1/0){var a=i<0?-1:1;return a*n}return i===i?i:0}return DT=r,DT}var MT,KL;function Jst(){if(KL)return MT;KL=1;var e=Qst(),t=Lv(),n=YU();function r(i){return function(a,s,o){return o&&typeof o!="number"&&t(a,s,o)&&(s=o=void 0),a=n(a),s===void 0?(s=a,a=0):s=n(s),o=o===void 0?a<s?1:-1:n(o),e(a,s,o,i)}}return MT=r,MT}var PT,YL;function tot(){if(YL)return PT;YL=1;var e=Jst(),t=e();return PT=t,PT}var eot=tot();const zy=Be(eot);function pd(e){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pd(e)}function ZL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function QL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZL(Object(n),!0).forEach(function(r){ZU(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ZU(e,t,n){return t=not(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function not(e){var t=rot(e,"string");return pd(t)=="symbol"?t:t+""}function rot(e,t){if(pd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(pd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iot=["Webkit","Moz","O","ms"],aot=function(t,n){var r=t.replace(/(\w)/,function(a){return a.toUpperCase()}),i=iot.reduce(function(a,s){return QL(QL({},a),{},ZU({},s+r,n))},{});return i[t]=n,i};function mc(e){"@babel/helpers - typeof";return mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(e)}function jy(){return jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jy.apply(this,arguments)}function JL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function FT(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JL(Object(n),!0).forEach(function(r){si(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JL(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function sot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,JU(r.key),r)}}function oot(e,t,n){return t&&tB(e.prototype,t),n&&tB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function lot(e,t,n){return t=Uy(t),uot(e,QU()?Reflect.construct(t,n||[],Uy(e).constructor):t.apply(e,n))}function uot(e,t){if(t&&(mc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cot(e)}function cot(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QU=function(){return!!e})()}function Uy(e){return Uy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Uy(e)}function fot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g2(e,t)}function g2(e,t){return g2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},g2(e,t)}function si(e,t,n){return t=JU(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JU(e){var t=hot(e,"string");return mc(t)=="symbol"?t:t+""}function hot(e,t){if(mc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(mc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var dot=function(t){var n=t.data,r=t.startIndex,i=t.endIndex,a=t.x,s=t.width,o=t.travellerWidth;if(!n||!n.length)return{};var l=n.length,c=Rh().domain(zy(0,l)).range([a,a+s-o]),h=c.domain().map(function(d){return c(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(r),endX:c(i),scale:c,scaleValues:h}},eB=function(t){return t.changedTouches&&!!t.changedTouches.length},gc=function(e){function t(n){var r;return sot(this,t),r=lot(this,t,[n]),si(r,"handleDrag",function(i){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(i):r.state.isSlideMoving&&r.handleSlideDrag(i)}),si(r,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&r.handleDrag(i.changedTouches[0])}),si(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=r.props,a=i.endIndex,s=i.onDragEnd,o=i.startIndex;s==null||s({endIndex:a,startIndex:o})}),r.detachDragEndListener()}),si(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),si(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),si(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),si(r,"handleSlideDragStart",function(i){var a=eB(i)?i.changedTouches[0]:i;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:a.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return fot(t,e),oot(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var i=r.startX,a=r.endX,s=this.state.scaleValues,o=this.props,l=o.gap,c=o.data,h=c.length-1,d=Math.min(i,a),p=Math.max(i,a),g=t.getIndexInRange(s,d),v=t.getIndexInRange(s,p);return{startIndex:g-g%l,endIndex:v===h?h:v-v%l}}},{key:"getTextOfTick",value:function(r){var i=this.props,a=i.data,s=i.tickFormatter,o=i.dataKey,l=hi(a[r],o,r);return se(s)?s(l,r):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var i=this.state,a=i.slideMoveStartX,s=i.startX,o=i.endX,l=this.props,c=l.x,h=l.width,d=l.travellerWidth,p=l.startIndex,g=l.endIndex,v=l.onChange,x=r.pageX-a;x>0?x=Math.min(x,c+h-d-o,c+h-d-s):x<0&&(x=Math.max(x,c-s,c-o));var b=this.getIndex({startX:s+x,endX:o+x});(b.startIndex!==p||b.endIndex!==g)&&v&&v(b),this.setState({startX:s+x,endX:o+x,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,i){var a=eB(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var i=this.state,a=i.brushMoveStartX,s=i.movingTravellerId,o=i.endX,l=i.startX,c=this.state[s],h=this.props,d=h.x,p=h.width,g=h.travellerWidth,v=h.onChange,x=h.gap,b=h.data,w={startX:this.state.startX,endX:this.state.endX},C=r.pageX-a;C>0?C=Math.min(C,d+p-g-c):C<0&&(C=Math.max(C,d-c)),w[s]=c+C;var T=this.getIndex(w),$=T.startIndex,A=T.endIndex,E=function(){var N=b.length-1;return s==="startX"&&(o>l?$%x===0:A%x===0)||o<l&&A===N||s==="endX"&&(o>l?A%x===0:$%x===0)||o>l&&A===N};this.setState(si(si({},s,c+C),"brushMoveStartX",r.pageX),function(){v&&E()&&v(T)})}},{key:"handleTravellerMoveKeyboard",value:function(r,i){var a=this,s=this.state,o=s.scaleValues,l=s.startX,c=s.endX,h=this.state[i],d=o.indexOf(h);if(d!==-1){var p=d+r;if(!(p===-1||p>=o.length)){var g=o[p];i==="startX"&&g>=c||i==="endX"&&g<=l||this.setState(si({},i,g),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,i=r.x,a=r.y,s=r.width,o=r.height,l=r.fill,c=r.stroke;return et.createElement("rect",{stroke:c,fill:l,x:i,y:a,width:s,height:o})}},{key:"renderPanorama",value:function(){var r=this.props,i=r.x,a=r.y,s=r.width,o=r.height,l=r.data,c=r.children,h=r.padding,d=Tt.Children.only(c);return d?et.cloneElement(d,{x:i,y:a,width:s,height:o,margin:h,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(r,i){var a,s,o=this,l=this.props,c=l.y,h=l.travellerWidth,d=l.height,p=l.traveller,g=l.ariaLabel,v=l.data,x=l.startIndex,b=l.endIndex,w=Math.max(r,this.props.x),C=FT(FT({},pe(this.props,!1)),{},{x:w,y:c,width:h,height:d}),T=g||"Min value: ".concat((a=v[x])===null||a===void 0?void 0:a.name,", Max value: ").concat((s=v[b])===null||s===void 0?void 0:s.name);return et.createElement(yn,{tabIndex:0,role:"slider","aria-label":T,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(A){["ArrowLeft","ArrowRight"].includes(A.key)&&(A.preventDefault(),A.stopPropagation(),o.handleTravellerMoveKeyboard(A.key==="ArrowRight"?1:-1,i))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(p,C))}},{key:"renderSlide",value:function(r,i){var a=this.props,s=a.y,o=a.height,l=a.stroke,c=a.travellerWidth,h=Math.min(r,i)+c,d=Math.max(Math.abs(i-r)-c,0);return et.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:h,y:s,width:d,height:o})}},{key:"renderText",value:function(){var r=this.props,i=r.startIndex,a=r.endIndex,s=r.y,o=r.height,l=r.travellerWidth,c=r.stroke,h=this.state,d=h.startX,p=h.endX,g=5,v={pointerEvents:"none",fill:c};return et.createElement(yn,{className:"recharts-brush-texts"},et.createElement(yy,jy({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,p)-g,y:s+o/2},v),this.getTextOfTick(i)),et.createElement(yy,jy({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,p)+l+g,y:s+o/2},v),this.getTextOfTick(a)))}},{key:"render",value:function(){var r=this.props,i=r.data,a=r.className,s=r.children,o=r.x,l=r.y,c=r.width,h=r.height,d=r.alwaysShowText,p=this.state,g=p.startX,v=p.endX,x=p.isTextActive,b=p.isSlideMoving,w=p.isTravellerMoving,C=p.isTravellerFocused;if(!i||!i.length||!Ot(o)||!Ot(l)||!Ot(c)||!Ot(h)||c<=0||h<=0)return null;var T=Ce("recharts-brush",a),$=et.Children.count(s)===1,A=aot("userSelect","none");return et.createElement(yn,{className:T,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:A},this.renderBackground(),$&&this.renderPanorama(),this.renderSlide(g,v),this.renderTravellerLayer(g,"startX"),this.renderTravellerLayer(v,"endX"),(x||b||w||C||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var i=r.x,a=r.y,s=r.width,o=r.height,l=r.stroke,c=Math.floor(a+o/2)-1;return et.createElement(et.Fragment,null,et.createElement("rect",{x:i,y:a,width:s,height:o,fill:l,stroke:"none"}),et.createElement("line",{x1:i+1,y1:c,x2:i+s-1,y2:c,fill:"none",stroke:"#fff"}),et.createElement("line",{x1:i+1,y1:c+2,x2:i+s-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,i){var a;return et.isValidElement(r)?a=et.cloneElement(r,i):se(r)?a=r(i):a=t.renderDefaultTraveller(i),a}},{key:"getDerivedStateFromProps",value:function(r,i){var a=r.data,s=r.width,o=r.x,l=r.travellerWidth,c=r.updateId,h=r.startIndex,d=r.endIndex;if(a!==i.prevData||c!==i.prevUpdateId)return FT({prevData:a,prevTravellerWidth:l,prevUpdateId:c,prevX:o,prevWidth:s},a&&a.length?dot({data:a,width:s,x:o,travellerWidth:l,startIndex:h,endIndex:d}):{scale:null,scaleValues:null});if(i.scale&&(s!==i.prevWidth||o!==i.prevX||l!==i.prevTravellerWidth)){i.scale.range([o,o+s-l]);var p=i.scale.domain().map(function(g){return i.scale(g)});return{prevData:a,prevTravellerWidth:l,prevUpdateId:c,prevX:o,prevWidth:s,startX:i.scale(r.startIndex),endX:i.scale(r.endIndex),scaleValues:p}}return null}},{key:"getIndexInRange",value:function(r,i){for(var a=r.length,s=0,o=a-1;o-s>1;){var l=Math.floor((s+o)/2);r[l]>i?o=l:s=l}return i>=r[o]?o:s}}])}(Tt.PureComponent);si(gc,"displayName","Brush");si(gc,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var LT,nB;function pot(){if(nB)return LT;nB=1;var e=zA();function t(n,r){var i;return e(n,function(a,s,o){return i=r(a,s,o),!i}),!!i}return LT=t,LT}var BT,rB;function mot(){if(rB)return BT;rB=1;var e=lj(),t=xo(),n=pot(),r=Zr(),i=Lv();function a(s,o,l){var c=r(s)?e:n;return l&&i(s,o,l)&&(o=void 0),c(s,t(o,3))}return BT=a,BT}var got=mot();const yot=Be(got);var Aa=function(t,n){var r=t.alwaysShow,i=t.ifOverflow;return r&&(i="extendDomain"),i===n},zT,iB;function vot(){if(iB)return zT;iB=1;var e=Aj();function t(n,r,i){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:i,writable:!0}):n[r]=i}return zT=t,zT}var jT,aB;function bot(){if(aB)return jT;aB=1;var e=vot(),t=Tj(),n=xo();function r(i,a){var s={};return a=n(a,3),t(i,function(o,l,c){e(s,l,a(o,l,c))}),s}return jT=r,jT}var xot=bot();const wot=Be(xot);var UT,sB;function Sot(){if(sB)return UT;sB=1;function e(t,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(!n(t[r],r,t))return!1;return!0}return UT=e,UT}var VT,oB;function Cot(){if(oB)return VT;oB=1;var e=zA();function t(n,r){var i=!0;return e(n,function(a,s,o){return i=!!r(a,s,o),i}),i}return VT=t,VT}var WT,lB;function Tot(){if(lB)return WT;lB=1;var e=Sot(),t=Cot(),n=xo(),r=Zr(),i=Lv();function a(s,o,l){var c=r(s)?e:t;return l&&i(s,o,l)&&(o=void 0),c(s,n(o,3))}return WT=a,WT}var $ot=Tot();const tV=Be($ot);var Aot=["x","y"];function md(e){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(e)}function y2(){return y2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y2.apply(this,arguments)}function uB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function vh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uB(Object(n),!0).forEach(function(r){kot(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function kot(e,t,n){return t=Eot(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eot(e){var t=Iot(e,"string");return md(t)=="symbol"?t:t+""}function Iot(e,t){if(md(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(md(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oot(e,t){if(e==null)return{};var n=Not(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Not(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function _ot(e,t){var n=e.x,r=e.y,i=Oot(e,Aot),a="".concat(n),s=parseInt(a,10),o="".concat(r),l=parseInt(o,10),c="".concat(t.height||i.height),h=parseInt(c,10),d="".concat(t.width||i.width),p=parseInt(d,10);return vh(vh(vh(vh(vh({},t),i),s?{x:s}:{}),l?{y:l}:{}),{},{height:h,width:p,name:t.name,radius:t.radius})}function cB(e){return et.createElement(Wst,y2({shapeType:"rectangle",propTransformer:_ot,activeClassName:"recharts-active-bar"},e))}var Rot=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,i){if(typeof t=="number")return t;var a=typeof r=="number";return a?t(r,i):(a||wl(),n)}},Dot=["value","background"],eV;function yc(e){"@babel/helpers - typeof";return yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yc(e)}function Mot(e,t){if(e==null)return{};var n=Pot(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pot(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Vy(){return Vy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vy.apply(this,arguments)}function fB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Sn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fB(Object(n),!0).forEach(function(r){no(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rV(r.key),r)}}function Lot(e,t,n){return t&&hB(e.prototype,t),n&&hB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bot(e,t,n){return t=Wy(t),zot(e,nV()?Reflect.construct(t,n||[],Wy(e).constructor):t.apply(e,n))}function zot(e,t){if(t&&(yc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jot(e)}function jot(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nV=function(){return!!e})()}function Wy(e){return Wy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Wy(e)}function Uot(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v2(e,t)}function v2(e,t){return v2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},v2(e,t)}function no(e,t,n){return t=rV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rV(e){var t=Vot(e,"string");return yc(t)=="symbol"?t:t+""}function Vot(e,t){if(yc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(yc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Vd=function(e){function t(){var n;Fot(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=Bot(this,t,[].concat(i)),no(n,"state",{isAnimationFinished:!1}),no(n,"id",Pd("recharts-bar-")),no(n,"handleAnimationEnd",function(){var s=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),s&&s()}),no(n,"handleAnimationStart",function(){var s=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),s&&s()}),n}return Uot(t,e),Lot(t,[{key:"renderRectanglesStatically",value:function(r){var i=this,a=this.props,s=a.shape,o=a.dataKey,l=a.activeIndex,c=a.activeBar,h=pe(this.props,!1);return r&&r.map(function(d,p){var g=p===l,v=g?c:s,x=Sn(Sn(Sn({},h),d),{},{isActive:g,option:v,index:p,dataKey:o,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return et.createElement(yn,Vy({className:"recharts-bar-rectangle"},sy(i.props,d,p),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value,"-").concat(p)}),et.createElement(cB,x))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,i=this.props,a=i.data,s=i.layout,o=i.isAnimationActive,l=i.animationBegin,c=i.animationDuration,h=i.animationEasing,d=i.animationId,p=this.state.prevData;return et.createElement(ys,{begin:l,duration:c,isActive:o,easing:h,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(g){var v=g.t,x=a.map(function(b,w){var C=p&&p[w];if(C){var T=Ji(C.x,b.x),$=Ji(C.y,b.y),A=Ji(C.width,b.width),E=Ji(C.height,b.height);return Sn(Sn({},b),{},{x:T(v),y:$(v),width:A(v),height:E(v)})}if(s==="horizontal"){var O=Ji(0,b.height),N=O(v);return Sn(Sn({},b),{},{y:b.y+b.height-N,height:N})}var _=Ji(0,b.width),R=_(v);return Sn(Sn({},b),{},{width:R})});return et.createElement(yn,null,r.renderRectanglesStatically(x))})}},{key:"renderRectangles",value:function(){var r=this.props,i=r.data,a=r.isAnimationActive,s=this.state.prevData;return a&&i&&i.length&&(!s||!Hv(s,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var r=this,i=this.props,a=i.data,s=i.dataKey,o=i.activeIndex,l=pe(this.props.background,!1);return a.map(function(c,h){c.value;var d=c.background,p=Mot(c,Dot);if(!d)return null;var g=Sn(Sn(Sn(Sn(Sn({},p),{},{fill:"#eee"},d),l),sy(r.props,c,h)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:s,index:h,className:"recharts-bar-background-rectangle"});return et.createElement(cB,Vy({key:"background-bar-".concat(h),option:r.props.background,isActive:h===o},g))})}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,s=a.data,o=a.xAxis,l=a.yAxis,c=a.layout,h=a.children,d=Mi(h,Ud);if(!d)return null;var p=c==="vertical"?s[0].height/2:s[0].width/2,g=function(b,w){var C=Array.isArray(b.value)?b.value[1]:b.value;return{x:b.x,y:b.y,value:C,errorVal:hi(b,w)}},v={clipPath:r?"url(#clipPath-".concat(i,")"):null};return et.createElement(yn,v,d.map(function(x){return et.cloneElement(x,{key:"error-bar-".concat(i,"-").concat(x.props.dataKey),data:s,xAxis:o,yAxis:l,layout:c,offset:p,dataPointFormatter:g})}))}},{key:"render",value:function(){var r=this.props,i=r.hide,a=r.data,s=r.className,o=r.xAxis,l=r.yAxis,c=r.left,h=r.top,d=r.width,p=r.height,g=r.isAnimationActive,v=r.background,x=r.id;if(i||!a||!a.length)return null;var b=this.state.isAnimationFinished,w=Ce("recharts-bar",s),C=o&&o.allowDataOverflow,T=l&&l.allowDataOverflow,$=C||T,A=he(x)?this.id:x;return et.createElement(yn,{className:w},C||T?et.createElement("defs",null,et.createElement("clipPath",{id:"clipPath-".concat(A)},et.createElement("rect",{x:C?c:c-d/2,y:T?h:h-p/2,width:C?d:d*2,height:T?p:p*2}))):null,et.createElement(yn,{className:"recharts-bar-rectangles",clipPath:$?"url(#clipPath-".concat(A,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar($,A),(!g||b)&&oo.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:i.curData}:r.data!==i.curData?{curData:r.data}:null}}])}(Tt.PureComponent);eV=Vd;no(Vd,"displayName","Bar");no(Vd,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!jc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});no(Vd,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,i=e.bandSize,a=e.xAxis,s=e.yAxis,o=e.xAxisTicks,l=e.yAxisTicks,c=e.stackedData,h=e.dataStartIndex,d=e.displayedData,p=e.offset,g=lrt(r,n);if(!g)return null;var v=t.layout,x=n.type.defaultProps,b=x!==void 0?Sn(Sn({},x),n.props):n.props,w=b.dataKey,C=b.children,T=b.minPointSize,$=v==="horizontal"?s:a,A=c?$.scale.domain():null,E=grt({numericAxis:$}),O=Mi(C,Rj),N=d.map(function(_,R){var I,P,B,V,z,M;c?I=urt(c[h+R],A):(I=hi(_,w),Array.isArray(I)||(I=[E,I]));var U=Rot(T,eV.defaultProps.minPointSize)(I[1],R);if(v==="horizontal"){var W,q=[s.scale(I[0]),s.scale(I[1])],F=q[0],G=q[1];P=KF({axis:a,ticks:o,bandSize:i,offset:g.offset,entry:_,index:R}),B=(W=G??F)!==null&&W!==void 0?W:void 0,V=g.size;var H=F-G;if(z=Number.isNaN(H)?0:H,M={x:P,y:s.y,width:V,height:s.height},Math.abs(U)>0&&Math.abs(z)<Math.abs(U)){var Y=ra(z||U)*(Math.abs(U)-Math.abs(z));B-=Y,z+=Y}}else{var ot=[a.scale(I[0]),a.scale(I[1])],ht=ot[0],yt=ot[1];if(P=ht,B=KF({axis:s,ticks:l,bandSize:i,offset:g.offset,entry:_,index:R}),V=yt-ht,z=g.size,M={x:a.x,y:B,width:a.width,height:z},Math.abs(U)>0&&Math.abs(V)<Math.abs(U)){var It=ra(V||U)*(Math.abs(U)-Math.abs(V));V+=It}}return Sn(Sn(Sn({},_),{},{x:P,y:B,width:V,height:z,value:c?I:I[1],payload:_,background:M},O&&O[R]&&O[R].props),{},{tooltipPayload:[BU(n,_)],tooltipPosition:{x:P+V/2,y:B+z/2}})});return Sn({data:N,layout:v},p)});function gd(e){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gd(e)}function Wot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,iV(r.key),r)}}function Got(e,t,n){return t&&dB(e.prototype,t),n&&dB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function pB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Zi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pB(Object(n),!0).forEach(function(r){Qv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Qv(e,t,n){return t=iV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iV(e){var t=qot(e,"string");return gd(t)=="symbol"?t:t+""}function qot(e,t){if(gd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(gd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hot=function(t,n,r,i,a){var s=t.width,o=t.height,l=t.layout,c=t.children,h=Object.keys(n),d={left:r.left,leftMirror:r.left,right:s-r.right,rightMirror:s-r.right,top:r.top,topMirror:r.top,bottom:o-r.bottom,bottomMirror:o-r.bottom},p=!!oi(c,Vd);return h.reduce(function(g,v){var x=n[v],b=x.orientation,w=x.domain,C=x.padding,T=C===void 0?{}:C,$=x.mirror,A=x.reversed,E="".concat(b).concat($?"Mirror":""),O,N,_,R,I;if(x.type==="number"&&(x.padding==="gap"||x.padding==="no-gap")){var P=w[1]-w[0],B=1/0,V=x.categoricalDomain.sort(V7);if(V.forEach(function(ot,ht){ht>0&&(B=Math.min((ot||0)-(V[ht-1]||0),B))}),Number.isFinite(B)){var z=B/P,M=x.layout==="vertical"?r.height:r.width;if(x.padding==="gap"&&(O=z*M/2),x.padding==="no-gap"){var U=bl(t.barCategoryGap,z*M),W=z*M/2;O=W-U-(W-U)/M*U}}}i==="xAxis"?N=[r.left+(T.left||0)+(O||0),r.left+r.width-(T.right||0)-(O||0)]:i==="yAxis"?N=l==="horizontal"?[r.top+r.height-(T.bottom||0),r.top+(T.top||0)]:[r.top+(T.top||0)+(O||0),r.top+r.height-(T.bottom||0)-(O||0)]:N=x.range,A&&(N=[N[1],N[0]]);var q=srt(x,a,p),F=q.scale,G=q.realScaleType;F.domain(w).range(N),ort(F);var H=mrt(F,Zi(Zi({},x),{},{realScaleType:G}));i==="xAxis"?(I=b==="top"&&!$||b==="bottom"&&$,_=r.left,R=d[E]-I*x.height):i==="yAxis"&&(I=b==="left"&&!$||b==="right"&&$,_=d[E]-I*x.width,R=r.top);var Y=Zi(Zi(Zi({},x),H),{},{realScaleType:G,x:_,y:R,scale:F,width:i==="xAxis"?r.width:x.width,height:i==="yAxis"?r.height:x.height});return Y.bandSize=Ny(Y,H),!x.hide&&i==="xAxis"?d[E]+=(I?-1:1)*Y.height:x.hide||(d[E]+=(I?-1:1)*Y.width),Zi(Zi({},g),{},Qv({},v,Y))},{})},aV=function(t,n){var r=t.x,i=t.y,a=n.x,s=n.y;return{x:Math.min(r,a),y:Math.min(i,s),width:Math.abs(a-r),height:Math.abs(s-i)}},Xot=function(t){var n=t.x1,r=t.y1,i=t.x2,a=t.y2;return aV({x:n,y:r},{x:i,y:a})},sV=function(){function e(t){Wot(this,e),this.scale=t}return Got(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.bandAware,a=r.position;if(n!==void 0){if(a)switch(a){case"start":return this.scale(n);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+s}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(n)+o}default:return this.scale(n)}if(i){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),i=r[0],a=r[r.length-1];return i<=a?n>=i&&n<=a:n>=a&&n<=i}}],[{key:"create",value:function(n){return new e(n)}}])}();Qv(sV,"EPS",1e-4);var gk=function(t){var n=Object.keys(t).reduce(function(r,i){return Zi(Zi({},r),{},Qv({},i,sV.create(t[i])))},{});return Zi(Zi({},n),{},{apply:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.bandAware,o=a.position;return wot(i,function(l,c){return n[c].apply(l,{bandAware:s,position:o})})},isInRange:function(i){return tV(i,function(a,s){return n[s].isInRange(a)})}})};function Kot(e){return(e%180+180)%180}var Yot=function(t){var n=t.width,r=t.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Kot(i),s=a*Math.PI/180,o=Math.atan(r/n),l=s>o&&s<Math.PI-o?r/Math.sin(s):n/Math.cos(s);return Math.abs(l)},GT,mB;function Zot(){if(mB)return GT;mB=1;var e=xo(),t=Fd(),n=Pv();function r(i){return function(a,s,o){var l=Object(a);if(!t(a)){var c=e(s,3);a=n(a),s=function(d){return c(l[d],d,l)}}var h=i(a,s,o);return h>-1?l[c?a[h]:h]:void 0}}return GT=r,GT}var qT,gB;function Qot(){if(gB)return qT;gB=1;var e=YU();function t(n){var r=e(n),i=r%1;return r===r?i?r-i:r:0}return qT=t,qT}var HT,yB;function Jot(){if(yB)return HT;yB=1;var e=bj(),t=xo(),n=Qot(),r=Math.max;function i(a,s,o){var l=a==null?0:a.length;if(!l)return-1;var c=o==null?0:n(o);return c<0&&(c=r(l+c,0)),e(a,t(s,3),c)}return HT=i,HT}var XT,vB;function tlt(){if(vB)return XT;vB=1;var e=Zot(),t=Jot(),n=e(t);return XT=n,XT}var elt=tlt();const nlt=Be(elt);var rlt=M4();const ilt=Be(rlt);var alt=ilt(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),yk=Tt.createContext(void 0),vk=Tt.createContext(void 0),oV=Tt.createContext(void 0),lV=Tt.createContext({}),uV=Tt.createContext(void 0),cV=Tt.createContext(0),fV=Tt.createContext(0),bB=function(t){var n=t.state,r=n.xAxisMap,i=n.yAxisMap,a=n.offset,s=t.clipPathId,o=t.children,l=t.width,c=t.height,h=alt(a);return et.createElement(yk.Provider,{value:r},et.createElement(vk.Provider,{value:i},et.createElement(lV.Provider,{value:a},et.createElement(oV.Provider,{value:h},et.createElement(uV.Provider,{value:s},et.createElement(cV.Provider,{value:c},et.createElement(fV.Provider,{value:l},o)))))))},slt=function(){return Tt.useContext(uV)},hV=function(t){var n=Tt.useContext(yk);n==null&&wl();var r=n[t];return r==null&&wl(),r},olt=function(){var t=Tt.useContext(yk);return eo(t)},llt=function(){var t=Tt.useContext(vk),n=nlt(t,function(r){return tV(r.domain,Number.isFinite)});return n||eo(t)},dV=function(t){var n=Tt.useContext(vk);n==null&&wl();var r=n[t];return r==null&&wl(),r},ult=function(){var t=Tt.useContext(oV);return t},clt=function(){return Tt.useContext(lV)},bk=function(){return Tt.useContext(fV)},xk=function(){return Tt.useContext(cV)};function vc(e){"@babel/helpers - typeof";return vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vc(e)}function flt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hlt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mV(r.key),r)}}function dlt(e,t,n){return t&&hlt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function plt(e,t,n){return t=Gy(t),mlt(e,pV()?Reflect.construct(t,n||[],Gy(e).constructor):t.apply(e,n))}function mlt(e,t){if(t&&(vc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return glt(e)}function glt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pV=function(){return!!e})()}function Gy(e){return Gy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Gy(e)}function ylt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b2(e,t)}function b2(e,t){return b2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},b2(e,t)}function xB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function wB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xB(Object(n),!0).forEach(function(r){wk(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function wk(e,t,n){return t=mV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mV(e){var t=vlt(e,"string");return vc(t)=="symbol"?t:t+""}function vlt(e,t){if(vc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(vc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function blt(e,t){return Clt(e)||Slt(e,t)||wlt(e,t)||xlt()}function xlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wlt(e,t){if(e){if(typeof e=="string")return SB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SB(e,t)}}function SB(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Slt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function Clt(e){if(Array.isArray(e))return e}function x2(){return x2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x2.apply(this,arguments)}var Tlt=function(t,n){var r;return et.isValidElement(t)?r=et.cloneElement(t,n):se(t)?r=t(n):r=et.createElement("line",x2({},n,{className:"recharts-reference-line-line"})),r},$lt=function(t,n,r,i,a,s,o,l,c){var h=a.x,d=a.y,p=a.width,g=a.height;if(r){var v=c.y,x=t.y.apply(v,{position:s});if(Aa(c,"discard")&&!t.y.isInRange(x))return null;var b=[{x:h+p,y:x},{x:h,y:x}];return l==="left"?b.reverse():b}if(n){var w=c.x,C=t.x.apply(w,{position:s});if(Aa(c,"discard")&&!t.x.isInRange(C))return null;var T=[{x:C,y:d+g},{x:C,y:d}];return o==="top"?T.reverse():T}if(i){var $=c.segment,A=$.map(function(E){return t.apply(E,{position:s})});return Aa(c,"discard")&&yot(A,function(E){return!t.isInRange(E)})?null:A}return null};function Alt(e){var t=e.x,n=e.y,r=e.segment,i=e.xAxisId,a=e.yAxisId,s=e.shape,o=e.className,l=e.alwaysShow,c=slt(),h=hV(i),d=dV(a),p=ult();if(!c||!p)return null;fs(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var g=gk({x:h.scale,y:d.scale}),v=zn(t),x=zn(n),b=r&&r.length===2,w=$lt(g,v,x,b,p,e.position,h.orientation,d.orientation,e);if(!w)return null;var C=blt(w,2),T=C[0],$=T.x,A=T.y,E=C[1],O=E.x,N=E.y,_=Aa(e,"hidden")?"url(#".concat(c,")"):void 0,R=wB(wB({clipPath:_},pe(e,!0)),{},{x1:$,y1:A,x2:O,y2:N});return et.createElement(yn,{className:Ce("recharts-reference-line",o)},Tlt(s,R),br.renderCallByParent(e,Xot({x1:$,y1:A,x2:O,y2:N})))}var Sk=function(e){function t(){return flt(this,t),plt(this,t,arguments)}return ylt(t,e),dlt(t,[{key:"render",value:function(){return et.createElement(Alt,this.props)}}])}(et.Component);wk(Sk,"displayName","ReferenceLine");wk(Sk,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function w2(){return w2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w2.apply(this,arguments)}function bc(e){"@babel/helpers - typeof";return bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bc(e)}function CB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function TB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CB(Object(n),!0).forEach(function(r){Jv(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function klt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Elt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yV(r.key),r)}}function Ilt(e,t,n){return t&&Elt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Olt(e,t,n){return t=qy(t),Nlt(e,gV()?Reflect.construct(t,n||[],qy(e).constructor):t.apply(e,n))}function Nlt(e,t){if(t&&(bc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _lt(e)}function _lt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gV=function(){return!!e})()}function qy(e){return qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qy(e)}function Rlt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S2(e,t)}function S2(e,t){return S2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},S2(e,t)}function Jv(e,t,n){return t=yV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yV(e){var t=Dlt(e,"string");return bc(t)=="symbol"?t:t+""}function Dlt(e,t){if(bc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(bc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Mlt=function(t){var n=t.x,r=t.y,i=t.xAxis,a=t.yAxis,s=gk({x:i.scale,y:a.scale}),o=s.apply({x:n,y:r},{bandAware:!0});return Aa(t,"discard")&&!s.isInRange(o)?null:o},tb=function(e){function t(){return klt(this,t),Olt(this,t,arguments)}return Rlt(t,e),Ilt(t,[{key:"render",value:function(){var r=this.props,i=r.x,a=r.y,s=r.r,o=r.alwaysShow,l=r.clipPathId,c=zn(i),h=zn(a);if(fs(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!h)return null;var d=Mlt(this.props);if(!d)return null;var p=d.x,g=d.y,v=this.props,x=v.shape,b=v.className,w=Aa(this.props,"hidden")?"url(#".concat(l,")"):void 0,C=TB(TB({clipPath:w},pe(this.props,!0)),{},{cx:p,cy:g});return et.createElement(yn,{className:Ce("recharts-reference-dot",b)},t.renderDot(x,C),br.renderCallByParent(this.props,{x:p-s,y:g-s,width:2*s,height:2*s}))}}])}(et.Component);Jv(tb,"displayName","ReferenceDot");Jv(tb,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Jv(tb,"renderDot",function(e,t){var n;return et.isValidElement(e)?n=et.cloneElement(e,t):se(e)?n=e(t):n=et.createElement(mk,w2({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function C2(){return C2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C2.apply(this,arguments)}function xc(e){"@babel/helpers - typeof";return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function $B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function AB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$B(Object(n),!0).forEach(function(r){eb(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$B(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Plt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Flt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bV(r.key),r)}}function Llt(e,t,n){return t&&Flt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Blt(e,t,n){return t=Hy(t),zlt(e,vV()?Reflect.construct(t,n||[],Hy(e).constructor):t.apply(e,n))}function zlt(e,t){if(t&&(xc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jlt(e)}function jlt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vV=function(){return!!e})()}function Hy(e){return Hy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Hy(e)}function Ult(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T2(e,t)}function T2(e,t){return T2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},T2(e,t)}function eb(e,t,n){return t=bV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bV(e){var t=Vlt(e,"string");return xc(t)=="symbol"?t:t+""}function Vlt(e,t){if(xc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(xc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wlt=function(t,n,r,i,a){var s=a.x1,o=a.x2,l=a.y1,c=a.y2,h=a.xAxis,d=a.yAxis;if(!h||!d)return null;var p=gk({x:h.scale,y:d.scale}),g={x:t?p.x.apply(s,{position:"start"}):p.x.rangeMin,y:r?p.y.apply(l,{position:"start"}):p.y.rangeMin},v={x:n?p.x.apply(o,{position:"end"}):p.x.rangeMax,y:i?p.y.apply(c,{position:"end"}):p.y.rangeMax};return Aa(a,"discard")&&(!p.isInRange(g)||!p.isInRange(v))?null:aV(g,v)},nb=function(e){function t(){return Plt(this,t),Blt(this,t,arguments)}return Ult(t,e),Llt(t,[{key:"render",value:function(){var r=this.props,i=r.x1,a=r.x2,s=r.y1,o=r.y2,l=r.className,c=r.alwaysShow,h=r.clipPathId;fs(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=zn(i),p=zn(a),g=zn(s),v=zn(o),x=this.props.shape;if(!d&&!p&&!g&&!v&&!x)return null;var b=Wlt(d,p,g,v,this.props);if(!b&&!x)return null;var w=Aa(this.props,"hidden")?"url(#".concat(h,")"):void 0;return et.createElement(yn,{className:Ce("recharts-reference-area",l)},t.renderRect(x,AB(AB({clipPath:w},pe(this.props,!0)),b)),br.renderCallByParent(this.props,b))}}])}(et.Component);eb(nb,"displayName","ReferenceArea");eb(nb,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});eb(nb,"renderRect",function(e,t){var n;return et.isValidElement(e)?n=et.cloneElement(e,t):se(e)?n=e(t):n=et.createElement(pk,C2({},t,{className:"recharts-reference-area-rect"})),n});function xV(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],i=0;i<e.length;i+=t)r.push(e[i]);return r}function Glt(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return Yot(r,n)}function qlt(e,t,n){var r=n==="width",i=e.x,a=e.y,s=e.width,o=e.height;return t===1?{start:r?i:a,end:r?i+s:a+o}:{start:r?i+s:a+o,end:r?i:a}}function Xy(e,t,n,r,i){if(e*t<e*r||e*t>e*i)return!1;var a=n();return e*(t-e*a/2-r)>=0&&e*(t+e*a/2-i)<=0}function Hlt(e,t){return xV(e,t+1)}function Xlt(e,t,n,r,i){for(var a=(r||[]).slice(),s=t.start,o=t.end,l=0,c=1,h=s,d=function(){var v=r==null?void 0:r[l];if(v===void 0)return{v:xV(r,c)};var x=l,b,w=function(){return b===void 0&&(b=n(v,x)),b},C=v.coordinate,T=l===0||Xy(e,C,w,h,o);T||(l=0,h=s,c+=1),T&&(h=C+e*(w()/2+i),l+=c)},p;c<=a.length;)if(p=d(),p)return p.v;return[]}function yd(e){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yd(e)}function kB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kB(Object(n),!0).forEach(function(r){Klt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Klt(e,t,n){return t=Ylt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ylt(e){var t=Zlt(e,"string");return yd(t)=="symbol"?t:t+""}function Zlt(e,t){if(yd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(yd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qlt(e,t,n,r,i){for(var a=(r||[]).slice(),s=a.length,o=t.start,l=t.end,c=function(p){var g=a[p],v,x=function(){return v===void 0&&(v=n(g,p)),v};if(p===s-1){var b=e*(g.coordinate+e*x()/2-l);a[p]=g=yr(yr({},g),{},{tickCoord:b>0?g.coordinate-b*e:g.coordinate})}else a[p]=g=yr(yr({},g),{},{tickCoord:g.coordinate});var w=Xy(e,g.tickCoord,x,o,l);w&&(l=g.tickCoord-e*(x()/2+i),a[p]=yr(yr({},g),{},{isShow:!0}))},h=s-1;h>=0;h--)c(h);return a}function Jlt(e,t,n,r,i,a){var s=(r||[]).slice(),o=s.length,l=t.start,c=t.end;if(a){var h=r[o-1],d=n(h,o-1),p=e*(h.coordinate+e*d/2-c);s[o-1]=h=yr(yr({},h),{},{tickCoord:p>0?h.coordinate-p*e:h.coordinate});var g=Xy(e,h.tickCoord,function(){return d},l,c);g&&(c=h.tickCoord-e*(d/2+i),s[o-1]=yr(yr({},h),{},{isShow:!0}))}for(var v=a?o-1:o,x=function(C){var T=s[C],$,A=function(){return $===void 0&&($=n(T,C)),$};if(C===0){var E=e*(T.coordinate-e*A()/2-l);s[C]=T=yr(yr({},T),{},{tickCoord:E<0?T.coordinate-E*e:T.coordinate})}else s[C]=T=yr(yr({},T),{},{tickCoord:T.coordinate});var O=Xy(e,T.tickCoord,A,l,c);O&&(l=T.tickCoord+e*(A()/2+i),s[C]=yr(yr({},T),{},{isShow:!0}))},b=0;b<v;b++)x(b);return s}function Ck(e,t,n){var r=e.tick,i=e.ticks,a=e.viewBox,s=e.minTickGap,o=e.orientation,l=e.interval,c=e.tickFormatter,h=e.unit,d=e.angle;if(!i||!i.length||!r)return[];if(Ot(l)||jc.isSsr)return Hlt(i,typeof l=="number"&&Ot(l)?l:0);var p=[],g=o==="top"||o==="bottom"?"width":"height",v=h&&g==="width"?_h(h,{fontSize:t,letterSpacing:n}):{width:0,height:0},x=function(T,$){var A=se(c)?c(T.value,$):T.value;return g==="width"?Glt(_h(A,{fontSize:t,letterSpacing:n}),v,d):_h(A,{fontSize:t,letterSpacing:n})[g]},b=i.length>=2?ra(i[1].coordinate-i[0].coordinate):1,w=qlt(a,b,g);return l==="equidistantPreserveStart"?Xlt(b,w,x,i,s):(l==="preserveStart"||l==="preserveStartEnd"?p=Jlt(b,w,x,i,s,l==="preserveStartEnd"):p=Qlt(b,w,x,i,s),p.filter(function(C){return C.isShow}))}var tut=["viewBox"],eut=["viewBox"],nut=["ticks"];function wc(e){"@babel/helpers - typeof";return wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wc(e)}function Hu(){return Hu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hu.apply(this,arguments)}function EB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function kr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EB(Object(n),!0).forEach(function(r){Tk(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function KT(e,t){if(e==null)return{};var n=rut(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rut(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function iut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,SV(r.key),r)}}function aut(e,t,n){return t&&IB(e.prototype,t),n&&IB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sut(e,t,n){return t=Ky(t),out(e,wV()?Reflect.construct(t,n||[],Ky(e).constructor):t.apply(e,n))}function out(e,t){if(t&&(wc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lut(e)}function lut(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wV=function(){return!!e})()}function Ky(e){return Ky=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ky(e)}function uut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$2(e,t)}function $2(e,t){return $2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},$2(e,t)}function Tk(e,t,n){return t=SV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SV(e){var t=cut(e,"string");return wc(t)=="symbol"?t:t+""}function cut(e,t){if(wc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(wc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Gc=function(e){function t(n){var r;return iut(this,t),r=sut(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return uut(t,e),aut(t,[{key:"shouldComponentUpdate",value:function(r,i){var a=r.viewBox,s=KT(r,tut),o=this.props,l=o.viewBox,c=KT(o,eut);return!Ku(a,l)||!Ku(s,c)||!Ku(i,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var i=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var i=this.props,a=i.x,s=i.y,o=i.width,l=i.height,c=i.orientation,h=i.tickSize,d=i.mirror,p=i.tickMargin,g,v,x,b,w,C,T=d?-1:1,$=r.tickSize||h,A=Ot(r.tickCoord)?r.tickCoord:r.coordinate;switch(c){case"top":g=v=r.coordinate,b=s+ +!d*l,x=b-T*$,C=x-T*p,w=A;break;case"left":x=b=r.coordinate,v=a+ +!d*o,g=v-T*$,w=g-T*p,C=A;break;case"right":x=b=r.coordinate,v=a+ +d*o,g=v+T*$,w=g+T*p,C=A;break;default:g=v=r.coordinate,b=s+ +d*l,x=b+T*$,C=x+T*p,w=A;break}return{line:{x1:g,y1:x,x2:v,y2:b},tick:{x:w,y:C}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,i=r.orientation,a=r.mirror,s;switch(i){case"left":s=a?"start":"end";break;case"right":s=a?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,i=r.orientation,a=r.mirror,s="end";switch(i){case"left":case"right":s="middle";break;case"top":s=a?"start":"end";break;default:s=a?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var r=this.props,i=r.x,a=r.y,s=r.width,o=r.height,l=r.orientation,c=r.mirror,h=r.axisLine,d=kr(kr(kr({},pe(this.props,!1)),pe(h,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var p=+(l==="top"&&!c||l==="bottom"&&c);d=kr(kr({},d),{},{x1:i,y1:a+p*o,x2:i+s,y2:a+p*o})}else{var g=+(l==="left"&&!c||l==="right"&&c);d=kr(kr({},d),{},{x1:i+g*s,y1:a,x2:i+g*s,y2:a+o})}return et.createElement("line",Hu({},d,{className:Ce("recharts-cartesian-axis-line",Di(h,"className"))}))}},{key:"renderTicks",value:function(r,i,a){var s=this,o=this.props,l=o.tickLine,c=o.stroke,h=o.tick,d=o.tickFormatter,p=o.unit,g=Ck(kr(kr({},this.props),{},{ticks:r}),i,a),v=this.getTickTextAnchor(),x=this.getTickVerticalAnchor(),b=pe(this.props,!1),w=pe(h,!1),C=kr(kr({},b),{},{fill:"none"},pe(l,!1)),T=g.map(function($,A){var E=s.getTickLineCoord($),O=E.line,N=E.tick,_=kr(kr(kr(kr({textAnchor:v,verticalAnchor:x},b),{},{stroke:"none",fill:c},w),N),{},{index:A,payload:$,visibleTicksCount:g.length,tickFormatter:d});return et.createElement(yn,Hu({className:"recharts-cartesian-axis-tick",key:"tick-".concat($.value,"-").concat($.coordinate,"-").concat($.tickCoord)},sy(s.props,$,A)),l&&et.createElement("line",Hu({},C,O,{className:Ce("recharts-cartesian-axis-tick-line",Di(l,"className"))})),h&&t.renderTickItem(h,_,"".concat(se(d)?d($.value,A):$.value).concat(p||"")))});return et.createElement("g",{className:"recharts-cartesian-axis-ticks"},T)}},{key:"render",value:function(){var r=this,i=this.props,a=i.axisLine,s=i.width,o=i.height,l=i.ticksGenerator,c=i.className,h=i.hide;if(h)return null;var d=this.props,p=d.ticks,g=KT(d,nut),v=p;return se(l)&&(v=p&&p.length>0?l(this.props):l(g)),s<=0||o<=0||!v||!v.length?null:et.createElement(yn,{className:Ce("recharts-cartesian-axis",c),ref:function(b){r.layerReference=b}},a&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),br.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,i,a){var s;return et.isValidElement(r)?s=et.cloneElement(r,i):se(r)?s=r(i):s=et.createElement(yy,Hu({},i,{className:"recharts-cartesian-axis-tick-value"}),a),s}}])}(Tt.Component);Tk(Gc,"displayName","CartesianAxis");Tk(Gc,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var fut=["x1","y1","x2","y2","key"],hut=["offset"];function Sl(e){"@babel/helpers - typeof";return Sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sl(e)}function OB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function xr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OB(Object(n),!0).forEach(function(r){dut(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dut(e,t,n){return t=put(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function put(e){var t=mut(e,"string");return Sl(t)=="symbol"?t:t+""}function mut(e,t){if(Sl(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Sl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cl(){return cl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cl.apply(this,arguments)}function NB(e,t){if(e==null)return{};var n=gut(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function gut(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var yut=function(t){var n=t.fill;if(!n||n==="none")return null;var r=t.fillOpacity,i=t.x,a=t.y,s=t.width,o=t.height,l=t.ry;return et.createElement("rect",{x:i,y:a,ry:l,width:s,height:o,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function CV(e,t){var n;if(et.isValidElement(e))n=et.cloneElement(e,t);else if(se(e))n=e(t);else{var r=t.x1,i=t.y1,a=t.x2,s=t.y2,o=t.key,l=NB(t,fut),c=pe(l,!1);c.offset;var h=NB(c,hut);n=et.createElement("line",cl({},h,{x1:r,y1:i,x2:a,y2:s,fill:"none",key:o}))}return n}function vut(e){var t=e.x,n=e.width,r=e.horizontal,i=r===void 0?!0:r,a=e.horizontalPoints;if(!i||!a||!a.length)return null;var s=a.map(function(o,l){var c=xr(xr({},e),{},{x1:t,y1:o,x2:t+n,y2:o,key:"line-".concat(l),index:l});return CV(i,c)});return et.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function but(e){var t=e.y,n=e.height,r=e.vertical,i=r===void 0?!0:r,a=e.verticalPoints;if(!i||!a||!a.length)return null;var s=a.map(function(o,l){var c=xr(xr({},e),{},{x1:o,y1:t,x2:o,y2:t+n,key:"line-".concat(l),index:l});return CV(i,c)});return et.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function xut(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,i=e.y,a=e.width,s=e.height,o=e.horizontalPoints,l=e.horizontal,c=l===void 0?!0:l;if(!c||!t||!t.length)return null;var h=o.map(function(p){return Math.round(p+i-i)}).sort(function(p,g){return p-g});i!==h[0]&&h.unshift(0);var d=h.map(function(p,g){var v=!h[g+1],x=v?i+s-p:h[g+1]-p;if(x<=0)return null;var b=g%t.length;return et.createElement("rect",{key:"react-".concat(g),y:p,x:r,height:x,width:a,stroke:"none",fill:t[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return et.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function wut(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,i=e.fillOpacity,a=e.x,s=e.y,o=e.width,l=e.height,c=e.verticalPoints;if(!n||!r||!r.length)return null;var h=c.map(function(p){return Math.round(p+a-a)}).sort(function(p,g){return p-g});a!==h[0]&&h.unshift(0);var d=h.map(function(p,g){var v=!h[g+1],x=v?a+o-p:h[g+1]-p;if(x<=0)return null;var b=g%r.length;return et.createElement("rect",{key:"react-".concat(g),x:p,y:s,width:x,height:l,stroke:"none",fill:r[b],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return et.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Sut=function(t,n){var r=t.xAxis,i=t.width,a=t.height,s=t.offset;return FU(Ck(xr(xr(xr({},Gc.defaultProps),r),{},{ticks:ls(r,!0),viewBox:{x:0,y:0,width:i,height:a}})),s.left,s.left+s.width,n)},Cut=function(t,n){var r=t.yAxis,i=t.width,a=t.height,s=t.offset;return FU(Ck(xr(xr(xr({},Gc.defaultProps),r),{},{ticks:ls(r,!0),viewBox:{x:0,y:0,width:i,height:a}})),s.top,s.top+s.height,n)},Bu={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function TV(e){var t,n,r,i,a,s,o=bk(),l=xk(),c=clt(),h=xr(xr({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Bu.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Bu.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Bu.horizontal,horizontalFill:(i=e.horizontalFill)!==null&&i!==void 0?i:Bu.horizontalFill,vertical:(a=e.vertical)!==null&&a!==void 0?a:Bu.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Bu.verticalFill,x:Ot(e.x)?e.x:c.left,y:Ot(e.y)?e.y:c.top,width:Ot(e.width)?e.width:c.width,height:Ot(e.height)?e.height:c.height}),d=h.x,p=h.y,g=h.width,v=h.height,x=h.syncWithTicks,b=h.horizontalValues,w=h.verticalValues,C=olt(),T=llt();if(!Ot(g)||g<=0||!Ot(v)||v<=0||!Ot(d)||d!==+d||!Ot(p)||p!==+p)return null;var $=h.verticalCoordinatesGenerator||Sut,A=h.horizontalCoordinatesGenerator||Cut,E=h.horizontalPoints,O=h.verticalPoints;if((!E||!E.length)&&se(A)){var N=b&&b.length,_=A({yAxis:T?xr(xr({},T),{},{ticks:N?b:T.ticks}):void 0,width:o,height:l,offset:c},N?!0:x);fs(Array.isArray(_),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Sl(_),"]")),Array.isArray(_)&&(E=_)}if((!O||!O.length)&&se($)){var R=w&&w.length,I=$({xAxis:C?xr(xr({},C),{},{ticks:R?w:C.ticks}):void 0,width:o,height:l,offset:c},R?!0:x);fs(Array.isArray(I),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Sl(I),"]")),Array.isArray(I)&&(O=I)}return et.createElement("g",{className:"recharts-cartesian-grid"},et.createElement(yut,{fill:h.fill,fillOpacity:h.fillOpacity,x:h.x,y:h.y,width:h.width,height:h.height,ry:h.ry}),et.createElement(vut,cl({},h,{offset:c,horizontalPoints:E,xAxis:C,yAxis:T})),et.createElement(but,cl({},h,{offset:c,verticalPoints:O,xAxis:C,yAxis:T})),et.createElement(xut,cl({},h,{horizontalPoints:E})),et.createElement(wut,cl({},h,{verticalPoints:O})))}TV.displayName="CartesianGrid";var Tut=["type","layout","connectNulls","ref"],$ut=["key"];function Sc(e){"@babel/helpers - typeof";return Sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sc(e)}function _B(e,t){if(e==null)return{};var n=Aut(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Aut(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Ph(){return Ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ph.apply(this,arguments)}function RB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ai(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RB(Object(n),!0).forEach(function(r){Qi(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function zu(e){return Out(e)||Iut(e)||Eut(e)||kut()}function kut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eut(e,t){if(e){if(typeof e=="string")return A2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A2(e,t)}}function Iut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Out(e){if(Array.isArray(e))return A2(e)}function A2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DB(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,AV(r.key),r)}}function _ut(e,t,n){return t&&DB(e.prototype,t),n&&DB(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rut(e,t,n){return t=Yy(t),Dut(e,$V()?Reflect.construct(t,n||[],Yy(e).constructor):t.apply(e,n))}function Dut(e,t){if(t&&(Sc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mut(e)}function Mut(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($V=function(){return!!e})()}function Yy(e){return Yy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Yy(e)}function Put(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k2(e,t)}function k2(e,t){return k2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},k2(e,t)}function Qi(e,t,n){return t=AV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AV(e){var t=Fut(e,"string");return Sc(t)=="symbol"?t:t+""}function Fut(e,t){if(Sc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Sc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wd=function(e){function t(){var n;Nut(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n=Rut(this,t,[].concat(i)),Qi(n,"state",{isAnimationFinished:!0,totalLength:0}),Qi(n,"generateSimpleStrokeDasharray",function(s,o){return"".concat(o,"px ").concat(s-o,"px")}),Qi(n,"getStrokeDasharray",function(s,o,l){var c=l.reduce(function(w,C){return w+C});if(!c)return n.generateSimpleStrokeDasharray(o,s);for(var h=Math.floor(s/c),d=s%c,p=o-s,g=[],v=0,x=0;v<l.length;x+=l[v],++v)if(x+l[v]>d){g=[].concat(zu(l.slice(0,v)),[d-x]);break}var b=g.length%2===0?[0,p]:[p];return[].concat(zu(t.repeat(l,h)),zu(g),b).map(function(w){return"".concat(w,"px")}).join(", ")}),Qi(n,"id",Pd("recharts-line-")),Qi(n,"pathRef",function(s){n.mainCurve=s}),Qi(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Qi(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Put(t,e),_ut(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,s=a.points,o=a.xAxis,l=a.yAxis,c=a.layout,h=a.children,d=Mi(h,Ud);if(!d)return null;var p=function(x,b){return{x:x.x,y:x.y,value:x.value,errorVal:hi(x.payload,b)}},g={clipPath:r?"url(#clipPath-".concat(i,")"):null};return et.createElement(yn,g,d.map(function(v){return et.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:s,xAxis:o,yAxis:l,layout:c,dataPointFormatter:p})}))}},{key:"renderDots",value:function(r,i,a){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.dot,c=o.points,h=o.dataKey,d=pe(this.props,!1),p=pe(l,!0),g=c.map(function(x,b){var w=ai(ai(ai({key:"dot-".concat(b),r:3},d),p),{},{index:b,cx:x.x,cy:x.y,value:x.value,dataKey:h,payload:x.payload,points:c});return t.renderDotItem(l,w)}),v={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(a,")"):null};return et.createElement(yn,Ph({className:"recharts-line-dots",key:"dots"},v),g)}},{key:"renderCurveStatically",value:function(r,i,a,s){var o=this.props,l=o.type,c=o.layout,h=o.connectNulls;o.ref;var d=_B(o,Tut),p=ai(ai(ai({},pe(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(a,")"):null,points:r},s),{},{type:l,layout:c,connectNulls:h});return et.createElement(i2,Ph({},p,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,i){var a=this,s=this.props,o=s.points,l=s.strokeDasharray,c=s.isAnimationActive,h=s.animationBegin,d=s.animationDuration,p=s.animationEasing,g=s.animationId,v=s.animateNewValues,x=s.width,b=s.height,w=this.state,C=w.prevPoints,T=w.totalLength;return et.createElement(ys,{begin:h,duration:d,isActive:c,easing:p,from:{t:0},to:{t:1},key:"line-".concat(g),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function($){var A=$.t;if(C){var E=C.length/o.length,O=o.map(function(P,B){var V=Math.floor(B*E);if(C[V]){var z=C[V],M=Ji(z.x,P.x),U=Ji(z.y,P.y);return ai(ai({},P),{},{x:M(A),y:U(A)})}if(v){var W=Ji(x*2,P.x),q=Ji(b/2,P.y);return ai(ai({},P),{},{x:W(A),y:q(A)})}return ai(ai({},P),{},{x:P.x,y:P.y})});return a.renderCurveStatically(O,r,i)}var N=Ji(0,T),_=N(A),R;if(l){var I="".concat(l).split(/[,\s]+/gim).map(function(P){return parseFloat(P)});R=a.getStrokeDasharray(_,T,I)}else R=a.generateSimpleStrokeDasharray(T,_);return a.renderCurveStatically(o,r,i,{strokeDasharray:R})})}},{key:"renderCurve",value:function(r,i){var a=this.props,s=a.points,o=a.isAnimationActive,l=this.state,c=l.prevPoints,h=l.totalLength;return o&&s&&s.length&&(!c&&h>0||!Hv(c,s))?this.renderCurveWithAnimation(r,i):this.renderCurveStatically(s,r,i)}},{key:"render",value:function(){var r,i=this.props,a=i.hide,s=i.dot,o=i.points,l=i.className,c=i.xAxis,h=i.yAxis,d=i.top,p=i.left,g=i.width,v=i.height,x=i.isAnimationActive,b=i.id;if(a||!o||!o.length)return null;var w=this.state.isAnimationFinished,C=o.length===1,T=Ce("recharts-line",l),$=c&&c.allowDataOverflow,A=h&&h.allowDataOverflow,E=$||A,O=he(b)?this.id:b,N=(r=pe(s,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},_=N.r,R=_===void 0?3:_,I=N.strokeWidth,P=I===void 0?2:I,B=Q7(s)?s:{},V=B.clipDot,z=V===void 0?!0:V,M=R*2+P;return et.createElement(yn,{className:T},$||A?et.createElement("defs",null,et.createElement("clipPath",{id:"clipPath-".concat(O)},et.createElement("rect",{x:$?p:p-g/2,y:A?d:d-v/2,width:$?g:g*2,height:A?v:v*2})),!z&&et.createElement("clipPath",{id:"clipPath-dots-".concat(O)},et.createElement("rect",{x:p-M/2,y:d-M/2,width:g+M,height:v+M}))):null,!C&&this.renderCurve(E,O),this.renderErrorBar(E,O),(C||s)&&this.renderDots(E,z,O),(!x||w)&&oo.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:i.curPoints}:r.points!==i.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,i){for(var a=r.length%2!==0?[].concat(zu(r),[0]):r,s=[],o=0;o<i;++o)s=[].concat(zu(s),zu(a));return s}},{key:"renderDotItem",value:function(r,i){var a;if(et.isValidElement(r))a=et.cloneElement(r,i);else if(se(r))a=r(i);else{var s=i.key,o=_B(i,$ut),l=Ce("recharts-line-dot",typeof r!="boolean"?r.className:"");a=et.createElement(mk,Ph({key:s},o,{className:l}))}return a}}])}(Tt.PureComponent);Qi(Wd,"displayName","Line");Qi(Wd,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!jc.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Qi(Wd,"getComposedData",function(e){var t=e.props,n=e.xAxis,r=e.yAxis,i=e.xAxisTicks,a=e.yAxisTicks,s=e.dataKey,o=e.bandSize,l=e.displayedData,c=e.offset,h=t.layout,d=l.map(function(p,g){var v=hi(p,s);return h==="horizontal"?{x:XF({axis:n,ticks:i,bandSize:o,entry:p,index:g}),y:he(v)?null:r.scale(v),value:v,payload:p}:{x:he(v)?null:n.scale(v),y:XF({axis:r,ticks:a,bandSize:o,entry:p,index:g}),value:v,payload:p}});return ai({points:d,layout:h},c)});function Cc(e){"@babel/helpers - typeof";return Cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cc(e)}function Lut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function But(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,IV(r.key),r)}}function zut(e,t,n){return t&&But(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jut(e,t,n){return t=Zy(t),Uut(e,kV()?Reflect.construct(t,n||[],Zy(e).constructor):t.apply(e,n))}function Uut(e,t){if(t&&(Cc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vut(e)}function Vut(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kV=function(){return!!e})()}function Zy(e){return Zy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Zy(e)}function Wut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E2(e,t)}function E2(e,t){return E2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},E2(e,t)}function EV(e,t,n){return t=IV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IV(e){var t=Gut(e,"string");return Cc(t)=="symbol"?t:t+""}function Gut(e,t){if(Cc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Cc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function I2(){return I2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I2.apply(this,arguments)}function qut(e){var t=e.xAxisId,n=bk(),r=xk(),i=hV(t);return i==null?null:et.createElement(Gc,I2({},i,{className:Ce("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(s){return ls(s,!0)}}))}var rb=function(e){function t(){return Lut(this,t),jut(this,t,arguments)}return Wut(t,e),zut(t,[{key:"render",value:function(){return et.createElement(qut,this.props)}}])}(et.Component);EV(rb,"displayName","XAxis");EV(rb,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Tc(e){"@babel/helpers - typeof";return Tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tc(e)}function Hut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_V(r.key),r)}}function Kut(e,t,n){return t&&Xut(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yut(e,t,n){return t=Qy(t),Zut(e,OV()?Reflect.construct(t,n||[],Qy(e).constructor):t.apply(e,n))}function Zut(e,t){if(t&&(Tc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qut(e)}function Qut(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OV=function(){return!!e})()}function Qy(e){return Qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Qy(e)}function Jut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O2(e,t)}function O2(e,t){return O2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},O2(e,t)}function NV(e,t,n){return t=_V(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _V(e){var t=tct(e,"string");return Tc(t)=="symbol"?t:t+""}function tct(e,t){if(Tc(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Tc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function N2(){return N2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N2.apply(this,arguments)}var ect=function(t){var n=t.yAxisId,r=bk(),i=xk(),a=dV(n);return a==null?null:et.createElement(Gc,N2({},a,{className:Ce("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(o){return ls(o,!0)}}))},ib=function(e){function t(){return Hut(this,t),Yut(this,t,arguments)}return Jut(t,e),Kut(t,[{key:"render",value:function(){return et.createElement(ect,this.props)}}])}(et.Component);NV(ib,"displayName","YAxis");NV(ib,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function MB(e){return act(e)||ict(e)||rct(e)||nct()}function nct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rct(e,t){if(e){if(typeof e=="string")return _2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _2(e,t)}}function ict(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function act(e){if(Array.isArray(e))return _2(e)}function _2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R2=function(t,n,r,i,a){var s=Mi(t,Sk),o=Mi(t,tb),l=[].concat(MB(s),MB(o)),c=Mi(t,nb),h="".concat(i,"Id"),d=i[0],p=n;if(l.length&&(p=l.reduce(function(x,b){if(b.props[h]===r&&Aa(b.props,"extendDomain")&&Ot(b.props[d])){var w=b.props[d];return[Math.min(x[0],w),Math.max(x[1],w)]}return x},p)),c.length){var g="".concat(d,"1"),v="".concat(d,"2");p=c.reduce(function(x,b){if(b.props[h]===r&&Aa(b.props,"extendDomain")&&Ot(b.props[g])&&Ot(b.props[v])){var w=b.props[g],C=b.props[v];return[Math.min(x[0],w,C),Math.max(x[1],w,C)]}return x},p)}return a&&a.length&&(p=a.reduce(function(x,b){return Ot(b)?[Math.min(x[0],b),Math.max(x[1],b)]:x},p)),p},YT={exports:{}},PB;function sct(){return PB||(PB=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,h){this.fn=l,this.context=c,this.once=h||!1}function a(l,c,h,d,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new i(h,d||l,p),v=n?n+c:c;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],g]:l._events[v].push(g):(l._events[v]=g,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],h,d;if(this._eventsCount===0)return c;for(d in h=this._events)t.call(h,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(h)):c},o.prototype.listeners=function(c){var h=n?n+c:c,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,g=d.length,v=new Array(g);p<g;p++)v[p]=d[p].fn;return v},o.prototype.listenerCount=function(c){var h=n?n+c:c,d=this._events[h];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,h,d,p,g,v){var x=n?n+c:c;if(!this._events[x])return!1;var b=this._events[x],w=arguments.length,C,T;if(b.fn){switch(b.once&&this.removeListener(c,b.fn,void 0,!0),w){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,d),!0;case 4:return b.fn.call(b.context,h,d,p),!0;case 5:return b.fn.call(b.context,h,d,p,g),!0;case 6:return b.fn.call(b.context,h,d,p,g,v),!0}for(T=1,C=new Array(w-1);T<w;T++)C[T-1]=arguments[T];b.fn.apply(b.context,C)}else{var $=b.length,A;for(T=0;T<$;T++)switch(b[T].once&&this.removeListener(c,b[T].fn,void 0,!0),w){case 1:b[T].fn.call(b[T].context);break;case 2:b[T].fn.call(b[T].context,h);break;case 3:b[T].fn.call(b[T].context,h,d);break;case 4:b[T].fn.call(b[T].context,h,d,p);break;default:if(!C)for(A=1,C=new Array(w-1);A<w;A++)C[A-1]=arguments[A];b[T].fn.apply(b[T].context,C)}}return!0},o.prototype.on=function(c,h,d){return a(this,c,h,d,!1)},o.prototype.once=function(c,h,d){return a(this,c,h,d,!0)},o.prototype.removeListener=function(c,h,d,p){var g=n?n+c:c;if(!this._events[g])return this;if(!h)return s(this,g),this;var v=this._events[g];if(v.fn)v.fn===h&&(!p||v.once)&&(!d||v.context===d)&&s(this,g);else{for(var x=0,b=[],w=v.length;x<w;x++)(v[x].fn!==h||p&&!v[x].once||d&&v[x].context!==d)&&b.push(v[x]);b.length?this._events[g]=b.length===1?b[0]:b:s(this,g)}return this},o.prototype.removeAllListeners=function(c){var h;return c?(h=n?n+c:c,this._events[h]&&s(this,h)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(YT)),YT.exports}var oct=sct();const lct=Be(oct);var ZT=new lct,QT="recharts.syncMouseEvents";function vd(e){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vd(e)}function uct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,RV(r.key),r)}}function fct(e,t,n){return t&&cct(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JT(e,t,n){return t=RV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RV(e){var t=hct(e,"string");return vd(t)=="symbol"?t:t+""}function hct(e,t){if(vd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(vd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var dct=function(){function e(){uct(this,e),JT(this,"activeIndex",0),JT(this,"coordinateList",[]),JT(this,"layout","horizontal")}return fct(e,[{key:"setDetails",value:function(n){var r,i=n.coordinateList,a=i===void 0?null:i,s=n.container,o=s===void 0?null:s,l=n.layout,c=l===void 0?null:l,h=n.offset,d=h===void 0?null:h,p=n.mouseHandlerCallback,g=p===void 0?null:p;this.coordinateList=(r=a??this.coordinateList)!==null&&r!==void 0?r:[],this.container=o??this.container,this.layout=c??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=g??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),a=i.x,s=i.y,o=i.height,l=this.coordinateList[this.activeIndex].coordinate,c=((n=window)===null||n===void 0?void 0:n.scrollX)||0,h=((r=window)===null||r===void 0?void 0:r.scrollY)||0,d=a+l+c,p=s+this.offset.top+o/2+h;this.mouseHandlerCallback({pageX:d,pageY:p})}}}])}();function pct(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],i=e==null?void 0:e[1];if(r&&i&&Ot(r)&&Ot(i))return!0}return!1}function mct(e,t,n,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-i,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function DV(e){var t=e.cx,n=e.cy,r=e.radius,i=e.startAngle,a=e.endAngle,s=or(t,n,r,i),o=or(t,n,r,a);return{points:[s,o],cx:t,cy:n,radius:r,startAngle:i,endAngle:a}}function gct(e,t,n){var r,i,a,s;if(e==="horizontal")r=t.x,a=r,i=n.top,s=n.top+n.height;else if(e==="vertical")i=t.y,s=i,r=n.left,a=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var o=t.cx,l=t.cy,c=t.innerRadius,h=t.outerRadius,d=t.angle,p=or(o,l,c,d),g=or(o,l,h,d);r=p.x,i=p.y,a=g.x,s=g.y}else return DV(t);return[{x:r,y:i},{x:a,y:s}]}function bd(e){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bd(e)}function FB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Dg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FB(Object(n),!0).forEach(function(r){yct(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yct(e,t,n){return t=vct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vct(e){var t=bct(e,"string");return bd(t)=="symbol"?t:t+""}function bct(e,t){if(bd(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(bd(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xct(e){var t,n,r=e.element,i=e.tooltipEventType,a=e.isActive,s=e.activeCoordinate,o=e.activePayload,l=e.offset,c=e.activeTooltipIndex,h=e.tooltipAxisBandSize,d=e.layout,p=e.chartName,g=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!g||!a||!s||p!=="ScatterChart"&&i!=="axis")return null;var v,x=i2;if(p==="ScatterChart")v=s,x=yst;else if(p==="BarChart")v=mct(d,s,l,h),x=pk;else if(d==="radial"){var b=DV(s),w=b.cx,C=b.cy,T=b.radius,$=b.startAngle,A=b.endAngle;v={cx:w,cy:C,startAngle:$,endAngle:A,innerRadius:T,outerRadius:T},x=UU}else v={points:gct(d,s,l)},x=i2;var E=Dg(Dg(Dg(Dg({stroke:"#ccc",pointerEvents:"none"},l),v),pe(g,!1)),{},{payload:o,payloadIndex:c,className:Ce("recharts-tooltip-cursor",g.className)});return Tt.isValidElement(g)?Tt.cloneElement(g,E):Tt.createElement(x,E)}var wct=["item"],Sct=["children","className","width","height","style","compact","title","desc"];function $c(e){"@babel/helpers - typeof";return $c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$c(e)}function Xu(){return Xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xu.apply(this,arguments)}function LB(e,t){return $ct(e)||Tct(e,t)||PV(e,t)||Cct()}function Cct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tct(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(h){c=!0,i=h}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function $ct(e){if(Array.isArray(e))return e}function BB(e,t){if(e==null)return{};var n=Act(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Act(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function kct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ect(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,FV(r.key),r)}}function Ict(e,t,n){return t&&Ect(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oct(e,t,n){return t=Jy(t),Nct(e,MV()?Reflect.construct(t,n||[],Jy(e).constructor):t.apply(e,n))}function Nct(e,t){if(t&&($c(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _ct(e)}function _ct(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MV(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MV=function(){return!!e})()}function Jy(e){return Jy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Jy(e)}function Rct(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D2(e,t)}function D2(e,t){return D2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},D2(e,t)}function Ac(e){return Pct(e)||Mct(e)||PV(e)||Dct()}function Dct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PV(e,t){if(e){if(typeof e=="string")return M2(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M2(e,t)}}function Mct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pct(e){if(Array.isArray(e))return M2(e)}function M2(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zB(Object(n),!0).forEach(function(r){Xt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Xt(e,t,n){return t=FV(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FV(e){var t=Fct(e,"string");return $c(t)=="symbol"?t:t+""}function Fct(e,t){if($c(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if($c(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lct={xAxis:["bottom","top"],yAxis:["left","right"]},Bct={width:"100%",height:"100%"},LV={x:0,y:0};function Mg(e){return e}var zct=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},jct=function(t,n,r,i){var a=n.find(function(h){return h&&h.index===r});if(a){if(t==="horizontal")return{x:a.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:a.coordinate};if(t==="centric"){var s=a.coordinate,o=i.radius;return vt(vt(vt({},i),or(i.cx,i.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,c=i.angle;return vt(vt(vt({},i),or(i.cx,i.cy,l,c)),{},{angle:c,radius:l})}return LV},ab=function(t,n){var r=n.graphicalItems,i=n.dataStartIndex,a=n.dataEndIndex,s=(r??[]).reduce(function(o,l){var c=l.props.data;return c&&c.length?[].concat(Ac(o),Ac(c)):o},[]);return s.length>0?s:t&&t.length&&Ot(i)&&Ot(a)?t.slice(i,a+1):[]};function BV(e){return e==="number"?[0,"auto"]:void 0}var P2=function(t,n,r,i){var a=t.graphicalItems,s=t.tooltipAxis,o=ab(n,t);return r<0||!a||!a.length||r>=o.length?null:a.reduce(function(l,c){var h,d=(h=c.props.data)!==null&&h!==void 0?h:n;d&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=r&&(d=d.slice(t.dataStartIndex,t.dataEndIndex+1));var p;if(s.dataKey&&!s.allowDuplicatedCategory){var g=d===void 0?o:d;p=iy(g,s.dataKey,i)}else p=d&&d[r]||o[r];return p?[].concat(Ac(l),[BU(c,p)]):l},[])},jB=function(t,n,r,i){var a=i||{x:t.chartX,y:t.chartY},s=zct(a,r),o=t.orderedTooltipTicks,l=t.tooltipAxis,c=t.tooltipTicks,h=trt(s,o,c,l);if(h>=0&&c){var d=c[h]&&c[h].value,p=P2(t,n,h,d),g=jct(r,o,h,a);return{activeTooltipIndex:h,activeLabel:d,activePayload:p,activeCoordinate:g}}return null},Uct=function(t,n){var r=n.axes,i=n.graphicalItems,a=n.axisType,s=n.axisIdKey,o=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,h=t.layout,d=t.children,p=t.stackOffset,g=PU(h,a);return r.reduce(function(v,x){var b,w=x.type.defaultProps!==void 0?vt(vt({},x.type.defaultProps),x.props):x.props,C=w.type,T=w.dataKey,$=w.allowDataOverflow,A=w.allowDuplicatedCategory,E=w.scale,O=w.ticks,N=w.includeHidden,_=w[s];if(v[_])return v;var R=ab(t.data,{graphicalItems:i.filter(function(H){var Y,ot=s in H.props?H.props[s]:(Y=H.type.defaultProps)===null||Y===void 0?void 0:Y[s];return ot===_}),dataStartIndex:l,dataEndIndex:c}),I=R.length,P,B,V;pct(w.domain,$,C)&&(P=J$(w.domain,null,$),g&&(C==="number"||E!=="auto")&&(V=Dh(R,T,"category")));var z=BV(C);if(!P||P.length===0){var M,U=(M=w.domain)!==null&&M!==void 0?M:z;if(T){if(P=Dh(R,T,C),C==="category"&&g){var W=U7(P);A&&W?(B=P,P=zy(0,I)):A||(P=QF(U,P,x).reduce(function(H,Y){return H.indexOf(Y)>=0?H:[].concat(Ac(H),[Y])},[]))}else if(C==="category")A?P=P.filter(function(H){return H!==""&&!he(H)}):P=QF(U,P,x).reduce(function(H,Y){return H.indexOf(Y)>=0||Y===""||he(Y)?H:[].concat(Ac(H),[Y])},[]);else if(C==="number"){var q=art(R,i.filter(function(H){var Y,ot,ht=s in H.props?H.props[s]:(Y=H.type.defaultProps)===null||Y===void 0?void 0:Y[s],yt="hide"in H.props?H.props.hide:(ot=H.type.defaultProps)===null||ot===void 0?void 0:ot.hide;return ht===_&&(N||!yt)}),T,a,h);q&&(P=q)}g&&(C==="number"||E!=="auto")&&(V=Dh(R,T,"category"))}else g?P=zy(0,I):o&&o[_]&&o[_].hasStack&&C==="number"?P=p==="expand"?[0,1]:LU(o[_].stackGroups,l,c):P=MU(R,i.filter(function(H){var Y=s in H.props?H.props[s]:H.type.defaultProps[s],ot="hide"in H.props?H.props.hide:H.type.defaultProps.hide;return Y===_&&(N||!ot)}),C,h,!0);if(C==="number")P=R2(d,P,_,a,O),U&&(P=J$(U,P,$));else if(C==="category"&&U){var F=U,G=P.every(function(H){return F.indexOf(H)>=0});G&&(P=F)}}return vt(vt({},v),{},Xt({},_,vt(vt({},w),{},{axisType:a,domain:P,categoricalDomain:V,duplicateDomain:B,originalDomain:(b=w.domain)!==null&&b!==void 0?b:z,isCategorical:g,layout:h})))},{})},Vct=function(t,n){var r=n.graphicalItems,i=n.Axis,a=n.axisType,s=n.axisIdKey,o=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,h=t.layout,d=t.children,p=ab(t.data,{graphicalItems:r,dataStartIndex:l,dataEndIndex:c}),g=p.length,v=PU(h,a),x=-1;return r.reduce(function(b,w){var C=w.type.defaultProps!==void 0?vt(vt({},w.type.defaultProps),w.props):w.props,T=C[s],$=BV("number");if(!b[T]){x++;var A;return v?A=zy(0,g):o&&o[T]&&o[T].hasStack?(A=LU(o[T].stackGroups,l,c),A=R2(d,A,T,a)):(A=J$($,MU(p,r.filter(function(E){var O,N,_=s in E.props?E.props[s]:(O=E.type.defaultProps)===null||O===void 0?void 0:O[s],R="hide"in E.props?E.props.hide:(N=E.type.defaultProps)===null||N===void 0?void 0:N.hide;return _===T&&!R}),"number",h),i.defaultProps.allowDataOverflow),A=R2(d,A,T,a)),vt(vt({},b),{},Xt({},T,vt(vt({axisType:a},i.defaultProps),{},{hide:!0,orientation:Di(Lct,"".concat(a,".").concat(x%2),null),domain:A,originalDomain:$,isCategorical:v,layout:h})))}return b},{})},Wct=function(t,n){var r=n.axisType,i=r===void 0?"xAxis":r,a=n.AxisComp,s=n.graphicalItems,o=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,h=t.children,d="".concat(i,"Id"),p=Mi(h,a),g={};return p&&p.length?g=Uct(t,{axes:p,graphicalItems:s,axisType:i,axisIdKey:d,stackGroups:o,dataStartIndex:l,dataEndIndex:c}):s&&s.length&&(g=Vct(t,{Axis:a,graphicalItems:s,axisType:i,axisIdKey:d,stackGroups:o,dataStartIndex:l,dataEndIndex:c})),g},Gct=function(t){var n=eo(t),r=ls(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:jA(r,function(i){return i.coordinate}),tooltipAxis:n,tooltipAxisBandSize:Ny(n,r)}},UB=function(t){var n=t.children,r=t.defaultShowTooltip,i=oi(n,gc),a=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(a=i.props.startIndex),i.props.endIndex>=0&&(s=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!r}},qct=function(t){return!t||!t.length?!1:t.some(function(n){var r=cs(n&&n.type);return r&&r.indexOf("Bar")>=0})},VB=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Hct=function(t,n){var r=t.props,i=t.graphicalItems,a=t.xAxisMap,s=a===void 0?{}:a,o=t.yAxisMap,l=o===void 0?{}:o,c=r.width,h=r.height,d=r.children,p=r.margin||{},g=oi(d,gc),v=oi(d,Yu),x=Object.keys(l).reduce(function(A,E){var O=l[E],N=O.orientation;return!O.mirror&&!O.hide?vt(vt({},A),{},Xt({},N,A[N]+O.width)):A},{left:p.left||0,right:p.right||0}),b=Object.keys(s).reduce(function(A,E){var O=s[E],N=O.orientation;return!O.mirror&&!O.hide?vt(vt({},A),{},Xt({},N,Di(A,"".concat(N))+O.height)):A},{top:p.top||0,bottom:p.bottom||0}),w=vt(vt({},b),x),C=w.bottom;g&&(w.bottom+=g.props.height||gc.defaultProps.height),v&&n&&(w=rrt(w,i,r,n));var T=c-w.left-w.right,$=h-w.top-w.bottom;return vt(vt({brushBottom:C},w),{},{width:Math.max(T,0),height:Math.max($,0)})},Xct=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},Kct=function(t){var n=t.chartName,r=t.GraphicalChild,i=t.defaultTooltipEventType,a=i===void 0?"axis":i,s=t.validateTooltipEventTypes,o=s===void 0?["axis"]:s,l=t.axisComponents,c=t.legendContent,h=t.formatAxisMap,d=t.defaultProps,p=function(w,C){var T=C.graphicalItems,$=C.stackGroups,A=C.offset,E=C.updateId,O=C.dataStartIndex,N=C.dataEndIndex,_=w.barSize,R=w.layout,I=w.barGap,P=w.barCategoryGap,B=w.maxBarSize,V=VB(R),z=V.numericAxisName,M=V.cateAxisName,U=qct(T),W=[];return T.forEach(function(q,F){var G=ab(w.data,{graphicalItems:[q],dataStartIndex:O,dataEndIndex:N}),H=q.type.defaultProps!==void 0?vt(vt({},q.type.defaultProps),q.props):q.props,Y=H.dataKey,ot=H.maxBarSize,ht=H["".concat(z,"Id")],yt=H["".concat(M,"Id")],It={},$t=l.reduce(function(pn,nn){var Fr=C["".concat(nn.axisType,"Map")],dr=H["".concat(nn.axisType,"Id")];Fr&&Fr[dr]||nn.axisType==="zAxis"||wl();var Lr=Fr[dr];return vt(vt({},pn),{},Xt(Xt({},nn.axisType,Lr),"".concat(nn.axisType,"Ticks"),ls(Lr)))},It),mt=$t[M],At=$t["".concat(M,"Ticks")],kt=$&&$[ht]&&$[ht].hasStack&&yrt(q,$[ht].stackGroups),gt=cs(q.type).indexOf("Bar")>=0,Ut=Ny(mt,At),Lt=[],Zt=U&&ert({barSize:_,stackGroups:$,totalSize:Xct($t,M)});if(gt){var Wt,qt,fe=he(ot)?B:ot,Rn=(Wt=(qt=Ny(mt,At,!0))!==null&&qt!==void 0?qt:fe)!==null&&Wt!==void 0?Wt:0;Lt=nrt({barGap:I,barCategoryGap:P,bandSize:Rn!==Ut?Rn:Ut,sizeList:Zt[yt],maxBarSize:fe}),Rn!==Ut&&(Lt=Lt.map(function(pn){return vt(vt({},pn),{},{position:vt(vt({},pn.position),{},{offset:pn.position.offset-Rn/2})})}))}var Ge=q&&q.type&&q.type.getComposedData;Ge&&W.push({props:vt(vt({},Ge(vt(vt({},$t),{},{displayedData:G,props:w,dataKey:Y,item:q,bandSize:Ut,barPosition:Lt,offset:A,stackedData:kt,layout:R,dataStartIndex:O,dataEndIndex:N}))),{},Xt(Xt(Xt({key:q.key||"item-".concat(F)},z,$t[z]),M,$t[M]),"animationId",E)),childIndex:e9(q,w.children),item:q})}),W},g=function(w,C){var T=w.props,$=w.dataStartIndex,A=w.dataEndIndex,E=w.updateId;if(!hM({props:T}))return null;var O=T.children,N=T.layout,_=T.stackOffset,R=T.data,I=T.reverseStackOrder,P=VB(N),B=P.numericAxisName,V=P.cateAxisName,z=Mi(O,r),M=prt(R,z,"".concat(B,"Id"),"".concat(V,"Id"),_,I),U=l.reduce(function(H,Y){var ot="".concat(Y.axisType,"Map");return vt(vt({},H),{},Xt({},ot,Wct(T,vt(vt({},Y),{},{graphicalItems:z,stackGroups:Y.axisType===B&&M,dataStartIndex:$,dataEndIndex:A}))))},{}),W=Hct(vt(vt({},U),{},{props:T,graphicalItems:z}),C==null?void 0:C.legendBBox);Object.keys(U).forEach(function(H){U[H]=h(T,U[H],W,H.replace("Map",""),n)});var q=U["".concat(V,"Map")],F=Gct(q),G=p(T,vt(vt({},U),{},{dataStartIndex:$,dataEndIndex:A,updateId:E,graphicalItems:z,stackGroups:M,offset:W}));return vt(vt({formattedGraphicalItems:G,graphicalItems:z,offset:W,stackGroups:M},F),U)},v=function(b){function w(C){var T,$,A;return kct(this,w),A=Oct(this,w,[C]),Xt(A,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Xt(A,"accessibilityManager",new dct),Xt(A,"handleLegendBBoxUpdate",function(E){if(E){var O=A.state,N=O.dataStartIndex,_=O.dataEndIndex,R=O.updateId;A.setState(vt({legendBBox:E},g({props:A.props,dataStartIndex:N,dataEndIndex:_,updateId:R},vt(vt({},A.state),{},{legendBBox:E}))))}}),Xt(A,"handleReceiveSyncEvent",function(E,O,N){if(A.props.syncId===E){if(N===A.eventEmitterSymbol&&typeof A.props.syncMethod!="function")return;A.applySyncEvent(O)}}),Xt(A,"handleBrushChange",function(E){var O=E.startIndex,N=E.endIndex;if(O!==A.state.dataStartIndex||N!==A.state.dataEndIndex){var _=A.state.updateId;A.setState(function(){return vt({dataStartIndex:O,dataEndIndex:N},g({props:A.props,dataStartIndex:O,dataEndIndex:N,updateId:_},A.state))}),A.triggerSyncEvent({dataStartIndex:O,dataEndIndex:N})}}),Xt(A,"handleMouseEnter",function(E){var O=A.getMouseInfo(E);if(O){var N=vt(vt({},O),{},{isTooltipActive:!0});A.setState(N),A.triggerSyncEvent(N);var _=A.props.onMouseEnter;se(_)&&_(N,E)}}),Xt(A,"triggeredAfterMouseMove",function(E){var O=A.getMouseInfo(E),N=O?vt(vt({},O),{},{isTooltipActive:!0}):{isTooltipActive:!1};A.setState(N),A.triggerSyncEvent(N);var _=A.props.onMouseMove;se(_)&&_(N,E)}),Xt(A,"handleItemMouseEnter",function(E){A.setState(function(){return{isTooltipActive:!0,activeItem:E,activePayload:E.tooltipPayload,activeCoordinate:E.tooltipPosition||{x:E.cx,y:E.cy}}})}),Xt(A,"handleItemMouseLeave",function(){A.setState(function(){return{isTooltipActive:!1}})}),Xt(A,"handleMouseMove",function(E){E.persist(),A.throttleTriggeredAfterMouseMove(E)}),Xt(A,"handleMouseLeave",function(E){A.throttleTriggeredAfterMouseMove.cancel();var O={isTooltipActive:!1};A.setState(O),A.triggerSyncEvent(O);var N=A.props.onMouseLeave;se(N)&&N(O,E)}),Xt(A,"handleOuterEvent",function(E){var O=t9(E),N=Di(A.props,"".concat(O));if(O&&se(N)){var _,R;/.*touch.*/i.test(O)?R=A.getMouseInfo(E.changedTouches[0]):R=A.getMouseInfo(E),N((_=R)!==null&&_!==void 0?_:{},E)}}),Xt(A,"handleClick",function(E){var O=A.getMouseInfo(E);if(O){var N=vt(vt({},O),{},{isTooltipActive:!0});A.setState(N),A.triggerSyncEvent(N);var _=A.props.onClick;se(_)&&_(N,E)}}),Xt(A,"handleMouseDown",function(E){var O=A.props.onMouseDown;if(se(O)){var N=A.getMouseInfo(E);O(N,E)}}),Xt(A,"handleMouseUp",function(E){var O=A.props.onMouseUp;if(se(O)){var N=A.getMouseInfo(E);O(N,E)}}),Xt(A,"handleTouchMove",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&A.throttleTriggeredAfterMouseMove(E.changedTouches[0])}),Xt(A,"handleTouchStart",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&A.handleMouseDown(E.changedTouches[0])}),Xt(A,"handleTouchEnd",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&A.handleMouseUp(E.changedTouches[0])}),Xt(A,"handleDoubleClick",function(E){var O=A.props.onDoubleClick;if(se(O)){var N=A.getMouseInfo(E);O(N,E)}}),Xt(A,"handleContextMenu",function(E){var O=A.props.onContextMenu;if(se(O)){var N=A.getMouseInfo(E);O(N,E)}}),Xt(A,"triggerSyncEvent",function(E){A.props.syncId!==void 0&&ZT.emit(QT,A.props.syncId,E,A.eventEmitterSymbol)}),Xt(A,"applySyncEvent",function(E){var O=A.props,N=O.layout,_=O.syncMethod,R=A.state.updateId,I=E.dataStartIndex,P=E.dataEndIndex;if(E.dataStartIndex!==void 0||E.dataEndIndex!==void 0)A.setState(vt({dataStartIndex:I,dataEndIndex:P},g({props:A.props,dataStartIndex:I,dataEndIndex:P,updateId:R},A.state)));else if(E.activeTooltipIndex!==void 0){var B=E.chartX,V=E.chartY,z=E.activeTooltipIndex,M=A.state,U=M.offset,W=M.tooltipTicks;if(!U)return;if(typeof _=="function")z=_(W,E);else if(_==="value"){z=-1;for(var q=0;q<W.length;q++)if(W[q].value===E.activeLabel){z=q;break}}var F=vt(vt({},U),{},{x:U.left,y:U.top}),G=Math.min(B,F.x+F.width),H=Math.min(V,F.y+F.height),Y=W[z]&&W[z].value,ot=P2(A.state,A.props.data,z),ht=W[z]?{x:N==="horizontal"?W[z].coordinate:G,y:N==="horizontal"?H:W[z].coordinate}:LV;A.setState(vt(vt({},E),{},{activeLabel:Y,activeCoordinate:ht,activePayload:ot,activeTooltipIndex:z}))}else A.setState(E)}),Xt(A,"renderCursor",function(E){var O,N=A.state,_=N.isTooltipActive,R=N.activeCoordinate,I=N.activePayload,P=N.offset,B=N.activeTooltipIndex,V=N.tooltipAxisBandSize,z=A.getTooltipEventType(),M=(O=E.props.active)!==null&&O!==void 0?O:_,U=A.props.layout,W=E.key||"_recharts-cursor";return et.createElement(xct,{key:W,activeCoordinate:R,activePayload:I,activeTooltipIndex:B,chartName:n,element:E,isActive:M,layout:U,offset:P,tooltipAxisBandSize:V,tooltipEventType:z})}),Xt(A,"renderPolarAxis",function(E,O,N){var _=Di(E,"type.axisType"),R=Di(A.state,"".concat(_,"Map")),I=E.type.defaultProps,P=I!==void 0?vt(vt({},I),E.props):E.props,B=R&&R[P["".concat(_,"Id")]];return Tt.cloneElement(E,vt(vt({},B),{},{className:Ce(_,B.className),key:E.key||"".concat(O,"-").concat(N),ticks:ls(B,!0)}))}),Xt(A,"renderPolarGrid",function(E){var O=E.props,N=O.radialLines,_=O.polarAngles,R=O.polarRadius,I=A.state,P=I.radiusAxisMap,B=I.angleAxisMap,V=eo(P),z=eo(B),M=z.cx,U=z.cy,W=z.innerRadius,q=z.outerRadius;return Tt.cloneElement(E,{polarAngles:Array.isArray(_)?_:ls(z,!0).map(function(F){return F.coordinate}),polarRadius:Array.isArray(R)?R:ls(V,!0).map(function(F){return F.coordinate}),cx:M,cy:U,innerRadius:W,outerRadius:q,key:E.key||"polar-grid",radialLines:N})}),Xt(A,"renderLegend",function(){var E=A.state.formattedGraphicalItems,O=A.props,N=O.children,_=O.width,R=O.height,I=A.props.margin||{},P=_-(I.left||0)-(I.right||0),B=RU({children:N,formattedGraphicalItems:E,legendWidth:P,legendContent:c});if(!B)return null;var V=B.item,z=BB(B,wct);return Tt.cloneElement(V,vt(vt({},z),{},{chartWidth:_,chartHeight:R,margin:I,onBBoxUpdate:A.handleLegendBBoxUpdate}))}),Xt(A,"renderTooltip",function(){var E,O=A.props,N=O.children,_=O.accessibilityLayer,R=oi(N,va);if(!R)return null;var I=A.state,P=I.isTooltipActive,B=I.activeCoordinate,V=I.activePayload,z=I.activeLabel,M=I.offset,U=(E=R.props.active)!==null&&E!==void 0?E:P;return Tt.cloneElement(R,{viewBox:vt(vt({},M),{},{x:M.left,y:M.top}),active:U,label:z,payload:U?V:[],coordinate:B,accessibilityLayer:_})}),Xt(A,"renderBrush",function(E){var O=A.props,N=O.margin,_=O.data,R=A.state,I=R.offset,P=R.dataStartIndex,B=R.dataEndIndex,V=R.updateId;return Tt.cloneElement(E,{key:E.key||"_recharts-brush",onChange:Og(A.handleBrushChange,E.props.onChange),data:_,x:Ot(E.props.x)?E.props.x:I.left,y:Ot(E.props.y)?E.props.y:I.top+I.height+I.brushBottom-(N.bottom||0),width:Ot(E.props.width)?E.props.width:I.width,startIndex:P,endIndex:B,updateId:"brush-".concat(V)})}),Xt(A,"renderReferenceElement",function(E,O,N){if(!E)return null;var _=A,R=_.clipPathId,I=A.state,P=I.xAxisMap,B=I.yAxisMap,V=I.offset,z=E.type.defaultProps||{},M=E.props,U=M.xAxisId,W=U===void 0?z.xAxisId:U,q=M.yAxisId,F=q===void 0?z.yAxisId:q;return Tt.cloneElement(E,{key:E.key||"".concat(O,"-").concat(N),xAxis:P[W],yAxis:B[F],viewBox:{x:V.left,y:V.top,width:V.width,height:V.height},clipPathId:R})}),Xt(A,"renderActivePoints",function(E){var O=E.item,N=E.activePoint,_=E.basePoint,R=E.childIndex,I=E.isRange,P=[],B=O.props.key,V=O.item.type.defaultProps!==void 0?vt(vt({},O.item.type.defaultProps),O.item.props):O.item.props,z=V.activeDot,M=V.dataKey,U=vt(vt({index:R,dataKey:M,cx:N.x,cy:N.y,r:4,fill:dk(O.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},pe(z,!1)),ay(z));return P.push(w.renderActiveDot(z,U,"".concat(B,"-activePoint-").concat(R))),_?P.push(w.renderActiveDot(z,vt(vt({},U),{},{cx:_.x,cy:_.y}),"".concat(B,"-basePoint-").concat(R))):I&&P.push(null),P}),Xt(A,"renderGraphicChild",function(E,O,N){var _=A.filterFormatItem(E,O,N);if(!_)return null;var R=A.getTooltipEventType(),I=A.state,P=I.isTooltipActive,B=I.tooltipAxis,V=I.activeTooltipIndex,z=I.activeLabel,M=A.props.children,U=oi(M,va),W=_.props,q=W.points,F=W.isRange,G=W.baseLine,H=_.item.type.defaultProps!==void 0?vt(vt({},_.item.type.defaultProps),_.item.props):_.item.props,Y=H.activeDot,ot=H.hide,ht=H.activeBar,yt=H.activeShape,It=!!(!ot&&P&&U&&(Y||ht||yt)),$t={};R!=="axis"&&U&&U.props.trigger==="click"?$t={onClick:Og(A.handleItemMouseEnter,E.props.onClick)}:R!=="axis"&&($t={onMouseLeave:Og(A.handleItemMouseLeave,E.props.onMouseLeave),onMouseEnter:Og(A.handleItemMouseEnter,E.props.onMouseEnter)});var mt=Tt.cloneElement(E,vt(vt({},_.props),$t));function At(nn){return typeof B.dataKey=="function"?B.dataKey(nn.payload):null}if(It)if(V>=0){var kt,gt;if(B.dataKey&&!B.allowDuplicatedCategory){var Ut=typeof B.dataKey=="function"?At:"payload.".concat(B.dataKey.toString());kt=iy(q,Ut,z),gt=F&&G&&iy(G,Ut,z)}else kt=q==null?void 0:q[V],gt=F&&G&&G[V];if(yt||ht){var Lt=E.props.activeIndex!==void 0?E.props.activeIndex:V;return[Tt.cloneElement(E,vt(vt(vt({},_.props),$t),{},{activeIndex:Lt})),null,null]}if(!he(kt))return[mt].concat(Ac(A.renderActivePoints({item:_,activePoint:kt,basePoint:gt,childIndex:V,isRange:F})))}else{var Zt,Wt=(Zt=A.getItemByXY(A.state.activeCoordinate))!==null&&Zt!==void 0?Zt:{graphicalItem:mt},qt=Wt.graphicalItem,fe=qt.item,Rn=fe===void 0?E:fe,Ge=qt.childIndex,pn=vt(vt(vt({},_.props),$t),{},{activeIndex:Ge});return[Tt.cloneElement(Rn,pn),null,null]}return F?[mt,null,null]:[mt,null]}),Xt(A,"renderCustomized",function(E,O,N){return Tt.cloneElement(E,vt(vt({key:"recharts-customized-".concat(N)},A.props),A.state))}),Xt(A,"renderMap",{CartesianGrid:{handler:Mg,once:!0},ReferenceArea:{handler:A.renderReferenceElement},ReferenceLine:{handler:Mg},ReferenceDot:{handler:A.renderReferenceElement},XAxis:{handler:Mg},YAxis:{handler:Mg},Brush:{handler:A.renderBrush,once:!0},Bar:{handler:A.renderGraphicChild},Line:{handler:A.renderGraphicChild},Area:{handler:A.renderGraphicChild},Radar:{handler:A.renderGraphicChild},RadialBar:{handler:A.renderGraphicChild},Scatter:{handler:A.renderGraphicChild},Pie:{handler:A.renderGraphicChild},Funnel:{handler:A.renderGraphicChild},Tooltip:{handler:A.renderCursor,once:!0},PolarGrid:{handler:A.renderPolarGrid,once:!0},PolarAngleAxis:{handler:A.renderPolarAxis},PolarRadiusAxis:{handler:A.renderPolarAxis},Customized:{handler:A.renderCustomized}}),A.clipPathId="".concat((T=C.id)!==null&&T!==void 0?T:Pd("recharts"),"-clip"),A.throttleTriggeredAfterMouseMove=_j(A.triggeredAfterMouseMove,($=C.throttleDelay)!==null&&$!==void 0?$:1e3/60),A.state={},A}return Rct(w,b),Ict(w,[{key:"componentDidMount",value:function(){var T,$;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(T=this.props.margin.left)!==null&&T!==void 0?T:0,top:($=this.props.margin.top)!==null&&$!==void 0?$:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var T=this.props,$=T.children,A=T.data,E=T.height,O=T.layout,N=oi($,va);if(N){var _=N.props.defaultIndex;if(!(typeof _!="number"||_<0||_>this.state.tooltipTicks.length-1)){var R=this.state.tooltipTicks[_]&&this.state.tooltipTicks[_].value,I=P2(this.state,A,_,R),P=this.state.tooltipTicks[_].coordinate,B=(this.state.offset.top+E)/2,V=O==="horizontal",z=V?{x:P,y:B}:{y:P,x:B},M=this.state.formattedGraphicalItems.find(function(W){var q=W.item;return q.type.name==="Scatter"});M&&(z=vt(vt({},z),M.props.points[_].tooltipPosition),I=M.props.points[_].tooltipPayload);var U={activeTooltipIndex:_,isTooltipActive:!0,activeLabel:R,activePayload:I,activeCoordinate:z};this.setState(U),this.renderCursor(N),this.accessibilityManager.setIndex(_)}}}},{key:"getSnapshotBeforeUpdate",value:function(T,$){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==$.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==T.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==T.margin){var A,E;this.accessibilityManager.setDetails({offset:{left:(A=this.props.margin.left)!==null&&A!==void 0?A:0,top:(E=this.props.margin.top)!==null&&E!==void 0?E:0}})}return null}},{key:"componentDidUpdate",value:function(T){w$([oi(T.children,va)],[oi(this.props.children,va)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var T=oi(this.props.children,va);if(T&&typeof T.props.shared=="boolean"){var $=T.props.shared?"axis":"item";return o.indexOf($)>=0?$:a}return a}},{key:"getMouseInfo",value:function(T){if(!this.container)return null;var $=this.container,A=$.getBoundingClientRect(),E=UQ(A),O={chartX:Math.round(T.pageX-E.left),chartY:Math.round(T.pageY-E.top)},N=A.width/$.offsetWidth||1,_=this.inRange(O.chartX,O.chartY,N);if(!_)return null;var R=this.state,I=R.xAxisMap,P=R.yAxisMap,B=this.getTooltipEventType(),V=jB(this.state,this.props.data,this.props.layout,_);if(B!=="axis"&&I&&P){var z=eo(I).scale,M=eo(P).scale,U=z&&z.invert?z.invert(O.chartX):null,W=M&&M.invert?M.invert(O.chartY):null;return vt(vt({},O),{},{xValue:U,yValue:W},V)}return V?vt(vt({},O),V):null}},{key:"inRange",value:function(T,$){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,E=this.props.layout,O=T/A,N=$/A;if(E==="horizontal"||E==="vertical"){var _=this.state.offset,R=O>=_.left&&O<=_.left+_.width&&N>=_.top&&N<=_.top+_.height;return R?{x:O,y:N}:null}var I=this.state,P=I.angleAxisMap,B=I.radiusAxisMap;if(P&&B){var V=eo(P);return eL({x:O,y:N},V)}return null}},{key:"parseEventsOfWrapper",value:function(){var T=this.props.children,$=this.getTooltipEventType(),A=oi(T,va),E={};A&&$==="axis"&&(A.props.trigger==="click"?E={onClick:this.handleClick}:E={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var O=ay(this.props,this.handleOuterEvent);return vt(vt({},O),E)}},{key:"addListener",value:function(){ZT.on(QT,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){ZT.removeListener(QT,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(T,$,A){for(var E=this.state.formattedGraphicalItems,O=0,N=E.length;O<N;O++){var _=E[O];if(_.item===T||_.props.key===T.key||$===cs(_.item.type)&&A===_.childIndex)return _}return null}},{key:"renderClipPath",value:function(){var T=this.clipPathId,$=this.state.offset,A=$.left,E=$.top,O=$.height,N=$.width;return et.createElement("defs",null,et.createElement("clipPath",{id:T},et.createElement("rect",{x:A,y:E,height:O,width:N})))}},{key:"getXScales",value:function(){var T=this.state.xAxisMap;return T?Object.entries(T).reduce(function($,A){var E=LB(A,2),O=E[0],N=E[1];return vt(vt({},$),{},Xt({},O,N.scale))},{}):null}},{key:"getYScales",value:function(){var T=this.state.yAxisMap;return T?Object.entries(T).reduce(function($,A){var E=LB(A,2),O=E[0],N=E[1];return vt(vt({},$),{},Xt({},O,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(T){var $;return($=this.state.xAxisMap)===null||$===void 0||($=$[T])===null||$===void 0?void 0:$.scale}},{key:"getYScaleByAxisId",value:function(T){var $;return($=this.state.yAxisMap)===null||$===void 0||($=$[T])===null||$===void 0?void 0:$.scale}},{key:"getItemByXY",value:function(T){var $=this.state,A=$.formattedGraphicalItems,E=$.activeItem;if(A&&A.length)for(var O=0,N=A.length;O<N;O++){var _=A[O],R=_.props,I=_.item,P=I.type.defaultProps!==void 0?vt(vt({},I.type.defaultProps),I.props):I.props,B=cs(I.type);if(B==="Bar"){var V=(R.data||[]).find(function(W){return ost(T,W)});if(V)return{graphicalItem:_,payload:V}}else if(B==="RadialBar"){var z=(R.data||[]).find(function(W){return eL(T,W)});if(z)return{graphicalItem:_,payload:z}}else if(Yv(_,E)||Zv(_,E)||dd(_,E)){var M=Zst({graphicalItem:_,activeTooltipItem:E,itemData:P.data}),U=P.activeIndex===void 0?M:P.activeIndex;return{graphicalItem:vt(vt({},_),{},{childIndex:U}),payload:dd(_,E)?P.data[M]:_.props.data[M]}}}return null}},{key:"render",value:function(){var T=this;if(!hM(this))return null;var $=this.props,A=$.children,E=$.className,O=$.width,N=$.height,_=$.style,R=$.compact,I=$.title,P=$.desc,B=BB($,Sct),V=pe(B,!1);if(R)return et.createElement(bB,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},et.createElement(C$,Xu({},V,{width:O,height:N,title:I,desc:P}),this.renderClipPath(),pM(A,this.renderMap)));if(this.props.accessibilityLayer){var z,M;V.tabIndex=(z=this.props.tabIndex)!==null&&z!==void 0?z:0,V.role=(M=this.props.role)!==null&&M!==void 0?M:"application",V.onKeyDown=function(W){T.accessibilityManager.keyboardEvent(W)},V.onFocus=function(){T.accessibilityManager.focus()}}var U=this.parseEventsOfWrapper();return et.createElement(bB,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},et.createElement("div",Xu({className:Ce("recharts-wrapper",E),style:vt({position:"relative",cursor:"default",width:O,height:N},_)},U,{ref:function(q){T.container=q}}),et.createElement(C$,Xu({},V,{width:O,height:N,title:I,desc:P,style:Bct}),this.renderClipPath(),pM(A,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(Tt.Component);Xt(v,"displayName",n),Xt(v,"defaultProps",vt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),Xt(v,"getDerivedStateFromProps",function(b,w){var C=b.dataKey,T=b.data,$=b.children,A=b.width,E=b.height,O=b.layout,N=b.stackOffset,_=b.margin,R=w.dataStartIndex,I=w.dataEndIndex;if(w.updateId===void 0){var P=UB(b);return vt(vt(vt({},P),{},{updateId:0},g(vt(vt({props:b},P),{},{updateId:0}),w)),{},{prevDataKey:C,prevData:T,prevWidth:A,prevHeight:E,prevLayout:O,prevStackOffset:N,prevMargin:_,prevChildren:$})}if(C!==w.prevDataKey||T!==w.prevData||A!==w.prevWidth||E!==w.prevHeight||O!==w.prevLayout||N!==w.prevStackOffset||!Ku(_,w.prevMargin)){var B=UB(b),V={chartX:w.chartX,chartY:w.chartY,isTooltipActive:w.isTooltipActive},z=vt(vt({},jB(w,T,O)),{},{updateId:w.updateId+1}),M=vt(vt(vt({},B),V),z);return vt(vt(vt({},M),g(vt({props:b},M),w)),{},{prevDataKey:C,prevData:T,prevWidth:A,prevHeight:E,prevLayout:O,prevStackOffset:N,prevMargin:_,prevChildren:$})}if(!w$($,w.prevChildren)){var U,W,q,F,G=oi($,gc),H=G&&(U=(W=G.props)===null||W===void 0?void 0:W.startIndex)!==null&&U!==void 0?U:R,Y=G&&(q=(F=G.props)===null||F===void 0?void 0:F.endIndex)!==null&&q!==void 0?q:I,ot=H!==R||Y!==I,ht=!he(T),yt=ht&&!ot?w.updateId:w.updateId+1;return vt(vt({updateId:yt},g(vt(vt({props:b},w),{},{updateId:yt,dataStartIndex:H,dataEndIndex:Y}),w)),{},{prevChildren:$,dataStartIndex:H,dataEndIndex:Y})}return null}),Xt(v,"renderActiveDot",function(b,w,C){var T;return Tt.isValidElement(b)?T=Tt.cloneElement(b,w):se(b)?T=b(w):T=et.createElement(mk,w),et.createElement(yn,{className:"recharts-active-dot",key:C},T)});var x=Tt.forwardRef(function(w,C){return et.createElement(v,Xu({},w,{ref:C}))});return x.displayName=v.displayName,x},Yct=Kct({chartName:"LineChart",GraphicalChild:Wd,axisComponents:[{axisType:"xAxis",AxisComp:rb},{axisType:"yAxis",AxisComp:ib}],formatAxisMap:Hot});const Zct=({data:e})=>Kt.jsx("div",{style:{width:"100%",height:300},children:Kt.jsx(MQ,{children:Kt.jsxs(Yct,{data:e,children:[Kt.jsx(TV,{strokeDasharray:"3 3"}),Kt.jsx(rb,{dataKey:"risk",label:{value:"Risk (Std Dev)",position:"insideBottomRight"}}),Kt.jsx(ib,{dataKey:"targetReturn",label:{value:"Return",angle:-90,position:"insideLeft"}}),Kt.jsx(va,{}),Kt.jsx(Wd,{type:"monotone",dataKey:"targetReturn",stroke:"#8884d8",dot:!1})]})})}),Qct=({weights:e,stats:t,assets:n})=>{var r,i,a;return Kt.jsxs("div",{children:[Kt.jsx("h4",{children:"Optimized Portfolio"}),e?Kt.jsx("ul",{children:n.map((s,o)=>Kt.jsxs("li",{children:[s,": ",(e[o]*100).toFixed(2),"%"]},s))}):Kt.jsx("span",{children:"No result"}),t&&Kt.jsxs("div",{children:[Kt.jsxs("div",{children:["Expected Return: ",(r=t.ret)==null?void 0:r.toFixed(4)]}),Kt.jsxs("div",{children:["Risk (Std Dev): ",(i=t.risk)==null?void 0:i.toFixed(4)]}),Kt.jsxs("div",{children:["Objective: ",(a=t.obj)==null?void 0:a.toFixed(4)]})]})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jct=1e-7,tft=1e-4;class zV{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class $k{refCount(t){return Gr("refCount")}incRef(t){return Gr("incRef")}timerAvailable(){return!0}time(t){return Gr("time")}read(t){return Gr("read")}readSync(t){return Gr("readSync")}readToGPU(t,n){return Gr("readToGPU")}numDataIds(){return Gr("numDataIds")}disposeData(t,n){return Gr("disposeData")}write(t,n,r){return Gr("write")}move(t,n,r,i,a){return Gr("move")}createTensorFromGPUData(t,n,r){return Gr("createTensorFromGPUData")}memory(){return Gr("memory")}floatPrecision(){return Gr("floatPrecision")}epsilon(){return this.floatPrecision()===32?Jct:tft}dispose(){return Gr("dispose")}}function Gr(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eft(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Vu(e,t,n)}function Cl(e,t,n){return Math.max(e,Math.min(t,n))}function Ak(e){return e%2===0?e:e+1}function Vu(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function nft(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function j(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function kk(e,t,n=""){j(we(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function jV(e){j(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function pt(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function we(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function kc(e){return e%1===0}function F2(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Ju(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function WB(e,t=i=>0,n,r){return new Promise((i,a)=>{let s=0;const o=()=>{if(e()){i();return}s++;const l=t(s);if(n!=null&&s>=n){a();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function UV(e,t){let n=1,r=-1;for(let a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(e[a]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${a}`);r=a}else if(e[a]<0)throw Error(`Shapes can not be < 0. Found ${e[a]} at dim ${a}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function re(e,t){const n=t.length;return e=e==null?t.map((r,i)=>i):[].concat(e),j(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),j(e.every(r=>kc(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function To(e,t){const n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:re(t,e).sort();let s=0;for(let o=0;o<e.length;++o){if(a!=null){if(a[s]===o&&e[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${e[o]}' is not 1`);(a[s]==null||a[s]>o)&&e[o]===1&&(n.push(e[o]),r.push(o)),a[s]<=o&&s++}e[o]!==1&&(n.push(e[o]),r.push(o))}return{newShape:n,keptDims:r}}function lr(e,t){return un(e,t)}function un(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function rft(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function ift(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function VV(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function tv(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function aft(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function Gd(e){return typeof e=="string"||e instanceof String}function sft(e){return typeof e=="boolean"}function L2(e){return typeof e=="number"}function qc(e){return Array.isArray(e)?qc(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":L2(e)?"float32":Gd(e)?"string":sft(e)?"bool":"float32"}function B2(e){return!!(e&&e.constructor&&e.call&&e.apply)}function z2(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Bt(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function WV(e,t,n,r=!1){const i=new Array;if(t.length===1){const a=t[0]*(r?2:1);for(let s=0;s<a;s++)i[s]=n[e+s]}else{const a=t[0],s=t.slice(1),o=s.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<a;l++)i[l]=WV(e+l*o,s,n,r)}return i}function aa(e,t,n=!1){if(e.length===0)return t[0];const r=e.reduce((i,a)=>i*a)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return WV(0,e,t,n)}function oft(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function Ek(e,t){const n=ur(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function ur(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function GV(e,t){const n=e.reduce((r,i)=>r*i,1);if(t==null||t==="float32")return aa(e,new Float32Array(n));if(t==="int32")return aa(e,new Int32Array(n));if(t==="bool")return aa(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function As(e){e.forEach(t=>{j(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function ka(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function Hc(e,t,n){if(t===0)return[];if(t===1)return[e];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function Ik(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GB="tfjsflags";class lft{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=uft,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(ct().getBool("IS_TEST")||ct().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){const i=this.urlFlags[t];ct().getBool("IS_TEST")||ct().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(Ik(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);GB in t&&t[GB].split(",").forEach(r=>{const[i,a]=r.split(":");this.urlFlags[i]=fft(i,a)})}}function uft(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(cft(t,r[0],r[1]),r.join("="))),t}function cft(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function fft(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function ct(){return qV}let qV=null;function hft(e){qV=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let t$;function HV(){if(t$==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");t$=e}return t$}function dft(){const e=HV();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function Ok(e,t){const n=dft();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const sb="Abs",qd="Acos",Hd="Acosh",Xc="Add",ob="AddN",Nk="All",_k="Any",lb="ArgMax",ub="ArgMin",Xd="Asin",Kd="Asinh",Yd="Atan",Zd="Atanh",Qd="Atan2",cb="AvgPool",Rk="AvgPoolGrad",fb="AvgPool3D",Dk="AvgPool3DGrad",hb="BatchMatMul",db="BatchToSpaceND",Mk="Bincount",Pk="BitwiseAnd",pft="BroadcastTo",XV="BroadcastArgs",Jd="Cast",tp="Ceil",ep="ClipByValue",Fk="Complex",pb="ComplexAbs",mb="Concat",gb="Conv2D",Lk="Conv2DBackpropFilter",yb="Conv2DBackpropInput",vb="Conv3D",Bk="Conv3DBackpropFilterV2",zk="Conv3DBackpropInputV2",np="Cos",rp="Cosh",jk="Cumprod",bb="Cumsum",Uk="CropAndResize",Vk="DenseBincount",Wk="DepthToSpace",xb="DepthwiseConv2dNative",Gk="DepthwiseConv2dNativeBackpropFilter",qk="DepthwiseConv2dNativeBackpropInput",KV="Diag",wb="Dilation2D",j2="Dilation2DBackpropInput",U2="Dilation2DBackpropFilter",mft="Draw",ip="RealDiv",Hk="Einsum",ap="Elu",Xk="EluGrad",sp="Erf",Sb="Equal",op="Exp",Cb="ExpandDims",lp="Expm1",Kk="FFT",Yk="Fill",Zk="FlipLeftRight",up="Floor",cp="FloorDiv",Tb="FusedBatchNorm",$b="GatherV2",YV="GatherNd",Ab="Greater",fp="GreaterEqual",hp="Identity",Qk="IFFT",Jk="Imag",dp="IsFinite",pp="IsInf",mp="IsNan",kb="LeakyRelu",Eb="Less",Ib="LessEqual",ZV="LinSpace",gp="Log",yp="Log1p",Ob="LogicalAnd",Nb="LogicalNot",_b="LogicalOr",gft="LogSoftmax",Rb="LRN",tE="LRNGrad",Db="Max",vp="Maximum",Mb="MaxPool",eE="MaxPoolGrad",Pb="MaxPool3D",nE="MaxPool3DGrad",QV="MaxPoolWithArgmax",Fb="Mean",Lb="Min",bp="Minimum",Bb="MirrorPad",xp="Mod",JV="Multinomial",wp="Multiply",zb="Neg",jb="NotEqual",rE="NonMaxSuppressionV3",iE="NonMaxSuppressionV4",aE="NonMaxSuppressionV5",Ub="OnesLike",Vb="OneHot",Wb="Pack",Gb="PadV2",Sp="Pow",qb="Prelu",Hb="Prod",tW="RaggedGather",eW="RaggedRange",nW="RaggedTensorToTensor",sE="Range",oE="Real",Cp="Reciprocal",Tp="Relu",Xb="Reshape",Kb="ResizeNearestNeighbor",lE="ResizeNearestNeighborGrad",Yb="ResizeBilinear",uE="ResizeBilinearGrad",$p="Relu6",Zb="Reverse",Ap="Round",kp="Rsqrt",rW="ScatterNd",iW="TensorScatterUpdate",aW="SearchSorted",Qb="Select",Ep="Selu",Jb="Slice",Ip="Sin",Op="Sinh",Np="Sign",_p="Sigmoid",Rp="Softplus",Dp="Sqrt",t0="Sum",e0="SpaceToBatchND",n0="SplitV",r0="Softmax",sW="SparseFillEmptyRows",oW="SparseReshape",lW="SparseSegmentMean",uW="SparseSegmentSum",cW="SparseToDense",Mp="SquaredDifference",cE="Square",fE="StaticRegexReplace",hE="StridedSlice",fW="StringNGrams",hW="StringSplit",dW="StringToHashBucketFast",Pp="Sub",Fp="Tan",Lp="Tanh",Bp="Tile",dE="TopK",pE="Transform",tc="Transpose",mE="Unique",i0="Unpack",a0="UnsortedSegmentSum",s0="ZerosLike",zp="Step",yft="FromPixels",gE="RotateWithOffset",ev="_FusedMatMul",nv="FusedConv2D",pW="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ui(...e){ct().getBool("IS_TEST")||ct().getBool("PROD")||console.warn(...e)}function vft(...e){ct().getBool("IS_TEST")||ct().getBool("PROD")||console.log(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rv=Ok("kernelRegistry",()=>new Map),V2=Ok("gradRegistry",()=>new Map);function qB(e,t){const n=gW(e,t);return rv.get(n)}function HB(e){return V2.get(e)}function XB(e){const t=rv.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[a,s]=i,[o]=a.split("_");o===e&&n.push(s)}return n}function mW(e){const{kernelName:t,backendName:n}=e,r=gW(t,n);rv.has(r)&&ui(`The kernel '${t}' for backend '${n}' is already registered`),rv.set(r,e)}function bft(e){const{kernelName:t}=e;V2.has(t)&&ct().getBool("DEBUG")&&ui(`Overriding the gradient for '${t}'`),V2.set(t,e)}function gW(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yW(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var e$,KB;function xft(){if(KB)return e$;KB=1,e$=t;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(R,I,P){this.low=R|0,this.high=I|0,this.unsigned=!!P}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function n(R){return(R&&R.__isLong__)===!0}t.isLong=n;var r={},i={};function a(R,I){var P,B,V;return I?(R>>>=0,(V=0<=R&&R<256)&&(B=i[R],B)?B:(P=o(R,(R|0)<0?-1:0,!0),V&&(i[R]=P),P)):(R|=0,(V=-128<=R&&R<128)&&(B=r[R],B)?B:(P=o(R,R<0?-1:0,!1),V&&(r[R]=P),P))}t.fromInt=a;function s(R,I){if(isNaN(R))return I?C:w;if(I){if(R<0)return C;if(R>=v)return O}else{if(R<=-9223372036854776e3)return N;if(R+1>=x)return E}return R<0?s(-R,I).neg():o(R%g|0,R/g|0,I)}t.fromNumber=s;function o(R,I,P){return new t(R,I,P)}t.fromBits=o;var l=Math.pow;function c(R,I,P){if(R.length===0)throw Error("empty string");if(R==="NaN"||R==="Infinity"||R==="+Infinity"||R==="-Infinity")return w;if(typeof I=="number"?(P=I,I=!1):I=!!I,P=P||10,P<2||36<P)throw RangeError("radix");var B;if((B=R.indexOf("-"))>0)throw Error("interior hyphen");if(B===0)return c(R.substring(1),I,P).neg();for(var V=s(l(P,8)),z=w,M=0;M<R.length;M+=8){var U=Math.min(8,R.length-M),W=parseInt(R.substring(M,M+U),P);if(U<8){var q=s(l(P,U));z=z.mul(q).add(s(W))}else z=z.mul(V),z=z.add(s(W))}return z.unsigned=I,z}t.fromString=c;function h(R,I){return typeof R=="number"?s(R,I):typeof R=="string"?c(R,I):o(R.low,R.high,typeof I=="boolean"?I:R.unsigned)}t.fromValue=h;var d=65536,p=1<<24,g=d*d,v=g*g,x=v/2,b=a(p),w=a(0);t.ZERO=w;var C=a(0,!0);t.UZERO=C;var T=a(1);t.ONE=T;var $=a(1,!0);t.UONE=$;var A=a(-1);t.NEG_ONE=A;var E=o(-1,2147483647,!1);t.MAX_VALUE=E;var O=o(-1,-1,!0);t.MAX_UNSIGNED_VALUE=O;var N=o(0,-2147483648,!1);t.MIN_VALUE=N;var _=t.prototype;return _.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},_.toString=function(I){if(I=I||10,I<2||36<I)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(N)){var P=s(I),B=this.div(P),V=B.mul(P).sub(this);return B.toString(I)+V.toInt().toString(I)}else return"-"+this.neg().toString(I);for(var z=s(l(I,6),this.unsigned),M=this,U="";;){var W=M.div(z),q=M.sub(W.mul(z)).toInt()>>>0,F=q.toString(I);if(M=W,M.isZero())return F+U;for(;F.length<6;)F="0"+F;U=""+F+U}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var I=this.high!=0?this.high:this.low,P=31;P>0&&(I&1<<P)==0;P--);return this.high!=0?P+33:P+1},_.isZero=function(){return this.high===0&&this.low===0},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return(this.low&1)===1},_.isEven=function(){return(this.low&1)===0},_.equals=function(I){return n(I)||(I=h(I)),this.unsigned!==I.unsigned&&this.high>>>31===1&&I.high>>>31===1?!1:this.high===I.high&&this.low===I.low},_.eq=_.equals,_.notEquals=function(I){return!this.eq(I)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(I){return this.comp(I)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(I){return this.comp(I)<=0},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(I){return this.comp(I)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(I){return this.comp(I)>=0},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(I){if(n(I)||(I=h(I)),this.eq(I))return 0;var P=this.isNegative(),B=I.isNegative();return P&&!B?-1:!P&&B?1:this.unsigned?I.high>>>0>this.high>>>0||I.high===this.high&&I.low>>>0>this.low>>>0?-1:1:this.sub(I).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(T)},_.neg=_.negate,_.add=function(I){n(I)||(I=h(I));var P=this.high>>>16,B=this.high&65535,V=this.low>>>16,z=this.low&65535,M=I.high>>>16,U=I.high&65535,W=I.low>>>16,q=I.low&65535,F=0,G=0,H=0,Y=0;return Y+=z+q,H+=Y>>>16,Y&=65535,H+=V+W,G+=H>>>16,H&=65535,G+=B+U,F+=G>>>16,G&=65535,F+=P+M,F&=65535,o(H<<16|Y,F<<16|G,this.unsigned)},_.subtract=function(I){return n(I)||(I=h(I)),this.add(I.neg())},_.sub=_.subtract,_.multiply=function(I){if(this.isZero())return w;if(n(I)||(I=h(I)),e){var P=e.mul(this.low,this.high,I.low,I.high);return o(P,e.get_high(),this.unsigned)}if(I.isZero())return w;if(this.eq(N))return I.isOdd()?N:w;if(I.eq(N))return this.isOdd()?N:w;if(this.isNegative())return I.isNegative()?this.neg().mul(I.neg()):this.neg().mul(I).neg();if(I.isNegative())return this.mul(I.neg()).neg();if(this.lt(b)&&I.lt(b))return s(this.toNumber()*I.toNumber(),this.unsigned);var B=this.high>>>16,V=this.high&65535,z=this.low>>>16,M=this.low&65535,U=I.high>>>16,W=I.high&65535,q=I.low>>>16,F=I.low&65535,G=0,H=0,Y=0,ot=0;return ot+=M*F,Y+=ot>>>16,ot&=65535,Y+=z*F,H+=Y>>>16,Y&=65535,Y+=M*q,H+=Y>>>16,Y&=65535,H+=V*F,G+=H>>>16,H&=65535,H+=z*q,G+=H>>>16,H&=65535,H+=M*W,G+=H>>>16,H&=65535,G+=B*F+V*q+z*W+M*U,G&=65535,o(Y<<16|ot,G<<16|H,this.unsigned)},_.mul=_.multiply,_.divide=function(I){if(n(I)||(I=h(I)),I.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&I.low===-1&&I.high===-1)return this;var P=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,I.low,I.high);return o(P,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?C:w;var B,V,z;if(this.unsigned){if(I.unsigned||(I=I.toUnsigned()),I.gt(this))return C;if(I.gt(this.shru(1)))return $;z=C}else{if(this.eq(N)){if(I.eq(T)||I.eq(A))return N;if(I.eq(N))return T;var M=this.shr(1);return B=M.div(I).shl(1),B.eq(w)?I.isNegative()?T:A:(V=this.sub(I.mul(B)),z=B.add(V.div(I)),z)}else if(I.eq(N))return this.unsigned?C:w;if(this.isNegative())return I.isNegative()?this.neg().div(I.neg()):this.neg().div(I).neg();if(I.isNegative())return this.div(I.neg()).neg();z=w}for(V=this;V.gte(I);){B=Math.max(1,Math.floor(V.toNumber()/I.toNumber()));for(var U=Math.ceil(Math.log(B)/Math.LN2),W=U<=48?1:l(2,U-48),q=s(B),F=q.mul(I);F.isNegative()||F.gt(V);)B-=W,q=s(B,this.unsigned),F=q.mul(I);q.isZero()&&(q=T),z=z.add(q),V=V.sub(F)}return z},_.div=_.divide,_.modulo=function(I){if(n(I)||(I=h(I)),e){var P=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,I.low,I.high);return o(P,e.get_high(),this.unsigned)}return this.sub(this.div(I).mul(I))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return o(~this.low,~this.high,this.unsigned)},_.and=function(I){return n(I)||(I=h(I)),o(this.low&I.low,this.high&I.high,this.unsigned)},_.or=function(I){return n(I)||(I=h(I)),o(this.low|I.low,this.high|I.high,this.unsigned)},_.xor=function(I){return n(I)||(I=h(I)),o(this.low^I.low,this.high^I.high,this.unsigned)},_.shiftLeft=function(I){return n(I)&&(I=I.toInt()),(I&=63)===0?this:I<32?o(this.low<<I,this.high<<I|this.low>>>32-I,this.unsigned):o(0,this.low<<I-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(I){return n(I)&&(I=I.toInt()),(I&=63)===0?this:I<32?o(this.low>>>I|this.high<<32-I,this.high>>I,this.unsigned):o(this.high>>I-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(I){if(n(I)&&(I=I.toInt()),I&=63,I===0)return this;var P=this.high;if(I<32){var B=this.low;return o(B>>>I|P<<32-I,P>>>I,this.unsigned)}else return I===32?o(P,0,this.unsigned):o(P>>>I-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},_.toBytes=function(I){return I?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var I=this.high,P=this.low;return[P&255,P>>>8&255,P>>>16&255,P>>>24,I&255,I>>>8&255,I>>>16&255,I>>>24]},_.toBytesBE=function(){var I=this.high,P=this.low;return[I>>>24,I>>>16&255,I>>>8&255,I&255,P>>>24,P>>>16&255,P>>>8&255,P&255]},t.fromBytes=function(I,P,B){return B?t.fromBytesLE(I,P):t.fromBytesBE(I,P)},t.fromBytesLE=function(I,P){return new t(I[0]|I[1]<<8|I[2]<<16|I[3]<<24,I[4]|I[5]<<8|I[6]<<16|I[7]<<24,P)},t.fromBytesBE=function(I,P){return new t(I[4]<<24|I[5]<<16|I[6]<<8|I[7],I[0]<<24|I[1]<<16|I[2]<<8|I[3],P)},e$}var vW=xft();const bW=Be(vW),wft=zK({__proto__:null,default:bW},[vW]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const il=bW||wft;function o0(e){return il.fromString(e,!0,16)}const xW=o0("c3a5c85c97cb3127"),nl=o0("b492b66fbe98f273"),wr=o0("9ae16a3b2f90404f");function W2(e){return e.xor(e.shru(47))}function wW(e,t,n){const r=e.slice(t,t+n);return il.fromBytes(Array.from(r),!0,!0)}function je(e,t){return wW(e,t,8)}function YB(e,t){return wW(e,t,4)}function Ln(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function lo(e,t,n=o0("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function Sft(e,t,n,r,i,a){i=i.add(e),a=Ln(a.add(i).add(r),21);const s=i;return i=i.add(t),i=i.add(n),a=a.add(Ln(i,44)),[i.add(r),a.add(s)]}function Pg(e,t,n,r){return Sft(je(e,t),je(e,t+8),je(e,t+16),je(e,t+24),n,r)}function Cft(e,t=e.length){if(t>=8){const n=wr.add(t*2),r=je(e,0).add(wr),i=je(e,t-8),a=Ln(i,37).mul(n).add(r),s=Ln(r,25).add(i).mul(n);return lo(a,s,n)}if(t>=4){const n=wr.add(t*2),r=YB(e,0);return lo(r.shl(3).add(t),YB(e,t-4),n)}if(t>0){const n=e[0],r=e[t>>1],i=e[t-1],a=n+(r<<8),s=t+(i<<2);return W2(wr.mul(a).xor(xW.mul(s))).mul(wr)}return wr}function Tft(e,t=e.length){const n=wr.add(t*2),r=je(e,0).mul(nl),i=je(e,8),a=je(e,t-8).mul(n),s=je(e,t-16).mul(wr);return lo(Ln(r.add(i),43).add(Ln(a,30)).add(s),r.add(Ln(i.add(wr),18)).add(a),n)}function $ft(e,t=e.length){const n=wr.add(t*2),r=je(e,0).mul(wr),i=je(e,8),a=je(e,t-8).mul(n),s=je(e,t-16).mul(wr),o=Ln(r.add(i),43).add(Ln(a,30)).add(s),l=lo(o,r.add(Ln(i.add(wr),18)).add(a),n),c=je(e,16).mul(n),h=je(e,24),d=o.add(je(e,t-32)).mul(n),p=l.add(je(e,t-24)).mul(n);return lo(Ln(c.add(h),43).add(Ln(d,30)).add(p),c.add(Ln(h.add(r),18)).add(d),n)}function Aft(e,t=e.length){const n=il.fromNumber(81,!0);if(t<=32)return t<=16?Cft(e,t):Tft(e,t);if(t<=64)return $ft(e,t);let r=n,i=n.mul(nl).add(113),a=W2(i.mul(wr).add(113)).mul(wr),s=[il.UZERO,il.UZERO],o=[il.UZERO,il.UZERO];r=r.mul(wr).add(je(e,0));let l=0;const c=(t-1>>6)*64,h=c+(t-1&63)-63;do r=Ln(r.add(i).add(s[0]).add(je(e,l+8)),37).mul(nl),i=Ln(i.add(s[1]).add(je(e,l+48)),42).mul(nl),r=r.xor(o[1]),i=i.add(s[0]).add(je(e,l+40)),a=Ln(a.add(o[0]),33).mul(nl),s=Pg(e,l,s[1].mul(nl),r.add(o[0])),o=Pg(e,l+32,a.add(o[1]),i.add(je(e,l+16))),[a,r]=[r,a],l+=64;while(l!==c);const d=nl.add(a.and(255).shl(1));return l=h,o[0]=o[0].add(t-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),r=Ln(r.add(i).add(s[0]).add(je(e,l+8)),37).mul(d),i=Ln(i.add(s[1]).add(je(e,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),i=i.add(s[0].mul(9).add(je(e,l+40))),a=Ln(a.add(o[0]),33).mul(d),s=Pg(e,l,s[1].mul(d),r.add(o[0])),o=Pg(e,l+32,a.add(o[1]),i.add(je(e,l+16))),[a,r]=[r,a],lo(lo(s[0],o[0],d).add(W2(i).mul(xW)).add(a),lo(s[1],o[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $o(e,t){return t==="string"?uo(e):jl([e],t)}function kft(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function jl(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Tl(e)),ct().getBool("DEBUG")&&rft(e,t),kft(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function Er(){return ct().platform.now()}function uo(e,t="utf-8"){return t=t||"utf-8",ct().platform.encode(e,t)}function ho(e,t="utf-8"){return t=t||"utf-8",ct().platform.decode(e,t)}function Li(e){return ct().platform.isTypedArray!=null?ct().platform.isTypedArray(e):yW(e)}function Tl(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||Ik(e)||e==null||Li(e)&&n)t.push(e);else if(Array.isArray(e)||Li(e))for(let r=0;r<e.length;++r)Tl(e[r],t,n);else{let r=-1;for(const i of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)Tl(e[i],t,n)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eft{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Oft)}profileKernel(t,n,r){let i;const a=()=>{i=r()};let s;const o=Er();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(a);else{a();for(const c of i)c.dataSync();s=Promise.resolve({kernelMs:Er()-o})}if(ct().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<i.length;c++){const h=i[c];h.data().then(d=>{Ift(d,h.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:s.then(c=>c.kernelMs),extraInfo:s.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:r,timeMs:i,inputs:a,extraInfo:s}=t;r.forEach(o=>{Promise.all([o.data(),i,s]).then(l=>{this.logger.logKernelProfile(n,o,l[0],l[1],a,l[2])})})}}function Ift(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){const i=e[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}class Oft{logKernelProfile(t,n,r,i,a,s){const o=typeof i=="number"?Ju(`${i}ms`,9):i.error,l=Ju(t,25),c=n.rank,h=n.size,d=Ju(n.shape.toString(),14);let p="";for(const g in a){const v=a[g];if(v!=null){const x=v.shape||n.shape,b=x.length;p+=`${g}: ${b}D ${b>0?x:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${d}	%c${h}	%c${p}	%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nft(e,t,n){const r={},i={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){const c=e[l],h=c.inputs;for(const d in h){const p=h[d];let g=!1;for(let v=0;v<t.length;v++)if(r[p.id]){c.outputs.forEach(x=>r[x.id]=!0),g=!0,i[c.id]=!0;break}if(g)break}}const a={};a[n.id]=!0;const s={};for(let l=e.length-1;l>=0;l--){const c=e[l],h=c.inputs;for(let d=0;d<c.outputs.length;d++)if(a[c.outputs[d].id]){for(const p in h)a[h[p].id]=!0,s[c.id]=!0;break}}const o=[];for(let l=0;l<e.length;l++){const c=e[l];if(i[c.id]&&s[c.id]){const h={};for(const p in c.inputs){const g=c.inputs[p];r[g.id]&&(h[p]=g)}const d=Object.assign({},c);d.inputs=h,d.outputs=c.outputs,o.push(d)}}return o}function _ft(e,t,n,r){for(let i=t.length-1;i>=0;i--){const a=t[i],s=[];if(a.outputs.forEach(l=>{const c=e[l.id];c!=null?s.push(c):s.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const o=a.gradient(s);for(const l in a.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=n(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const h=a.inputs[l];if(!we(c.shape,h.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${h.shape}'`);if(e[h.id]==null)e[h.id]=c;else{const d=e[h.id];e[h.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZB=20,bh=3,n$=7;function Rft(e,t,n,r){const i=Bt(t),a=Dft(e,t,n,i),s=t.length,o=Kg(e,t,n,i,a),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Dft(e,t,n,r){const i=pt(t),a=r[r.length-1],s=new Array(a).fill(0),o=t.length,l=n==="complex64"?kh(e):e;if(o>1)for(let c=0;c<i/a;c++){const h=c*a;for(let d=0;d<a;d++)s[d]=Math.max(s[d],Ah(l[h+d],0,n).length)}return s}function Ah(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(n$))} + ${parseFloat(e[1].toFixed(n$))}j`:Gd(e)?r=`'${e}'`:n==="bool"?r=SW(e):r=parseFloat(e.toFixed(n$)).toString(),Ju(r,t)}function SW(e){return e===0?"false":"true"}function Kg(e,t,n,r,i,a=!0){const s=n==="complex64"?2:1,o=t[0],l=t.length;if(l===0){if(n==="complex64"){const x=kh(e);return[Ah(x[0],0,n)]}return n==="bool"?[SW(e[0])]:[e[0].toString()]}if(l===1){if(o>ZB){const b=bh*s;let w=Array.from(e.slice(0,b)),C=Array.from(e.slice((o-bh)*s,o*s));return n==="complex64"&&(w=kh(w),C=kh(C)),["["+w.map((T,$)=>Ah(T,i[$],n)).join(", ")+", ..., "+C.map((T,$)=>Ah(T,i[o-bh+$],n)).join(", ")+"]"]}return["["+(n==="complex64"?kh(e):Array.from(e)).map((b,w)=>Ah(b,i[w],n)).join(", ")+"]"]}const c=t.slice(1),h=r.slice(1),d=r[0]*s,p=[];if(o>ZB){for(let x=0;x<bh;x++){const b=x*d,w=b+d;p.push(...Kg(e.slice(b,w),c,n,h,i,!1))}p.push("...");for(let x=o-bh;x<o;x++){const b=x*d,w=b+d;p.push(...Kg(e.slice(b,w),c,n,h,i,x===o-1))}}else for(let x=0;x<o;x++){const b=x*d,w=b+d;p.push(...Kg(e.slice(b,w),c,n,h,i,x===o-1))}const g=l===2?",":"";p[0]="["+(o>0?p[0]+g:"");for(let x=1;x<p.length-1;x++)p[x]=" "+p[x]+g;let v=`,
`;for(let x=2;x<l;x++)v+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":v),p}function kh(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yn{constructor(t,n,r){if(this.dtype=n,this.shape=t.slice(),this.size=pt(t),r!=null){const i=r.length;j(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||un(n,this.size),this.strides=Bt(t)}set(t,...n){n.length===0&&(n=[0]),j(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const i of t){if(i<0||i>=this.shape[n]){const a=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return ta().makeTensor(this.values,this.shape,this.dtype)}}let ta=null,Wu=null;function Mft(e){ta=e}function Pft(e){Wu=e}class Cn{constructor(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=pt(t),this.strides=Bt(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Wu.buffer(this.shape,this.dtype,t)}bufferSync(){return Wu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return aa(this.shape,t,this.dtype==="complex64")}arraySync(){return aa(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=ta().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(r=>ho(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),ta().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=ta().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>ho(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await ta().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),ta().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Wu.print(this,t)}clone(){return this.throwIfDisposed(),Wu.clone(this)}toString(t=!1){const n=this.dataSync();return Rft(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Wu.cast(this,t)}variable(t=!0,n,r){return this.throwIfDisposed(),ta().makeVariable(this,t,n,r)}}Object.defineProperty(Cn,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function dt(){return Ok("Tensor",()=>Cn)}dt();class iv extends Cn{constructor(t,n,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!we(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);ta().disposeTensor(this),this.dataId=t.dataId,ta().incRef(this,null)}dispose(){ta().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(iv,Symbol.hasInstance,{value:e=>e instanceof Cn&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var QB;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(QB||(QB={}));var G2;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(G2||(G2={}));var q2;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(q2||(q2={}));var H2;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(H2||(H2={}));var X2;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(X2||(X2={}));const Fft={float32:H2,int32:G2,bool:q2,complex64:X2};function Xr(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return Fft[e][t]}function yE(e){return Xr(e,"int32")}function CW(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function TW(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cn(e,t){if(e.dtype===t.dtype)return[e,t];const n=Xr(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function $W(e){const t=[];return AW(e,t,new Set),t}function AW(e,t,n){if(e==null)return;if(e instanceof Cn){t.push(e);return}if(!Lft(e))return;const r=e;for(const i in r){const a=r[i];n.has(a)||(n.add(a),AW(a,t,n))}}function Lft(e){return Array.isArray(e)||typeof e=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$(e){return e.kernelName!=null}class JB{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Ec{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new JB}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,r=1){return t in this.registryFactory?(ui(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:r},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(t);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Eft(this.backendInstance),!0}setupRegisteredKernels(){XB(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){XB(t).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof $k)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,a=r.then(s=>i<this.pendingBackendInitId?!1:(this.registry[t]=s,this.pendingBackendInit=null,!0)).catch(s=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,ui(`Initialization of backend ${t} failed`),ui(s.stack||s.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(r){return ui(`Initialization of backend ${t} failed`),ui(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n],{success:i,asyncInit:a}=this.initializeBackend(r);if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const r=this.state.tensorInfo.get(n),i=r.backend,a=this.readSync(n),s=i.refCount(n);i.disposeData(n,!0),r.backend=t,t.move(n,a,r.shape,r.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let r=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,r){t();try{const i=r();return n(),i}catch(i){throw n(),i}}nextTensorId(){return Ec.nextTensorId++}nextVariableId(){return Ec.nextVariableId++}clone(t){const n=tt.runKernel(hp,{x:t}),r={x:t},i=s=>({x:()=>{const o="float32",l={x:s},c={dtype:o};return tt.runKernel(Jd,l,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,r,[n],i,a,{}),n}runKernel(t,n,r){if(this.backendName==null&&this.backend,!(qB(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,r){const i=this.backend.numDataIds();let a=0;r.forEach(l=>{a+=l.dtype==="complex64"?3:1});const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-n-a-s;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let n,r=[];const i=this.isTapeOn(),a=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=r$(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(r$(t)){const{kernelName:v,inputs:x,attrs:b}=t;this.backendName==null&&this.backend;const w=qB(v,this.backendName);j(w!=null,()=>`Cannot find registered kernel '${v}' for backend '${this.backendName}'`),o=()=>{const C=this.backend.numDataIds();l=w.kernelFunc({inputs:x,attrs:b,backend:this.backend});const T=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(v,C,T);const $=T.map(A=>A.rank!=null?A:this.makeTensorFromTensorInfo(A));if(i){const A=this.getTensorsForGradient(v,x,$);r=this.saveTensorsForBackwardMode(A)}return $}}else{const{forwardFunc:v}=t,x=b=>{i&&(r=b.map(w=>this.keep(this.clone(w))))};o=()=>{const b=this.backend.numDataIds();l=this.tidy(()=>v(this.backend,x));const w=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,b,w),w}}const{inputs:h,attrs:d}=t,p=r$(t)?null:t.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(g=this.profiler.profileKernel(c,h,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),n=g.outputs)}),i&&this.addTapeNode(c,h,n,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(v=>h[v]!=null?h[v].shape:null),outputShapes:n.map(v=>v.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(t,n,r){const i=HB(t);if(i!=null){const a=i.inputsToSave||[],s=i.outputsToSave||[];let o;i.saveAllInputs?(j(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(c=>n[c])):o=a.map(c=>n[c]);const l=r.filter((c,h)=>s[h]);return o.concat(l)}return[]}makeTensor(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let a=t;r==="string"&&Gd(t[0])&&(a=t.map(l=>uo(l)));const s=i.write(a,n,r),o=new Cn(n,r,s,this.nextTensorId());if(this.trackTensor(o,i),r==="string"){const l=this.state.tensorInfo.get(s),c=aft(a);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(t,n,r,i){r=r||"float32";const a={dataId:t,shape:n,dtype:r};return this.makeTensorFromTensorInfo(a,i)}makeTensorFromTensorInfo(t,n){const{dataId:r,shape:i,dtype:a}=t,s=new Cn(i,a,r,this.nextTensorId());return this.trackTensor(s,n),s}makeVariable(t,n=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const a=new iv(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*tv(t.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r})),t instanceof iv||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const r=t.size*tv(t.dtype);this.state.numBytes-=r}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,r,i,a,s){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},l=HB(t);l!=null&&(i=l.gradFunc),i!=null&&(o.gradient=c=>(c=c.map((h,d)=>{if(h==null){const p=r[d],g=ur(p.size,p.dtype);return this.makeTensor(g,p.shape,p.dtype)}return h}),i(c.length>1?c:c[0],a,s))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=$W(t),r=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const s=this.state.activeScope.track[a];!s.kept&&!r.has(s.id)&&s.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===i.id&&this.track(a)})}gradients(t,n,r,i=!1){if(j(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));j(a instanceof Cn,()=>"The result y returned by f() must be a tensor.");const s=Nft(this.state.activeTape,n,a);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[a.id]=r??Bft(a.shape),_ft(o,s,c=>this.tidy(c),zft);const l=n.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const h of c.saved)h.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(t){return j(B2(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{j(n.every(o=>o instanceof Cn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};n.forEach((o,l)=>{i[l]=o});const a=(o,l)=>(r=t(...n,l),j(r.value instanceof Cn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),j(B2(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),s=(o,l)=>{const c=r.gradFunc(o,l),h=Array.isArray(c)?c:[c];j(h.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),j(h.every(p=>p instanceof Cn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return h.forEach((p,g)=>{d[g]=()=>p}),d};return this.runKernelFunc({forwardFunc:a,backwardsFunc:s,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=Er(),r=await this.backend.time(t);return r.wallMs=Er()-n,r}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new JB;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ec.nextTensorId=0;Ec.nextVariableId=0;function Bft(e){const t=Ek(pt(e),"float32");return tt.makeTensor(t,e,"float32")}function kW(){const e=HV();if(e._tfengine==null){const t=new lft(e);e._tfengine=new Ec(t)}return hft(e._tfengine.ENV),Mft(()=>e._tfengine),e._tfengine}const tt=kW();function zft(e,t){const n={a:e,b:t};return tt.runKernel(Xc,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jft(){return typeof navigator<"u"&&navigator!=null}function EW(e){if(e||jft()){if(e||(e=navigator),e.product==="ReactNative")return!0;const t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function IW(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rr=ct();Rr.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Rr.registerFlag("IS_BROWSER",()=>IW());Rr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Rr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Rr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Rr.registerFlag("PROD",()=>!1);Rr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Rr.getBool("DEBUG"));Rr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Rr.registerFlag("IS_TEST",()=>!1);Rr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Rr.getBool("DEBUG"));Rr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Rr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Rr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0(e,t){let n=e;if(Li(e))return t==="string"?[]:[e.length];if(CW(e)){const i=e.channels||"RGBA";return[e.height,e.width*i.length]}else if(TW(e))return[e.buffer.size/(t==null?4:tv(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||Li(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&ct().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&OW(e,r,[]),r}function OW(e,t,n){if(n=n||[],!Array.isArray(e)&&!Li(e)){j(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}j(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),j(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const r=t.slice(1);for(let i=0;i<e.length;++i)OW(e[i],r,n.concat(i))}function tz(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function X(e,t,n,r="numeric"){if(e instanceof dt())return tz(r,e.dtype,t,n),e;let i=qc(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),tz(r,i,t,n),e==null||!Li(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const l=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const a=l0(e,i);!Li(e)&&!Array.isArray(e)&&(e=[e]);const o=i!=="string"?jl(e,i):Tl(e,[],!0);return tt.makeTensor(o,a,i)}function NW(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((a,s)=>X(a,`${t}[${s}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uft="__op";function rt(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Uft;const i=(...a)=>{tt.startScope(n);try{const s=r(...a);return Ik(s)&&console.error("Cannot return a Promise inside of tidy."),tt.endScope(s),s}catch(s){throw tt.endScope(null),s}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vft(e,t){const n=X(e,"real","complex"),r=X(t,"imag","complex");kk(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return tt.runKernel(Fk,i)}const Ic=rt({complex_:Vft});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0(e,t,n,r){if(r==null)r=qc(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(TW(e)||CW(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return tt.backend.createTensorFromGPUData(e,t||n,r)}if(!Li(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){As(t);const i=pt(t),a=pt(n);j(i===a,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${a}`);for(let s=0;s<n.length;++s){const o=n[s],l=s===n.length-1?o!==pt(t.slice(s)):!0;j(n[s]===t[s]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Li(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?jl(e,r):Tl(e,[],!0),tt.makeTensor(e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(e,t,n){const r=l0(e,n);return u0(e,t,r,n)}class Kc{static join(t){return new Kc(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>Li(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){const i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=n+i.byteLength;this.shards.push({buffer:i,start:n,end:a}),n=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);const i=n-t,a=new ArrayBuffer(i),s=new Uint8Array(a);let o=0;for(let l=r;l<this.shards.length;l++){const c=this.shards[l],d=t+o-c.start,p=o,v=Math.min(n,c.end)-c.start,x=new Uint8Array(c.buffer,d,v-d);if(s.set(x,p),o+=x.length,n<c.end)break}return a}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(i){return t<i.start?-1:t>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Wft(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Wft(e,t){let n=0,r=e.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,a=t(e[i]);if(a===0)return i;a<0?r=i:n=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ya(){return tt}function ez(){return tt.memory()}function st(e,t){return tt.tidy(e,t)}function oe(e){$W(e).forEach(n=>n.dispose())}function Ea(e){return tt.keep(e)}function RW(e,t,n=1){return tt.registerBackend(e,t,n)}function Gft(){return tt.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nz=4;async function rz(e,t){const n=[],r=[],i=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);for(let s=0;s<i.length;++s){const o=i[s],l=Array.isArray(e)?e[s].tensor:e[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async d=>{const p=await l.bytes(),g=p.reduce((b,w)=>b+w.length,0)+nz*p.length,v=new Uint8Array(g);let x=0;for(let b=0;b<p.length;b++){const w=p[b],C=new Uint8Array(new Uint32Array([w.length]).buffer);v.set(C,x),x+=nz,v.set(w,x),x+=w.length}d(v)});r.push(h)}else r.push(l.data());t!=null&&(c.group=t),n.push(c)}const a=await Promise.all(r);return{data:qft(a),specs:n}}function qft(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(a=>{if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const r=new Uint8Array(t);let i=0;return n.forEach(a=>{r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}const vE=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function iz(e){return vE?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function Hft(e){if(vE)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function Xft(e){if(vE){const r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function Kft(e){return Kc.join(e)}function DW(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:iz(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:iz(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new Kc(e.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return vr.instance==null&&(vr.instance=new vr),vr.instance}static registerSaveRouter(t){vr.getInstance().saveRouters.push(t)}static registerLoadRouter(t){vr.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return vr.getHandlers(t,"save")}static getLoadHandlers(t,n){return vr.getHandlers(t,"load",n)}static getHandlers(t,n,r){const i=[];return(n==="load"?vr.getInstance().loadRouters:vr.getInstance().saveRouters).forEach(s=>{const o=s(t,r);o!==null&&i.push(o)}),i}}const Yft=e=>vr.getSaveHandlers(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K2="tensorflowjs",Y2=1,fl="models_store",ro="model_info_store";function MW(){if(!ct().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Z2(e){const t=e.result;t.createObjectStore(fl,{keyPath:"modelPath"}),t.createObjectStore(ro,{keyPath:"modelPath"})}class $l{constructor(t){if(this.indexedDB=MW(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((r,i)=>{const a=this.indexedDB.open(K2,Y2);a.onupgradeneeded=()=>Z2(a),a.onsuccess=()=>{const s=a.result;if(n==null){const o=s.transaction(fl,"readonly"),c=o.objectStore(fl).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return s.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=h=>(s.close(),i(c.error)),o.oncomplete=()=>s.close()}else{n.weightData=Kc.join(n.weightData);const o=DW(n),l=s.transaction(ro,"readwrite");let c=l.objectStore(ro),h;try{h=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(p){return i(p)}let d;h.onsuccess=()=>{d=s.transaction(fl,"readwrite");const p=d.objectStore(fl);let g;try{g=p.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:o})}catch(v){return i(v)}g.onsuccess=()=>r({modelArtifactsInfo:o}),g.onerror=v=>{c=l.objectStore(ro);const x=c.delete(this.modelPath);x.onsuccess=()=>(s.close(),i(g.error)),x.onerror=b=>(s.close(),i(g.error))}},h.onerror=p=>(s.close(),i(h.error)),l.oncomplete=()=>{d==null?s.close():d.oncomplete=()=>s.close()}}},a.onerror=s=>i(a.error)})}}$l.URL_SCHEME="indexeddb://";const PW=e=>ct().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith($l.URL_SCHEME)?Zft(e.slice($l.URL_SCHEME.length)):null;vr.registerSaveRouter(PW);vr.registerLoadRouter(PW);function Zft(e){return new $l(e)}function Qft(e){return e.startsWith($l.URL_SCHEME)?e.slice($l.URL_SCHEME.length):e}class Jft{constructor(){this.indexedDB=MW()}async listModels(){return new Promise((t,n)=>{const r=this.indexedDB.open(K2,Y2);r.onupgradeneeded=()=>Z2(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(ro,"readonly"),o=a.objectStore(ro).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;t(l)},o.onerror=l=>(i.close(),n(o.error)),a.oncomplete=()=>i.close()},r.onerror=i=>n(r.error)})}async removeModel(t){return t=Qft(t),new Promise((n,r)=>{const i=this.indexedDB.open(K2,Y2);i.onupgradeneeded=()=>Z2(i),i.onsuccess=()=>{const a=i.result,s=a.transaction(ro,"readwrite"),o=s.objectStore(ro),l=o.get(t);let c;l.onsuccess=()=>{if(l.result==null)return a.close(),r(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const h=o.delete(t),d=()=>{c=a.transaction(fl,"readwrite");const g=c.objectStore(fl).delete(t);g.onsuccess=()=>n(l.result.modelArtifactsInfo),g.onerror=v=>r(l.error)};h.onsuccess=d,h.onerror=p=>(d(),a.close(),r(l.error))}},l.onerror=h=>(a.close(),r(l.error)),s.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},i.onerror=a=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const as="/",Gu="tensorflowjs_models",FW="info",tht="model_topology",eht="weight_specs",nht="weight_data",rht="model_metadata";function LW(e){return{info:[Gu,e,FW].join(as),topology:[Gu,e,tht].join(as),weightSpecs:[Gu,e,eht].join(as),weightData:[Gu,e,nht].join(as),modelMetadata:[Gu,e,rht].join(as)}}function BW(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function iht(e){const t=e.split(as);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(as)}function aht(e){return e.startsWith(Al.URL_SCHEME)?e.slice(Al.URL_SCHEME.length):e}class Al{constructor(t){if(!ct().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=LW(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=DW(t),a=Kc.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Hft(a));const s={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(s)),{modelArtifactsInfo:i}}catch{throw BW(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const o=JSON.parse(a);n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,o.signature!=null&&(n.signature=o.signature),o.userDefinedMetadata!=null&&(n.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(n.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(n.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(n.trainingConfig=o.trainingConfig)}const s=this.LS.getItem(this.keys.weightData);if(s==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Xft(s),n}}Al.URL_SCHEME="localstorage://";const zW=e=>ct().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Al.URL_SCHEME)?sht(e.slice(Al.URL_SCHEME.length)):null;vr.registerSaveRouter(zW);vr.registerLoadRouter(zW);function sht(e){return new Al(e)}class oht{constructor(){j(ct().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),j(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=Gu+as,r=as+FW;for(let i=0;i<this.LS.length;++i){const a=this.LS.key(i);if(a.startsWith(n)&&a.endsWith(r)){const s=iht(a);t[s]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){t=aht(t);const n=LW(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return BW(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const az="://";class ba{constructor(){this.managers={}}static getInstance(){return ba.instance==null&&(ba.instance=new ba),ba.instance}static registerManager(t,n){j(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(az)&&(t=t.slice(0,t.indexOf(az))),j(t.length>0,()=>"scheme must not be an empty string.");const r=ba.getInstance();j(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){const n=ba.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(ba.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lht{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!ct().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return yW(t)}}if(ct().get("IS_BROWSER")){ct().setPlatform("browser",new lht);try{ba.registerManager(Al.URL_SCHEME,new oht)}catch{}try{ba.registerManager($l.URL_SCHEME,new Jft)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uht={importFetch:()=>require("node-fetch")};let i$;class cht{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return ct().global.fetch!=null?ct().global.fetch(t,n):(i$==null&&(i$=uht.importFetch()),i$(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}ct().get("IS_NODE")&&!ct().get("IS_BROWSER")&&ct().setPlatform("node",new cht);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ne(e,t="float32",n){return t=t||"float32",As(e),new Yn(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fht(e,t){const n=X(e,"x","cast");if(!ift(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:t};return tt.runKernel(Jd,r,i)}const _t=rt({cast_:fht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hht(e){const n={x:X(e,"x","clone","string_or_numeric")};return tt.runKernel(hp,n)}const ml=rt({clone_:hht});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dht(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */kW();const pht={buffer:ne,cast:_t,clone:ml,print:dht};Pft(pht);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mht(e,t){let n=X(e,"a","add"),r=X(t,"b","add");[n,r]=cn(n,r);const i={a:n,b:r};return tt.runKernel(Xc,i)}const Ct=rt({add_:mht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ght(e,t){let n=X(e,"a","floorDiv"),r=X(t,"b","floorDiv");[n,r]=cn(n,r);const i={a:n,b:r};return tt.runKernel(cp,i)}const jW=rt({floorDiv_:ght});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yht(e,t){let n=X(e,"a","div"),r=X(t,"b","div");if([n,r]=cn(n,r),n.dtype==="int32"&&r.dtype==="int32")return jW(n,r);const i={a:n,b:r},a={};return tt.runKernel(ip,i,a)}const jt=rt({div_:yht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vht(e,t){let n=X(e,"a","mul"),r=X(t,"b","mul");[n,r]=cn(n,r);const i={a:n,b:r};return tt.runKernel(wp,i)}const J=rt({mul_:vht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bht(e){const t=X(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return tt.runKernel(pb,n)}else{const n={x:t};return tt.runKernel(sb,n)}}const sr=rt({abs_:bht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xht(e){const n={x:X(e,"x","acos")};return tt.runKernel(qd,n)}const wht=rt({acos_:xht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sht(e){const n={x:X(e,"x","acosh")};return tt.runKernel(Hd,n)}const Cht=rt({acosh_:Sht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tht(e){j(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),j(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((i,a)=>X(i,`tensors${a}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!we(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=t;return tt.runKernel(ob,r)}const sz=rt({addN_:Tht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ht(e,t=null,n=!1){const i={x:X(e,"x","all","bool")},a={axis:t,keepDims:n};return tt.runKernel(Nk,i,a)}const UW=rt({all_:$ht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aht(e,t=null,n=!1){const i={x:X(e,"x","any","bool")},a={axis:t,keepDims:n};return tt.runKernel(_k,i,a)}const Q2=rt({any_:Aht});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kht(e,t=0){const r={x:X(e,"x","argMax")},i={axis:t};return tt.runKernel(lb,r,i)}const xd=rt({argMax_:kht});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eht(e,t=0){const r={x:X(e,"x","argMin")},i={axis:t};return tt.runKernel(ub,r,i)}const Iht=rt({argMin_:Eht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oht(e){const n={x:X(e,"x","asin")};return tt.runKernel(Xd,n)}const Nht=rt({asin_:Oht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ht(e){const n={x:X(e,"x","asinh")};return tt.runKernel(Kd,n)}const Rht=rt({asinh_:_ht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dht(e){const n={x:X(e,"x","atan")};return tt.runKernel(Yd,n)}const Mht=rt({atan_:Dht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pht(e,t){let n=X(e,"a","atan2"),r=X(t,"b","atan2");[n,r]=cn(n,r);const i={a:n,b:r};return tt.runKernel(Qd,i)}const Fht=rt({atan2_:Pht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lht(e){const n={x:X(e,"x","atanh")};return tt.runKernel(Zd,n)}const Bht=rt({atanh_:Lht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jp(e,t,n,r,i="NHWC",a){const s=e[3],o=[...t,s],l=Es(i);return Qn(e,o,n,a,r,null,null,l)}function ji(e,t,n,r,i,a,s="channelsLast"){const[o,l]=wd(t);let c;if(s==="channelsLast")c=[o,l,e[3],e[3]];else if(s==="channelsFirst")c=[o,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return Qn(e,c,n,r,i,a,!1,s)}function ks(e,t,n,r,i,a,s="NDHWC"){const[o,l,c]=J2(t);let h,d;if(s==="NDHWC")d="channelsLast",h=[o,l,c,e[4],e[4]];else if(s==="NCDHW")d="channelsFirst",h=[o,l,c,e[1],e[1]];else throw new Error(`Unknown dataFormat ${s}`);return Ao(e,h,n,r,i,!1,d,a)}function Qn(e,t,n,r,i,a,s=!1,o="channelsLast"){let[l,c,h,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,h,d]=e;else if(o==="channelsFirst")[l,d,c,h]=e;else throw new Error(`Unknown dataFormat ${o}`);const[p,g,,v]=t,[x,b]=wd(n),[w,C]=wd(r),T=ec(p,w),$=ec(g,C),{padInfo:A,outHeight:E,outWidth:O}=Uht(i,c,h,x,b,T,$,a,o),N=s?v*d:v;let _;return o==="channelsFirst"?_=[l,N,E,O]:o==="channelsLast"&&(_=[l,E,O,N]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:h,inChannels:d,outHeight:E,outWidth:O,outChannels:N,padInfo:A,strideHeight:x,strideWidth:b,filterHeight:p,filterWidth:g,effectiveFilterHeight:T,effectiveFilterWidth:$,dilationHeight:w,dilationWidth:C,inShape:e,outShape:_,filterShape:t}}function Ao(e,t,n,r,i,a=!1,s="channelsLast",o){let[l,c,h,d,p]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,c,h,d,p]=e;else if(s==="channelsFirst")[l,p,c,h,d]=e;else throw new Error(`Unknown dataFormat ${s}`);const[g,v,x,,b]=t,[w,C,T]=J2(n),[$,A,E]=J2(r),O=ec(g,$),N=ec(v,A),_=ec(x,E),{padInfo:R,outDepth:I,outHeight:P,outWidth:B}=Vht(i,c,h,d,w,C,T,O,N,_,o),V=a?b*p:b;let z;return s==="channelsFirst"?z=[l,V,I,P,B]:s==="channelsLast"&&(z=[l,I,P,B,V]),{batchSize:l,dataFormat:s,inDepth:c,inHeight:h,inWidth:d,inChannels:p,outDepth:I,outHeight:P,outWidth:B,outChannels:V,padInfo:R,strideDepth:w,strideHeight:C,strideWidth:T,filterDepth:g,filterHeight:v,filterWidth:x,effectiveFilterDepth:O,effectiveFilterHeight:N,effectiveFilterWidth:_,dilationDepth:$,dilationHeight:A,dilationWidth:E,inShape:e,outShape:z,filterShape:t}}function zht(e,t,n,r,i){r==null&&(r=bE(e,t,n));const a=e[0],s=e[1],o=Sd((a-t+2*r)/n+1,i),l=Sd((s-t+2*r)/n+1,i);return[o,l]}function jht(e,t,n,r,i,a){i==null&&(i=bE(e,t[0],r[0]));const s=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*i>=t[o]&&(s[o]=Sd((e[o]-t[o]+2*i)/r[o]+1,a));return s}function bE(e,t,n,r=1){const i=ec(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function wd(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function J2(e){return typeof e=="number"?[e,e,e]:e}function ec(e,t){return t<=1?e:e+(e-1)*(t-1)}function Uht(e,t,n,r,i,a,s,o,l){let c,h,d;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const g=zht([t,n],a,r,e,o);h=g[0],d=g[1]}else if(e==="same"){h=Math.ceil(t/r),d=Math.ceil(n/i);const p=Math.max(0,(h-1)*r+a-t),g=Math.max(0,(d-1)*i+s-n),v=Math.floor(p/2),x=p-v,b=Math.floor(g/2),w=g-b;c={top:v,bottom:x,left:b,right:w,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((t-a+1)/r),d=Math.ceil((n-s+1)/i);else if(typeof e=="object"){const p=l==="channelsLast"?e[1][0]:e[2][0],g=l==="channelsLast"?e[1][1]:e[2][1],v=l==="channelsLast"?e[2][0]:e[3][0],x=l==="channelsLast"?e[2][1]:e[3][1];c={top:p,bottom:g,left:v,right:x,type:p===0&&g===0&&v===0&&x===0?"VALID":"EXPLICIT"},h=Sd((t-a+p+g)/r+1,o),d=Sd((n-s+v+x)/i+1,o)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:h,outWidth:d}}function Vht(e,t,n,r,i,a,s,o,l,c,h){let d,p,g,v;if(e==="valid"&&(e=0),typeof e=="number"){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const b=jht([t,n,r,1],[o,l,c],1,[i,a,s],e,h);p=b[0],g=b[1],v=b[2]}else if(e==="same"){p=Math.ceil(t/i),g=Math.ceil(n/a),v=Math.ceil(r/s);const x=(p-1)*i+o-t,b=(g-1)*a+l-n,w=(v-1)*s+c-r,C=Math.floor(x/2),T=x-C,$=Math.floor(b/2),A=b-$,E=Math.floor(w/2),O=w-E;d={top:$,bottom:A,left:E,right:O,front:C,back:T,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outDepth:p,outHeight:g,outWidth:v}}function Sd(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function kl(e){const[t,n,r]=wd(e);return t===1&&n===1&&r===1}function cr(e,t){return kl(e)||kl(t)}function El(e){return wd(e).every(t=>t>0)}function Es(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Pr(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")j(kc(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(i=>{j(kc(i),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wht(e,t){const r={x:X(e,"x","reshape","string_or_numeric")},i={shape:t};return tt.runKernel(Xb,r,i)}const nt=rt({reshape_:Wht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ght(e,t,n,r,i){const a=X(e,"x","avgPool","float32"),s=1;j(cr(n,s),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);let o=a,l=!1;a.rank===3&&(l=!0,o=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),j(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Pr("avgPool",r,i);const c={x:o},h={filterSize:t,strides:n,pad:r,dimRoundingMode:i};let d=tt.runKernel(cb,c,h);return d=_t(d,a.dtype),l?nt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const xE=rt({avgPool_:Ght});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qht(e,t,n,r,i,a="NDHWC"){const s=X(e,"x","avgPool3d","float32");let o=s,l=!1;s.rank===4&&(l=!0,o=nt(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),j(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),j(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),j(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Pr("avgPool3d",r,i);const c={x:o},h={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a};let d=tt.runKernel(fb,c,h);return d=_t(d,o.dtype),l?nt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Hht=rt({avgPool3d_:qht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xht(e,t=0){j(e.length>=1,()=>"Pass at least one tensor to concat");const n=NW(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return ml(n[0]);const r=n,i={axis:t};return tt.runKernel(mb,r,i)}const _r=rt({concat_:Xht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kht(e,t,n=!1,r=!1){let i=X(e,"a","matMul"),a=X(t,"b","matMul");[i,a]=cn(i,a);const s={a:i,b:a},o={transposeA:n,transposeB:r};return tt.runKernel(hb,s,o)}const xe=rt({matMul_:Kht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yht(e){const n={x:X(e,"x","sigmoid","float32")};return tt.runKernel(_p,n)}const Yc=rt({sigmoid_:Yht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zht(e,t,n){const r=X(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},a={begin:t,size:n};return tt.runKernel(Jb,i,a)}const Ue=rt({slice_:Zht});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qht(e){const n={x:X(e,"x","tanh","float32")};return tt.runKernel(Lp,n)}const c0=rt({tanh_:Qht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jht(e,t,n){const r=X(e,"x","batchToSpaceND"),i=t.reduce((o,l)=>o*l);j(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),j(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),j(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);const a={x:r},s={blockShape:t,crops:n};return tt.runKernel(db,a,s)}const wE=rt({batchToSpaceND_:Jht});function tdt(e){let t;return e.rank===0||e.rank===1?t=nt(e,[1,1,1,e.size]):e.rank===2?t=nt(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function edt(e,t,n,r,i,a){a==null&&(a=.001);const s=X(e,"x","batchNorm"),o=X(t,"mean","batchNorm"),l=X(n,"variance","batchNorm");let c;i!=null&&(c=X(i,"scale","batchNorm"));let h;r!=null&&(h=X(r,"offset","batchNorm")),j(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(h==null||o.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:tdt(s),scale:c,offset:h,mean:o,variance:l},g={varianceEpsilon:a},v=tt.runKernel(Tb,p,g);return nt(v,s.shape)}const f0=rt({batchNorm_:edt});function ndt(e,t,n,r,i,a){const s=X(e,"x","batchNorm"),o=X(t,"mean","batchNorm"),l=X(n,"variance","batchNorm");let c;i!=null&&(c=X(i,"scale","batchNorm"));let h;return r!=null&&(h=X(r,"offset","batchNorm")),j(s.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`),j(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),j(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&j(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),h!=null&&j(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),f0(s,o,l,h,c,a)}const rdt=rt({batchNorm2d_:ndt});function idt(e,t,n,r,i,a){const s=X(e,"x","batchNorm"),o=X(t,"mean","batchNorm"),l=X(n,"variance","batchNorm");let c;i!=null&&(c=X(i,"scale","batchNorm"));let h;return r!=null&&(h=X(r,"offset","batchNorm")),j(s.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`),j(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),j(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&j(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),h!=null&&j(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),f0(s,o,l,h,c,a)}const adt=rt({batchNorm3d_:idt});function sdt(e,t,n,r,i,a){const s=X(e,"x","batchNorm"),o=X(t,"mean","batchNorm"),l=X(n,"variance","batchNorm");let c;i!=null&&(c=X(i,"scale","batchNorm"));let h;return r!=null&&(h=X(r,"offset","batchNorm")),j(s.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`),j(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),j(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&j(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),h!=null&&j(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),f0(s,o,l,h,c,a)}const odt=rt({batchNorm4d_:sdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ldt(e,t,n){const r=X(e,"x","bincount"),i=X(t,"weights","bincount");j(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),j(n>=0,()=>`size must be non-negative, but got ${n}.`),j(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const a={x:r,weights:i},s={size:n};return tt.runKernel(Mk,a,s)}const udt=rt({bincount_:ldt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cdt(e,t){let n=X(e,"broadcastTo","x");const r=n.shape;if(As(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const c=n.shape.slice();for(;c.length<t.length;)c.unshift(1);n=nt(n,c)}const i=n.shape,a=Array.from(t);for(let c=t.length-1;c>=0;c--)if(i[c]===t[c])a[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(a.map((c,h)=>c>1?h:-1).filter(c=>c>=0).length===0)return ml(n);const o={x:n},l={reps:a};return tt.runKernel(Bp,o,l)}const Fh=rt({broadcastTo_:cdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fdt(e){const n={x:X(e,"x","ceil","float32")};return tt.runKernel(tp,n)}const hdt=rt({ceil_:fdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(e,t,n){As(e),n=n||qc(t);const r={shape:e,value:t,dtype:n};return tt.runKernel(Yk,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ddt(e,t,n){const r=X(e,"x","clipByValue");if(j(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return Up(r.shape,t,r.dtype);const i={x:r},a={clipValueMin:t,clipValueMax:n};return tt.runKernel(ep,i,a)}const di=rt({clipByValue_:ddt});function pdt(e){return _r(e,0)}const mdt=rt({concat1d_:pdt});function gdt(e,t){return _r(e,t)}const ydt=rt({concat2d_:gdt});function vdt(e,t){return _r(e,t)}const bdt=rt({concat3d_:vdt});function xdt(e,t){return _r(e,t)}const wdt=rt({concat4d_:xdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sdt(e,t,n,r,i="NHWC",a=[1,1],s){const o=X(e,"x","conv2d","float32"),l=X(t,"filter","conv2d","float32");let c=o,h=!1;o.rank===3&&(h=!0,c=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),j(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),j(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Pr("conv2d",r,s);const d=i==="NHWC"?c.shape[3]:c.shape[1];j(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),j(cr(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),j(El(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),j(El(n),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:c,filter:l},g={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s},v=tt.runKernel(gb,p,g);return h?nt(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const Il=rt({conv2d_:Sdt});function Cdt(e,t,n,r,i="NWC",a=1,s){const o=X(e,"x","conv1d"),l=X(t,"filter","conv1d");let c=o,h=!1;o.rank===2&&(h=!0,c=nt(o,[1,o.shape[0],o.shape[1]])),j(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),j(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Pr("conv1d",r,s),j(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),j(cr(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),j(El(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),j(El(n),()=>"Error in conv1D: Stride should be larger than 0."),j(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const d=nt(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=nt(c,[c.shape[0],1,c.shape[1],c.shape[2]]),b=Il(p,d,[1,n],r,"NHWC",[1,a],s);return h?nt(b,[b.shape[2],b.shape[3]]):nt(b,[b.shape[0],b.shape[2],b.shape[3]])}const VW=rt({conv1d_:Cdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tdt(e,t,n,r,i,a="NHWC",s){j(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,l=t,c=!1;t.rank===3&&(c=!0,l=nt(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),j(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),j(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),j(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const h=a==="NHWC"?o[3]:o[1],d=a==="NHWC"?l.shape[3]:l.shape[1];j(h===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${n.shape[2]}.`),j(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Pr("conv2dDerInput",i,s);const p={dy:l,filter:n},g={strides:r,pad:i,dataFormat:a,dimRoundingMode:s,inputShape:o},v=tt.runKernel(yb,p,g);return c?nt(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const SE=rt({conv2DBackpropInput_:Tdt});function $dt(e,t,n,r,i,a){const s=X(e,"x","conv2dTranspose"),o=X(t,"filter","conv2dTranspose");return SE(n,s,o,r,i,"NHWC",a)}const WW=rt({conv2dTranspose_:$dt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Adt(e,t,n,r,i="NDHWC",a=[1,1,1]){const s=X(e,"x","conv3d"),o=X(t,"filter","conv3d");let l=s,c=!1;s.rank===4&&(c=!0,l=nt(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),j(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),j(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),j(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),j(cr(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),j(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),j(El(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),j(El(n),()=>"Error in conv3D: Strides should be larger than 0.");const h={x:l,filter:o},d={strides:n,pad:r,dataFormat:i,dilations:a},p=tt.runKernel(vb,h,d);return c?nt(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const kdt=rt({conv3d_:Adt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Edt(e,t,n,r,i){j(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,s=t,o=!1;t.rank===4&&(o=!0,s=nt(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,e[0],e[1],e[2],e[3]]);const l=a[4],c=s.shape[4];j(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),j(s.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`),j(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),j(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),j(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const h={dy:s,filter:n},d={pad:i,strides:r,inputShape:a},p=tt.runKernel(zk,h,d);return o?nt(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const GW=rt({conv3DBackpropInput_:Edt});function Idt(e,t,n,r,i){const a=X(e,"x","conv3dTranspose"),s=X(t,"filter","conv3dTranspose");return GW(n,a,s,r,i)}const Odt=rt({conv3dTranspose_:Idt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ndt(e){const n={x:X(e,"x","cos","float32")};return tt.runKernel(np,n)}const CE=rt({cos_:Ndt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _dt(e){const n={x:X(e,"x","cosh","float32")};return tt.runKernel(rp,n)}const qW=rt({cosh_:_dt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rdt(e,t=0,n=!1,r=!1){const a={x:X(e,"x","cumprod")},s={axis:t,exclusive:n,reverse:r};return tt.runKernel(jk,a,s)}const tA=rt({cumprod_:Rdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ddt(e,t=0,n=!1,r=!1){const a={x:X(e,"x","cumsum")},s={axis:t,exclusive:n,reverse:r};return tt.runKernel(bb,a,s)}const HW=rt({cumsum_:Ddt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mdt(e,t,n,r=!1){const i=X(e,"x","denseBincount"),a=X(t,"weights","denseBincount");j(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),j(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),j(n>=0,()=>`size must be non-negative, but got ${n}.`),j(a.size===i.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${a.shape}.`);const s={x:i,weights:a},o={size:n,binaryOutput:r};return tt.runKernel(Vk,s,o)}const oz=rt({denseBincount_:Mdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pdt(e,t,n="NHWC"){const r=X(e,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],s=n==="NHWC"?r.shape[3]:r.shape[1];j(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),j(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),j(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${r.shape}`),j(s%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${s} for depthToSpace with input shape ${r.shape}`);const o={x:r},l={blockSize:t,dataFormat:n};return tt.runKernel(Wk,o,l)}const Fdt=rt({depthToSpace_:Pdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ldt(e,t,n,r,i="NHWC",a=[1,1],s){const o=X(e,"x","depthwiseConv2d","float32"),l=X(t,"filter","depthwiseConv2d","float32");let c=o,h=!1;o.rank===3&&(h=!0,c=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),j(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),j(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=i==="NHWC"?c.shape[3]:c.shape[1];j(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Pr("depthwiseConv2d",r,s);const p={x:c,filter:l},g={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s},v=tt.runKernel(xb,p,g);return h?nt(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const TE=rt({depthwiseConv2d_:Ldt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bdt(e,t,n,r,i=[1,1],a="NHWC"){const s=X(e,"x","dilation2d"),o=X(t,"filter","dilation2d");j(s.rank===3||s.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`),j(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),j(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=s,c=!1;s.rank===3&&(l=nt(s,[1,s.shape[0],s.shape[1],s.shape[2]]),c=!0),j(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const h={x:l,filter:o},d={strides:n,pad:r,dilations:i},p=tt.runKernel(wb,h,d);return c?nt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const zdt=rt({dilation2d_:Bdt});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oc(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const a=n-1-i,s=e[a]||1;(t[t.length-1-i]||1)>1&&s===1&&r.unshift(a)}return r}function On(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],a=t.length-r-1,s=t[a];(i==null||i===1&&s>1)&&n.unshift(a)}return n}function Jt(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let a=e[e.length-i-1];a==null&&(a=1);let s=t[t.length-i-1];if(s==null&&(s=1),a===1)r[n-i-1]=s;else if(s===1)r[n-i-1]=a;else if(a!==s){const o=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(o)}else r[n-i-1]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jdt(e,t){let n=X(e,"a","equal","string_or_numeric"),r=X(t,"b","equal","string_or_numeric");[n,r]=cn(n,r),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(Sb,i)}const Ra=rt({equal_:jdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Udt(e,t,n){const r=X(t,"a","where"),i=X(n,"b","where"),a=X(e,"condition","where","bool"),s=Jt(Jt(a.shape,r.shape),i.shape),o=Fh(a,s),l=Fh(r,s),c=Fh(i,s),h={condition:o,t:l,e:c};return tt.runKernel(Qb,h)}const Cr=rt({where_:Udt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vdt(e){const n={x:X(e,"x","zerosLike")};return tt.runKernel(s0,n)}const ge=rt({zerosLike_:Vdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wdt(e,t){let n=X(e,"a","div"),r=X(t,"b","div");[n,r]=cn(n,r);const i=jt(n,r),a=ge(i),s=Ra(r,a);return Cr(s,a,i)}const Gdt=rt({divNoNan_:Wdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qdt(e,t){const n=X(e,"t1","dot"),r=X(t,"t2","dot");j((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];if(j(i===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`),n.rank===1&&r.rank===1){const s=nt(n,[1,-1]),o=nt(r,[-1,1]),l=xe(s,o);return nt(l,[])}else if(n.rank===1&&r.rank===2){const s=nt(n,[1,-1]),o=nt(r,[r.shape[0],r.shape[1]]),l=xe(s,o);return nt(l,[l.size])}else if(n.rank===2&&r.rank===1){const s=nt(r,[-1,1]),o=xe(n,s);return nt(o,[o.size])}else{const s=nt(r,[r.shape[0],r.shape[1]]);return xe(n,s)}}const vs=rt({dot_:qdt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hdt(e,...t){const n=t.map((i,a)=>X(i,`tensors${a}`,"einsum")),r={equation:e};return tt.runKernel(Hk,n,r)}const xh=rt({einsum_:Hdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xdt(e){const n={x:X(e,"x","elu","float32")};return tt.runKernel(ap,n)}const h0=rt({elu_:Xdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kdt(e){let t=X(e,"x","erf");j(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=_t(t,"float32"));const n={x:t};return tt.runKernel(sp,n)}const XW=rt({erf_:Kdt});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $E(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function KW(e,t,n){const r=e.length+t.length,i=[];let a=0,s=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?i.push(e[a++]):i.push(t[s++]);return i}function Vn(e,t){const n=[],r=e.length;for(let a=0;a<r;a++)t.indexOf(a)===-1&&n.push(e[a]);const i=t.map(a=>e[a]);return[n,i]}function bn(e,t){const n=t.map(r=>1);return KW(e,n,t)}function Jn(e,t,n){j($E(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function en(e,t){if($E(e,t))return null;const n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function ko(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function fn(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ydt(e,t=null,n=!1){const i={x:X(e,"x","max")},a={reductionIndices:t,keepDims:n};return tt.runKernel(Db,i,a)}const Pi=rt({max_:Ydt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zdt(e,t=null,n=!1){const i={x:X(e,"x","min")},a={axis:t,keepDims:n};return tt.runKernel(Lb,i,a)}const Cd=rt({min_:Zdt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qdt(e,t){let n=X(e,"base","pow"),r=X(t,"exp","pow");[n,r]=cn(n,r);const i={a:n,b:r};return tt.runKernel(Sp,i)}const Ol=rt({pow_:Qdt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function de(e,t){if((Li(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Li(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return u0(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jdt(e){const n={x:X(e,"x","sqrt","float32")};return tt.runKernel(Dp,n)}const Nn=rt({sqrt_:Jdt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpt(e){const t=X(e,"x","square"),n={};return tt.runKernel("Square",{x:t},n)}const _e=rt({square_:tpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ept(e,t=null,n=!1){let r=X(e,"x","sum");r.dtype==="bool"&&(r=_t(r,"int32"));const i={x:r},a={axis:t,keepDims:n};return tt.runKernel(t0,i,a)}const Rt=rt({sum_:ept});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npt(e,t="euclidean",n=null,r=!1){e=X(e,"x","norm");const i=YW(e,t,n);let a=i.shape;if(r){const s=re(n,e.shape);a=bn(i.shape,s)}return nt(i,a)}function YW(e,t,n=null){if(e.rank===0)return sr(e);if(e.rank!==1&&n===null)return YW(nt(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Rt(sr(e),n);if(t===1/0)return Pi(sr(e),n);if(t===-1/0)return Cd(sr(e),n);if(t==="euclidean"||t===2)return Nn(Rt(Ol(sr(e),de(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Pi(Rt(sr(e),n[0]),n[1]-1);if(t===1/0)return Pi(Rt(sr(e),n[1]),n[0]);if(t===-1/0)return Cd(Rt(sr(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Nn(Rt(_e(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const d0=rt({norm_:npt});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rpt(e,t=null,n=!1){return d0(e,"euclidean",t,n)}const ipt=rt({euclideanNorm_:rpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function apt(e){const n={x:X(e,"x","exp")};return tt.runKernel(op,n)}const Da=rt({exp_:apt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spt(e,t=0){const n=X(e,"x","expandDims","string_or_numeric");j(t<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},i={dim:t};return tt.runKernel(Cb,r,i)}const Ir=rt({expandDims_:spt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function opt(e){const n={x:X(e,"x","expm1")};return tt.runKernel(lp,n)}const lpt=rt({expm1_:opt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function upt(e,t){const n=X(e,"x","tile","string_or_numeric");j(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const r={x:n},i={reps:t};return tt.runKernel(Bp,r,i)}const ia=rt({tile_:upt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpt(e,t,n,r="float32"){t==null&&(t=e);const i=ne([e,t],r),a=e<=t?e:t;for(let o=0;o<a;++o)i.set(1,o,o);const s=nt(i.toTensor(),[e,t]);if(n==null)return s;if(n.length===1)return ia(Ir(s,0),[n[0],1,1]);if(n.length===2)return ia(Ir(Ir(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return ia(Ir(Ir(Ir(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const ZW=rt({eye_:cpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpt(e){const n={x:X(e,"x","floor","float32")};return tt.runKernel(up,n)}const p0=rt({floor_:fpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpt(e,t,n=0,r=0){const i=X(e,"x","gather"),a=X(t,"indices","gather","int32"),s={x:i,indices:a},o={axis:n,batchDims:r};return tt.runKernel($b,s,o)}const Vp=rt({gather_:hpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpt(e,t){let n=X(e,"a","greater","string_or_numeric"),r=X(t,"b","greater","string_or_numeric");[n,r]=cn(n,r),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(Ab,i)}const pi=rt({greater_:dpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ppt(e,t){let n=X(e,"a","greaterEqual","string_or_numeric"),r=X(t,"b","greaterEqual","string_or_numeric");[n,r]=cn(n,r),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(fp,i)}const Ul=rt({greaterEqual_:ppt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpt(e){const n={input:X(e,"input","imag")};return tt.runKernel(Jk,n)}const AE=rt({imag_:mpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpt(e){const n={x:X(e,"x","isFinite")};return tt.runKernel(dp,n)}const ypt=rt({isFinite_:gpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpt(e){const n={x:X(e,"x","isInf")};return tt.runKernel(pp,n)}const bpt=rt({isInf_:vpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpt(e){const n={x:X(e,"x","isNaN")};return tt.runKernel(mp,n)}const wpt=rt({isNaN_:xpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spt(e,t=.2){const r={x:X(e,"x","leakyRelu")},i={alpha:t};return tt.runKernel(kb,r,i)}const kE=rt({leakyRelu_:Spt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cpt(e,t){let n=X(e,"a","less","string_or_numeric"),r=X(t,"b","less","string_or_numeric");[n,r]=cn(n,r),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(Eb,i)}const av=rt({less_:Cpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tpt(e,t){let n=X(e,"a","lessEqual","string_or_numeric"),r=X(t,"b","lessEqual","string_or_numeric");[n,r]=cn(n,r),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(Ib,i)}const Zc=rt({lessEqual_:Tpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $pt(e,t=5,n=1,r=1,i=.5){const a=X(e,"x","localResponseNormalization");j(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),j(kc(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let s=a,o=!1;a.rank===3&&(o=!0,s=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:s},c={depthRadius:t,bias:n,alpha:r,beta:i},h=tt.runKernel(Rb,l,c);return o?nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Apt=rt({localResponseNormalization_:$pt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpt(e){const n={x:X(e,"x","log","float32")};return tt.runKernel(gp,n)}const Ma=rt({log_:kpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ept(e){const n={x:X(e,"x","log1p")};return tt.runKernel(yp,n)}const QW=rt({log1p_:Ept});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipt(e,t){j(B2(e),()=>"The f passed in variableGrads(f) must be a function"),j(t==null||Array.isArray(t)&&t.every(c=>c instanceof iv),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const c in tt.registeredVariables)t.push(tt.registeredVariables[c])}const r=n?t.filter(c=>!c.trainable):null,i=t.length;t=t.filter(c=>c.trainable),j(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const a=!0,{value:s,grads:o}=tt.gradients(e,t,null,a);j(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),j(s.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`);const l={};return t.forEach((c,h)=>{o[h]!=null&&(l[c.name]=o[h])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:s,grads:l}}function Nc(e){return tt.customGrad(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Opt(e){const n={x:X(e,"x","neg")};return tt.runKernel(zb,n)}const Ye=rt({neg_:Opt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Npt(e){const n={x:X(e,"x","softplus")};return tt.runKernel(Rp,n)}const Wp=rt({softplus_:Npt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _pt(e){const t=X(e,"x","logSigmoid");return Nc(r=>({value:Ye(Wp(Ye(r))),gradFunc:s=>J(s,Yc(Ye(r)))}))(t)}const Rpt=rt({logSigmoid_:_pt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpt(e,t){let n=X(e,"a","sub"),r=X(t,"b","sub");[n,r]=cn(n,r);const i={a:n,b:r};return tt.runKernel(Pp,i)}const Vt=rt({sub_:Dpt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mpt(e,t=-1){const n=X(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Nc((i,a)=>{const o=Pi(i,t,!0),l=Vt(i,o),c=Vt(_t(l,"float32"),Ma(Rt(Da(l),t,!0)));return a([c]),{value:c,gradFunc:(d,p)=>{const[g]=p,v=!0,x=Da(g);return Vt(d,J(Rt(d,t,v),x))}}})(n)}const JW=rt({logSoftmax_:Mpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppt(e,t=null,n=!1){const r=X(e,"x","logSumExp"),i=re(t,r.shape),a=Pi(r,i,!0),s=Vt(r,a),o=Da(s),l=Rt(o,i),c=Ma(l),h=Ct(nt(a,c.shape),c);if(n){const d=bn(h.shape,i);return nt(h,d)}return h}const tG=rt({logSumExp_:Ppt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpt(e,t){const n=X(e,"a","logicalAnd","bool"),r=X(t,"b","logicalAnd","bool");Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(Ob,i)}const bs=rt({logicalAnd_:Fpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lpt(e){const n={x:X(e,"x","logicalNot","bool")};return tt.runKernel(Nb,n)}const EE=rt({logicalNot_:Lpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpt(e,t){const n=X(e,"a","logicalOr","bool"),r=X(t,"b","logicalOr","bool");Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(_b,i)}const eG=rt({logicalOr_:Bpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpt(e,t){const n=X(e,"a","logicalXor","bool"),r=X(t,"b","logicalXor","bool");return Jt(n.shape,r.shape),bs(eG(e,t),EE(bs(e,t)))}const jpt=rt({logicalXor_:zpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upt(e,t,n,r,i){const a=X(e,"x","maxPool"),s=1;let o=a,l=!1;a.rank===3&&(l=!0,o=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),j(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),j(cr(n,s),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),Pr("maxPool",r,i);const c={x:o},h={filterSize:t,strides:n,pad:r,dimRoundingMode:i},d=tt.runKernel(Mb,c,h);return l?nt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const IE=rt({maxPool_:Upt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpt(e,t=[1,1,1],n,r,i,a="NDHWC"){const s=X(e,"x","maxPool3d");let o=s,l=!1;s.rank===4&&(l=!0,o=nt(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),j(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),j(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Pr("maxPool3d",r,i);const c={x:o},h={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},d=tt.runKernel(Pb,c,h);return l?nt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Wpt=rt({maxPool3d_:Vpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpt(e,t){let n=X(e,"a","maximum"),r=X(t,"b","maximum");[n,r]=cn(n,r),n.dtype==="bool"&&(n=_t(n,"int32"),r=_t(r,"int32")),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(vp,i)}const Eo=rt({maximum_:Gpt});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpt(e,t=null,n=!1){const i={x:X(e,"x","mean")},a={axis:t,keepDims:n};return tt.runKernel(Fb,i,a)}const vn=rt({mean_:qpt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(e,t="float32"){if(As(e),t==="complex64"){const r=Bn(e,"float32"),i=Bn(e,"float32");return Ic(r,i)}const n=ur(pt(e),t);return tt.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Io(e,t="float32"){if(As(e),t==="complex64"){const r=Io(e,"float32"),i=Bn(e,"float32");return Ic(r,i)}const n=Ek(pt(e),t);return tt.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpt(e,t){let n=X(e,"a","minimum"),r=X(t,"b","minimum");[n,r]=cn(n,r),n.dtype==="bool"&&(n=_t(n,"int32"),r=_t(r,"int32")),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(bp,i)}const Td=rt({minimum_:Hpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xpt(e,t,n){j(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=X(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");j(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);const i=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)j(t[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),j(t[o][0]>=0&&t[o][0]<=r.shape[o]-i&&t[o][1]>=0&&t[o][1]<=r.shape[o]-i,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-i} or less than 0 for input of shape ${r.shape}`);const a={paddings:t,mode:n},s={x:r};return tt.runKernel(Bb,s,a)}const Kpt=rt({mirrorPad_:Xpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ypt(e,t){let n=X(e,"a","mod"),r=X(t,"b","mod");[n,r]=cn(n,r);const i={a:n,b:r};return tt.runKernel(xp,i)}const Zpt=rt({mod_:Ypt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpt(e,t=null,n=!1){e=X(e,"x","moments");const r=re(t,e.shape),i=vn(e,r,n);let a=i.shape;n||(a=bn(i.shape,r));const s=_e(Vt(_t(e,"float32"),nt(i,a))),o=vn(s,r,n);return{mean:i,variance:o}}const OE=rt({moments_:Qpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpt(e,t){let n=X(e,"a","notEqual","string_or_numeric"),r=X(t,"b","notEqual","string_or_numeric");[n,r]=cn(n,r),Jt(n.shape,r.shape);const i={a:n,b:r};return tt.runKernel(jb,i)}const sv=rt({notEqual_:Jpt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tmt(e,t,n=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const s={indices:X(e,"indices","oneHot","int32")},o={dtype:i,depth:t,onValue:n,offValue:r};return tt.runKernel(Vb,s,o)}const nG=rt({oneHot_:tmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function emt(e){const n={x:X(e,"x","onesLike")};return tt.runKernel(Ub,n)}const Bi=rt({onesLike_:emt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nmt(e,t,n=0){const r=X(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},a={x:r};return tt.runKernel(Gb,a,i)}const NE=rt({pad_:nmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rmt(e,t,n){const r=X(e,"x","spaceToBatchND");j(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),j(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),j(r.shape.reduce((s,o,l)=>l>0&&l<=t.length?s&&(o+n[l-1][0]+n[l-1][1])%t[l-1]===0:s,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const i={x:r},a={blockShape:t,paddings:n};return tt.runKernel(e0,i,a)}const _E=rt({spaceToBatchND_:rmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function imt(e,t,n,r,i,a,s){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");const o=X(e,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),j(cr(a,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`);const h=ji(l.shape,t,a,i,r),d=[h.dilationHeight,h.dilationWidth];let p;r==="same"?p=smt([h.filterHeight,h.filterWidth],d):p=[[0,0],[0,0]];const g=d[0]===1&&d[1]===1,[v,x]=amt([h.inHeight,h.inWidth],d,p),b=g?r:"valid",w=g?l:_E(l,d,v),T=(n==="avg"?()=>xE(w,t,a,b,s):()=>IE(w,t,a,b,s))(),$=g?T:wE(T,d,x);return c?nt($,[$.shape[1],$.shape[2],$.shape[3]]):$}function amt(e,t,n){const r=n.map(h=>h[0]),i=n.map(h=>h[1]),a=e.concat(r,i),s=t.map((h,d)=>(h-a[d]%h)%h),o=i.map((h,d)=>h+s[d]),l=t.map((h,d)=>[r[d],o[d]]),c=t.map((h,d)=>[0,s[d]]);return[l,c]}function smt(e,t){const r=e.map((s,o)=>s+(s-1)*(t[o]-1)).map(s=>s-1),i=r.map(s=>Math.floor(s/2)),a=r.map((s,o)=>s-i[o]);return r.map((s,o)=>[i[o],a[o]])}const omt=rt({pool_:imt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lmt(e,t){const n=X(e,"x","prelu"),r=X(t,"alpha","prelu"),i={x:n,alpha:r};return tt.runKernel(qb,i)}const RE=rt({prelu_:lmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function umt(e,t=null,n=!1){let r=X(e,"x","prod");r.dtype==="bool"&&(r=_t(r,"int32"));const i={x:r},a={axis:t,keepDims:n};return tt.runKernel(Hb,i,a)}const cmt=rt({prod_:umt});var Yg={exports:{}},fmt=Yg.exports,lz;function hmt(){return lz||(lz=1,function(e){(function(t,n,r){function i(l){var c=this,h=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=h(" "),c.s1=h(" "),c.s2=h(" "),c.s0-=h(l),c.s0<0&&(c.s0+=1),c.s1-=h(l),c.s1<0&&(c.s1+=1),c.s2-=h(l),c.s2<0&&(c.s2+=1),h=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function s(l,c){var h=new i(l),d=c&&c.state,p=h.next;return p.int32=function(){return h.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&a(d,h),p.state=function(){return a(h,{})}),p}function o(){var l=4022871197,c=function(h){h=String(h);for(var d=0;d<h.length;d++){l+=h.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=s:this.alea=s})(fmt,e)}(Yg)),Yg.exports}var Zg={exports:{}},dmt=Zg.exports,uz;function pmt(){return uz||(uz=1,function(e){(function(t,n,r){function i(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function s(o,l){var c=new i(o),h=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,v=(p+g)/(1<<21);while(v===0);return v},d.int32=c.next,d.quick=d,h&&(typeof h=="object"&&a(h,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=s:this.xor128=s})(dmt,e)}(Zg)),Zg.exports}var Qg={exports:{}},mmt=Qg.exports,cz;function gmt(){return cz||(cz=1,function(e){(function(t,n,r){function i(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,h==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function s(o,l){var c=new i(o),h=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,v=(p+g)/(1<<21);while(v===0);return v},d.int32=c.next,d.quick=d,h&&(typeof h=="object"&&a(h,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=s:this.xorwow=s})(mmt,e)}(Qg)),Qg.exports}var Jg={exports:{}},ymt=Jg.exports,fz;function vmt(){return fz||(fz=1,function(e){(function(t,n,r){function i(o){var l=this;l.next=function(){var h=l.x,d=l.i,p,g;return p=h[d],p^=p>>>7,g=p^p<<24,p=h[d+1&7],g^=p^p>>>10,p=h[d+3&7],g^=p^p>>>3,p=h[d+4&7],g^=p^p<<7,p=h[d+7&7],p=p^p<<13,g^=p^p<<9,h[d]=g,l.i=d+1&7,g};function c(h,d){var p,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,p=0;p<d.length;++p)g[p&7]=g[p&7]<<15^d.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],h.x=g,h.i=0,p=256;p>0;--p)h.next()}c(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function s(o,l){o==null&&(o=+new Date);var c=new i(o),h=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,v=(p+g)/(1<<21);while(v===0);return v},d.int32=c.next,d.quick=d,h&&(h.x&&a(h,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=s:this.xorshift7=s})(ymt,e)}(Jg)),Jg.exports}var ty={exports:{}},bmt=ty.exports,hz;function xmt(){return hz||(hz=1,function(e){(function(t,n,r){function i(o){var l=this;l.next=function(){var h=l.w,d=l.X,p=l.i,g,v;return l.w=h=h+1640531527|0,v=d[p+34&127],g=d[p=p+1&127],v^=v<<13,g^=g<<17,v^=v>>>15,g^=g>>>12,v=d[p]=v^g,l.i=p,v+(h^h>>>16)|0};function c(h,d){var p,g,v,x,b,w=[],C=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,C=Math.max(C,d.length)),v=0,x=-32;x<C;++x)d&&(g^=d.charCodeAt((x+32)%d.length)),x===0&&(b=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(b=b+1640531527|0,p=w[x&127]^=g+b,v=p==0?v+1:0);for(v>=128&&(w[(d&&d.length||0)&127]=-1),v=127,x=4*128;x>0;--x)g=w[v+34&127],p=w[v=v+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,w[v]=g^p;h.w=b,h.X=w,h.i=v}c(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function s(o,l){o==null&&(o=+new Date);var c=new i(o),h=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,v=(p+g)/(1<<21);while(v===0);return v},d.int32=c.next,d.quick=d,h&&(h.X&&a(h,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=s:this.xor4096=s})(bmt,e)}(ty)),ty.exports}var ey={exports:{}},wmt=ey.exports,dz;function Smt(){return dz||(dz=1,function(e){(function(t,n,r){function i(o){var l=this,c="";l.next=function(){var d=l.b,p=l.c,g=l.d,v=l.a;return d=d<<25^d>>>7^p,p=p-g|0,g=g<<24^g>>>8^v,v=v-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^v,l.a=v-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var h=0;h<c.length+20;h++)l.b^=c.charCodeAt(h)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function s(o,l){var c=new i(o),h=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,v=(p+g)/(1<<21);while(v===0);return v},d.int32=c.next,d.quick=d,h&&(typeof h=="object"&&a(h,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=s:this.tychei=s})(wmt,e)}(ey)),ey.exports}var ny={exports:{}};const Cmt={},Tmt=Object.freeze(Object.defineProperty({__proto__:null,default:Cmt},Symbol.toStringTag,{value:"Module"})),$mt=jK(Tmt);var Amt=ny.exports,pz;function kmt(){return pz||(pz=1,function(e){(function(t,n,r){var i=256,a=6,s=52,o="random",l=r.pow(i,a),c=r.pow(2,s),h=c*2,d=i-1,p;function g($,A,E){var O=[];A=A==!0?{entropy:!0}:A||{};var N=w(b(A.entropy?[$,T(n)]:$??C(),3),O),_=new v(O),R=function(){for(var I=_.g(a),P=l,B=0;I<c;)I=(I+B)*i,P*=i,B=_.g(1);for(;I>=h;)I/=2,P/=2,B>>>=1;return(I+B)/P};return R.int32=function(){return _.g(4)|0},R.quick=function(){return _.g(4)/4294967296},R.double=R,w(T(_.S),n),(A.pass||E||function(I,P,B,V){return V&&(V.S&&x(V,_),I.state=function(){return x(_,{})}),B?(r[o]=I,P):I})(R,N,"global"in A?A.global:this==r,A.state)}function v($){var A,E=$.length,O=this,N=0,_=O.i=O.j=0,R=O.S=[];for(E||($=[E++]);N<i;)R[N]=N++;for(N=0;N<i;N++)R[N]=R[_=d&_+$[N%E]+(A=R[N])],R[_]=A;(O.g=function(I){for(var P,B=0,V=O.i,z=O.j,M=O.S;I--;)P=M[V=d&V+1],B=B*i+M[d&(M[V]=M[z=d&z+P])+(M[z]=P)];return O.i=V,O.j=z,B})(i)}function x($,A){return A.i=$.i,A.j=$.j,A.S=$.S.slice(),A}function b($,A){var E=[],O=typeof $,N;if(A&&O=="object")for(N in $)try{E.push(b($[N],A-1))}catch{}return E.length?E:O=="string"?$:$+"\0"}function w($,A){for(var E=$+"",O,N=0;N<E.length;)A[d&N]=d&(O^=A[d&N]*19)+E.charCodeAt(N++);return T(A)}function C(){try{var $;return p&&($=p.randomBytes)?$=$(i):($=new Uint8Array(i),(t.crypto||t.msCrypto).getRandomValues($)),T($)}catch{var A=t.navigator,E=A&&A.plugins;return[+new Date,t,E,t.screen,T(n)]}}function T($){return String.fromCharCode.apply(0,$)}if(w(r.random(),n),e.exports){e.exports=g;try{p=$mt}catch{}}else r["seed"+o]=g})(typeof self<"u"?self:Amt,[],Math)}(ny)),ny.exports}var a$,mz;function Emt(){if(mz)return a$;mz=1;var e=hmt(),t=pmt(),n=gmt(),r=vmt(),i=xmt(),a=Smt(),s=kmt();return s.alea=e,s.xor128=t,s.xorwow=n,s.xorshift7=r,s.xor4096=i,s.tychei=a,a$=s,a$}var DE=Emt();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rG{constructor(t,n,r,i,a){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const s=a||Math.random();this.random=DE.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,n,r=!1;for(;!r;){let i,a,s;do i=2*this.random()-1,a=2*this.random()-1,s=i*i+a*a;while(s>=1||s===0);const o=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*i*o,n=this.mean+this.stdDev*a*o,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Imt{constructor(t=0,n=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=DE.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Omt(e,t=0,n=1,r,i){if(As(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const a=new rG(t,n,r,!1,i),s=ne(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const Nmt=rt({randomNormal_:Omt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _mt(e,t=0,n=1,r="float32",i){As(e);const a=ne(e,r),s=new Imt(t,n,null,i);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const Gp=rt({randomUniform_:_mt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $d(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return tt.runKernel(sE,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rmt(e){const n={input:X(e,"input","real")};return tt.runKernel(oE,n)}const ov=rt({real_:Rmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dmt(e){const n={x:X(e,"x","reciprocal")};return tt.runKernel(Cp,n)}const Mmt=rt({reciprocal_:Dmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pmt(e){const n={x:X(e,"x","relu")};return tt.runKernel(Tp,n)}const Dr=rt({relu_:Pmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fmt(e){const n={x:X(e,"x","relu6")};return tt.runKernel($p,n)}const iG=rt({relu6_:Fmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lmt(e,t){const r={x:X(e,"x","reverse")},i={dims:t};return tt.runKernel(Zb,r,i)}const Nl=rt({reverse_:Lmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bmt(e){const n={x:X(e,"x","round")};return tt.runKernel(Ap,n)}const aG=rt({round_:Bmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zmt(e){const n={x:X(e,"x","rsqrt","float32")};return tt.runKernel(kp,n)}const sG=rt({rsqrt_:zmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jmt(e){const n={x:X(e,"x","selu")};return tt.runKernel(Ep,n)}const oG=rt({selu_:jmt});function Umt(e,t,n,r,i,a=[1,1],s="NHWC"){const o=X(e,"x","separableConv2d"),l=X(t,"depthwiseFilter","separableConv2d"),c=X(n,"pointwiseFilter","separableConv2d");let h=o,d=!1;if(o.rank===3&&(d=!0,h=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");j(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),j(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),j(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),j(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),j(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=l.shape[2],g=l.shape[3];j(c.shape[2]===p*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*g}, but got ${c.shape[2]}.`);const v=TE(h,l,r,i,s,a),b=Il(v,c,1,"valid",s);return d?nt(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const lG=rt({separableConv2d_:Umt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vmt(e){const n={x:X(e,"x","sign")};return tt.runKernel(Np,n)}const Wmt=rt({sign_:Vmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gmt(e){const n={x:X(e,"x","sin","float32")};return tt.runKernel(Ip,n)}const uG=rt({sin_:Gmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qmt(e){const n={x:X(e,"x","sinh")};return tt.runKernel(Op,n)}const cG=rt({sinh_:qmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hmt(e,t,n){const r=X(e,"x","slice1d");return j(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Ue(r,[t],[n])}const ME=rt({slice1d_:Hmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xmt(e,t,n){const r=X(e,"x","slice2d");return j(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Ue(r,t,n)}const fG=rt({slice2d_:Xmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kmt(e,t,n){const r=X(e,"x","slice3d");return j(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Ue(r,t,n)}const PE=rt({slice3d_:Kmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ymt(e,t,n){const r=X(e,"x","slice4d");return j(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Ue(r,t,n)}const lv=rt({slice4d_:Ymt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zmt(e,t=-1){const n=X(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},i={dim:t};return tt.runKernel(r0,r,i)}const FE=rt({softmax_:Zmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qmt(e){j(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return tt.runKernel(Kk,t)}const hG=rt({fft_:Qmt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jmt(e){j(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return tt.runKernel(Qk,t)}const eA=rt({ifft_:Jmt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tgt(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const i=nt(e,[n,t]);r=eA(i)}else{const i=[n,2*(t-1)],a=nt(ov(e),[n,t]),s=nt(AE(e),[n,t]),o=Nl(Ue(a,[0,1],[n,t-2]),1),l=J(Nl(Ue(s,[0,1],[n,t-2]),1),de(-1)),c=_r([a,o],1),h=_r([s,l],1),d=nt(Ic(c,h),[i[0],i[1]]);r=eA(d)}if(r=ov(r),e.rank===3&&e.shape[0]!==0){const i=r,a=e.shape[0];r=nt(r,[a,r.shape[0]/a,r.shape[1]]),i.dispose()}return r}const egt=rt({irfft_:tgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ngt(e,t,n=0){const i={x:X(e,"x","split")},a={numOrSizeSplits:t,axis:n};return tt.runKernel(n0,i,a)}const fi=rt({split_:ngt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rgt(e,t){j(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const r=e.size/n;let i;if(t!=null&&t<n){const v=e.shape.map(b=>0),x=e.shape.map(b=>b);x[e.shape.length-1]=t,i=Ue(e,v,x),n=t}else if(t!=null&&t>n){const v=e.shape.map(x=>x);v[e.shape.length-1]=t-n,i=_r([e,Bn(v)],e.shape.length-1),n=t}else i=e;const a=ge(i),s=nt(Ic(i,a),[r,n]),o=hG(s),l=Math.floor(n/2)+1,c=ov(o),h=AE(o),d=fi(c,[l,n-l],c.shape.length-1),p=fi(h,[l,n-l],h.shape.length-1),g=i.shape.slice();return g[i.shape.length-1]=l,nt(Ic(d[0],p[0]),g)}const igt=rt({rfft_:rgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function agt(e,t){let n=X(e,"a","squaredDifference"),r=X(t,"b","squaredDifference");[n,r]=cn(n,r),Jt(n.shape,r.shape);const i={a:n,b:r},a={};return tt.runKernel(Mp,i,a)}const sgt=rt({squaredDifference_:agt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ogt(e,t){const n=X(e,"x","squeeze","string_or_numeric");return nt(n,To(n.shape,t).newShape)}const qp=rt({squeeze_:ogt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lgt(e,t=0){const n=NW(e,"tensors","stack","string_or_numeric");j(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&j(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,i={axis:t};return tt.runKernel(Wb,r,i)}const xs=rt({stack_:lgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ugt(e,t=0){const r={x:X(e,"x","step")},i={alpha:t};return tt.runKernel(zp,r,i)}const Hp=rt({step_:ugt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cgt(e,t,n,r,i=0,a=0,s=0,o=0,l=0){const h={x:X(e,"x","stridedSlice","string_or_numeric")},d={begin:t,end:n,strides:r,beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return tt.runKernel(hE,h,d)}const fgt=rt({stridedSlice_:cgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hgt(e){const n={x:X(e,"x","tan","float32")};return tt.runKernel(Fp,n)}const dgt=rt({tan_:hgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tn(e,t){jV(e);const n=l0(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return u0(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nc(e,t,n){if(jV(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=l0(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return u0(e,t,r,n)}function dG(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(a+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(a+` update.rank != ${i+e.length-r}`);for(let s=0;s<i;++s)if(n.shape[s]!==t.shape[s])throw new Error(a+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${t.shape[s]}).`);for(let s=0;s<n.rank-i;++s)if(n.shape[s+i]!==e[s+r])throw new Error(a+` updates.shape[${s+i}] (${n.shape[s+i]}) != shape[${s+i}] (${e[s+i]})`)}function pgt(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}dG(n,t,e)}function Vl(e,t,n){const r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length;let s=1;for(let d=i;d<a;++d)s*=n[d];const o=i<1?1:i,l=pt(t.shape)/o,c=[...Bt(n.slice(0,i)),1],h=pt(n);return{sliceRank:i,numUpdates:l,sliceSize:s,strides:c,outputSize:h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mgt(e,t=1,n=!0){const r=X(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const a={x:r},s={k:t,sorted:n},[o,l]=tt.runKernel(dE,a,s);return{values:o,indices:l}}const ggt=rt({topk_:mgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ygt(e,t=0,n=1,r,i){if(As(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new rG(t,n,r,!0,i),s=ne(e,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const pG=rt({truncatedNormal_:ygt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vgt(e,t=0){const n=X(e,"x","unique","string_or_numeric");j(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},i={axis:t},[a,s]=tt.runKernel(mE,r,i);return{values:a,indices:s}}const bgt=rt({unique_:vgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xgt(e,t,n){const r=X(e,"x","unsortedSegmentSum"),i=X(t,"segmentIds","unsortedSegmentSum","int32");j(kc(n),()=>"numSegments must be of dtype int");const a={x:r,segmentIds:i},s={numSegments:n};return tt.runKernel(a0,a,s)}const mG=rt({unsortedSegmentSum_:xgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wgt(e,t=0){const n=X(e,"x","unstack","string_or_numeric");j(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},i={axis:t};return tt.runKernel(i0,r,i)}const _l=rt({unstack_:wgt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG(e,t=!0,n,r){return tt.makeVariable(e,t,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(e,t){const n=[];for(let a=0;a<t.length;a++)t[a]&&n.push(a);const r=ne(e,"int32"),i=ne([n.length,e.length],"int32");for(let a=0;a<n.length;a++){const s=r.indexToLoc(n[a]),o=a*e.length;i.values.set(s,o)}return i.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sgt(e,t,n){const r=X(e,"x","transpose");if(t==null&&(t=r.shape.map((s,o)=>o).reverse()),j(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(s=>{j(s>=0&&s<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();const i={x:r},a={perm:t};return r.dtype==="complex64"?st(()=>{let s=ov(r),o=AE(r);return s=tt.runKernel(tc,{x:s},a),o=tt.runKernel(tc,{x:o},a),n&&(o=Ye(o)),Ic(s,o)}):tt.runKernel(tc,i,a)}const me=rt({transpose_:Sgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cgt(e,t){if(t==null)return e.shape.slice();if(we(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tgt(e,t,n,r){const i=X(e,"x","dropout");if(j(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),j(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof Cn?i.clone():i;const a=Cgt(i,n),s=1-t,o=jt(p0(Ct(Gp(a,0,1,"float32",r),s)),s);return J(i,o)}const $gt=rt({dropout_:Tgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Agt(e,t,n,r,i,a="NHWC",s){let o=e;e.rank===3&&(o=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=nt(t,[1,t.shape[0],t.shape[1],t.shape[2]])),j(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),j(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),j(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=a==="NHWC"?o.shape[3]:o.shape[1],h=a==="NHWC"?l.shape[3]:l.shape[1];j(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),j(h===n[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${n[3]}).`),Pr("conv2dDerFilter",i,s);const d={x:o,dy:l},p={strides:r,pad:i,dataFormat:a,dimRoundingMode:s,filterShape:n};return tt.runKernel(Lk,d,p)}const LE=rt({conv2DBackpropFilter_:Agt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BE(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return J(e,Hp(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function zE(e,t){let n=t;const r=On(e.shape,t.shape);return r.length>0&&(n=Rt(n,r)),nt(n,e.shape)}function jE(e,t,n,r){if(t==="linear")return e;if(t==="relu")return Dr(e);if(t==="elu")return h0(e);if(t==="relu6")return iG(e);if(t==="prelu")return RE(e,n);if(t==="leakyrelu")return kE(e,r);if(t==="sigmoid")return Yc(e);throw new Error(`Unknown fused activation ${t}.`)}const UE=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kgt({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(l=l||"linear",UE(tt.state.gradientDepth,l)===!1){j(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let E=Il(e,t,n,r,i,a,s);return o!=null&&(E=Ct(E,o)),jE(E,l,c,h)}const d=X(e,"x","conv2d","float32"),p=X(t,"filter","conv2d","float32");let g=d,v=!1;d.rank===3&&(v=!0,g=nt(d,[1,d.shape[0],d.shape[1],d.shape[2]])),j(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),j(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Pr("fused conv2d",r,s);const x=i==="NHWC"?g.shape[3]:g.shape[1];j(p.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${p.shape[2]}.`),j(cr(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const b=Qn(g.shape,p.shape,n,a,r,s);let w;o!=null&&(w=X(o,"bias","fused conv2d"),[w]=cn(w,d),i==="NHWC"?Jt(b.outShape,w.shape):(j(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),j(w.shape.length===0||w.shape[0]===b.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${b.outChannels})`)));let C;if(c!=null){const E=c.shape;if(j(E.length<=1||E.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${E.length}.`),E.length===1)j(E[0]===1||E[0]===b.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the number of output channels (${b.outChannels}).`);else if(E.length===3)try{Jt(E,b.outShape)}catch{const N=`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the output shape of the conv2d (${b.outShape}).`;throw Error(N)}C=X(c,"prelu weights","fused conv2d")}const T=(E,O)=>{j(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[N,_,R,I]=O,P=BE(E,R,l);j(kl(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const B=SE(_.shape,P,N,n,r),V=LE(_,P,N.shape,n,r),z=[B,V];if(I!=null){const M=zE(I,P);z.push(M)}return z},$={x:g,filter:p,bias:w,preluActivationWeights:C},A={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s,activation:l,leakyreluAlpha:h};return o==null?Nc((O,N,_)=>{let R=tt.runKernel(nv,$,A);return _([N,O,R]),v&&(R=nt(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:T}})(g,p):Nc((O,N,_,R)=>{let I=tt.runKernel(nv,$,A);return R([N,O,I,_]),v&&(I=nt(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:T}})(g,p,w)}const Egt=rt({fusedConv2d_:kgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Igt(e,t,n,r,i,a=[1,1],s){let o=e;e.rank===3&&(o=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;l.rank===3&&(l=nt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:o,dy:l},h={strides:r,pad:i,dimRoundingMode:s,dilations:a,filterShape:n};return tt.runKernel(Gk,c,h)}const Ogt=rt({depthwiseConv2dNativeBackpropFilter_:Igt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ngt(e,t,n,r,i,a=[1,1],s){let o=t,l=!1;t.rank===3&&(l=!0,o=nt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:o,filter:n},h={strides:r,pad:i,dimRoundingMode:s,dilations:a,inputShape:e},d=tt.runKernel(qk,c,h);return l?nt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const _gt=rt({depthwiseConv2dNativeBackpropInput_:Ngt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rgt({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:a="linear",preluActivationWeights:s,leakyreluAlpha:o=.2}){if(UE(tt.state.gradientDepth,a)===!1){let I=xe(e,t,n,r);return i!=null&&(I=Ct(I,i)),jE(I,a,s,o)}let l=X(e,"a","fused matMul"),c=X(t,"b","fused matMul");[l,c]=cn(l,c);const h=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],g=r?c.shape[c.rank-2]:c.shape[c.rank-1],v=l.shape.slice(0,-2),x=c.shape.slice(0,-2),b=pt(v),w=pt(x);j(h===d,()=>`Error in fused matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);const T=Jt(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,g]),$=n?nt(l,[b,h,p]):nt(l,[b,p,h]),A=r?nt(c,[w,g,d]):nt(c,[w,d,g]);let E;i!=null&&(E=X(i,"bias","fused matMul"),[E]=cn(E,l),Jt(T,E.shape));let O;s!=null&&(O=X(s,"prelu weights","fused matMul"));const N=(I,P)=>{const[B,V,z,M]=P,U=BE(nt(I,z.shape),z,a);let W,q;if(!n&&!r?(W=xe(U,V,!1,!0),q=xe(B,U,!0,!1)):!n&&r?(W=xe(U,V,!1,!1),q=xe(U,B,!0,!1)):n&&!r?(W=xe(V,U,!1,!0),q=xe(B,U,!1,!1)):(W=xe(V,U,!0,!0),q=xe(U,B,!0,!0)),i!=null){const F=zE(M,U);return[W,q,F]}else return[W,q]},_={a:$,b:A,bias:E,preluActivationWeights:O},R={transposeA:n,transposeB:r,activation:a,leakyreluAlpha:o};return i==null?Nc((P,B,V)=>{const z=tt.runKernel(ev,_,R);return V([P,B,z]),{value:nt(z,T),gradFunc:N}})($,A):Nc((P,B,V,z)=>{const M=tt.runKernel(ev,_,R);return z([P,B,M,V]),{value:nt(M,T),gradFunc:N}})($,A,E)}const gz=rt({fusedMatMul_:Rgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dgt(e,t,n,r,i="bilinear",a=0){const s=X(e,"image","cropAndResize"),o=X(t,"boxes","cropAndResize","float32"),l=X(n,"boxInd","cropAndResize","int32"),c=o.shape[0];j(s.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`),j(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),j(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),j(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),j(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),j(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const h={image:s,boxes:o,boxInd:l},d={method:i,extrapolationValue:a,cropSize:r};return tt.runKernel(Uk,h,d)}const Mgt=rt({cropAndResize_:Dgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pgt(e){const t=X(e,"image","flipLeftRight","float32");j(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return tt.runKernel(Zk,n,{})}const Fgt=rt({flipLeftRight_:Pgt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lgt(e){const t=X(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];j(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),j(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,ia(t,i)}const Bgt=rt({grayscaleToRGB_:Lgt});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zgt(e){const t=X(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];j(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),j(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const i=t.dtype,a=_t(t,"float32"),s=Tn([.2989,.587,.114]);let o;switch(t.rank){case 2:o=xh("ij,j->i",a,s);break;case 3:o=xh("ijk,k->ij",a,s);break;case 4:o=xh("ijkl,l->ijk",a,s);break;case 5:o=xh("ijklm,m->ijkl",a,s);break;case 6:o=xh("ijklmn,n->ijklm",a,s);break;default:throw new Error("Not a valid tensor rank.")}return o=Ir(o,-1),_t(o,i)}const jgt=rt({rgbToGrayscale_:zgt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ugt(e,t,n=0,r=.5){const i=X(e,"image","rotateWithOffset","float32");j(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const a={image:i},s={radians:t,fillValue:n,center:r};return tt.runKernel(gE,a,s)}const Vgt=rt({rotateWithOffset_:Ugt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qc(e,t,n,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);const s=e.shape[0];return n=Math.min(n,s),j(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),j(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),j(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),j(t.rank===1,()=>"scores must be a 1D tensor"),j(t.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${t.shape[0]}`),j(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wgt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=X(e,"boxes","nonMaxSuppression","float32"),s=X(t,"scores","nonMaxSuppression","float32"),o=Qc(a,s,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return tt.runKernel(rE,{boxes:a,scores:s},l)}const Ggt=rt({nonMaxSuppression_:Wgt});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qgt(e,t,n){const r=Hgt(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function Hgt(e,t,n){return Kgt(e,t,n||Xgt)}function Xgt(e,t){return e>t?1:e<t?-1:0}function Kgt(e,t,n){let r=0,i=e.length,a=0,s=!1;for(;r<i;){a=r+(i-r>>>1);const o=n(t,e[a]);o>0?r=a+1:(i=a,s=!o)}return s?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VE(e,t,n,r,i){return qE(e,t,n,r,i,0)}function WE(e,t,n,r,i,a){return qE(e,t,n,r,i,0,!1,a,!0)}function GE(e,t,n,r,i,a){return qE(e,t,n,r,i,a,!0)}function qE(e,t,n,r,i,a,s=!1,o=!1,l=!1){const c=[];for(let b=0;b<t.length;b++)t[b]>i&&c.push({score:t[b],boxIndex:b,suppressBeginIndex:0});c.sort(yz);const h=a>0?-.5/a:0,d=[],p=[];for(;d.length<n&&c.length>0;){const b=c.pop(),{score:w,boxIndex:C,suppressBeginIndex:T}=b;if(w<i)break;let $=!1;for(let A=d.length-1;A>=T;--A){const E=Ygt(e,C,d[A]);if(E>=r){$=!0;break}if(b.score=b.score*Zgt(r,h,E),b.score<=i)break}b.suppressBeginIndex=d.length,$||(b.score===w?(d.push(C),p.push(b.score)):b.score>i&&qgt(c,b,yz))}const g=d.length,v=n-g;o&&v>0&&(d.push(...new Array(v).fill(0)),p.push(...new Array(v).fill(0)));const x={selectedIndices:d};return s&&(x.selectedScores=p),l&&(x.validOutputs=g),x}function Ygt(e,t,n){const r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),a=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),g=(o-a)*(l-s),v=(d-c)*(p-h);if(g<=0||v<=0)return 0;const x=Math.max(a,c),b=Math.max(s,h),w=Math.min(o,d),C=Math.min(l,p),T=Math.max(w-x,0)*Math.max(C-b,0);return T/(g+v-T)}function Zgt(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function yz(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Qgt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=X(e,"boxes","nonMaxSuppressionAsync"),s=X(t,"scores","nonMaxSuppressionAsync"),o=Qc(a,s,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l=await Promise.all([a.data(),s.data()]),c=l[0],h=l[1],{selectedIndices:d}=VE(c,h,n,r,i);return a!==e&&a.dispose(),s!==t&&s.dispose(),Tn(d,"int32")}const Jgt=Qgt;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tyt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=X(e,"boxes","nonMaxSuppression"),o=X(t,"scores","nonMaxSuppression"),l=Qc(s,o,n,r,i,a);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const c={boxes:s,scores:o},h={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a},d=tt.runKernel(aE,c,h);return{selectedIndices:d[0],selectedScores:d[1]}}const eyt=rt({nonMaxSuppressionWithScore_:tyt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nyt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=X(e,"boxes","nonMaxSuppressionAsync"),o=X(t,"scores","nonMaxSuppressionAsync"),l=Qc(s,o,n,r,i,a);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const c=await Promise.all([s.data(),o.data()]),h=c[0],d=c[1],{selectedIndices:p,selectedScores:g}=GE(h,d,n,r,i,a);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:Tn(p,"int32"),selectedScores:Tn(g)}}const ryt=nyt;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iyt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const s=X(e,"boxes","nonMaxSuppression"),o=X(t,"scores","nonMaxSuppression"),l=Qc(s,o,n,r,i,null),c=l.maxOutputSize,h=l.iouThreshold,d=l.scoreThreshold,p={boxes:s,scores:o},g={maxOutputSize:c,iouThreshold:h,scoreThreshold:d,padToMaxOutputSize:a},v=tt.runKernel(iE,p,g);return{selectedIndices:v[0],validOutputs:v[1]}}const ayt=rt({nonMaxSuppressionPadded_:iyt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function syt(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const s=X(e,"boxes","nonMaxSuppressionAsync"),o=X(t,"scores","nonMaxSuppressionAsync"),l=Qc(s,o,n,r,i,null),c=l.maxOutputSize,h=l.iouThreshold,d=l.scoreThreshold,[p,g]=await Promise.all([s.data(),o.data()]),{selectedIndices:v,validOutputs:x}=WE(p,g,c,h,d,a);return s!==e&&s.dispose(),o!==t&&o.dispose(),{selectedIndices:Tn(v,"int32"),validOutputs:de(x,"int32")}}const oyt=syt;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lyt(e,t,n=!1,r=!1){const i=X(e,"images","resizeBilinear");j(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),j(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),j(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=i,s=!1;i.rank===3&&(s=!0,a=nt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:a},l={alignCorners:n,halfPixelCenters:r,size:t},c=tt.runKernel(Yb,o,l);return s?nt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const vG=rt({resizeBilinear_:lyt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uyt(e,t,n=!1,r=!1){const i=X(e,"images","resizeNearestNeighbor");j(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),j(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),j(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),j(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=i,s=!1;i.rank===3&&(s=!0,a=nt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:a},l={alignCorners:n,halfPixelCenters:r,size:t},c=tt.runKernel(Kb,o,l);return s?nt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const bG=rt({resizeNearestNeighbor_:uyt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cyt(e,t="binary",n=!1,r=.5){const i=X(e,"image","threshold"),a=.2989,s=.587,o=.114,l=i.shape[0]*i.shape[1];let c=J(Tn([r]),255),h,d,p,g;if(j(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),j(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),j(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),j(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[h,d,p]=fi(i,[1,1,1],-1);const b=J(h,a),w=J(d,s),C=J(p,o);g=Ct(Ct(b,w),C)}else g=e;if(t==="otsu"){const b=udt(_t(aG(g),"int32"),_W([]),256);c=fyt(b,l)}const v=n?Zc(g,c):pi(g,c);return _t(J(v,255),"int32")}function fyt(e,t){let n=Tn([-1]),r=Tn([0]),i=Tn([0]),a,s,o,l,c,h;for(let d=0;d<e.size-1;d++){a=Ue(e,0,d+1),s=Ue(e,d+1),c=jt(Rt(a),t),h=jt(Rt(s),t);const p=Rt(J(a,$d(0,a.size)));o=jt(p,Rt(a));const g=Up(s.shape,a.size),v=Ct($d(0,s.size),g),x=J(s,v);l=jt(Rt(x),Rt(s));const b=Vt(o,l),w=Vt(o,l),C=J(c,h);i=J(J(C,b),w);const T=pi(i,r);r=Cr(T,i,r),n=Cr(T,Tn([d]),n)}return n}const hyt=rt({threshold_:cyt});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dyt(e,t,n="nearest",r="constant",i=0,a){const s=X(e,"image","transform","float32"),o=X(t,"transforms","transform","float32");j(s.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`),j(o.rank===2&&(o.shape[0]===s.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),j(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const l={image:s,transforms:o},c={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return tt.runKernel(pE,l,c)}const pyt=rt({transform_:dyt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function myt(e,t,n){const r=X(e,"a","bandPart");j(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[a,s]=r.shape.slice(-2);let o,l;typeof t=="number"?(j(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),j(t<=a,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`),o=X(t<0?a:t,"numLower","bandPart")):(j(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Cr(av(t,0),a,Td(t,a))),typeof n=="number"?(j(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),j(n<=s,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`),l=X(n<0?s:n,"numUpper","bandPart")):(j(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Cr(av(n,0),s,Td(n,s)));const c=nt($d(0,a,1,"int32"),[-1,1]),h=$d(0,s,1,"int32"),d=Vt(c,h),p=bs(Zc(d,o),Ul(d,Ye(l))),g=Bn([a,s],r.dtype);return nt(xs(_l(nt(r,[-1,a,s])).map(v=>Cr(p,v,g))),i)}const gyt=rt({bandPart_:myt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yyt(e){let t;if(Array.isArray(e)){t=!1,j(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=e[0].shape[0];for(let a=1;a<e.length;++a)j(e[a].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[a].shape[0]} vs. ${i})`)}else t=!0,e=fi(e,e.shape[0],0).map(i=>qp(i,[0]));j(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],r=e;for(let i=0;i<e.length;++i)n.push(tt.tidy(()=>{let a=r[i];if(i>0)for(let s=0;s<i;++s){const o=J(Rt(J(n[s],a)),n[s]);a=Vt(a,o)}return jt(a,d0(a,"euclidean"))}));return t?xs(n,0):n}const vyt=rt({gramSchmidt_:yyt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function byt(e,t=!1){if(j(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return vz(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((l,c)=>l*c),r=_l(nt(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];r.forEach(l=>{const[c,h]=vz(l,t);i.push(c),a.push(h)});const s=nt(xs(i,0),e.shape),o=nt(xs(a,0),e.shape);return[s,o]}}function vz(e,t=!1){return tt.tidy(()=>{j(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],r=e.shape[1];let i=ZW(n),a=ml(e);const s=nc([[1]],[1,1]);let o=ml(s);const l=n>=r?r:n;for(let c=0;c<l;++c){const h=a,d=o,p=i;[o,a,i]=tt.tidy(()=>{const g=Ue(a,[c,c],[n-c,1]),v=d0(g),x=Ue(a,[c,c],[1,1]),b=Cr(pi(x,0),nc([[-1]]),nc([[1]])),w=Vt(x,J(b,v)),C=jt(g,w);C.shape[0]===1?o=ml(s):o=_r([s,Ue(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const T=Ye(jt(xe(b,w),v)),$=Ue(a,[c,0],[n-c,r]),A=J(T,o),E=me(o);if(c===0)a=Vt($,xe(A,xe(E,$)));else{const _=Vt($,xe(A,xe(E,$)));a=_r([Ue(a,[0,0],[c,r]),_],0)}const O=me(A),N=Ue(i,[0,c],[n,i.shape[1]-c]);if(c===0)i=Vt(N,xe(xe(N,o),O));else{const _=Vt(N,xe(xe(N,o),O));i=_r([Ue(i,[0,0],[n,c]),_],1)}return[o,a,i]}),oe([h,d,p])}return!t&&n>r&&(i=Ue(i,[0,0],[n,r]),a=Ue(a,[0,0],[r,r])),[i,a]})}const xyt=rt({qr_:byt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const us={flipLeftRight:Fgt,grayscaleToRGB:Bgt,resizeNearestNeighbor:bG,resizeBilinear:vG,rgbToGrayscale:jgt,rotateWithOffset:Vgt,cropAndResize:Mgt,nonMaxSuppression:Ggt,nonMaxSuppressionAsync:Jgt,nonMaxSuppressionWithScore:eyt,nonMaxSuppressionWithScoreAsync:ryt,nonMaxSuppressionPadded:ayt,nonMaxSuppressionPaddedAsync:oyt,threshold:hyt,transform:pyt},wyt={bandPart:gyt,gramSchmidt:vyt,qr:xyt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Syt=new Map,Cyt=new Map;class Jc{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Oi{constructor(){this.classNameMap={}}static getMap(){return Oi.instance==null&&(Oi.instance=new Oi),Oi.instance}static register(t){Oi.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function St(e,t,n){j(e.className!=null,()=>"Class being registered does not have the static className property defined."),j(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),j(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const r=n,i=t+">"+r;return Oi.register(e),Syt.set(i,e),Cyt.set(e,i),e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oo extends Jc{minimize(t,n=!1,r){const{value:i,grads:a}=this.computeGradients(t,r);if(r!=null){const s=r.map(o=>({name:o.name,tensor:a[o.name]}));this.applyGradients(s)}else this.applyGradients(a);return oe(a),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return Ipt(t,n)}dispose(){this.iterations_!=null&&oe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:de(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Oo,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xG extends Oo{static get className(){return"Adadelta"}constructor(t,n,r=null){super(),this.learningRate=t,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=tt.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const a=tt.registeredVariables[r],s=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:st(()=>ge(a).variable(s))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:st(()=>ge(a).variable(s))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const l=this.accumulatedGrads[i].variable,c=this.accumulatedUpdates[i].variable;st(()=>{const h=Ct(J(l,this.rho),J(_e(o),1-this.rho)),d=J(jt(Nn(Ct(c,this.epsilon)),Nn(Ct(l,this.epsilon))),o),p=Ct(J(c,this.rho),J(_e(d),1-this.rho));l.assign(h),c.assign(p);const g=Ct(J(d,-this.learningRate),a);a.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(oe(this.accumulatedGrads.map(t=>t.variable)),oe(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,r=!1;this.accumulatedGrads=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wG extends Oo{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const a=tt.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:st(()=>Up(a.shape,this.initialAccumulatorValue).variable(!1))});const s=Array.isArray(t)?t[i].tensor:t[r];if(s==null)return;const o=this.accumulatedGrads[i].variable;st(()=>{const l=Ct(o,_e(s));o.assign(l);const c=Ct(J(jt(s,Nn(Ct(l,tt.backend.epsilon()))),-this.learningRate),a);a.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&oe(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SG extends Oo{static get className(){return"Adam"}constructor(t,n,r,i=null){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],st(()=>{this.accBeta1=de(n).variable(),this.accBeta2=de(r).variable()}),i==null&&(this.epsilon=tt.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);st(()=>{const r=Vt(1,this.accBeta1),i=Vt(1,this.accBeta2);n.forEach((a,s)=>{const o=tt.registeredVariables[a],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:st(()=>ge(o).variable(l))}),this.accumulatedSecondMoment[s]==null&&(this.accumulatedSecondMoment[s]={originalName:`${a}/v`,variable:st(()=>ge(o).variable(l))});const c=Array.isArray(t)?t[s].tensor:t[a];if(c==null)return;const h=this.accumulatedFirstMoment[s].variable,d=this.accumulatedSecondMoment[s].variable,p=Ct(J(h,this.beta1),J(c,1-this.beta1)),g=Ct(J(d,this.beta2),J(_e(c),1-this.beta2)),v=jt(p,r),x=jt(g,i);h.assign(p),d.assign(g);const b=Ct(J(jt(v,Ct(Nn(x),this.epsilon)),-this.learningRate),o);o.assign(b)}),this.accBeta1.assign(J(this.accBeta1,this.beta1)),this.accBeta2.assign(J(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&oe(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&oe(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),st(()=>{this.accBeta1.assign(Ol(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ol(this.beta2,this.iterations_+1))});const n=t.length/2,r=!1;this.accumulatedFirstMoment=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CG extends Oo{static get className(){return"Adamax"}constructor(t,n,r,i=null,a=0){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],st(()=>{this.iteration=de(0).variable(),this.accBeta1=de(n).variable()}),i==null&&(this.epsilon=tt.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);st(()=>{const r=Vt(1,this.accBeta1),i=jt(-this.learningRate,Ct(J(this.iteration,this.decay),1));n.forEach((a,s)=>{const o=tt.registeredVariables[a],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:ge(o).variable(l)}),this.accumulatedWeightedInfNorm[s]==null&&(this.accumulatedWeightedInfNorm[s]={originalName:`${a}/v`,variable:ge(o).variable(l)});const c=Array.isArray(t)?t[s].tensor:t[a];if(c==null)return;const h=this.accumulatedFirstMoment[s].variable,d=this.accumulatedWeightedInfNorm[s].variable,p=Ct(J(h,this.beta1),J(c,1-this.beta1)),g=J(d,this.beta2),v=sr(c),x=Eo(g,v);h.assign(p),d.assign(x);const b=Ct(J(jt(i,r),jt(p,Ct(x,this.epsilon))),o);o.assign(b)}),this.iteration.assign(Ct(this.iteration,1)),this.accBeta1.assign(J(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&oe(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&oe(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HE extends Oo{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;const s=tt.registeredVariables[r];st(()=>{const o=Ct(J(this.c,a),s);s.assign(o)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=Ea(de(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TG extends HE{static get className(){return"Momentum"}constructor(t,n,r=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=de(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const a=tt.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:st(()=>ge(a).variable(!1))});const s=this.accumulations[i].variable,o=Array.isArray(t)?t[i].tensor:t[r];o!=null&&st(()=>{let l;const c=Ct(J(this.m,s),o);this.useNesterov?l=Ct(J(this.c,Ct(o,J(c,this.m))),a):l=Ct(J(this.c,c),a),s.assign(c),a.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&oe(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $G extends Oo{static get className(){return"RMSProp"}constructor(t,n=.9,r=0,i=null,a=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,i==null&&(this.epsilon=tt.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const a=tt.registeredVariables[r],s=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:st(()=>ge(a).variable(s))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:st(()=>ge(a).variable(s))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:st(()=>ge(a).variable(s))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const l=this.accumulatedMeanSquares[i].variable,c=this.accumulatedMoments[i].variable;st(()=>{const h=Ct(J(l,this.decay),J(_e(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[i].variable,p=Ct(J(d,this.decay),J(o,1-this.decay)),g=jt(J(o,this.learningRate),Nn(Vt(h,Ct(_e(p),this.epsilon)))),v=Ct(J(c,this.momentum),g);l.assign(h),d.assign(p),c.assign(v);const x=Vt(a,v);a.assign(x)}else{const d=Ct(J(l,this.decay),J(_e(o),1-this.decay)),p=Ct(J(c,this.momentum),jt(J(o,this.learningRate),Nn(Ct(d,this.epsilon))));l.assign(d),c.assign(p);const g=Vt(a,p);a.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&oe(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&oe(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&oe(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,r=!1;this.accumulatedMeanSquares=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tyt=[xG,wG,SG,CG,TG,$G,HE];function $yt(){for(const e of Tyt)St(e)}function XE(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(pt(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,a=i[i.length-1];let s=1;for(let d=0;d<i.length-1;++d)s*=i[d];const o=e.shape,l=i.slice();l.pop();let c=1;for(let d=a;d<n;++d)c*=o[d],l.push(o[d]);const h=[...Bt(e.shape).map(d=>d/c),1].slice(0,a);return[l,s,c,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nA=-2,Ayt=-1;function KE(e,t,n){const r=e.shape.length;j(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),j(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)j(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function kyt(e){const t=[];let n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function YE(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function AG(e,t,n,r){const i=[...e];for(let a=i.length;a<r.length;a++)i.push(1);for(let a=0;a<n;a++)a===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function kG(e,t,n){return n<=e?n:n-(t-1)}function EG(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function Eyt(e,t,n,r,i,a,s,o,l){const c=e.length;let h=new Array(c),d=new Array(c),p=new Array(c);if(t.length&&n>0){const g=t[0],v=n+1;h=IG(s,g,v,r,e),d=OG(o,g,v,i,e),p=AG(a,g,v,e)}else for(let g=0;g<c;g++)h[g]=_G(s,r,a,e,g,l),d[g]=RG(o,i,a,e,g,l),p[g]=NG(a,g,l);return{begin:h,end:d,strides:p}}function IG(e,t,n,r,i){const a=[...i],s=EG(n,t);for(let o=0;o<a.length;o++)if(s.indexOf(o)>-1)a[o]=0;else{const l=kG(t,n,o);let c=r[l];e&1<<l&&(c=0),a[o]=c}return a}function OG(e,t,n,r,i){const a=[...i],s=EG(n,t);for(let o=0;o<a.length;o++)if(s.indexOf(o)>-1)a[o]=Number.MAX_SAFE_INTEGER;else{const l=kG(t,n,o);let c=r[l];e&1<<l&&(c=Number.MAX_SAFE_INTEGER),a[o]=c}for(let o=0;o<a.length;o++){const l=i[o];a[o]<0&&(a[o]+=l),a[o]=Cl(0,a[o],i[o])}return a}function NG(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function _G(e,t,n,r,i,a){let s=t[i];const o=n[i]||1;(e&1<<i||a&1<<i||s==null)&&(o>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);const l=r[i];return s<0&&(s+=l),s=Cl(0,s,l-1),s}function RG(e,t,n,r,i,a){let s=t[i];const o=n[i]||1;(e&1<<i||a&1<<i||s==null)&&(o>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);const l=r[i];return s<0&&(s+=l),o>0?s=Cl(0,s,l):s=Cl(-1,s,l-1),s}function ZE(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function QE(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function m0(e,t,n){let r;const i=e.shape.length;typeof t=="number"?r=[t,...new Array(i-1).fill(0)]:t.length<i?r=t.concat(new Array(i-t.length).fill(0)):r=t.slice(),r.forEach(s=>{j(s!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(i).fill(-1):typeof n=="number"?a=[n,...new Array(i-1).fill(-1)]:n.length<i?a=n.concat(new Array(i-n.length).fill(-1)):a=n,a=a.map((s,o)=>s>=0?s:(j(s===-1,()=>`Negative size values should be exactly -1 but got ${s} for the slice() size at index ${o}.`),e.shape[o]-r[o])),[r,a]}function JE(e,t,n,r,i,a,s,o,l){let c;if(r==null?(c=new Array(t.length),c.fill(1)):c=r,s!=null&&(s&s-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let T=0;T<d.dims;T++)h&&(1<<T&o)!==0&&d.numAddAxisAfterEllipsis++,1<<T&s&&(h=!0);h||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Iyt(d,p);let g=!0,v=!0,x=!0;const b=[],w=[];for(let T=0;T<e.length;++T){if(p.strides[T]===0)throw Error(`strides[${T}] must be non-zero`);const $=!!(p.shrinkAxisMask&1<<T),A=e[T];if(A===-1){b.push($?1:-1);continue}const E=[p.beginMask&1<<T,p.endMask&1<<T],O=[p.strides[T]>0?0:-1,p.strides[T]>0?A:A-1];if($&&p.strides[T]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&p.strides[T]===1;const N=!!(p.beginMask&1<<T&&p.endMask&1<<T);if(p.beginValid&&p.endValid){if($){const P=p.begin[T]<0?A+p.begin[T]:p.begin[T];if(p.begin[T]=P,p.end[T]=p.begin[T]+1,P<0||P>=A)throw Error(`slice index ${p.begin[T]} of dimension ${T} out of bounds.`)}else p.begin[T]=bz(p.begin[T],0,p.strides[T],A,E,O),p.end[T]=bz(p.end[T],1,p.strides[T],A,E,O);const I=p.strides[T]===1&&p.begin[T]===0&&p.end[T]===A;g=g&&I,v=v&&(T===0&&p.strides[T]===1||I)}else g=g&&p.strides[T]===1&&N,v=v&&(T===0&&p.strides[T]===1||N);let _,R=!1;if(p.beginValid&&p.endValid?(_=p.end[T]-p.begin[T],R=!0):$?(_=1,R=!0):N&&A>=0&&(p.strides[T]<0?_=-A:_=A,R=!0),R){let I;_===0||_<0!=p.strides[T]<0?I=0:I=Math.trunc(_/p.strides[T])+(_%p.strides[T]!==0?1:0),b.push(I)}else b.push(-1)}for(let T=0;T<p.finalShapeGatherIndices.length;++T){const $=p.finalShapeGatherIndices[T];$>=0?w.push(b[$]):$===nA&&w.push(1)}return{finalShapeSparse:w.filter((T,$)=>p.finalShapeGatherIndices[$]!==nA),finalShape:w,isIdentity:g,sliceDim0:v,isSimpleSlice:x,begin:p.begin,end:p.end,strides:p.strides}}function Iyt(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(nA),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(Ayt),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function bz(e,t,n,r,i,a){if(i[t])return n>0?a[t]:a[t+1&1];{const s=e<0?r+e:e;return s<a[0]?a[0]:s>a[1]?a[1]:s}}const Oyt=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:KE,computeFlatOffset:QE,computeOutShape:YE,getNormalizedAxes:Eyt,isSliceContinous:ZE,maskToAxes:kyt,parseSliceParams:m0,sliceInfo:JE,startForAxis:_G,startIndicesWithElidedDims:IG,stopForAxis:RG,stopIndicesWithElidedDims:OG,stridesForAxis:NG,stridesWithElidedDims:AG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nyt{static sgd(t){return new HE(t)}static momentum(t,n,r=!1){return new TG(t,n,r)}static rmsprop(t,n=.9,r=0,i=null,a=!1){return new $G(t,n,r,i,a)}static adam(t=.001,n=.9,r=.999,i=null){return new SG(t,n,r,i)}static adadelta(t=.001,n=.95,r=null){return new xG(t,n,r)}static adamax(t=.002,n=.9,r=.999,i=null,a=0){return new CG(t,n,r,i,a)}static adagrad(t,n=.1){return new wG(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rl=Nyt;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _yt=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function DG(){return new Promise(e=>_yt(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tI(e,t){const n=e[0].length;e.forEach((i,a)=>{j(i.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),j(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=e[0];e.forEach((i,a)=>{for(let s=0;s<n;s++)j(s===t||i[s]===r[s],()=>`Error in concat${n}D: Shape of tensors[${a}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`)})}function Ia(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ea;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(ea||(ea={}));function MG(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const a=n[i],s=r[r.length-n.length+i],o=r[s];if(a>=0)if(o>=0){if(o!==a)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${a} but shape[${i+e}] = ${o}`)}else r[s]=a}return r}function PG(e){const t={FIRST_DIM_SIZE:ea.FIRST_DIM_SIZE,VALUE_ROWIDS:ea.VALUE_ROWIDS,ROW_LENGTHS:ea.ROW_LENGTHS,ROW_SPLITS:ea.ROW_SPLITS,ROW_LIMITS:ea.ROW_LIMITS,ROW_STARTS:ea.ROW_STARTS},n=[];for(const r of e)if(r in t)n.push(t[r]);else break;return n}function FG(e){return e.length===0?0:e[0]===ea.FIRST_DIM_SIZE?e.length-1:e.length}function LG(e,t){if(e==null||t==null)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const a=e[i],s=t[i+1];if(a>=0&&s>=0&&a!==1&&a!==s)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${a} but ragged tensor input.flatValues.shape[${i-e.length}] = ${s}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eI=30;function g0(e){return e<=eI?e:z2(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nI(e,t,n){const r=n*(typeof e=="number"?e:e[0]),i=t*(typeof e=="number"?e:e[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);const a=t.length;for(let s=0;s<a;++s)i=i.concat([e[s+1]/t[s],t[s]]);i=i.concat(e.slice(a+1))}return i}function Kp(e,t,n=!0){const r=[];if(n){r.push(t);for(let i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{const i=[],a=[];for(let s=1;s<e;++s)s>=t*2+1||s%2===1?a.push(s):i.push(s);r.push(...i),r.push(0),r.push(...a)}return r}function Yp(e,t,n,r=!0){const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function rI(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function iI(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y0=1.7580993408473768,v0=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aI=.3275911,sI=.254829592,oI=-.284496736,lI=1.421413741,uI=-1.453152027,cI=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function BG(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function zG(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function jG(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function fI(e,t){const n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function UG(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function VG(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const a=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function WG(e,t,n){const r=(n?2:-2)*Math.PI*(e/t),i=Math.cos(r),a=Math.sin(r);return{real:i,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s$="->",Ryt=/->/g,xz=",",wz="...";function hI(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(Ryt,"").length)/s$.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${s$}").`);const[r,i]=e.split(s$);j(r.indexOf(wz)===-1,()=>`The ellipsis notation ("${wz}") is not supported yet.`);const a=r.split(xz),s=a.length;if(t!==s)throw new Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let p=0;p<i.length;++p){const g=i[p];if(!a.some(v=>v.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);o.indexOf(g)===-1&&o.push(g)}for(let p=0;p<r.length;++p){const g=r[p];o.indexOf(g)===-1&&g!==xz&&o.push(g)}const l=new Array(a.length);for(let p=0;p<s;++p){if(new Set(a[p].split("")).size!==a[p].length)throw new Error(`Found duplicate axes in input component ${a[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let g=0;g<a[p].length;++g)l[p].push(o.indexOf(a[p][g]))}const c=o.length,h=i.length,d=[];for(let p=h;p<c;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function dI(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;const r=[];for(let i=0;i<e;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function pI(e,t,n){const r=new Array(e);for(let i=0;i<n.length;++i){const a=n[i].shape;for(let s=0;s<t[i].length;++s)r[t[i][s]]===void 0?r[t[i][s]]=a[s]:j(r[t[i][s]]===a[s],()=>`Expected dimension ${r[t[i][s]]} at axis ${s} of input shaped ${JSON.stringify(a)}, but got dimension ${a[s]}`)}}function mI(e,t){const n=e,r=[];let i=0;e.length===0&&n.push(-1),i=e.length+1;for(let s=0;s<i;++s)r.push([]);const a=[];for(let s=0;s<n.length;++s){const o=n[s],l=Dyt(t,o);for(const c of l)a.indexOf(c)===-1&&(r[s].push(c),a.push(c))}return{path:n,steps:r}}function gI(e){return e.every((t,n)=>t===n)}function Dyt(e,t){const n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function yI(e,t,n=0){let r=[];if(typeof t=="number")j(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{const i=t.reduce((s,o)=>(o===-1&&(s+=1),s),0);j(i<=1,()=>"There should be only one negative value in split array.");const a=t.indexOf(-1);if(a!==-1){const s=t.reduce((o,l)=>l>0?o+l:o);t[a]=e.shape[n]-s}j(e.shape[n]===t.reduce((s,o)=>s+o),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function qG(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function HG(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function KG(e,t){return`size ${e} must be non-negative, not ${t}`}function YG(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function ZG(e,t){const n=pt(e),r=pt(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function QG(e,t){const n=pt(e),r=pt(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rA(){return"segment ids must be >= 0"}function JG(){return"segment ids are not increasing"}function tq(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function eq(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(e,t){let n=!1,r;for(e<=eI?(r=e,n=!0):r=z2(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=z2(e,r+1);return r}function rq(e,t,n){const r=[],i=e.length;for(let a=0;a<i;a++)a!==t?r.push(e[a]):r.push(n);return r}function vI(e,t,n,r){const i=t.shape.length,a=e.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>a)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${a}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(e.shape[d]!==t.shape[d])throw new Error(`x.shape[${d}]: ${e.shape[d]} should be equal to indices.shape[${d}]: ${t.shape[d]}.`);const s=e.shape[n],o=[];let l=1,c=1,h=1;for(let d=0;d<r;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=r;d<n;d++)o.push(e.shape[d]),c*=e.shape[d];for(let d=r;d<i;d++)o.push(t.shape[d]);for(let d=n+1;d<a;d++)o.push(e.shape[d]),h*=e.shape[d];return{batchSize:l,sliceSize:h,outerSize:c,dimSize:s,outputShape:o}}const Myt=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:vI,computeOutShape:rq,segOpComputeOptimalWindowSize:nq},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ss(e){try{return e.map(t=>ho(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function iq(e){return e.map(t=>uo(t))}const Pyt=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:sI,ERF_A2:oI,ERF_A3:lI,ERF_A4:uI,ERF_A5:cI,ERF_P:aI,PARALLELIZE_THRESHOLD:eI,get RowPartitionType(){return ea},SELU_SCALE:v0,SELU_SCALEALPHA:y0,applyActivation:jE,assertAndGetBroadcastShape:Jt,assertAxesAreInnerMostDims:Jn,assertParamsConsistent:tI,assignToTypedArray:UG,axesAreInnerMostDims:$E,calculateShapes:Vl,checkEinsumDimSizes:pI,checkPadOnDimRoundingMode:Pr,combineLocations:KW,combineRaggedTensorToTensorShapes:MG,complexWithEvenIndex:zG,complexWithOddIndex:jG,computeConv2DInfo:Qn,computeConv3DInfo:Ao,computeDefaultPad:bE,computeDilation2DInfo:jp,computeOptimalWindowSize:g0,computeOutAndReduceShapes:Vn,computeOutShape:Ia,computePool2DInfo:ji,computePool3DInfo:ks,convertConv2DDataFormat:Es,decodeEinsumEquation:hI,eitherStridesOrDilationsAreOne:cr,expandShapeToKeepDim:bn,exponent:WG,exponents:VG,fromStringArrayToUint8:iq,fromUint8ToStringArray:Ss,getAxesPermutation:en,getBroadcastDims:Oc,getComplexWithIndex:fI,getEinsumComputePath:mI,getEinsumPermutation:dI,getFusedBiasGradient:zE,getFusedDyActivation:BE,getImageCenter:nI,getInnerMostAxes:fn,getPermuted:Kp,getRaggedRank:FG,getReductionAxes:On,getReshaped:Xp,getReshapedPermuted:Yp,getRowPartitionTypesHelper:PG,getSliceBeginCoords:rI,getSliceSize:iI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:GG,getSparseFillEmptyRowsNegativeIndexErrorMessage:qG,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:HG,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:YG,getSparseReshapeInputOutputMismatchErrorMessage:QG,getSparseReshapeInputOutputMultipleErrorMessage:ZG,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:XG,getSparseReshapeNegativeOutputDimErrorMessage:KG,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:eq,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:rA,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:JG,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:tq,getUndoAxesPermutation:ko,isIdentityPermutation:gI,log:vft,mergeRealAndImagArrays:ws,prepareAndValidate:XE,prepareSplitSize:yI,segment_util:Myt,shouldFuse:UE,slice_util:Oyt,splitRealAndImagArrays:BG,stridesOrDilationsArePositive:El,tupleValuesAreOne:kl,upcastType:Xr,validateDefaultValueShape:LG,validateInput:pgt,validateUpdateShape:dG,warn:ui},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */$yt();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq={kernelName:sb,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(e,Hp(_t(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fyt={kernelName:qd,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=_e(_t(n,"float32")),i=Nn(Vt(de(1),r));return Ye(jt(e,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lyt={kernelName:Hd,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Nn(Vt(_e(_t(n,"float32")),1));return jt(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Byt={kernelName:Xc,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Jt(n.shape,r.shape);return{a:()=>{let o=e;const l=On(n.shape,i);return l.length>0&&(o=Rt(o,l)),nt(o,n.shape)},b:()=>{let o=e;const l=On(r.shape,i);return l.length>0&&(o=Rt(o,l)),nt(o,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zyt={kernelName:ob,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((r,i)=>{n[i]=()=>e.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jyt={kernelName:lb,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ge(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uyt={kernelName:ub,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ge(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vyt={kernelName:Xd,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,Nn(Vt(de(1),_e(_t(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wyt={kernelName:Kd,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Nn(Ct(de(1),_e(_t(n,"float32"))));return jt(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gyt={kernelName:Qd,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Jt(n.shape,r.shape);return{a:()=>{const o=Ct(_e(n),_e(r));let l=J(e,jt(r,o));const c=On(n.shape,i);return c.length>0&&(l=Rt(l,c)),nt(l,n.shape)},b:()=>{const o=Ct(_e(n),_e(r));let l=Ye(J(e,jt(n,o)));const c=On(r.shape,i);return c.length>0&&(l=Rt(l,c)),nt(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qyt={kernelName:Yd,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,Ct(_e(_t(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hyt={kernelName:Zd,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,Vt(de(1),_e(_t(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xyt(e,t,n,r,i,a){const s=X(e,"dy","avgPool3dGrad"),o=X(t,"input","avgPool3dGrad");let l=s,c=o,h=!1;o.rank===4&&(h=!0,l=nt(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),c=nt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),j(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),j(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Pr("avgPool3dGrad",i,a);const d={dy:l,input:c},p={filterSize:n,strides:r,pad:i,dimRoundingMode:a},g=tt.runKernel(Dk,d,p);return h?nt(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Kyt=rt({avgPool3dGrad_:Xyt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yyt={kernelName:fb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:a,pad:s,dimRoundingMode:o}=n;return{x:()=>Kyt(e,r,i,a,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zyt(e,t,n,r,i){const a=X(e,"dy","avgPoolGrad"),s=X(t,"input","avgPoolGrad");j(s.rank===a.rank,()=>`Rank of input (${s.rank}) does not match rank of dy (${a.rank})`);let o=s,l=a,c=!1;s.rank===3&&(c=!0,o=nt(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),j(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),j(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const h={dy:l,input:o},d={filterSize:n,strides:r,pad:i},p=tt.runKernel(Rk,h,d);return c?nt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Qyt=rt({avgPoolGrad_:Zyt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jyt={kernelName:cb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:a,pad:s}=n;return{x:()=>Qyt(e,r,i,a,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tvt={kernelName:hb,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,i]=t,{transposeA:a,transposeB:s}=n;return!a&&!s?{a:()=>xe(e,i,!1,!0),b:()=>xe(r,e,!0,!1)}:!a&&s?{a:()=>xe(e,i,!1,!1),b:()=>xe(e,r,!0,!1)}:a&&!s?{a:()=>xe(i,e,!1,!0),b:()=>xe(r,e,!1,!1)}:{a:()=>xe(i,e,!0,!0),b:()=>xe(e,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const evt={kernelName:db,gradFunc:(e,t,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>_E(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nvt={kernelName:pft,gradFunc:(e,t,n)=>{const r=n,i=r.inputShape,a=r.shape,s=Array.from(a);for(let l=i.length-1;l>=0;l--)if(i[l]===a[l])s[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);const o=[];for(let l=0;l<s.length;l++)s[l]>1&&o.push(l);return{x:()=>Rt(e,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rvt={kernelName:Jd,gradFunc:e=>({x:()=>e.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ivt={kernelName:tp,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const avt={kernelName:ep,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>Cr(bs(Ul(r,i),Zc(r,a)),e,ge(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const svt={kernelName:pb,inputsToSave:["x"],gradFunc:aq.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ovt={kernelName:mb,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map(l=>l.shape),{axis:i}=n,a=re(i,t[0].shape)[0],s=r.map(l=>l[a]);return fi(e,s,a).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lvt={kernelName:gb,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{dilations:a,strides:s,pad:o,dataFormat:l}=n;return j(kl(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>SE(r.shape,e,i,s,o,l),filter:()=>LE(r,e,i.shape,s,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uvt={kernelName:yb,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{strides:a,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>Il(e,i,a,s,o,1,l),filter:()=>LE(e,r,i.shape,a,s,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cvt(e,t,n,r,i){let a=e;e.rank===4&&(a=nt(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let s=t;s.rank===4&&(s=nt(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),j(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),j(s.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`),j(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),j(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),j(s.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`);const o={x:a,dy:s},l={strides:r,pad:i,filterShape:n};return tt.runKernel(Bk,o,l)}const fvt=rt({conv3DBackpropFilter_:cvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hvt={kernelName:vb,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:a}=n;j(kl(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[s,o]=t;return{x:()=>GW(s.shape,e,o,i,a),filter:()=>fvt(s,e,o.shape,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dvt={kernelName:np,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(Ye(uG(_t(n,"float32"))),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pvt={kernelName:rp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(cG(_t(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mvt={kernelName:bb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i,exclusive:a,reverse:s}=n;return{x:()=>{const o=en([i],r.rank);let l=HW(e,i,a,!s);return o!=null&&(l=me(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gvt={kernelName:xb,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:a,dimRoundingMode:s}=n,o=r??[1,1];j(kl(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,c]=t;return j(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),j(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),j(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),j(cr(i,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${o}'.`),Pr("depthwiseConv2d",a,s),{x:()=>_gt(l.shape,e,c,i,a,o,s),filter:()=>Ogt(l,e,c.shape,i,a,o,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yvt={kernelName:wb,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,a={x:r,filter:i,dy:e},s={x:r,filter:i,dy:e};return{x:()=>tt.runKernel(j2,a,n),filter:()=>tt.runKernel(U2,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vvt={kernelName:ap,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>tt.runKernel(Xk,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bvt={kernelName:sp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=J(Da(Ye(_e(n))),2/Math.sqrt(Math.PI));return{x:()=>J(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xvt={kernelName:op,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(e,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wvt={kernelName:Cb,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>nt(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Svt={kernelName:lp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(e,Da(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cvt={kernelName:up,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tvt={kernelName:cp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Jt(n.shape,r.shape);return{a:()=>{const o=jt(e,_t(r,"float32")),l=On(n.shape,i);return l.length>0?nt(Rt(o,l),n.shape):o},b:()=>{let o=J(e,_t(n,"float32"));const l=On(r.shape,i);l.length>0&&(o=nt(Rt(o,l),r.shape));const c=_e(r);return Ye(jt(o,_t(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $vt={kernelName:Tb,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[i,a,s,o]=t,l=o??de(1),c=On(a.shape,i.shape),h=[];if(a.rank===1){for(let $=0;$<i.shape.length-1;++$)h.push(i.shape[$]);h.push(1)}const d=Vt(i,a),p=J(e,l),g=sG(Ct(s,de(r))),v=J(J(J(g,g),g),de(-.5));return{x:()=>a.rank===1?nt(J(J(e,ia(nt(g,[1,1,1,a.shape[0]]),h)),l),i.shape):nt(J(J(e,g),l),i.shape),mean:()=>{let $=J(J(g,de(-1)),p);return a.rank===1&&($=Rt($,c)),nt($,a.shape)},variance:()=>{let $=J(J(v,d),p);return a.rank===1&&($=Rt($,c)),nt($,a.shape)},scale:()=>{const $=J(d,g);let A=J(e,$);return a.rank===1&&(A=Rt(A,c)),nt(A,a.shape)},offset:()=>{let $=e;return a.rank===1&&($=Rt($,c)),nt($,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Avt={kernelName:$b,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,i]=t,{axis:a,batchDims:s}=n,o=re(a,r.shape)[0],l=(c,h,d)=>()=>{const p=c.shape,g=h.size,v=p.slice(0,o),x=v.length,b=p.slice(a,p.length).slice(1),w=b.length,C=Sz(0,x),T=Sz(x+1,x+1+w),$=Cz([v,[g],b]),A=nt(d,$),E=nt(h,[g]),O=Cz([[x],C,T]),N=me(A,O);let _=mG(N,E,c.shape[o]);const R=ko(O);return _=me(_,R),_};if(s===1){const c=r.shape[0],h=r.split(c,0);return{x:()=>xs(h.map((g,v)=>l(g,i.slice(v,1),e.slice(v,1))())).reshape(r.shape),indices:()=>i}}else return{x:l(r,i,e),indices:()=>i}}};function Sz(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function Cz(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kvt={kernelName:fp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>ge(n),b:()=>ge(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Evt={kernelName:hp,gradFunc:e=>({x:()=>_t(e,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ivt={kernelName:dp,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ovt={kernelName:pp,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nvt={kernelName:mp,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _vt={kernelName:kb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:i}=n,a=pi(r,0);return{x:()=>Cr(a,e,J(e,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rvt={kernelName:yp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,Ct(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dvt={kernelName:gp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,_t(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mvt={kernelName:gft,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;return{logits:()=>{const s=Da(r);return Vt(e,J(Rt(e,i,!0),s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pvt(e,t,n,r=5,i=1,a=1,s=.5){const o={x:e,y:t,dy:n},l={depthRadius:r,bias:i,alpha:a,beta:s};return tt.runKernel(tE,o,l)}const Fvt=rt({localResponseNormalizationBackprop_:Pvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lvt={kernelName:Rb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{depthRadius:a,bias:s,alpha:o,beta:l}=n;return{x:()=>Fvt(r,i,e,a,s,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(e,t,n,r){return t.rank<n.rank&&(t=nt(t,bn(t.shape,r))),e.rank<n.rank&&(e=nt(e,bn(e.shape,r))),{x:()=>J(e,_t(Ra(n,t),e.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tz={kernelName:Db,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:i}=r,a=t[0],s=t[1],o=re(i,a.shape),l=sq(e,s,a,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bvt={kernelName:vp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>J(e,_t(Ul(n,r),"float32")),b:()=>J(e,_t(av(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zvt(e,t,n,r,i,a,s){const o=X(e,"dy","maxPool3dGrad"),l=X(t,"input","maxPool3dGrad"),c=X(n,"output","maxPool3dGrad");let h=o,d=l,p=c,g=!1;l.rank===4&&(g=!0,h=nt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=nt(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=nt(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),j(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),j(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),j(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),Pr("maxPool3dGrad",a,s);const v={dy:h,input:d,output:p},x={filterSize:r,strides:i,pad:a,dimRoundingMode:s},b=tt.runKernel(nE,v,x);return g?nt(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}const jvt=rt({maxPool3dGrad_:zvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uvt={kernelName:Pb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>jvt(e,r,i,a,s,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vvt(e,t,n,r,i,a,s){const o=X(e,"dy","maxPoolGrad"),l=X(t,"input","maxPoolGrad"),c=X(n,"output","maxPoolGrad");j(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),j(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),j(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Pr("maxPoolGrad",a,s);const h={dy:o,input:l,output:c},d={filterSize:r,strides:i,pad:a,dimRoundingMode:s};return tt.runKernel(eE,h,d)}const Wvt=rt({maxPoolGrad_:Vvt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gvt={kernelName:Mb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:a,strides:s,pad:o}=n;return{x:()=>Wvt(e,r,i,a,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qvt={kernelName:Fb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n,a=re(i,r.shape),o=Vn(r.shape,a)[1],l=pt(o);return{x:()=>{const h=r.shape.slice();a.forEach(g=>{h[g]=1});const d=nt(e,h);return jt(J(d,Io(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hvt={kernelName:Lb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:i}=r,[a,s]=t,o=re(i,a.shape),l=sq(e,s,a,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xvt={kernelName:bp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>J(e,_t(Zc(n,r),"float32")),b:()=>J(e,_t(pi(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kvt={kernelName:Bb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,a=i.map(s=>s[0]);return{x:()=>Ue(e,a,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yvt={kernelName:xp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Jt(n.shape,r.shape);return{a:()=>{const o=On(n.shape,i);return o.length>0?nt(Rt(e,o),n.shape):e},b:()=>{const o=J(e,Ye(p0(jt(n,r)))),l=On(r.shape,i);return l.length>0?nt(Rt(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zvt={kernelName:wp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Jt(n.shape,r.shape);return{a:()=>{const o=J(e,_t(r,"float32")),l=On(n.shape,i);return l.length>0?nt(Rt(o,l),n.shape):o},b:()=>{const o=J(e,_t(n,"float32")),l=On(r.shape,i);return l.length>0?nt(Rt(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qvt={kernelName:zb,gradFunc:e=>({x:()=>Ye(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jvt={kernelName:Vb,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>Bn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tbt={kernelName:Ub,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ebt={kernelName:Wb,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return _l(e,r).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $z={kernelName:Gb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,a=i.map(s=>s[0]);return{x:()=>Ue(e,a,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nbt={kernelName:Sp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,i]=t,a=n,s=r,o=Jt(a.shape,s.shape);return{a:()=>{const h=_t(s,"float32");let d=J(e,J(h,Ol(a,Vt(h,de(1)))));const p=On(a.shape,o);return p.length>0&&(d=Rt(d,p)),nt(d,a.shape)},b:()=>{const h=pi(a,0),d=Cr(h,Ma(a),ge(a));let p=J(e,J(i,d));const g=On(s.shape,o);return g.length>0&&(p=Rt(p,g)),nt(p,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rbt={kernelName:qb,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,i=pi(n,0);return{x:()=>Cr(i,e,J(e,r)),alpha:()=>{let a=Cr(i,ge(e),J(e,n));const s=On(r.shape,e.shape);return s.length>0&&(a=Rt(a,s)),nt(a,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ibt(e,t,n){const r=e.shape.slice();r[n]=1;const i=nt(t,r),a=tA(e,n,!0,!1),s=tA(e,n,!0,!0),o=J(a,s);return J(i,o)}function abt(e,t,n){const r=e.shape.length,i=r-n.length,a=en(n,r);let s=e;a!=null&&(s=me(e,a));const o=s.shape.slice(),c=o.splice(r-n.length,n.length).reduce((p,g)=>p*g,1);o.push(c);const h=s.reshape(o);let d=ibt(h,t,i);if(d=d.reshape(s.shape),a!=null){const p=ko(a);d=me(d,p)}return d}const sbt={kernelName:Hb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;let a=[];return i==null?a=r.shape.map((s,o)=>o):typeof i=="number"?a=[i]:a=i,{x:()=>abt(r,e,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const obt={kernelName:ip,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Jt(n.shape,r.shape);return{a:()=>{const o=jt(e,_t(r,"float32")),l=On(n.shape,i);return l.length>0?nt(Rt(o,l),n.shape):o},b:()=>{let o=J(e,_t(n,"float32"));const l=On(r.shape,i);l.length>0&&(o=nt(Rt(o,l),r.shape));const c=_e(r);return Ye(jt(o,_t(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lbt={kernelName:Cp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,Ye(_e(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ubt={kernelName:$p,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=J(Zc(n,6),Hp(n));return{x:()=>J(e,_t(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cbt={kernelName:Tp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(e,_t(Hp(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fbt={kernelName:Xb,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>nt(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hbt={kernelName:Yb,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>tt.runKernel(uE,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dbt={kernelName:Kb,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>tt.runKernel(lE,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbt={kernelName:Zb,gradFunc:(e,t,n)=>{const{dims:r}=n,i=re(r,e.shape);return{x:()=>Nl(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mbt={kernelName:Ap,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gbt={kernelName:kp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ye(jt(e,J(Ol(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybt={kernelName:Qb,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>_t(ge(n),"float32"),t:()=>J(e,_t(n,e.dtype)),e:()=>J(e,_t(EE(n),e.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vbt={kernelName:Ep,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=pi(n,de(0)),i=de(y0),a=de(v0),s=J(e,a),o=J(J(e,i),Da(_t(n,"float32")));return Cr(r,s,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bbt={kernelName:_p,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(e,J(n,Vt(de(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xbt={kernelName:Np,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wbt={kernelName:Ip,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(CE(_t(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sbt={kernelName:Op,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(qW(_t(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cbt={kernelName:Jb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:i,size:a}=n,s=r.shape,[o,l]=m0(r,i,a),c=[];for(let h=0;h<e.rank;h++)c.push([o[h],s[h]-o[h]-l[h]]);return{x:()=>NE(e,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tbt={kernelName:r0,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:i}=n,a=!0,s=J(e,r);return{logits:()=>Vt(s,J(Rt(s,[i],a),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $bt={kernelName:Rp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(e,Yc(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Az={kernelName:e0,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>wE(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kz={kernelName:n0,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>_r(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Abt={kernelName:Dp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,J(Nn(_t(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kbt={kernelName:cE,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(e,J(_t(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ebt={kernelName:Mp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=de(2);return{a:()=>J(e,J(i,Vt(n,r))),b:()=>J(e,J(i,Vt(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ibt={kernelName:zp,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Obt={kernelName:Pp,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=Jt(n.shape,r.shape);return{a:()=>{let o=e;const l=On(n.shape,i);return l.length>0&&(o=Rt(o,l)),nt(o,n.shape)},b:()=>{let o=e;const l=On(r.shape,i);return l.length>0&&(o=Rt(o,l)),nt(Ye(o),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nbt={kernelName:t0,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,i=r.shape.slice(),{axis:a}=n;re(a,r.shape).forEach(c=>{i[c]=1});const o=nt(e,i),l=J(o,Io(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _bt={kernelName:Fp,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jt(e,_e(CE(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rbt={kernelName:Lp,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>J(Vt(de(1),_e(n)),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dbt={kernelName:Bp,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:i}=n;return{x:()=>{let s=ge(r);if(r.rank===1)for(let o=0;o<i[0];++o)s=Ct(s,Ue(e,[o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)s=Ct(s,Ue(e,[o*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)s=Ct(s,Ue(e,[o*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)for(let h=0;h<i[3];++h)s=Ct(s,Ue(e,[o*r.shape[0],l*r.shape[1],c*r.shape[2],h*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return s}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mbt={kernelName:tc,gradFunc:(e,t,n)=>{const r=n,{perm:i}=r,a=ko(i);return{x:()=>me(e,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pbt={kernelName:i0,gradFunc:(e,t,n)=>{const r=n,{axis:i}=r;return{value:()=>xs(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fbt={kernelName:a0,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Lbt(e,n)}}};function Lbt(e,t){const n=Eo(t,ge(t)),r=Vp(e,n);let i=Ul(t,de(0,"int32"));const a=r.rank-i.rank;for(let o=0;o<a;++o)i=Ir(i,o+1);i=bs(i,Io(r.shape,"bool"));const s=ge(r);return Cr(i,r,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bbt={kernelName:s0,gradFunc:e=>({x:()=>ge(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zbt=[aq,Fyt,Lyt,Byt,zyt,jyt,Uyt,Vyt,Wyt,Gyt,qyt,Hyt,Yyt,Jyt,tvt,evt,nvt,rvt,ivt,avt,svt,ovt,uvt,lvt,hvt,dvt,pvt,mvt,gvt,yvt,obt,vvt,bvt,xvt,wvt,Svt,Tvt,Cvt,$vt,Avt,kvt,Evt,Ivt,Ovt,Nvt,_vt,Rvt,Dvt,Mvt,Lvt,Tz,Tz,Bvt,Uvt,Gvt,qvt,Hvt,Xvt,Kvt,Yvt,Zvt,Qvt,Jvt,tbt,ebt,$z,$z,nbt,rbt,sbt,lbt,ubt,cbt,fbt,hbt,dbt,pbt,mbt,gbt,ybt,vbt,bbt,xbt,wbt,Sbt,Cbt,Tbt,$bt,Az,Az,kz,kz,Abt,Ebt,kbt,Ibt,Obt,Nbt,_bt,Rbt,Dbt,Mbt,Pbt,Fbt,Bbt];for(const e of zbt)bft(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.abs=function(){return this.throwIfDisposed(),sr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.acos=function(){return this.throwIfDisposed(),wht(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.acosh=function(){return this.throwIfDisposed(),Cht(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.add=function(e){return this.throwIfDisposed(),Ct(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.all=function(e,t){return this.throwIfDisposed(),UW(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.any=function(e,t){return this.throwIfDisposed(),Q2(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.argMax=function(e){return this.throwIfDisposed(),xd(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.argMin=function(e){return this.throwIfDisposed(),Iht(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.asScalar=function(){return this.throwIfDisposed(),j(this.size===1,()=>"The array must have only 1 element."),nt(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.asType=function(e){return this.throwIfDisposed(),_t(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.as1D=function(){return this.throwIfDisposed(),nt(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.as2D=function(e,t){return this.throwIfDisposed(),nt(this,[e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),nt(this,[e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),nt(this,[e,t,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),nt(this,[e,t,n,r,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.asin=function(){return this.throwIfDisposed(),Nht(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.asinh=function(){return this.throwIfDisposed(),Rht(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.atan=function(){return this.throwIfDisposed(),Mht(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.atan2=function(e){return this.throwIfDisposed(),Fht(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.atanh=function(){return this.throwIfDisposed(),Bht(this)};dt().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),xE(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),wE(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),f0(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Fh(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.cast=function(e){return this.throwIfDisposed(),_t(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.ceil=function(){return this.throwIfDisposed(),hdt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),di(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Cn&&(e=[e]),_r([this,...e],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.conv1d=function(e,t,n,r,i,a){return this.throwIfDisposed(),VW(this,e,t,n,r,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),WW(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.conv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),Il(this,e,t,n,r,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.cos=function(){return this.throwIfDisposed(),CE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.cosh=function(){return this.throwIfDisposed(),qW(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),tA(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),HW(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Fdt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.depthwiseConv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),TE(this,e,t,n,r,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),zdt(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.divNoNan=function(e){return this.throwIfDisposed(),Gdt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.div=function(e){return this.throwIfDisposed(),jt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.dot=function(e){return this.throwIfDisposed(),vs(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.elu=function(){return this.throwIfDisposed(),h0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.equal=function(e){return this.throwIfDisposed(),Ra(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.erf=function(){return this.throwIfDisposed(),XW(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),ipt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.exp=function(){return this.throwIfDisposed(),Da(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.expandDims=function(e){return this.throwIfDisposed(),Ir(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.expm1=function(){return this.throwIfDisposed(),lpt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.fft=function(){return this.throwIfDisposed(),hG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.flatten=function(){return this.throwIfDisposed(),nt(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.floor=function(){return this.throwIfDisposed(),p0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.floorDiv=function(e){return this.throwIfDisposed(),jW(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.gather=function(e,t,n){return this.throwIfDisposed(),Vp(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Ul(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.greater=function(e){return this.throwIfDisposed(),pi(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.ifft=function(){return this.throwIfDisposed(),eA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.irfft=function(){return this.throwIfDisposed(),egt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.isFinite=function(){return this.throwIfDisposed(),ypt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.isInf=function(){return this.throwIfDisposed(),bpt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.isNaN=function(){return this.throwIfDisposed(),wpt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.leakyRelu=function(e){return this.throwIfDisposed(),kE(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.lessEqual=function(e){return this.throwIfDisposed(),Zc(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.less=function(e){return this.throwIfDisposed(),av(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),Apt(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.logSigmoid=function(){return this.throwIfDisposed(),Rpt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.logSoftmax=function(e){return this.throwIfDisposed(),JW(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),tG(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.log=function(){return this.throwIfDisposed(),Ma(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.log1p=function(){return this.throwIfDisposed(),QW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.logicalAnd=function(e){return this.throwIfDisposed(),bs(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.logicalNot=function(){return this.throwIfDisposed(),EE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.logicalOr=function(e){return this.throwIfDisposed(),eG(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.logicalXor=function(e){return this.throwIfDisposed(),jpt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),xe(this,e,t,n)};dt().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),IE(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.max=function(e,t){return this.throwIfDisposed(),Pi(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.maximum=function(e){return this.throwIfDisposed(),Eo(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.mean=function(e,t){return this.throwIfDisposed(),vn(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.min=function(e,t){return this.throwIfDisposed(),Cd(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.minimum=function(e){return this.throwIfDisposed(),Td(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Kpt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.mod=function(e){return this.throwIfDisposed(),Zpt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.mul=function(e){return this.throwIfDisposed(),J(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.neg=function(){return this.throwIfDisposed(),Ye(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.norm=function(e,t,n){return this.throwIfDisposed(),d0(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.notEqual=function(e){return this.throwIfDisposed(),sv(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),nG(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.onesLike=function(){return this.throwIfDisposed(),Bi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.pad=function(e,t){return this.throwIfDisposed(),NE(this,e,t)};dt().prototype.pool=function(e,t,n,r,i,a){return this.throwIfDisposed(),omt(this,e,t,n,r,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.pow=function(e){return this.throwIfDisposed(),Ol(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.prelu=function(e){return this.throwIfDisposed(),RE(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.prod=function(e,t){return this.throwIfDisposed(),cmt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.reciprocal=function(){return this.throwIfDisposed(),Mmt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.relu=function(){return this.throwIfDisposed(),Dr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.relu6=function(){return this.throwIfDisposed(),iG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.reshapeAs=function(e){return this.throwIfDisposed(),nt(this,e.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.reshape=function(e){return this.throwIfDisposed(),nt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),vG(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),bG(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.reverse=function(e){return this.throwIfDisposed(),Nl(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.rfft=function(){return this.throwIfDisposed(),igt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.round=function(){return this.throwIfDisposed(),aG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.rsqrt=function(){return this.throwIfDisposed(),sG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.selu=function(){return this.throwIfDisposed(),oG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.separableConv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),lG(this,e,t,n,r,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.sigmoid=function(){return this.throwIfDisposed(),Yc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.sign=function(){return this.throwIfDisposed(),Wmt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.sin=function(){return this.throwIfDisposed(),uG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.sinh=function(){return this.throwIfDisposed(),cG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.slice=function(e,t){return this.throwIfDisposed(),Ue(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.softmax=function(e){return this.throwIfDisposed(),FE(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.softplus=function(){return this.throwIfDisposed(),Wp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),_E(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.split=function(e,t){return this.throwIfDisposed(),fi(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.sqrt=function(){return this.throwIfDisposed(),Nn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.square=function(){return this.throwIfDisposed(),_e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.squaredDifference=function(e){return this.throwIfDisposed(),sgt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.squeeze=function(e){return this.throwIfDisposed(),qp(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof Cn?[this,e]:[this,...e];return xs(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.step=function(e){return this.throwIfDisposed(),Hp(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.stridedSlice=function(e,t,n,r,i,a,s,o){return this.throwIfDisposed(),fgt(this,e,t,n,r,i,a,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.sub=function(e){return this.throwIfDisposed(),Vt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.sum=function(e,t){return this.throwIfDisposed(),Rt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.tan=function(){return this.throwIfDisposed(),dgt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.tanh=function(){return this.throwIfDisposed(),c0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.tile=function(e){return this.throwIfDisposed(),ia(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.toBool=function(){return this.throwIfDisposed(),_t(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.toFloat=function(){return this.throwIfDisposed(),_t(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.toInt=function(){return this.throwIfDisposed(),_t(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.topk=function(e,t){return this.throwIfDisposed(),ggt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.transpose=function(e){return this.throwIfDisposed(),me(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.unique=function(e){return this.throwIfDisposed(),bgt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),mG(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.unstack=function(e){return this.throwIfDisposed(),_l(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.where=function(e,t){return this.throwIfDisposed(),Cr(e,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dt().prototype.zerosLike=function(){return this.throwIfDisposed(),ge(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class xa extends Error{constructor(t){super(t),Object.setPrototypeOf(this,xa.prototype)}}class _i extends Error{constructor(t){super(t),Object.setPrototypeOf(this,_i.prototype)}}class Z extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Z.prototype)}}class te extends Error{constructor(t){super(t),Object.setPrototypeOf(this,te.prototype)}}class bI extends Error{constructor(t){super(t),Object.setPrototypeOf(this,bI.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oq{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rl(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{const n=new Array(t);return n.fill(e),n}}function wa(e,t){if(!e)throw new bI(t)}function Ez(e,t){let n=0;for(const r of e)r===t&&n++;return n}function Or(e){return e.length===1?e[0]:e}function Ee(e){return Array.isArray(e)?e:[e]}function is(e){const n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function al(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let ki={};function xI(e){if(e==null)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function iA(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>iA(t));else{const t=Object.keys(e);for(const n of t){const r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:iA(r))}}}function Zp(e,t={},n={},r="object",i=!1){if(typeof e=="string"){const a=e;let s;if(a in n)s=n[a];else if(a in ki)s=ki[a];else if(s=t[a],s==null)throw new Z(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}else{const a=e;if(a.className==null||a.config==null)throw new Z(`${r}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const s=a.className;let o,l;if(s in n?[o,l]=n[s]:s in ki?[o,l]=ki.className:s in t&&([o,l]=t[s]),o==null)throw new Z(`Unknown ${r}: ${s}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const g of Object.keys(ki))c[g]=ki[g];for(const g of Object.keys(n))c[g]=n[g];const h=a.config;h.customObjects=c;const d=Object.assign({},ki);for(const g of Object.keys(n))ki[g]=n[g];iA(a.config);const p=l(o,a.config,n,i);return ki=Object.assign({},d),p}else{const c=Object.assign({},ki);for(const d of Object.keys(n))ki[d]=n[d];const h=new o(a.config);return ki=Object.assign({},c),h}}}function jbt(e,t){return e<t?-1:e>t?1:0}function Fg(e,t){return-1*jbt(e,t)}function co(e){if(e==null)return e;const t=[];for(const n of e)t.indexOf(n)===-1&&t.push(n);return t}function Ubt(e){if(e==null)throw new Z(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Wl(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new Z(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function wI(e,t,n=0,r=1/0){return wa(n>=0),wa(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(i=>typeof i===t)}function jn(e,t){Array.isArray(e)?(j(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>jn(n,`element ${r+1} of ${t}`))):j(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${lq(e)}.`)}function lq(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>lq(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function Vbt(e,t,n){let r=n!=null?n():Er(),i;return(...s)=>{const o=n!=null?n():Er();return o-r<t||(r=o,i=e(...s)),i}}function uq(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Wbt=0;function cq(){return Wbt++}const Lg={};function b0(e=""){return e in Lg||(Lg[e]=0),Lg[e]+=1,e+Lg[e].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Gbt=["channelsFirst","channelsLast"],qbt=["nearest","bilinear"],Hbt=["valid","same","causal"],Xbt=["max","avg"],Kbt=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ju=new Map;function hn(e){Wl(Gbt,"DataFormat",e)}function Ybt(e){Wl(qbt,"InterpolationFormat",e)}function mi(e){Wl(Hbt,"PaddingMode",e)}function fq(e){Wl(Xbt,"PoolMode",e)}const Lh=[],Iz="/";function gl(e,t){Lh.push(e);try{const n=t();return Lh.pop(),n}catch(n){throw Lh.pop(),n}}function Zbt(){return Lh.length===0?"":Lh.join(Iz)+Iz}function hq(e){if(!pq(e))throw new Error("Not a valid tensor name: '"+e+"'");return Zbt()+e}function dq(e){if(!pq(e))throw new Error("Not a valid tensor name: '"+e+"'");ju.has(e)||ju.set(e,0);const t=ju.get(e);if(ju.set(e,ju.get(e)+1),t>0){const n=`${e}_${t}`;return ju.set(n,1),n}else return e}const Qbt=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function pq(e){return!!e.match(Qbt)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jbt(e){return e===parseInt(e.toString(),10)}function fo(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function _c(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function po(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function oa(e,t){if(t<e)throw new Z(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let o$;function $n(){return o$==null&&(o$=Gft().epsilon()),o$}function la(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oa(e,t){return _t(e,t)}function Qp(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),nt(e,n)}function t0t(e,t){return st(()=>{if(e.shape.length!==2)throw new Z(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);const n=Qp(e,1);return aA(n,[1,t,1])})}function e0t(e){const t=[fo(e.shape)];return nt(e,t)}function n0t(e){if(e.rank<=1)throw new Z(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],fo(e.shape,1)];return nt(e,t)}function yl(e,t,n){return st(()=>{switch(e.rank){case 1:return ME(e,t,n);case 2:return fG(e,[t,0],[n,e.shape[1]]);case 3:return PE(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return lv(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Ue(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Ue(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Z(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function l$(e,t,n){return st(()=>{switch(e.rank){case 1:return ME(e,t,n);case 2:return fG(e,[0,t],[e.shape[0],n]);case 3:return PE(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return lv(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Z(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function Bg(e,t,n,r){return st(()=>{switch(e.rank){case 1:return ME(e,t,n);case 2:switch(r){case 1:return yl(e,t,n);case 2:return l$(e,t,n);default:throw new Z(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return yl(e,t,n);case 2:return PE(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return l$(e,t,n);default:throw new Z(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return yl(e,t,n);case 2:return lv(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return lv(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return l$(e,t,n);default:throw new Z(`The axis is not within the rank of the tensor ${r}`)}default:throw new Z(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function SI(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),_r(e,t)}function Oz(e,t){switch(e.rank){case 1:return mdt([e,t]);case 2:return ydt([e,t],0);case 3:return bdt([e,t],0);case 4:return wdt([e,t],0);default:throw new Z(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function aA(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Z(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return ia(e,t)}function x0(e,t=0,n=1,r,i){return Nmt(e,t,n,r,i)}function Na(e,t,n,r){if(e.rank<2||t.rank<2)throw new te(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){const i=e.shape.slice(-1)[0],a=t.shape.slice(-2)[0];if(i!==a)throw new te(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return gz({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?sA(e.rank,r,la()):null,activation:n});{const i=e.shape.slice(),a=i.pop();e=nt(e,[-1,a]);const s=t.shape.slice(),o=s.pop(),l=s.pop(),c=[...s,o],h=Array.from({length:t.rank},(v,x)=>x===0?t.rank-2:x<=t.rank-2?x-1:x);t=nt(me(t,h),[l,-1]);const d=[...i,...c];return nt(gz({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?sA(e.rank,r,la()):null,activation:n}),d)}}function mq(e,t,n){return st(()=>(Array.isArray(t)?t=Tn(t,"int32"):t=_t(t,"int32"),Vp(e,t,n)))}function Jp(e){return J(e,e)}function sA(e,t,n){const r=t.shape;if(t.rank!==1&&t.rank!==e)throw new Z(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?nt(t,[1,r[0],1,1,1]):nt(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?nt(t,[1,1,1,1,r[0]]):nt(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?nt(t,[1,r[0],1,1]):nt(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?nt(t,[1,1,1,r[0]]):nt(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?nt(t,[1,r[0],1]):nt(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?nt(t,[1,1,r[0]]):nt(t,[1].concat(r))}else if(e<3)return t;throw new Z(`Unsupported input rank by biasAdd: ${t.rank}`)}function fa(e,t,n){return st(()=>(n==null&&(n=la()),hn(n),Ct(e,sA(e.rank,t,n))))}function r0t(e,t=1){if(t!==1)throw new te(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return h0(e)}function i0t(e){return st(()=>jt(e,Ct(sr(e),1)))}function gq(e,t,n,r){return st(()=>$gt(e,t,n,r))}function a0t(e){return st(()=>{const t=Ct(.5,J(.2,e));return di(t,0,1)})}function tm(e,t,n=!1){return n?e():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const s0t=["fanIn","fanOut","fanAvg"],o0t=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function l0t(e){Wl(s0t,"FanMode",e)}function u0t(e){Wl(o0t,"Distribution",e)}class Ui extends Jc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class yq extends Ui{apply(t,n){return Bn(t,n)}}yq.className="Zeros";St(yq);class CI extends Ui{apply(t,n){return Io(t,n)}}CI.className="Ones";St(CI);class vq extends Ui{constructor(t){if(super(),typeof t!="object")throw new Z(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new Z(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return st(()=>J(de(this.value),Io(t,n)))}getConfig(){return{value:this.value}}}vq.className="Constant";St(vq);class bq extends Ui{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return Gp(t,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}bq.className="RandomUniform";St(bq);class xq extends Ui{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new te(`randomNormal does not support dType ${n}.`);return x0(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}xq.className="RandomNormal";St(xq);class wq extends Ui{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new te(`truncatedNormal does not support dType ${n}.`);return pG(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}wq.className="TruncatedNormal";St(wq);class Sq extends Ui{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return st(()=>{if(t.length!==2||t[0]!==t[1])throw new Z("Identity matrix initializer can only be used for 2D square matrices.");return J(this.gain,ZW(t[0]))})}getConfig(){return{gain:this.gain}}}Sq.className="Identity";St(Sq);function c0t(e,t="channelsLast"){let n,r;if(hn(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){const i=fo(e,2);n=e[1]*i,r=e[0]*i}else if(t==="channelsLast"){const i=fo(e,0,e.length-2);n=e[e.length-2]*i,r=e[e.length-1]*i}}else{const i=fo(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}class Kr extends Ui{constructor(t){if(super(),t.scale<0)throw new Z(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,l0t(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,u0t(this.distribution),this.seed=t.seed}apply(t,n){const r=c0t(t),i=r[0],a=r[1];let s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,i):this.mode==="fanOut"?s/=Math.max(1,a):s/=Math.max(1,(i+a)/2),this.distribution==="normal"){const o=Math.sqrt(s);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new te(`${this.getClassName()} does not support dType ${n}.`);return pG(t,0,o,n,this.seed)}else{const o=Math.sqrt(3*s);return Gp(t,-o,o,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Kr.className="VarianceScaling";St(Kr);class TI extends Kr{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Kr.className}}TI.className="GlorotUniform";St(TI);class $I extends Kr{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Kr.className}}$I.className="GlorotNormal";St($I);class AI extends Kr{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Kr.className}}AI.className="HeNormal";St(AI);class kI extends Kr{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Kr.className}}kI.className="HeUniform";St(kI);class EI extends Kr{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Kr.className}}EI.className="LeCunNormal";St(EI);class II extends Kr{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Kr.className}}II.className="LeCunUniform";St(II);class Cq extends Ui{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,n){return st(()=>{if(t.length<2)throw new te("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=pt(t.slice(0,-1)),i=t[t.length-1],a=r*i;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const s=[Math.max(i,r),Math.min(i,r)],o=x0(s,0,1,n,this.seed),l=wyt.qr(o,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(i,r)*Math.min(i,r)],[Math.min(i,r)+1]);return c=J(c,d.sign()),r<i&&(c=c.transpose()),J(de(this.gain),c.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}Cq.className="Orthogonal";St(Cq);const Nz={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function _z(e,t={}){return Zp(e,Oi.getMap().classNameMap,t,"initializer")}function tn(e){return xI(e)}function Ke(e){if(typeof e=="string"){const t=e in Nz?Nz[e]:e;if(t==="GlorotNormal")return new $I;if(t==="GlorotUniform")return new TI;if(t==="HeNormal")return new AI;if(t==="HeUniform")return new kI;if(t==="LeCunNormal")return new EI;if(t==="LeCunUniform")return new II;{const n={};return n.className=t,n.config={},_z(n)}}else return e instanceof Ui?e:_z(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oA(e){return Array.isArray(e)&&Array.isArray(e[0])}function uv(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Yt(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new Z(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function be(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new Z(`Expected exactly 1 Shape; got ${e.length}`)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cv(e){let t=0;for(const n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,i)=>r*i);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Rz="Variable";class f0t{constructor(t,n="float32",r=Rz,i=!0,a=null){this.dtype=n??"float32",this.shape=t.shape,this.id=cq(),r=r??Rz,this.originalName=hq(r),this.name=dq(this.originalName),this.trainable_=i,this.constraint=a,this.val=gG(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),h0t(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function h0t(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function lA(e){return e.map(t=>t.read())}function OI(e){e.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class An{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Pa{constructor(t,n,r,i,a,s,o){this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=a,this.outputTensorIndex=o,this.id=cq(),s!=null&&(this.originalName=hq(s),this.name=dq(this.originalName)),this.rank=n.length}}let d0t=0;class w0{constructor(t,n){this.callArgs=n,this.id=d0t++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const r of t.inboundLayers)r!=null&&r.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let p0t=0;class ie extends Jc{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=p0t++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const r=this.getClassName();n=is(r)+"_"+b0(r)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let r;if(t.batchInputShape!=null)r=t.batchInputShape;else if(t.inputShape!=null){let a=null;t.batchSize!=null&&(a=t.batchSize),r=[a].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;i==null&&(i=t.inputDType),i==null&&(i="float32"),this.dtype=i}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new _i(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new Z(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Or(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Or(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new xa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new xa(`Layer ${this.name} is not connected, no input to return.`);return Or(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new xa(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new xa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Or(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const n=Ee(t);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=Ee(this.inputSpec);if(n.length!==r.length)throw new Z(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${t}`);for(let i=0;i<n.length;i++){const a=n[i],s=r[i];if(s==null)continue;const o=a.rank;if(s.ndim!=null&&o!==s.ndim)throw new Z(`Input ${i} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${o}`);if(s.maxNDim!=null&&o>s.maxNDim)throw new Z(`Input ${i} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${o}`);if(s.minNDim!=null&&o<s.minNDim)throw new Z(`Input ${i} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${o}.`);if(s.dtype!=null&&a.dtype!==s.dtype)throw new Z(`Input ${i} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${a.dtype}.`);if(s.axes){const l=a.shape;for(const c in s.axes){const h=Number(c),d=s.axes[c],p=h>=0?l[h]:l[l.length+h];if(d!=null&&[d,null].indexOf(p)===-1)throw new Z(`Input ${i} is incompatible with layer ${this.name}: expected axis ${h} of input shape to have value ${d} but got shape ${l}.`)}}if(s.shape!=null)for(let l=0;l<s.shape.length;++l){const c=s.shape[l],h=a.shape[l];if(c!=null&&h!=null&&c!==h)throw new Z(`Input ${i} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${a.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const r=Ee(t),i=y0t(t),a=v0t(t);if(i===a)throw new Z("Arguments to apply() must be all SymbolicTensors or all Tensors");return gl(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const s=[];for(const o of Ee(t))s.push(o.shape);this.build(Or(s)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(t),a){let s=this.call(t,n);this.supportsMasking&&this.setMaskMetadata(t,s);const o=Ee(s),l=[];for(let c of o)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(s=Or(l),this.activityRegularizer!=null)throw new te("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}else{const s=m0t(t),o=this.computeOutputShape(s);let l;const c=g0t(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?s[0]:s),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((h,d)=>new Pa(c,h,this,Ee(t),n,this.name,d)):l=new Pa(c,o,this,Ee(t),n,this.name),this.addInboundNode(t,l,null,null,s,o,n),this._refCount++,this.activityRegularizer!=null)throw new te("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,i)=>{r!=null&&t[i]!=null&&t[i]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new xa(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);t.indexOf(r)===-1&&t.push(r)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new xa(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new _i(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return cv(this.weights)}build(t){this.built=!0}getWeights(t=!1){return lA(t?this.trainableWeights:this.weights)}setWeights(t){st(()=>{const n=this.weights;if(n.length!==t.length)throw new Z(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const r=[],i=lA(n);for(let a=0;a<i.length;++a){const s=i[a],o=n[a],l=t[a];if(!we(s.shape,l.shape))throw new Z(`Layer weight shape ${s.shape} not compatible with provided weight shape ${l.shape}`);r.push([o,l])}OI(r)})}addWeight(t,n,r,i,a,s,o,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new Z(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(i=l!=null?l():Ke("zeros"));const c=i.apply(n,r),h=new f0t(c,r,t,s,o);return c.dispose(),a!=null&&this.addLoss(()=>a.apply(h.read())),s==null&&(s=!0),s?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=Ee(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(t,n,r){if(!this.supportsMasking)return;const i=this.computeMask(t,r),a=Ee(n),s=Ee(i);if(a.length!==s.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let o=0;o<a.length;o++)a[o].kerasMask=s[o]}addInboundNode(t,n,r,i,a,s,o=null){const l=Ee(t);n=Ee(n),r=Ee(r),i=Ee(i),a=uv(a),s=uv(s);const c=[],h=[],d=[];for(const p of l)c.push(p.sourceLayer),h.push(p.nodeIndex),d.push(p.tensorIndex);new w0({outboundLayer:this,inboundLayers:c,nodeIndices:h,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:i,inputShapes:a,outputShapes:s},o);for(let p=0;p<n.length;p++)n[p].sourceLayer=this,n[p].nodeIndex=this.inboundNodes.length-1,n[p].tensorIndex=p}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function m0t(e){e=Ee(e);const t=[];for(const n of e)t.push(n.shape);return Or(t)}function g0t(e){return"float32"}function Tq(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{const r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const i=[];for(let a=0;a<r.inboundLayers.length;a++){const s=r.inputTensors[a],o=r.inboundLayers[a],l=r.nodeIndices[a],c=Tq(s,o,l);for(const h of c)i.indexOf(h)===-1&&i.push(h)}return i}}}function y0t(e){let t=!0;for(const n of Ee(e))if(!(n instanceof Pa)){t=!1;break}return t}function v0t(e){let t=!0;for(const n of Ee(e))if(n instanceof Pa){t=!1;break}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class em extends ie{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:b0("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new Z("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new Z("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new Z("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=t.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const i=new Pa(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new w0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new Z(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}em.className="InputLayer";St(em);function b0t(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new Z("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new em({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function x0t(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return _t(t,e.dtype)}catch{throw new Z(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}class io{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof io)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=x0t(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new Z(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Pa){if(this.id2Value[t.id]==null)throw new Z(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Z(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof Pa){if(this.id2Value[t.id]==null)throw new Z(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Z(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&oe(this.id2Mask)}}const fv=new oq,hv=new oq;function w0t(e){fv!=null&&fv.setMaxEntries(e),hv!=null&&hv.setMaxEntries(e)}function Eh(e,t,n,r){const i=n==null?!1:n.training,a=Array.isArray(e),s=a?e:[e],o=s.map(v=>v.name),l=[],c=t.names();for(const v of o)c.indexOf(v)!==-1?l.push(t.getValue(v)):l.push(null);const h=o.join(",")+"|"+t.names().sort().join(",");let d=fv.get(h),p;if(d==null){const v=S0t(s,t);d=v.sorted,p=v.recipientCounts,fv.put(h,d),hv.put(h,p)}p={},i||Object.assign(p,hv.get(h));const g=new io(t);for(let v=0;v<d.length;++v){const x=d[v],b=x.sourceLayer;if(b instanceof em)continue;const w=[],C=[],T=[];let $=!1;for(const _ of x.inputs){const R=g.getValue(_),I=g.getMask(_);w.push(R),C.push(I),I!=null&&($=!0),i||(p[_.name]--,p[_.name]===0&&!t.hasKey(_)&&o.indexOf(_.name)===-1&&!R.isDisposed&&_.sourceLayer.stateful!==!0&&T.push(R))}$&&(n=n||{},n.mask=C[0]);const A=Ee(b.apply(w,n));let E=null;b.supportsMasking&&(E=b.computeMask(w,C));const O=T0t(x),N=Array.isArray(O)?O:[O];for(let _=0;_<N.length;++_){g.hasKey(N[_])||g.add(N[_],A[_],Array.isArray(E)?E[0]:E);const R=o.indexOf(N[_].name);R!==-1&&(l[R]=A[_])}i||oe(T)}return g.disposeMasks(),a?l:l[0]}function S0t(e,t){j(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){const i=Dz(e[0],t);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const a of e){const{sorted:s,recipientMap:o}=Dz(a,t);for(const l of s)i.has(l.name)||(n.push(l),i.add(l.name));for(const l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:C0t(r)}}function C0t(e){const t={};for(const n in e)t[n]=e[n].size;return t}function Dz(e,t){const n=new Set,r=[],i={};for(const o of t.names())n.add(o);const a=[],s=[];for(a.push(e);a.length>0;){const o=a[a.length-1];if(n.has(o.name)){a.pop();continue}const l=s[s.length-1]===a.length-1;if(o.inputs.length===0||l)a.pop(),r.push(o),n.add(o.name),l&&s.pop();else{s.push(a.length-1);for(const c of o.inputs)i[c.name]==null&&(i[c.name]=new Set),i[c.name].add(o.name),!n.has(c.name)&&a.push(c)}}return{sorted:r,recipientMap:i}}function T0t(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(const i of e.sourceLayer.inboundNodes[r].outputTensors)if(i.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $0t=ct();$0t.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,w0t);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NI(e,t){return st(()=>Nn(Rt(J(e,e),t,!0)))}class nm extends Jc{getConfig(){return{}}}class $q extends nm{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return st(()=>{const n=NI(t,this.axis),r=di(n,0,this.maxValue);return J(t,jt(r,Ct($n(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}$q.className="MaxNorm";St($q);class Aq extends nm{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return st(()=>jt(t,Ct($n(),NI(t,this.axis))))}getConfig(){return{axis:this.axis}}}Aq.className="UnitNorm";St(Aq);class kq extends nm{apply(t){return Dr(t)}}kq.className="NonNeg";St(kq);class Eq extends nm{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return st(()=>{const n=NI(t,this.axis),r=Ct(J(this.rate,di(n,this.minValue,this.maxValue)),J(1-this.rate,n));return J(t,jt(r,Ct($n(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Eq.className="MinMaxNorm";St(Eq);const Mz={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function En(e){return xI(e)}function Pz(e,t={}){return Zp(e,Oi.getMap().classNameMap,t,"constraint")}function In(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in Mz?Mz[e]:e,config:{}};return Pz(n)}else return e instanceof nm?e:Pz(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Qo(e){if(e==null)return;const t=[],n=[],r=[];for(const i in e){const a=e[i];if(typeof a!="number"){const s=a;t.push(s.data()),n.push(i),r.push(s)}}if(t.length>0){const i=await Promise.all(t);for(let a=0;a<i.length;++a)e[n[a]]=i[a][0];oe(r)}}function Iq(e){if(e!=null)for(const t in e){const n=e[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Fz;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(Fz||(Fz={}));const A0t=125;class Ad{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class k0t{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class E0t extends Ad{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const i in n){const a=n[i];if(typeof a=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+a*r;else{let s;i in this.totals?s=this.totals[i]:this.totals[i]=0;const o=st(()=>Ct(this.totals[i],J(a,r)));this.totals[i]=o,s!=null&&s.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:st(()=>{const i=J(jt(1,this.seen),this.totals[r]);n[r]=i,this.totals[r].dispose(),Ea(n[r])}))}}class I0t extends Ad{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const t=[],n=[],r=[];for(const a in this.history){const s=this.history[a];for(let o=0;o<s.length;++o)if(typeof s[o]!="number"){const l=s[o];t.push(l.data()),n.push(a),r.push(o)}}const i=await Promise.all(t);for(let a=0;a<i.length;++a)this.history[n[a]][r[a]].dispose(),this.history[n[a]][r[a]]=i[a][0]}}class O0t extends Ad{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||DG,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=A0t),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");L2(this.yieldEvery)&&(this.maybeWait=Vbt(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,r){const i=[];this.yield!=null&&(await Qo(r),i.push(this.yield(t,n,r))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await Qo(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const r=[];this.epochEnd!=null&&(await Qo(n),r.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(t,n){this.batchBegin!=null&&(await Qo(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const r=[];this.batchEnd!=null&&(await Qo(n),r.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):L2(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(r)}async onTrainBegin(t){this.trainBegin!=null&&(await Qo(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await Qo(t),await this.trainEnd(t))}}function Oq(e,t){return e==null&&(e={}),e instanceof Ad?[e]:Array.isArray(e)&&e[0]instanceof Ad?e:Ee(e).map(r=>new O0t(r,t))}class Ii{constructor(){}static registerCallbackConstructor(t,n){j(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),Ii.checkForDuplicate(n),Ii.constructors[t]==null&&(Ii.constructors[t]=[]),Ii.constructors[t].push(n)}static checkForDuplicate(t){for(const n in Ii.constructors)Ii.constructors[+n].forEach(i=>{if(i===t)throw new Z("Duplicate callback constructor.")})}static clear(){Ii.constructors={}}static createCallbacks(t){const n=[];for(const r in Ii.constructors){const i=+r;t>=i&&n.push(...Ii.constructors[i])}return n.map(r=>new r)}}Ii.constructors={};function Nq(e,t,n,r,i,a,s,o,l){const c=new I0t,h=[new E0t,...Ii.createCallbacks(t)];e!=null&&h.push(...e),h.push(c);const d=new k0t(h);return d.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:s,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ds(e,t={},n=!1){return Zp(e,Oi.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dv(e,t){return st(()=>{e.dtype!=="float32"&&(e=_t(e,"float32"));const n=Rt(Jp(e),t,!0),r=Up(n.shape,$n()),i=Nn(Eo(n,r));return jt(e,i)})}function S0(e,t){return st(()=>vn(Jp(Vt(t,e)),-1))}function _I(e,t){return st(()=>vn(sr(Vt(t,e)),-1))}function RI(e,t){return st(()=>{const n=Vt(e,t),r=di(sr(e),$n(),Number.MAX_VALUE),i=sr(jt(n,r));return J(100,vn(i,-1))})}function N0t(e,t){return st(()=>{const n=di(t,$n(),Number.MAX_VALUE),r=Ma(Ct(1,n)),i=di(e,$n(),Number.MAX_VALUE),a=Ma(Ct(1,i));return vn(Jp(Vt(r,a)),-1)})}function _0t(e,t){return st(()=>{const n=Eo(0,Vt(1,J(e,t)));return vn(Jp(n),-1)})}function R0t(e,t){return st(()=>{const n=Eo(0,Vt(1,J(e,t)));return vn(n,-1)})}function D0t(e,t){return st(()=>{const n=Rt(J(e,t),-1),r=Pi(J(Vt(1,e),t),-1);return Eo(0,Ct(1,Vt(r,n)))})}function M0t(e,t){return st(()=>{const n=Math.log(2),r=Vt(t,e),i=Vt(Ct(r,Wp(J(-2,r))),n);return vn(i,-1)})}function kd(e,t,n=!1){return st(()=>{if(n)t=FE(t);else{const r=Rt(t,t.shape.length-1,!0);t=jt(t,r)}return t=di(t,$n(),1-$n()),Ye(Rt(J(_t(e,"float32"),Ma(t)),t.shape.length-1))})}function pv(e,t,n=!1){return st(()=>{const r=_t(p0(e0t(e)),"int32");t=di(t,$n(),1-$n());const i=t.shape,a=nt(nG(r,i[i.length-1]),i);return kd(a,t,n)})}function P0t(e,t){if(!we(e.shape,t.shape))throw new Z(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return st(()=>{const n=Dr(t),r=Ye(sr(t));return Ct(Vt(n,J(t,e)),QW(Da(r)))})}function C0(e,t){return st(()=>{let n;return n=di(t,$n(),1-$n()),n=Ma(jt(n,Vt(1,n))),vn(P0t(e,n),-1)})}function F0t(e,t){return st(()=>{const n=di(e,$n(),1),r=di(t,$n(),1);return Rt(J(e,Ma(jt(n,r))),-1)})}function L0t(e,t){return st(()=>{const n=Ma(Ct($n(),t));return vn(Vt(t,J(e,n)),-1)})}function _q(e,t){return st(()=>{const n=dv(e,-1),r=dv(t,-1),i=J(n,r);return Ye(Rt(i,-1))})}const mv={meanSquaredError:S0,meanAbsoluteError:_I,meanAbsolutePercentageError:RI,meanSquaredLogarithmicError:N0t,squaredHinge:_0t,hinge:R0t,categoricalHinge:D0t,logcosh:M0t,categoricalCrossentropy:kd,sparseCategoricalCrossentropy:pv,binaryCrossentropy:C0,kullbackLeiblerDivergence:F0t,poisson:L0t,cosineProximity:_q};function u$(e){if(typeof e=="string"){if(e in mv)return mv[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Z(t)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rq(e,t){return st(()=>{const n=J(.5,Bi(t)),r=Oa(pi(t,n),e.dtype);return vn(Ra(e,r),-1)})}function Dq(e,t){return st(()=>Oa(Ra(xd(e,-1),xd(t,-1)),"float32"))}function B0t(e,t){return st(()=>_t(Rt(bs(Ra(e,1),Ra(t,1))),"float32"))}function z0t(e,t){return st(()=>_t(Rt(bs(Ra(e,0),Ra(t,1))),"float32"))}function j0t(e,t){return st(()=>{const n=B0t(e,t),r=z0t(e,t),i=Ct(n,r);return _t(Cr(pi(i,0),jt(n,i),0),"float32")})}function U0t(e,t){return C0(e,t)}function V0t(e,t){return e.rank===t.rank&&(e=qp(e,[e.rank-1])),t=xd(t,-1),t.dtype!==e.dtype&&(t=_t(t,e.dtype)),_t(Ra(e,t),"float32")}const W0t=S0,G0t=S0,q0t=_I,H0t=_I,X0t=RI,K0t=RI,Mq=kd,Y0t=_q,Pq=pv,gv={binaryAccuracy:Rq,categoricalAccuracy:Dq,precision:j0t,categoricalCrossentropy:Mq,sparseCategoricalCrossentropy:Pq,mse:W0t,MSE:G0t,mae:q0t,MAE:H0t,mape:X0t,MAPE:K0t,cosine:Y0t};function Z0t(e){if(typeof e=="string"&&e in gv)return gv[e];if(typeof e!="string"&&e!=null)return e;throw new Z(`Unknown metric ${e}`)}function zg(e){if(wa(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(const n of Object.keys(mv))if(mv[n]===e){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(gv))if(gv[n]===e){t=n;break}return t!==void 0?t:e.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Q0t(e){const t={Adagrad:()=>rl.adagrad(.01),Adadelta:()=>rl.adadelta(1,.95,$n()),Adam:()=>rl.adam(.001,.9,.999,$n()),Adamax:()=>rl.adamax(.002,.9,.999,$n(),0),RMSProp:()=>rl.rmsprop(.001,.9,0,$n()),SGD:()=>rl.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Z(`Unknown Optimizer ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Lz=1*1024*1024;function Bz(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!uA(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(e);r.length>Lz&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Lz}.`)}}function uA(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t)if(typeof n!="string"||!uA(e[n]))return!1;return!0}else if(Array.isArray(e)){for(const t of e)if(!uA(t))return!1;return!0}else return!1;else{const t=typeof e;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function J0t(e,t,n,r=console.log){const i=ext(e),a=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(h=>Math.floor(t*h)));let s;if(!i){a.push("Receives inputs"),s=[];for(const h in e.nodesByDepth)s.push(...e.nodesByDepth[h])}r("_".repeat(t)),yv(a,n,r),r("=".repeat(t));const o=e.layers;for(let h=0;h<o.length;++h)i?nxt(o[h],n,r):rxt(o[h],n,s,r),r((h===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=txt(e),c=cv(e.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(t))}function txt(e){let t;return e.collectedTrainableWeights!=null?t=cv(e.collectedTrainableWeights):t=cv(e.trainableWeights),t}function ext(e){let t=!0;const n=[],r=[];for(const i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(const i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of e.layers){let a=!1;for(const s of i.inboundNodes)if(r.indexOf(s)!==-1)if(a){t=!1;break}else a=!0;if(!t)break}return t}function yv(e,t,n=console.log){let r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function nxt(e,t,n){let r,i;try{i=e.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}const a=e.name,s=e.getClassName(),o=[`${a} (${s})`,i,r,e.countParams().toString()];yv(o,t,n)}function rxt(e,t,n,r){let i,a;try{a=e.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{a="multiple"}try{i=JSON.stringify(e.outputShape)}catch{i="multiple"}const s=[];for(const d of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){const g=d.inboundLayers[p].name,v=d.nodeIndices[p],x=d.tensorIndices[p];s.push(`${g}[${v}][${x}]`)}const o=e.name,l=e.getClassName(),c=s.length===0?"":s[0],h=[`${o} (${l})`,a,i,e.countParams().toString(),c];yv(h,t,r);for(let d=1;d<s.length;++d)yv(["","","","",s[d]],t,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fq(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function cA(e,t){if(e===null)return null;if(typeof e=="string")return al(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const a=e[i];Fq(t,i,a)?n.push(a):n.push(cA(a,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r];if(r==="name"&&typeof i=="string")n[r]=i;else{const a=al(r);n[a]=cA(i,a)}}return n}}function fA(e,t){if(e==null)return null;if(typeof e=="string")return is(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const a=e[i];Fq(t,i,a)?n.push(a):n.push(fA(a,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r],a=is(r);(r==="name"||r==="className")&&typeof i=="string"?n[a]=i:n[a]=fA(i,r)}return n}}/** @license See the LICENSE file. */const Lq="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ixt=e=>{const t=Object.keys(e);if(t.length===0)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Yi extends ie{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const C=this.getClassName().toLowerCase();this.name=b0(C)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],co(this.inputs).length!==this.inputs.length)throw new Z(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(C=>C.name)}`);co(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(C=>C.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const C of this.outputs){const T=C.sourceLayer,$=C.nodeIndex,A=C.tensorIndex;this.outputLayers.push(T),this.outputLayersNodeIndices.push($),this.outputLayersTensorIndices.push(A)}for(const C of this.inputs){const T=C.sourceLayer,$=C.nodeIndex,A=C.tensorIndex;wa($===0,"input layer has >1 nodes"),wa(A===0,"input layer has >1 tensors"),this.inputLayers.push(T),this.inputLayersNodeIndices.push($),this.inputLayersTensorIndices.push(A)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let C=0;C<this.inputLayers.length;C++){const T=this.inputLayers[C];if(!(T instanceof em))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${C} (0-based) originates from layer type ${T.getClassName()}.`);this.inputNames.push(T.name),this.feedInputShapes.push(T.batchInputShape),this.feedInputNames.push(T.name)}for(const C of this.outputLayers)this.outputNames.push(C.name);this.internalInputShapes=this.inputs.map(C=>C.shape),this.internalOutputShapes=this.outputs.map(C=>C.shape);const n={},r={},i={},a={},s={},o=[],l=(C,T,$,A,E,O)=>{(A==null||E==null||O==null)&&(A=C.sourceLayer,E=C.nodeIndex,O=C.tensorIndex);const N=A.inboundNodes[E];if($.indexOf(N)!==-1)throw new _i(`The tensor ${C.name} at layer "${A.name}" is part of a cycle.`);if(T.indexOf(N)!==-1)return;this.containerNodes.add(Yi.nodeKey(A,E)),A.id in s||(s[A.id]=Object.keys(s).length),$.indexOf(N)===-1&&$.push(N);const _=N.inboundLayers.length;for(let R=0;R<_;R++){const I=N.inputTensors[R],P=N.inboundLayers[R],B=N.nodeIndices[R],V=N.tensorIndices[R];l(I,T,$,P,B,V)}for(T.push(N);$.indexOf(N)>=0;)$.splice($.indexOf(N),1);o.push(N)},c=[],h=[];for(const C of this.outputs)l(C,c,h);const d=o.slice().reverse();for(const C of d){r[C.id]=C,C.id in n||(n[C.id]=0);let T=n[C.id];const $=i[C.outboundLayer.id]==null?0:i[C.outboundLayer.id];T=Math.max(T,$),i[C.outboundLayer.id]=T,a[C.outboundLayer.id]=C.outboundLayer,n[C.id]=T;for(let A=0;A<C.inboundLayers.length;A++){const E=C.inboundLayers[A],O=C.nodeIndices[A],N=E.inboundNodes[O],_=n[N.id]==null?0:n[N.id];n[N.id]=Math.max(T+1,_),r[N.id]=N}}const p={};for(const C in n){const T=n[C];T in p||(p[T]=[]),p[T].push(r[C])}const g={};for(const C in i){const T=i[C];T in g||(g[T]=[]),g[T].push(a[C])}let v=Object.keys(g).map(C=>parseInt(C,10)).sort(Fg);this.layers=[];for(const C of v){const T=g[C];T.sort(($,A)=>{const E=s[$.id],O=s[A.id];return E<O?-1:E>O?1:0});for(const $ of T)$ instanceof Yi&&this.internalContainerRefs.push($),this.layers.push($)}this.layersByDepth=g,v=Object.keys(p).map(C=>parseInt(C,10)).sort(Fg);const x=this.inputs.slice(),b=[];for(const C of v)for(const T of p[C]){const $=T.outboundLayer;if($!=null){for(const A of T.inputTensors)if(x.indexOf(A)===-1)throw new _i(`Graph disconnected: cannot obtain value for tensor ${A} at layer "${$.name}". The following previous layers were accessed without issue: ${b}`);for(const A of T.outputTensors)x.push(A);b.push($.name)}}this.nodesByDepth=p;const w=this.layers.map(C=>C.name);for(const C of w){const T=w.filter($=>$===C).length;if(T!==1)throw new _i(`The name "${C}" is used ${T} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new w0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(C=>null),outputMasks:this.outputs.map(C=>null),inputShapes:this.inputs.map(C=>C.shape),outputShapes:this.outputs.map(C=>C.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new Z("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const r={};let i=0;const a=ixt(t);a&&this.parseWeights(t);for(const o of this.layers)for(const[l,c]of o.weights.entries()){const h=a?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(r[h]!=null)throw new Z(`Duplicate weight name: ${h}`);r[h]=c,i++}const s=[];for(const o in t){let l=o;if(r[o]==null){const c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[l]!=null)s.push([r[l],t[o]]);else if(n)throw new Z(`Provided weight data has no target variable: ${o}`);delete r[l]}if(n){const o=[];for(const l in r)o.push(l);if(o.length>0)throw new Z(`${o.length} of ${i} weights are not set: ${o}`)}OI(s)}parseWeights(t){for(const n in Object.keys(t)){const r=n.split("/"),i=["vars","layer_checkpoint_dependencies"],a=r.map(s=>s.startsWith("_")?s.slice(1):s).filter(s=>!i.includes(s)).join("/");a!==n&&(t[a]=t[n],delete t[n])}}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${Lq}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const r=fA(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return st(()=>{t=Ee(t);const r=new io;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return Eh(this.outputs,r,n)})}computeMask(t,n){return st(()=>{t=Ee(t);let r;return n==null?r=Rl(null,t.length):r=Ee(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const n=uv(t);if(n.length!==this.inputLayers.length)throw new Z(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let o=0;o<n.length;o++){const l=this.inputLayers[o],c=n[o],h=l.name+"_0_0";r[h]=c}const i=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Fg);if(i.length>1)for(const o of i){const l=this.nodesByDepth[o];for(const c of l){const h=c.outboundLayer;if(this.inputLayers.map(x=>x.id).indexOf(h.id)!==-1)continue;const d=[];for(let x=0;x<c.inboundLayers.length;x++){const b=c.inboundLayers[x],w=c.nodeIndices[x],C=c.tensorIndices[x],T=`${b.name}_${w}_${C}`,$=r[T];d.push($)}const p=h.computeOutputShape(Or(d)),g=uv(p),v=h.inboundNodes.indexOf(c);for(let x=0;x<g.length;x++){const b=`${h.name}_${v}_${x}`;r[b]=g[x]}}}const a=[],s=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],h=this.outputLayersTensorIndices[o],d=`${l.name}_${c}_${h}`;s.push(d)}for(let o=0;o<s.length;o++){const l=s[o];wa(l in r),a.push(r[l])}return Or(a)}runInternalGraph(t,n){n==null&&(n=Rl(null,t.length));const r={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],h=t[l],d=n[l];r[c.id]=[h,d]}const i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Fg);for(const l of i){const c=this.nodesByDepth[l];for(const h of c){const d=h.outboundLayer,p=h.inputTensors,g=h.outputTensors,v=new Array;for(const x of p)x.id in r&&v.push(r[x.id]);if(v.length===p.length){let x={},b,w,C,T;if(h.callArgs!=null&&(x=h.callArgs),v.length===1){const[$,A]=v[0];x.mask==null&&(x.mask=A),C=Ee(d.call($,x)),T=Ee(d.computeMask($,A)),b=[$],w=[A]}else b=v.map($=>$[0]),w=v.map($=>$[1]),x.mask==null&&(x.mask=w),C=Ee(d.call(b,x)),T=Ee(d.computeMask(b,w));if(d.activityRegularizer)throw new te("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let $=0;$<g.length;++$){const A=g[$],E=C[$],O=T[$];r[A.id]=[E,O]}}}}const a=[],s=[],o=[];for(const l of this.outputs){wa(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[c,h]=r[l.id];o.push(c.shape),a.push(c),s.push(h)}return[a,s,o]}buildNodeConversionMap(t){const n={};let r;for(const i of this.layers){r=i instanceof Yi?1:0;for(let a=0;a<i.inboundNodes.length;a++){const s=Yi.nodeKey(i,a);this.containerNodes.has(s)&&(n[s]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new Z("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const r of this.layers)if(r.name===t)return r;throw new Z(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new Z(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return st(()=>{const t=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const i=Yi.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const s of this.layers){const o=s.getClassName(),l=s.getConfig(),c=[];for(let d=0;d<s.inboundNodes.length;d++){const p=s.inboundNodes[d],g=Yi.nodeKey(s,d);let v={};if(this.containerNodes.has(g)){if(p.callArgs)try{JSON.stringify(p.callArgs),v=p.callArgs}catch{console.warn(`Layer ${s.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),v={}}if(p.inboundLayers.length>0){const x=[];for(let b=0;b<p.inboundLayers.length;b++){const w=p.inboundLayers[b],C=p.nodeIndices[b],T=p.tensorIndices[b],$=Yi.nodeKey(w,C);let A=n[$];A==null&&(A=0),x.push([w.name,A,T,v])}c.push(x)}}}const h={};h.name=s.name,h.className=o,h.config=l,h.inboundNodes=c,r.push(h)}t.layers=r;const i=[];for(let s=0;s<this.inputLayers.length;s++){const o=this.inputLayers[s],l=this.inputLayersNodeIndices[s],c=Yi.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let h=n[c];h==null&&(h=0);const d=this.inputLayersTensorIndices[s];i.push([o.name,h,d])}t.inputLayers=i;const a=[];for(let s=0;s<this.outputLayers.length;s++){const o=this.outputLayers[s],l=this.outputLayersNodeIndices[s],c=Yi.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let h=n[c];h==null&&(h=0);const d=this.outputLayersTensorIndices[s];a.push([o.name,h,d])}return t.outputLayers=a,t}static fromConfig(t,n,r={},i=!1){const a={},s={};function o(b,w){b.name in s?s[b.name].push(w):s[b.name]=[w]}function l(b,w){const C=[];let T;for(const $ of w){const A=$[0],E=$[1],O=$[2];if(T=$[3]==null?{}:$[3],!(A in a)){o(b,w);return}const N=a[A];if(N.inboundNodes.length<=E){o(b,w);return}const _=N.inboundNodes[E];C.push(_.outputTensors[O])}C.length>0&&b.apply(Or(C),T)}function c(b){const w=b.name,C=ds(b,n.customObjects!=null?n.customObjects:{});C.setFastWeightInitDuringBuild(i),a[w]=C,b.inboundNodes.forEach($=>{if(!($ instanceof Array))throw new Z(`Corrupted configuration, expected array for nodeData: ${$}`);o(C,$)})}const h=n.name,d=n.layers;for(const b of d)c(b);for(;!Ubt(s);)for(const b of d){const w=a[b.name];if(w.name in s){const C=s[w.name];delete s[w.name];for(const T of C)l(w,T)}}const p=[],g=[],v=n.inputLayers;for(const b of v){const w=b[0],C=b[1],T=b[2];wa(w in a);const A=a[w].inboundNodes[C].outputTensors;p.push(A[T])}const x=n.outputLayers;for(const b of x){const w=b[0],C=b[1],T=b[2];wa(w in a);const A=a[w].inboundNodes[C].outputTensors;g.push(A[T])}return new t({inputs:p,outputs:g,name:h})}get stateful(){if(this._stateful)throw new Z("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){st(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function axt(e,t,n){const r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(i=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){const i=[];return t.forEach(a=>{a in e?i.push(e[a]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function Bq(e,t){return axt(e,t,"classWeight")}async function zq(e,t,n,r){if(n!=null){const i=st(()=>{if(e.shape.length===1)return ml(e);if(e.shape.length===2){if(e.shape[1]>1)return xd(e,1);if(e.shape[1]===1)return nt(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await i.data());oe(i);const s=[];return a.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);s.push(n[o])}),Tn(s,"float32")}else return null}function sxt(e,t){return J(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const oxt=32;function jq(e,t){let n,r;const i=t;n=i.xs,r=i.ys,j(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const a=zz("input",e.inputNames,n),s=zz("output",e.outputNames,r),o=a[0].shape[0];j(a.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),j(s.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let l=0;l<a.length;l++)j(a[l].shape[0]===o,()=>`Batch size mismatch: input ${e.inputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);for(let l=0;l<s.length;l++)j(s[l].shape[0]===o,()=>`Batch size mismatch: output ${e.outputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${e.inputNames[0]}.`);return{xs:a,ys:s}}function zz(e,t,n){if(n instanceof Cn)return[n];if(Array.isArray(n))return j(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{const r=[];for(const i of t){if(n[i]==null)throw new Z(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function lxt(e){if(e.length===3)throw new te("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function uxt(e,t,n){const r=n.batchesPerEpoch!=null;if(j(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),j(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),j(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),j(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),j(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const i=n.validationData!=null;let a,s;if(i)if(jz(n.validationData))j(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const b=lxt(n.validationData);a=b.xs,s=b.ys}const o=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let c;i?c=l.slice().concat(l.map(b=>"val_"+b)):c=l.slice();const h=Oq(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:p,history:g}=Nq(h,d,n.epochs,null,null,cxt(t,n),null,i,c);p.setModel(e),e.history=g,await p.onTrainBegin(),e.stopTraining_=!1;let v=n.initialEpoch==null?0:n.initialEpoch,x=await t.iterator();for(;v<n.epochs;){const b={};await p.onEpochBegin(v);let w=0,C=0;for(r||(x=await t.iterator());!r||w<n.batchesPerEpoch;){const T=await x.next();if(r&&T.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(T.value!=null){const{xs:$,ys:A}=jq(e,T.value),E={};E.batch=C,E.size=$[0].shape[0],await p.onBatchBegin(C,E);const O=[];if(n.classWeight!=null){const R=Bq(n.classWeight,e.outputNames);for(let I=0;I<R.length;++I)O.push(await zq(A[I],null,R[I]))}const N=$.concat(A).concat(O),_=o(N);oe(N);for(let R=0;R<l.length;++R){const I=l[R],P=_[R];E[I]=P,Ea(P)}await p.onBatchEnd(C,E),Iq(E),C++,w++}if(r?w>=n.batchesPerEpoch:T.done){if(i){let $;jz(n.validationData)?$=Ee(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):$=Ee(e.evaluate(a,s,{batchSize:n.validationBatchSize==null?oxt:n.validationBatchSize,verbose:0}));for(let A=0;A<e.metricsNames.length;++A)b[`val_${e.metricsNames[A]}`]=$[A]}break}if(e.stopTraining_)break}if(await p.onEpochEnd(v,b),v++,e.stopTraining_)break}return await p.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function cxt(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function jz(e){return typeof e.iterator=="function"}function fxt(e){return typeof e.next=="function"}async function hxt(e,t,n){n=n||{};const r=n.batches!=null,i=e.testFunction;let a=[];if(n.verbose>0)throw new te("Verbose mode is not implemented yet.");j(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const s=fxt(t)?t:await t.iterator();let o=0,l=0;for(;!r||l<n.batches;){const c=await s.next();if(a=st(()=>{if(c.value){const{xs:h,ys:d}=jq(e,c.value),p=h.concat(d),g=st(()=>i(p));if(oe(p),l===0)for(let x=0;x<g.length;++x)a.push(de(0));const v=p[0].shape[0];for(let x=0;x<g.length;++x){const b=g[x],w=a[x];a[x]=st(()=>Ct(a[x],J(v,b))),l>0&&oe(w)}oe(g),o+=v,++l}return a}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<a.length;++c){const h=a[c];a[c]=jt(a[c],o),oe(h)}return Or(a)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function c$(e){j(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function wh(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>yl(r,t,n-t)):yl(e,t,n-t)}function hA(e,t){return st(()=>e==null?null:Array.isArray(e)?e.map(n=>hA(n,t)):mq(e,t.dtype==="int32"?t:_t(t,"int32")))}function f$(e,t){const n=[];let r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function Uq(e){const t=[];e instanceof Cn&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(r.rank===1)t.push(Qp(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Ki(e,t){if(e==null)return;const n=[];if(t instanceof Cn)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(const i in t){const a=t[i];n.push(a.id)}const r=[];if(e instanceof Cn)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(e!=null)for(const i in e){const a=e[i];n.indexOf(a.id)===-1&&r.push(a)}r.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dxt(e){return e instanceof Cn}function dA(e){return Array.isArray(e)}function Uz(e){return!dxt(e)&&!dA(e)}function Vz(e,t,n,r=!0,i=""){if(t==null||t.length===0){if(e!=null){let s=!1;if(dA(e)&&e.length>0)s=!0;else if(Uz(e)){for(const o in e)if(e.hasOwnProperty(o)){s=!0;break}}else s=!0;if(s)throw new Z(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(s=>null);let a;if(Uz(e)){e=e,a=[];for(const s of t){if(e[s]==null)throw new Z(`No data provided for "${s}". Need data for each key in: ${t}`);a.push(e[s])}}else if(dA(e)){if(e=e,e.length!==t.length)throw new Z(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);a=e}else{if(e=e,t.length>1)throw new Z(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);a=[e]}if(a=Uq(a),n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;const o=a[s];if(o.shape.length!==n[s].length)throw new Z(`Error when checking ${i}: expected ${t[s]} to have ${n[s].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;const c=o.shape[l],h=n[s][l];if(h!=null&&h>=0&&c!==h)throw new Z(`${i} expected a batch of elements where each example has shape [${n[s].slice(1,n[s].length)}] (i.e.,tensor shape [*,${n[s].slice(1,n[s].length)}]) but the ${i} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return a}function pxt(e,t,n){const r=co(e.map(a=>a.shape[0]));r.sort();const i=co(t.map(a=>a.shape[0]));if(i.sort(),r.length>1)throw new Z(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(a=>a.shape))}`);if(i.length>1)throw new Z(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(r.length>0&&i.length>0&&!we(r,i))throw new Z(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function mxt(e,t,n){const r=[S0,C0,kd];for(let i=0;i<e.length;++i){const a=e[i],s=t[i],o=n[i];if(s!=null){if(s===kd&&a.shape[a.shape.length-1]===1)throw new Z(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(s)!==-1){const l=a.shape.slice(1),c=o.slice(1);for(let h=0;h<l.length;++h){const d=l[h],p=c[h];if(p!=null&&d!==p)throw new Z(`A target Tensor with shape ${a.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function Wz(e,t,n,r=!0,i=""){let a;if(Array.isArray(e)){if(e.length!==t.length)throw new Z(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);a=e}else{if(t.length>1)throw new Z(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);a=[e]}if(n!=null)for(let s=0;s<t.length;++s){if(n[s]==null)continue;const o=a[s];if(o.shape.length!==n[s].length)throw new Z(`Error when checking ${i}: expected ${t[s]} to have ${n[s].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;const c=o.shape[l],h=n[s][l];if(h!=null&&h!==c)throw new Z(`Error when checking ${i}: expected ${t[s]} to have shape ${JSON.stringify(n[s])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function gxt(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{const r=[];for(const i of t){let a=n.hasOwnProperty(i)?n[i]:[];Array.isArray(a)||(a=[a]),r.push(a)}return r}}const yxt="layers-model";class rc extends Yi{constructor(t){super(t),this.isTraining=!1}summary(t,n,r=console.log){if(!this.built)throw new Z("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");J0t(this,t,n,r)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=Q0t(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof Oo))throw new Z("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const s in t.loss)if(this.outputNames.indexOf(s)===-1)throw new Z(`Unknown entry in loss dictionary: "${s}". Only expected the following keys: ${this.outputNames}`);for(const s of this.outputNames)t.loss[s]==null&&console.warn(`Output "${s}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${s} during training`),n.push(u$(t.loss[s]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Z(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(o=>u$(o))}else{const s=u$(t.loss);this.outputs.forEach(o=>{n.push(s)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){const o=this.internalOutputShapes[s],l=this.outputNames[s];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[s])}const r=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],gl("loss",()=>{for(let s=0;s<this.outputs.length;++s){if(r.indexOf(s)!==-1)continue;const o=this.lossFunctions[s];this.outputs.length>1&&(this.metricsTensors.push([o,s]),this.metricsNames.push(this.outputNames[s]+"_loss"))}});const i=gxt(t.metrics,this.outputNames),a=(s,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[s]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,s])};gl("metric",()=>{for(let s=0;s<this.outputs.length;++s){if(r.indexOf(s)!==-1)continue;const o=i[s];(c=>{const h="";let d,p,g;for(const v of c){if(typeof v=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(v)!==-1){const b=this.internalOutputShapes[s];b[b.length-1]===1||this.lossFunctions[s]===C0?["accuracy","acc"].indexOf(v)!==-1?p=Rq:["crossentropy","ce"].indexOf(v)!==-1&&(p=U0t):this.lossFunctions[s]===pv?["accuracy","acc"].indexOf(v)!==-1?p=V0t:["crossentropy","ce"].indexOf(v)!==-1&&(p=Pq):["accuracy","acc"].indexOf(v)!==-1?p=Dq:["crossentropy","ce"].indexOf(v)!==-1&&(p=Mq);let w;["accuracy","acc"].indexOf(v)!==-1?w="acc":["crossentropy","ce"].indexOf(v)!==-1&&(w="ce"),g=p,d=h+w}else g=Z0t(v),d=h+zg(v);let x;gl(d,()=>{x=g}),a(s,d,x)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,r={}){const i=r.batchSize==null?32:r.batchSize;c$(i);const s=this.standardizeUserDataXY(t,n,!0,i);try{const o=s[0].concat(s[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,o,i,r.verbose,r.steps);return Or(c)}finally{Ki(s[0],t),Ki(s[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),hxt(this,t,n)}checkNumSamples(t,n,r,i="steps"){let a;if(r!=null){if(a=null,n!=null)throw new Z(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?a=t[0].shape[0]:a=t.shape[0];else throw new Z(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return a}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new Z("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),i=r?n:[n],a=this.retrieveSymbolicTensors(i),s=new io;if(t instanceof Cn&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Z(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)s.add(this.inputs[l],t[l])}else for(const l of this.inputs){const c=t[l.name];if(c==null)throw new Z(`No value is provided for the model's input ${l.name}`);s.add(l,c)}const o=Eh(a,s);return r?o:o[0]}retrieveSymbolicTensors(t){const n=Rl(null,t.length);let r=t.length;for(const i of this.layers){const a=Array.isArray(i.output)?i.output:[i.output],s=a.map(o=>o.name);for(let o=0;o<t.length;++o){const l=s.indexOf(t[o]);if(l!==-1&&(n[o]=a[l],r--),r===0)break}if(r===0)break}if(r>0){const i=[];throw n.forEach((a,s)=>{a==null&&i.push(t[s])}),new Z(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return n}predictLoop(t,n=32,r=!1){return st(()=>{const i=this.checkNumSamples(t);if(r)throw new te("Verbose predictLoop() is not implemented yet.");const a=f$(i,n),s=this.outputs.map(o=>[]);for(let o=0;o<a.length;++o)st(()=>{const c=a[o][0],h=a[o][1],d=wh(t,c,h),p=[];if(Array.isArray(d))for(let v=0;v<d.length;++v)p.push({key:this.inputs[v],value:d[v]});else p.push({key:this.inputs[0],value:d});const g=new io(p);return Eh(this.outputs,g)}).forEach((c,h)=>s[h].push(c));return Or(s.map(o=>_r(o,0)))})}predict(t,n={}){const r=Uq(t);Wz(r,this.inputNames,this.feedInputShapes,!1);try{const i=n.batchSize==null?32:n.batchSize;return c$(i),this.predictLoop(r,i)}finally{Ki(r,t)}}predictOnBatch(t){Wz(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,r=!0,i){if(this.optimizer_==null)throw new _i("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let s=0;s<this.feedOutputShapes.length;++s){const o=this.feedOutputShapes[s];this.feedLossFns[s]===pv?a.push(o.slice(0,o.length-1).concat([1])):a.push(o)}if(t=Vz(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=Vz(n,this.feedOutputNames,a,!1,"target"),pxt(t,n),mxt(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&t[0].shape[0]%i!==0)throw new Z(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,r,i,a=!0,s){const[o,l]=this.standardizeUserDataXY(t,n,a,s);if(r!=null)throw new Error("sample weight is not supported yet.");let c=null;if(i!=null){const h=Bq(i,this.outputNames);c=[];for(let d=0;d<h.length;++d)c.push(await zq(l[d],null,h[d]))}return[o,l,c]}testLoop(t,n,r,i=0,a){return st(()=>{const s=this.checkNumSamples(n,r,a,"steps"),o=[];if(i>0)throw new te("Verbose mode is not implemented yet.");if(a!=null)throw new te("steps mode in testLoop() is not implemented yet");{const l=f$(s,r),c=Tn(oa(0,s));for(let h=0;h<l.length;++h){const d=l[h][0],p=l[h][1],g=yl(c,d,p-d),v=hA(n,g),x=t(v);if(h===0)for(let b=0;b<x.length;++b)o.push(de(0));for(let b=0;b<x.length;++b){const w=x[b];o[b]=Ct(o[b],J(p-d,w))}}for(let h=0;h<o.length;++h)o[h]=jt(o[h],s)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let r=0;r<t.length;++r){const i=t[r];let a=i;if(Ez(t,i)>1){const s=Ez(t.slice(0,r),i);a+=`_${s}`}n.push(a)}return n}makeTrainFunction(){return t=>{const n=[],r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),s=[],o=()=>{const d=[];for(let x=0;x<this.inputs.length;++x)d.push({key:this.inputs[x],value:r[x]});const p=new io(d),g=Eh(this.outputs,p,{training:!0});let v;for(let x=0;x<this.lossFunctions.length;++x){const b=this.lossFunctions[x];let w=b(i[x],g[x]);a[x]!=null&&(w=sxt(w,a[x]));const C=vn(w);n.push(C),x===0?v=w:v=Ct(v,w)}for(let x=0;x<this.metricsTensors.length;++x){let b;if(this.outputs.length>1&&x<this.outputs.length)b=n[x];else{const w=this.metricsTensors[x][0],C=this.metricsTensors[x][1];b=vn(w(i[C],g[C]))}Ea(b),s.push(b)}return v=vn(v),this.calculateLosses().forEach(x=>{v=Ct(v,x)}),v},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(o,!0,l)].concat(s)}}makeTestFunction(){this.testFunction=t=>st(()=>{const n=[];let r;const i=t.slice(0,this.inputs.length),a=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let c=0;c<this.inputs.length;++c)s.push({key:this.inputs[c],value:i[c]});const o=new io(s),l=Eh(this.outputs,o);for(let c=0;c<this.lossFunctions.length;++c){const h=this.lossFunctions[c],d=vn(h(a[c],l[c]));c===0?r=d:r=Ct(r,d),n.push(r)}for(let c=0;c<this.metricsTensors.length;++c){const h=this.metricsTensors[c][0],d=this.metricsTensors[c][1],p=vn(h(a[d],l[d]));n.push(p)}return n})}async fit(t,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let i,a,s,o,l,c,h,d,p;try{const g=r.batchSize==null?32:r.batchSize;c$(g);const x=await this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,!1,g);i=x[0],a=x[1],p=x[2];let b=!1,w;if(r.validationData!=null&&r.validationData.length>0){if(b=!0,r.validationData.length===2)l=r.validationData[0],c=r.validationData[1];else throw r.validationData.length===3?new te("validationData including sample weights is not supported yet."):new Z(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const R=await this.standardizeUserData(l,c,null,null,!0,g);h=R[0],d=R[1],w=h.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){b=!0;const _=Math.floor(i[0].shape[0]*(1-r.validationSplit)),R=i[0].shape[0];h=wh(i,_,R),s=i,i=wh(i,0,_),d=wh(a,_,R),o=a,a=wh(a,0,_),w=h.concat(d)}else r.validationSteps!=null&&(b=!0);const C=i.concat(a).concat(p);this.checkTrainableWeightsConsistency();const T=this.makeTrainFunction(),$=this.getDedupedMetricsNames();let A,E;b?(this.makeTestFunction(),A=this.testFunction,E=$.slice().concat($.map(_=>"val_"+_))):(A=null,w=[],E=$.slice());const O=Oq(r.callbacks,r.yieldEvery);return await this.fitLoop(T,C,$,g,r.epochs,r.verbose,O,A,w,r.shuffle,E,r.initialEpoch,null,null)}finally{this.isTraining=!1,Ki(i,t),Ki(a,n),Ki(s,t),Ki(o,n),Ki(h,l),Ki(d,c),p!=null&&oe(p)}}async fitLoop(t,n,r,i,a,s,o,l,c,h,d,p,g,v){i==null&&(i=32),a==null&&(a=1),h==null&&(h=!0),p==null&&(p=0);let x=!1;if(l!=null&&c!=null&&(x=!0),v!=null&&(x=!0,g==null))throw new Z("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const b=this.checkNumSamples(n,i,g,"steps_per_epoch");let w;b!=null&&(w=oa(0,b)),s==null&&(s=1);const{callbackList:C,history:T}=Nq(o,s,a,p,b,g,i,x,d);C.setModel(this),this.history=T,await C.onTrainBegin(),this.stopTraining_=!1;for(let $=p;$<a;++$){await C.onEpochBegin($);const A={};if(g!=null)throw new te("stepsPerEpoch mode is not implemented yet.");{if(h==="batch")throw new te("batch shuffling is not implemneted yet");h&&eft(w);const E=Tn(w),O=f$(b,i);for(let N=0;N<O.length;++N){const _={};if(await C.onBatchBegin(N,_),st(()=>{const R=O[N][0],I=O[N][1],P=yl(E,R,I-R);_.batch=N,_.size=I-R;const B=hA(n,P),V=t(B);for(let z=0;z<r.length;++z){const M=r[z],U=V[z];_[M]=U,Ea(U)}if(N===O.length-1&&x){const z=this.testLoop(l,c,i);for(let M=0;M<r.length;++M){const U=r[M],W=z[M];Ea(W),A["val_"+U]=W}}}),await C.onBatchEnd(N,_),Iq(_),this.stopTraining_)break}E.dispose()}if(await C.onEpochEnd($,A),this.stopTraining_)break}return await C.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,n){return uxt(this,t,n)}async trainOnBatch(t,n){const r=await this.standardizeUserData(t,n),i=r[0],a=r[1],o=this.makeTrainFunction()(i.concat(a)),l=[];for(const c of o){const h=await c.data();l.push(h[0])}return oe(o),Ki(r[0],t),Ki(r[1],n),Or(l)}getNamedWeights(t){const n=[],r=t!=null&&t.trainableOnly,i=r?this.trainableWeights:this.weights,a=this.getWeights(r);for(let s=0;s<i.length;++s)r&&!i[s].trainable||n.push({name:i[s].originalName,tensor:a[s]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=ez().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-ez().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=is(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>is(n))}else{const n=Object.keys(this.loss);t={};const r=this.loss;for(const i of n)if(typeof r[i]=="string")t[i]=is(r[i]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[is(zg(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>is(zg(t)));{const t={};for(const n in this.metrics)t[n]=is(zg(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=cA(t.optimizer_config),r=ds(n);let i;if(typeof t.loss=="string")i=al(t.loss);else if(Array.isArray(t.loss))i=t.loss.map(s=>al(s));else if(t.loss!=null){i={};for(const s in t.loss)i[s]=al(t.loss[s])}let a;if(Array.isArray(t.metrics))a=t.metrics.map(s=>al(s));else if(t.metrics!=null){a={};for(const s in t.metrics)a[s]=al(t.metrics[s])}this.compile({loss:i,metrics:a,optimizer:r})}async save(t,n){if(typeof t=="string"){const c=Yft(t);if(c.length===0)throw new Z(`Cannot find any save handlers for URL '${t}'`);if(c.length>1)throw new Z(`Found more than one (${c.length}) save handlers for URL '${t}'`);t=c[0]}if(t.save==null)throw new Z("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await rz(this.getNamedWeights(n)),o={modelTopology:this.toJSON(null,!1),format:yxt,generatedBy:`TensorFlow.js tfjs-layers v${Lq}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:h,specs:d}=await rz(await this.optimizer.getWeights(),c);r.specs.push(...d),r.data=Kft([r.data,h])}return this.userDefinedMetadata!=null&&(Bz(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=r.data,o.weightSpecs=r.specs,t.save(o)}setUserDefinedMetadata(t){Bz(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}rc.className="Model";St(rc);class Vq extends rc{}Vq.className="Functional";St(Vq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ed extends rc{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:b0("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new Z(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof Ed||t instanceof rc;let r;if(n){if(r=t,r.outputs.length!==1)throw new Z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new Z("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new Z("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=b0t({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new Z(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new Z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Tq(this.outputs[0])}this.inboundNodes=[],new w0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Rl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(be(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new rc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,r=console.log){this.built||this.build(),super.summary(t,n,r)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,r={}){if(!this.built)throw new _i("The model needs to be compiled before being used.");return this.model.evaluate(t,n,r)}async evaluateDataset(t,n){if(!this.built)throw new _i("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,r={}){if(!this.built)throw new _i("The model needs to be compiled before being used.");return this.model.fit(t,n,r)}async fitDataset(t,n){if(!this.built)throw new _i("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,r={},i=!1){let a,s={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new Z("Legacy serialization format not supported yet.");a=n}else j(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,s=n;const o=new t(s);if(!(o instanceof Ed))throw new te(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of a){const h=ds(l,void 0,i);i&&h.setFastWeightInitDuringBuild(!0),o.add(h)}return o}set stopTraining(t){if(this.model==null)throw new Z("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new Z("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),t.push(r)}return{name:this.name,layers:t}}}Ed.className="Sequential";St(Ed);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let fr=class extends Jc{getConfig(){return{}}};class Wq extends fr{apply(t,n=1){return r0t(t,n)}}Wq.className="elu";St(Wq);class Gq extends fr{apply(t){return oG(t)}}Gq.className="selu";St(Gq);class qq extends fr{apply(t){return Dr(t)}}qq.className="relu";St(qq);class Hq extends fr{apply(t){return st(()=>Td(6,Dr(t)))}}Hq.className="relu6";St(Hq);class Xq extends fr{apply(t){return t}}Xq.className="linear";St(Xq);class Kq extends fr{apply(t){return Yc(t)}}Kq.className="sigmoid";St(Kq);class Yq extends fr{apply(t){return a0t(t)}}Yq.className="hardSigmoid";St(Yq);class Zq extends fr{apply(t){return Wp(t)}}Zq.className="softplus";St(Zq);class Qq extends fr{apply(t){return i0t(t)}}Qq.className="softsign";St(Qq);class Jq extends fr{apply(t){return c0(t)}}Jq.className="tanh";St(Jq);let DI=class extends fr{apply(t,n=-1){return FE(t,n)}};DI.className="softmax";St(DI);class tH extends fr{apply(t,n=-1){return JW(t,n)}}tH.className="logSoftmax";St(tH);class eH extends fr{apply(t){return st(()=>st(()=>{const n=Math.sqrt(2),r=J(.5,Ct(1,XW(jt(t,n))));return J(t,r)}))}}eH.className="gelu";St(eH);class nH extends fr{apply(t){return st(()=>J(.5,J(t,Ct(1,c0(J(Nn(jt(2,Math.PI)),Ct(t,J(.044715,Ol(t,3)))))))))}}nH.className="gelu_new";St(nH);class rH extends fr{apply(t){return st(()=>J(t,c0(Wp(t))))}}rH.className="mish";St(rH);class iH extends fr{apply(t,n=1){return st(()=>J(Yc(J(t,n)),t))}}iH.className="swish";St(iH);function mo(e){return e.getClassName()}function h$(e,t={}){return Zp(e,Oi.getMap().classNameMap,t,"activation")}function go(e){if(e==null){const t={};return t.className="linear",t.config={},h$(t)}if(typeof e=="string"){const t={};return t.className=e,t.config={},h$(t)}else return e instanceof fr?e:h$(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vxt(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}class aH extends Jc{}class sH extends aH{constructor(t){super(),vxt(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return st(()=>{let n=Bn([1]);return this.hasL1&&(n=Ct(n,Rt(J(this.l1,sr(t))))),this.hasL2&&(n=Ct(n,Rt(J(this.l2,Jp(t))))),nt(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}sH.className="L1L2";St(sH);const Gz={l1l2:"L1L2"};function Le(e){return xI(e)}function qz(e,t={}){return Zp(e,Oi.getMap().classNameMap,t,"regularizer")}function Ze(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in Gz?Gz[e]:e,config:{}};return qz(n)}else return e instanceof aH?e:qz(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oH extends ie{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=Yt(t);let r=Dr(t);return this.maxValue!=null&&(r=di(r,0,this.maxValue)),r}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}oH.className="ReLU";St(oH);class lH extends ie{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=Yt(t);return kE(r,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}lH.className="LeakyReLU";St(lH);class uH extends ie{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Ke(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Ze(t.alphaRegularizer),this.alphaConstraint=In(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new Z(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=be(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)n[i-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let i=1;i<t.length;++i)r[i]=t[i];this.inputSpec=[new An({ndim:t.length,axes:r})],this.built=!0}call(t,n){return t=Yt(t),RE(t,this.alpha.read())}getConfig(){const t={alphaInitializer:tn(this.alphaInitializer),alphaRegularizer:Le(this.alphaRegularizer),alphaConstraint:En(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}uH.className="PReLU";St(uH);let cH=class extends ie{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new te(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=Yt(t);return h0(r)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}};cH.className="ELU";St(cH);class fH extends ie{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const r=Yt(t);return J(r,_t(pi(r,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}fH.className="ThresholdedReLU";St(fH);class hH extends ie{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new DI().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){return st(()=>{let r=Yt(t);const i=n.mask;if(i!=null){const a=J(Vt(Io(r.shape),_t(i,r.dtype)),de(-1e9));r=Ct(r,a)}return this.axis instanceof Array?this.axis.length>1?Da(Vt(r,tG(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}hH.className="Softmax";St(hH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ic(e,t,n){if(typeof e=="number")return Rl(e,t);if(e.length!==t)throw new Z(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){const i=e[r];if(!Jbt(i))throw new Z(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function sa(e,t,n,r,i=1){if(e==null)return e;const a=t+(t-1)*(i-1);let s;return n==="same"?s=e:s=e-a+1,Math.floor((s+r-1)/r)}function Sa(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+po([n-t,0]);else if(r==="same")e=e*t;else throw new Z(`Unsupport padding mode: ${r}.`);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MI(e,t){return st(()=>(hn(t),t==="channelsFirst"?me(e,[0,2,3,1]):e))}function dH(e,t){return st(()=>(hn(t),t==="channelsFirst"?me(e,[0,2,3,4,1]):e))}function bxt(e,t,n,r=1,i="valid",a,s=1){return st(()=>{if(a==null&&(a=la()),hn(a),e.shape.length!==3)throw new Z(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new Z(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new Z(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(a==="channelsFirst"&&(e=me(e,[0,2,1])),i==="causal")throw new te("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=VW(e,t,r,i==="same"?"same":"valid","NWC",s);return n!=null&&(o=fa(o,n)),o})}function Hz(e,t,n,r=[1,1],i="valid",a,s,o=null){return st(()=>{if(a==null&&(a=la()),hn(a),e.rank!==3&&e.rank!==4)throw new Z(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new Z(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let l=MI(e,a);if(i==="causal")throw new te("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Egt({x:l,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),a==="channelsFirst"&&(l=me(l,[0,3,1,2])),l})}function xxt(e,t,n,r=[1,1,1],i="valid",a,s){return st(()=>{if(a==null&&(a=la()),hn(a),e.rank!==4&&e.rank!==5)throw new Z(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new Z(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let o=dH(e,a);if(i==="causal")throw new te("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=kdt(o,t,r,i==="same"?"same":"valid","NDHWC",s),n!=null&&(o=fa(o,n)),a==="channelsFirst"&&(o=me(o,[0,4,1,2,3])),o})}class T0 extends ie{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",T0.verifyArgs(n),this.rank=t,jn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new te(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=ic(n.kernelSize,t,"kernelSize"),this.strides=ic(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,mi(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,hn(this.dataFormat),this.activation=go(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Ke(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=In(n.biasConstraint),this.biasRegularizer=Ze(n.biasRegularizer),this.activityRegularizer=Ze(n.activityRegularizer),this.dilationRate=ic(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Z(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Z(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Z(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(wa("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!wI(t.kernelSize,"number",1,3))throw new Z(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:mo(this.activation),useBias:this.useBias,biasInitializer:tn(this.biasInitializer),biasRegularizer:Le(this.biasRegularizer),activityRegularizer:Le(this.activityRegularizer),biasConstraint:En(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class tf extends T0{constructor(t,n){super(t,n),this.kernel=null,tf.verifyArgs(n),this.filters=n.filters,jn(this.filters,"filters"),this.kernelInitializer=Ke(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=In(n.kernelConstraint),this.kernelRegularizer=Ze(n.kernelRegularizer)}build(t){t=be(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Z(`The channel dimension of the input should be defined. Found ${t[n]}`);const r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return st(()=>{t=Yt(t);let r;const i=this.bias==null?null:this.bias.read(),a=uq(this.activation.getClassName());if(a!=null&&this.rank===2)r=Hz(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)r=bxt(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=Hz(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=xxt(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new te("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=be(t);const n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let a=0;a<r.length;++a){const s=sa(r[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);n.push(s)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){const t={filters:this.filters,kernelInitializer:tn(this.kernelInitializer),kernelRegularizer:Le(this.kernelRegularizer),kernelConstraint:En(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new Z(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class rm extends tf{constructor(t){super(2,t),rm.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!wI(t.kernelSize,"number",1,2))throw new Z(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}rm.className="Conv2D";St(rm);class im extends tf{constructor(t){super(3,t),im.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new Z(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}im.className="Conv3D";St(im);class pH extends rm{constructor(t){if(super(t),this.inputSpec=[new An({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Z(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=be(t),t.length!==4)throw new Z("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Z("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new An({ndim:4,axes:{[n]:r}})],this.built=!0}call(t,n){return st(()=>{let r=Yt(t);if(r.shape.length!==4)throw new Z(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,a=i[0];let s,o;this.dataFormat==="channelsFirst"?(s=2,o=3):(s=1,o=2);const l=i[s],c=i[o],h=this.kernelSize[0],d=this.kernelSize[1],p=this.strides[0],g=this.strides[1],v=Sa(l,p,h,this.padding),x=Sa(c,g,d,this.padding),b=[a,v,x,this.filters];this.dataFormat!=="channelsLast"&&(r=me(r,[0,2,3,1]));let w=WW(r,this.kernel.read(),b,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=me(w,[0,3,1,2])),this.bias!=null&&(w=fa(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(t){t=be(t);const n=t.slice();let r,i,a;this.dataFormat==="channelsFirst"?(r=1,i=2,a=3):(r=3,i=1,a=2);const s=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[r]=this.filters,n[i]=Sa(n[i],l,s,this.padding),n[a]=Sa(n[a],c,o,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}pH.className="Conv2DTranspose";St(pH);class mH extends im{constructor(t){if(super(t),this.inputSpec=[new An({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Z(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=be(t),t.length!==5)throw new Z("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Z("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new An({ndim:5,axes:{[n]:r}})],this.built=!0}call(t,n){return st(()=>{let r=Yt(t);if(r.shape.length!==5)throw new Z(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,a=i[0];let s,o,l;this.dataFormat==="channelsFirst"?(l=2,s=3,o=4):(l=1,s=2,o=3);const c=i[l],h=i[s],d=i[o],p=this.kernelSize[0],g=this.kernelSize[1],v=this.kernelSize[2],x=this.strides[0],b=this.strides[1],w=this.strides[2],C=Sa(c,x,p,this.padding),T=Sa(h,b,g,this.padding),$=Sa(d,w,v,this.padding),A=[a,C,T,$,this.filters];this.dataFormat!=="channelsLast"&&(r=me(r,[0,2,3,4,1]));let E=Odt(r,this.kernel.read(),A,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(E=me(E,[0,4,1,2,3])),this.bias!==null&&(E=fa(E,this.bias.read(),this.dataFormat)),this.activation!==null&&(E=this.activation.apply(E)),E})}computeOutputShape(t){t=be(t);const n=t.slice();let r,i,a,s;this.dataFormat==="channelsFirst"?(r=1,i=2,a=3,s=4):(r=4,i=1,a=2,s=3);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],h=this.strides[0],d=this.strides[1],p=this.strides[2];return n[r]=this.filters,n[i]=Sa(n[i],h,o,this.padding),n[a]=Sa(n[a],d,l,this.padding),n[s]=Sa(n[s],p,c,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}mH.className="Conv3DTranspose";St(mH);class gH extends tf{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new Z("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new Z("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new Z(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Ke(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Ze(n.depthwiseRegularizer),this.depthwiseConstraint=In(n.depthwiseConstraint),this.pointwiseInitializer=Ke(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Ze(n.pointwiseRegularizer),this.pointwiseConstraint=In(n.pointwiseConstraint)}build(t){if(t=be(t),t.length<this.rank+2)throw new Z(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new Z(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(r*this.depthMultiplier,this.filters);const s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new An({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(t,n){return st(()=>{t=Yt(t);let r;if(this.rank===1)throw new te("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=me(t,[0,2,3,1])),r=lG(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=fa(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=me(r,[0,3,1,2])),r})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=tn(this.depthwiseInitializer),t.pointwiseInitializer=tn(this.pointwiseInitializer),t.depthwiseRegularizer=Le(this.depthwiseRegularizer),t.pointwiseRegularizer=Le(this.pointwiseRegularizer),t.depthwiseConstraint=En(this.depthwiseConstraint),t.pointwiseConstraint=En(this.pointwiseConstraint),t}}gH.className="SeparableConv";class yH extends gH{constructor(t){super(2,t)}}yH.className="SeparableConv2D";St(yH);class $0 extends tf{constructor(t){super(1,t),$0.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!wI(t.kernelSize,"number",1,1))throw new Z(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}$0.className="Conv1D";St($0);class vH extends ie{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return st(()=>{if(t=Yt(t),this.dataFormat==="channelsLast"){const r=Bg(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Bg(r,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Bg(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Bg(r,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}vH.className="Cropping2D";St(vH);class bH extends ie{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,hn(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,Ybt(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],r=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,r]}else{const n=t[1]==null?null:this.size[0]*t[1],r=t[2]==null?null:this.size[1]*t[2];return[t[0],n,r,t[3]]}}call(t,n){return st(()=>{let r=Yt(t);const i=r.shape;if(this.dataFormat==="channelsFirst"){r=me(r,[0,2,3,1]);const a=this.size[0]*i[2],s=this.size[1]*i[3],o=this.interpolation==="nearest"?us.resizeNearestNeighbor(r,[a,s]):us.resizeBilinear(r,[a,s]);return me(o,[0,3,1,2])}else{const a=this.size[0]*i[1],s=this.size[1]*i[2];return this.interpolation==="nearest"?us.resizeNearestNeighbor(r,[a,s]):us.resizeBilinear(r,[a,s])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}bH.className="UpSampling2D";St(bH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wxt(e,t,n=[1,1],r="valid",i,a){return st(()=>{i==null&&(i=la()),hn(i);let s=MI(e,i);if(e.rank!==4)throw new Z(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new Z(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return s=TE(s,t,n,r==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(s=me(s,[0,3,1,2])),s})}class xH extends T0{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Ke(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=In(t.depthwiseConstraint),this.depthwiseRegularizer=Ze(t.depthwiseRegularizer)}build(t){if(t=be(t),t.length<4)throw new Z(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new Z(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const r=t[n],i=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return st(()=>{t=Yt(t);let r=wxt(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=fa(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(t){t=be(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=sa(n,this.kernelSize[0],this.padding,this.strides[0]),s=sa(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],i,a,s]:[t[0],a,s,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=tn(this.depthwiseInitializer),t.depthwiseRegularizer=Le(this.depthwiseRegularizer),t.depthwiseConstraint=En(this.depthwiseRegularizer),t}}xH.className="DepthwiseConv2D";St(xH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wH(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new Z("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function SH(e,t,n,r=!1,i,a,s=!1,o=!1){return st(()=>{const l=t.shape.length;if(l<3)throw new Z(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(oa(2,l));t=me(t,c),s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=_t(_t(i,"bool"),"float32"),i.rank===l-1&&(i=Ir(i,-1)),i=me(i,c)),r&&(t=Nl(t,0),i!=null&&(i=Nl(i,0)));const h=[];let d,p=n;const g=t.shape[0],v=_l(t);let x;i!=null&&(x=_l(i));for(let w=0;w<g;++w){const C=v[w],T=st(()=>e(C,p));if(i==null)d=T[0],p=T[1];else{const $=st(()=>{const A=x[w],E=Vt(Bi(A),A),O=Ct(J(T[0],A),J(p[0],E)),N=p.map((_,R)=>Ct(J(T[1][R],A),J(_,E)));return{output:O,newStates:N}});d=$.output,p=$.newStates}o&&h.push(d)}let b;return o&&(b=xs(h,1)),[d,b,p]})}class No extends ie{constructor(t){super(t);let n;if(t.cell==null)throw new Z("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new LI({cells:t.cell}):n=t.cell,n.stateSize==null)throw new Z("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new An({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return oa(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){oA(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let i;if(this.returnSequences?i=[t[0],t[1],r]:i=[t[0],r],this.returnState){const a=[];for(const s of n)a.push([t[0],s]);return[i].concat(a)}else return i}computeMask(t,n){return st(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const i=this.states.map(a=>null);return[r].concat(i)}else return r})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<t;++r)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new te("Constants support is not implemented in RNN yet.");oA(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new An({shape:[n,null,...r]});const i=[t[0]].concat(t.slice(2));this.cell.build(i);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!we(this.stateSpec.map(s=>s.shape[s.shape.length-1]),a))throw new Z(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(s=>new An({shape:[null,s]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){st(()=>{if(!this.stateful)throw new xa("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new Z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>Bn([r,i])):this.states_=[Bn([r,this.cell.stateSize])];else if(t==null)oe(this.states_),this.keptStates!=null&&(oe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>Bn([r,i])):this.states_[0]=Bn([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):oe(this.states_);for(let i=0;i<this.states_.length;++i){const a=t[i],s=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,o=[r,s];if(!we(a.shape,o))throw new Z(`State ${i} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${a.shape}`);this.states_[i]=a}}this.states_=this.states_.map(i=>Ea(i.clone()))})}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const a=wH(t,r,i,this.numConstants);t=a.inputs,r=a.initialState,i=a.constants;let s=[],o=[];if(r!=null){n.initialState=r,s=s.concat(r),this.stateSpec=[];for(const c of r)this.stateSpec.push(new An({shape:c.shape}));o=o.concat(this.stateSpec)}if(i!=null&&(n.constants=i,s=s.concat(i),this.numConstants=i.length),s[0]instanceof Pa){const c=[t].concat(s),h=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=h;const p=super.apply(c,n);return this.inputSpec=d,p}else return super.apply(t,n)}call(t,n){return st(()=>{const r=n==null?null:n.mask,i=n==null?null:n.training;let a=n==null?null:n.initialState;t=Yt(t),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(t));const s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==s)throw new Z(`RNN Layer has ${s} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:i},c=SH((v,x)=>{const b=this.cell.call([v].concat(x),o);return[b[0],b.slice(1)]},t,a,this.goBackwards,r,null,this.unroll,this.returnSequences),h=c[0],d=c[1],p=c[2];this.stateful&&this.resetStates(p,i);const g=this.returnSequences?d:h;return this.returnState?[g].concat(p):g})}getInitialState(t){return st(()=>{let n=Bn(t.shape);return n=Rt(n,[1,2]),n=Qp(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?aA(n,[1,r]):n):this.cell.stateSize>1?[aA(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===No.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(t,n,r={}){const i=n.cell,a=ds(i,r);return new t(Object.assign(n,{cell:a}))}}No.className="RNN";St(No);class A0 extends ie{}class PI extends A0{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,jn(this.units,"units"),this.activation=go(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Ke(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ke(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ke(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ze(t.kernelRegularizer),this.recurrentRegularizer=Ze(t.recurrentRegularizer),this.biasRegularizer=Ze(t.biasRegularizer),this.kernelConstraint=In(t.kernelConstraint),this.recurrentConstraint=In(t.recurrentConstraint),this.biasConstraint=In(t.biasConstraint),this.dropout=_c([1,po([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=_c([1,po([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=be(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return st(()=>{if(t=t,t.length!==2)throw new Z(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let r=t[1];t=t[0];const i=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yo({ones:()=>Bi(t),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yo({ones:()=>Bi(r),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let a;const s=this.dropoutMask,o=this.recurrentDropoutMask;s!=null?a=Na(J(t,s),this.kernel.read()):a=Na(t,this.kernel.read()),this.bias!=null&&(a=fa(a,this.bias.read())),o!=null&&(r=J(r,o));let l=Ct(a,Na(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:mo(this.activation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),recurrentInitializer:tn(this.recurrentInitializer),biasInitializer:tn(this.biasInitializer),kernelRegularizer:Le(this.kernelRegularizer),recurrentRegularizer:Le(this.recurrentRegularizer),biasRegularizer:Le(this.biasRegularizer),activityRegularizer:Le(this.activityRegularizer),kernelConstraint:En(this.kernelConstraint),recurrentConstraint:En(this.recurrentConstraint),biasConstraint:En(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),n)}}PI.className="SimpleRNNCell";St(PI);class CH extends No{constructor(t){t.cell=new PI(t),super(t)}call(t,n){return st(()=>{this.cell.dropoutMask!=null&&(oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:a})})}static fromConfig(t,n){return new t(n)}}CH.className="SimpleRNN";St(CH);class FI extends A0{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new Z("GRUCell does not support reset_after parameter set to true.");this.units=t.units,jn(this.units,"units"),this.activation=go(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=go(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Ke(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ke(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ke(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ze(t.kernelRegularizer),this.recurrentRegularizer=Ze(t.recurrentRegularizer),this.biasRegularizer=Ze(t.biasRegularizer),this.kernelConstraint=In(t.kernelConstraint),this.recurrentConstraint=In(t.recurrentConstraint),this.biasConstraint=In(t.biasConstraint),this.dropout=_c([1,po([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=_c([1,po([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=be(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return st(()=>{if(t=t,t.length!==2)throw new Z(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training==null?!1:n.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yo({ones:()=>Bi(t),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yo({ones:()=>Bi(i),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,s=this.recurrentDropoutMask;let o,l,c;0<this.dropout&&this.dropout<1&&(t=J(t,a[0]));let h=Na(t,this.kernel.read());this.useBias&&(h=fa(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=J(i,s[0]));const d=this.recurrentKernel.read(),[p,g]=fi(d,[2*this.units,this.units],d.rank-1),v=Na(i,p),[x,b,w]=fi(h,3,h.rank-1),[C,T]=fi(v,2,v.rank-1);o=this.recurrentActivation.apply(Ct(x,C)),l=this.recurrentActivation.apply(Ct(b,T));const $=Na(J(l,i),g);c=this.activation.apply(Ct(w,$));const A=Ct(J(o,i),J(Ct(1,Ye(o)),c));return[A,A]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:mo(this.activation),recurrentActivation:mo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),recurrentInitializer:tn(this.recurrentInitializer),biasInitializer:tn(this.biasInitializer),kernelRegularizer:Le(this.kernelRegularizer),recurrentRegularizer:Le(this.recurrentRegularizer),biasRegularizer:Le(this.biasRegularizer),activityRegularizer:Le(this.activityRegularizer),kernelConstraint:En(this.kernelConstraint),recurrentConstraint:En(this.recurrentConstraint),biasConstraint:En(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),n)}}FI.className="GRUCell";St(FI);class TH extends No{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new FI(t),super(t)}call(t,n){return st(()=>{this.cell.dropoutMask!=null&&(oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:a})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}TH.className="GRU";St(TH);class k0 extends A0{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,jn(this.units,"units"),this.activation=go(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=go(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Ke(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ke(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ke(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Ze(t.kernelRegularizer),this.recurrentRegularizer=Ze(t.recurrentRegularizer),this.biasRegularizer=Ze(t.biasRegularizer),this.kernelConstraint=In(t.kernelConstraint),this.recurrentConstraint=In(t.recurrentConstraint),this.biasConstraint=In(t.biasConstraint),this.dropout=_c([1,po([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=_c([1,po([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=be(t);const r=t[t.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,s=this.units;i=new(n=class extends Ui{apply(l,c){const h=a.apply([s]),d=new CI().apply([s]),p=a.apply([s*2]);return Oz(Oz(h,d),p)}},n.className="CustomInit",n)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return st(()=>{const r=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new Z(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let i=t[1];const a=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yo({ones:()=>Bi(t),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yo({ones:()=>Bi(i),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,h,d;0<this.dropout&&this.dropout<1&&(t=J(t,s[0]));let p=Na(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=J(i,o[0])),p=Ct(p,Na(i,this.recurrentKernel.read())),this.useBias&&(p=fa(p,this.bias.read()));const[g,v,x,b]=fi(p,4,p.rank-1);l=this.recurrentActivation.apply(g),c=this.recurrentActivation.apply(v),h=Ct(J(c,a),J(l,this.activation.apply(x))),d=this.recurrentActivation.apply(b);const w=J(d,this.activation.apply(h));return[w,w,h]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:mo(this.activation),recurrentActivation:mo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),recurrentInitializer:tn(this.recurrentInitializer),biasInitializer:tn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Le(this.kernelRegularizer),recurrentRegularizer:Le(this.recurrentRegularizer),biasRegularizer:Le(this.biasRegularizer),activityRegularizer:Le(this.activityRegularizer),kernelConstraint:En(this.kernelConstraint),recurrentConstraint:En(this.recurrentConstraint),biasConstraint:En(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),n)}}k0.className="LSTMCell";St(k0);class $H extends No{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new k0(t),super(t)}call(t,n){return st(()=>{this.cell.dropoutMask!=null&&(oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:a})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}$H.className="LSTM";St($H);class LI extends A0{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return st(()=>{t=t;let r=t.slice(1);const i=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?i.push(r.splice(0,o.stateSize.length)):i.push(r.splice(0,1));i.reverse();const a=[];let s;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];r=i[o],o===0?s=[t[0]].concat(r):s=[s[0]].concat(r),s=l.call(s,n),a.push(s.slice(1))}r=[];for(const o of a.slice().reverse())r.push(...o);return[s[0]].concat(r)})}build(t){oA(t)&&(t=t[0]),t=t;let n;this.cells.forEach((r,i)=>{gl(`RNNCell_${i}`,()=>{r.build(t),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=a=>({className:a.getClassName(),config:a.getConfig()}),i={cells:this.cells.map(n)};return Object.assign(Object.assign({},t),i)}static fromConfig(t,n,r={}){const i=[];for(const a of n.cells)i.push(ds(a,r));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return lA(t)}setWeights(t){const n=[];for(const r of this.cells){const i=r.weights.length,a=t.splice(i);for(let s=0;s<r.weights.length;++s)n.push([r.weights[s],a[s]])}OI(n)}}LI.className="StackedRNNCells";St(LI);function yo(e){const{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:a}=e,s=()=>a!=null?a(t(),n):gq(t(),n),o=()=>tm(s,t,r);return!i||i<=1?Ea(o().clone()):Array(i).fill(void 0).map(o).map(c=>Ea(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Sxt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class AH extends No{constructor(t){if(t.unroll)throw new te("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new te("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new An({ndim:5})]}call(t,n){return st(()=>{if(this.cell.dropoutMask!=null&&(oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new Z("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:a})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return st(()=>{const{stateSize:n}=this.cell,r=t.shape,i=this.computeSingleOutputShape(r),a=[i[0],...i.slice(2)],s=Bn(a);return Array.isArray(n)?Array(n.length).fill(s):[s]})}resetStates(t,n=!1){st(()=>{if(!this.stateful)throw new xa("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,i=this.computeSingleOutputShape(r),a=[i[0],...i.slice(2)];if(r[0]==null)throw new Z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Bn(a)):this.states_=[Bn(a)];else if(t==null)oe(this.states_),this.keptStates!=null&&(oe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Bn(a)):this.states_[0]=Bn(a);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):oe(this.states_);for(let o=0;o<this.states_.length;++o){const l=t[o],c=a;if(!we(l.shape,c))throw new Z(`State ${o} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>Ea(o.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:r,kernelSize:i,padding:a,strides:s,dilationRate:o}=this.cell,l=n==="channelsFirst",c=t[l?3:2],h=t[l?4:3],d=sa(c,i[0],a,s[0],o[0]),p=sa(h,i[1],a,s[1],o[1]);return[...t.slice(0,2),...l?[r,d,p]:[d,p,r]]}}AH.className="ConvRNN2D";class BI extends k0{constructor(t){const{filters:n,kernelSize:r,strides:i,padding:a,dataFormat:s,dilationRate:o}=t;super(Object.assign(Object.assign({},t),{units:n})),this.filters=n,jn(this.filters,"filters"),this.kernelSize=ic(r,2,"kernelSize"),this.kernelSize.forEach(l=>jn(l,"kernelSize")),this.strides=ic(i||1,2,"strides"),this.strides.forEach(l=>jn(l,"strides")),this.padding=a||"valid",mi(this.padding),this.dataFormat=s||"channelsLast",hn(this.dataFormat),this.dilationRate=ic(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>jn(l,"dilationRate"))}build(t){var n;t=be(t);const r=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[r]==null)throw new Z(`The channel dimension of the input should be defined. Found ${t[r]}`);const i=t[r],a=4,s=this.kernelSize.concat([i,this.filters*a]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,h=this.filters;l=new(n=class extends Ui{apply(p,g){const v=c.apply([h]),x=Io([h]),b=c.apply([h*2]);return SI([v,x,b])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return st(()=>{if(t.length!==3)throw new Z(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training||!1,i=t[0],a=t[1],s=t[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=yo({ones:()=>Bi(i),rate:this.dropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(F,G,H)=>!G||!G[H]?F:J(G[H],F);let h=c(i,l,0),d=c(i,l,1),p=c(i,l,2),g=c(i,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=yo({ones:()=>Bi(a),rate:this.recurrentDropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const v=this.recurrentDropoutMask;let x=c(a,v,0),b=c(a,v,1),w=c(a,v,2),C=c(a,v,3);const T=3,[$,A,E,O]=fi(this.kernel.read(),o,T),[N,_,R,I]=this.useBias?fi(this.bias.read(),o):[null,null,null,null];h=this.inputConv(h,$,N,this.padding),d=this.inputConv(d,A,_,this.padding),p=this.inputConv(p,E,R,this.padding),g=this.inputConv(g,O,I,this.padding);const[P,B,V,z]=fi(this.recurrentKernel.read(),o,T);x=this.recurrentConv(x,P),b=this.recurrentConv(b,B),w=this.recurrentConv(w,V),C=this.recurrentConv(C,z);const M=this.recurrentActivation.apply(Ct(h,x)),U=this.recurrentActivation.apply(Ct(d,b)),W=Ct(J(U,s),J(M,this.activation.apply(Ct(p,w)))),q=J(this.recurrentActivation.apply(Ct(g,C)),this.activation.apply(W));return[q,q,W]})}getConfig(){const t=super.getConfig(),{units:n}=t,r=Sxt(t,["units"]),i={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},r),i)}inputConv(t,n,r,i){const a=Il(t,n,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?fa(a,r,this.dataFormat):a}recurrentConv(t,n){return Il(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}BI.className="ConvLSTM2DCell";St(BI);class kH extends AH{constructor(t){const n=new BI(t);super(Object.assign(Object.assign({},t),{cell:n}))}static fromConfig(t,n){return new t(n)}}kH.className="ConvLSTM2D";St(kH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zI extends ie{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,r=[];for(let i=0;i<this.noiseShape.length;++i)r.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return r}call(t,n){return st(()=>{this.invokeCallHook(t,n);const r=Yt(t);if(0<this.rate&&this.rate<1){const i=n.training==null?!1:n.training,a=this.getNoiseShape(r);return tm(()=>gq(r,this.rate,a,this.seed),()=>r,i)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}zI.className="Dropout";St(zI);class EH extends zI{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}EH.className="SpatialDropout1D";St(EH);class IH extends ie{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,jn(this.units,"units"),this.activation=go(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=Ke(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Ke(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=In(t.kernelConstraint),this.biasConstraint=In(t.biasConstraint),this.kernelRegularizer=Ze(t.kernelRegularizer),this.biasRegularizer=Ze(t.biasRegularizer),this.activityRegularizer=Ze(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=be(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=be(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return st(()=>{this.invokeCallHook(t,n);const r=Yt(t),i=uq(this.activation.getClassName());let a;return i!=null?a=Na(r,this.kernel.read(),i,this.bias?this.bias.read():null):(a=Na(r,this.kernel.read()),this.bias!=null&&(a=fa(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const t={units:this.units,activation:mo(this.activation),useBias:this.useBias,kernelInitializer:tn(this.kernelInitializer),biasInitializer:tn(this.biasInitializer),kernelRegularizer:Le(this.kernelRegularizer),biasRegularizer:Le(this.biasRegularizer),activityRegularizer:Le(this.activityRegularizer),kernelConstraint:En(this.kernelConstraint),biasConstraint:En(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}IH.className="Dense";St(IH);class OH extends ie{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=be(t);for(const n of t.slice(1))if(n==null)throw new Z(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],fo(t,1)]}call(t,n){return st(()=>{this.invokeCallHook(t,n);let r=Yt(t);if(this.dataFormat==="channelsFirst"&&r.rank>1){const i=[0];for(let a=2;a<r.rank;++a)i.push(a);i.push(1),r=me(r,i)}return n0t(r)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}OH.className="Flatten";St(OH);class NH extends ie{constructor(t){super(t),this.supportsMasking=!0,this.activation=go(t.activation)}call(t,n){return st(()=>{this.invokeCallHook(t,n);const r=Yt(t);return this.activation.apply(r)})}getConfig(){const t={activation:mo(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}NH.className="Activation";St(NH);class _H extends ie{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return st(()=>(t=Yt(t),t0t(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}_H.className="RepeatVector";St(_H);class RH extends ie{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const r="Total size of new array must be unchanged.",i=n.slice();let a=1,s=null;for(let l=0;l<i.length;++l){const c=i[l];if(this.isUnknown(c))if(s===null)s=l;else throw new Z("Can only specifiy one unknown dimension.");else a*=c}const o=fo(t);if(s!==null){if(a===0||o%a!==0)throw new Z(r);i[s]=o/a}else if(o!==a)throw new Z(r);return i}computeOutputShape(t){let n=!1;for(let r=0;r<t.length;++r)if(this.isUnknown(t[r])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return st(()=>{this.invokeCallHook(t,n);const r=Yt(t),i=r.shape,a=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return nt(r,a)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}RH.className="Reshape";St(RH);class DH extends ie{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=oa(1,t.dims.length+1);if(!we(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new An({ndim:this.dims.length+1})]}computeOutputShape(t){t=be(t);const n=t.slice();return this.dims.forEach((r,i)=>{n[i+1]=t[r]}),n}call(t,n){return me(Yt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}DH.className="Permute";St(DH);class MH extends ie{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const r=Yt(t);return Q2(sv(r,this.maskValue),-1)}call(t,n){return st(()=>{this.invokeCallHook(t,n);const r=Yt(t),s=Q2(sv(r,this.maskValue),-1,!0);return J(r,_t(s,r.dtype))})}}MH.className="Masking";St(MH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PH extends ie{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ee(t.inputLength))}this.inputDim=t.inputDim,jn(this.inputDim,"inputDim"),this.outputDim=t.outputDim,jn(this.outputDim,"outputDim"),this.embeddingsInitializer=Ke(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Ze(t.embeddingsRegularizer),this.activityRegularizer=Ze(t.activityRegularizer),this.embeddingsConstraint=In(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return st(()=>this.maskZero?(t=Yt(t),sv(t,ge(t))):null)}computeOutputShape(t){if(t=be(t),this.inputLength==null)return[...t,this.outputDim];const n=Ee(this.inputLength);if(n.length!==t.length-1)throw new Z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let r=0;for(let i=0;i<n.length;++i){const a=n[i],s=t[i+1];if(a!=null&&s!=null&&a!==s)throw new Z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);a==null&&(n[r]=s),r++}}return[t[0],...n,this.outputDim]}call(t,n){return st(()=>{this.invokeCallHook(t,n);let r=Yt(t);r.dtype!=="int32"&&(r=Oa(r,"int32"));const i=mq(this.embeddings.read(),nt(r,[r.size]));return nt(i,be(this.computeOutputShape(r.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:tn(this.embeddingsInitializer),embeddingsRegularizer:Le(this.embeddingsRegularizer),activityRegularizer:Le(this.activityRegularizer),embeddingsConstraint:En(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}PH.className="Embedding";St(PH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Gl extends ie{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new te}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const r=t.slice(0,t.length-n.length);for(let i=0;i<n.length;++i){const a=t[t.length-n.length+i],s=n[i];if(a==null||s==null||a<0||s<0)r.push(null);else if(a===1)r.push(s);else if(s===1)r.push(a);else{if(a!==s)throw new Z("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));r.push(a)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[be(t)]),t=t,t.length<2)throw new Z(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const a of t)a!=null&&a[0]!==null&&n.push(a[0]);if(n=co(n),n.length>1)throw new Z(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=t[0]==null?null:t[0].slice(1);for(let a=1;a<t.length;++a){const s=t[a]==null?null:t[a].slice(1);r=this.computeElementwiseOpOutputShape(r,s)}const i=t.map(a=>a.length);t.indexOf(null)===-1&&co(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return st(()=>{if(t=t,this.reshapeRequired){const r=[],i=t.map(a=>a.rank);if(i.indexOf(null)===-1){const a=po(i);for(let s of t){const o=s.rank;for(let l=0;l<a-o;++l)s=Qp(s,1);r.push(s)}return this.mergeFunction(r)}else{let a=!1;for(const l of t){const c=l.rank;if(c==null){const h=l.shape,d=h[0],p=h.slice(1).concat([d]);let g=nt(l,[d].concat(fo(h.slice(1))));g=me(g,[1,0]),g=nt(g,p),r.push(g),a=!0}else if(c>1){const h=oa(1,c).concat([0]);r.push(me(l,h)),a=!0}else r.push(l)}let s=this.mergeFunction(r);const o=s.rank;if(a){if(o==null){const l=s.shape,c=l.length,h=l[c-1],d=[h].concat(l.slice(0,l.length-1));s=nt(me(nt(s,[-1,h]),[1,0]),d)}else if(o>1){const l=[o-1].concat(oa(0,o-1));s=me(s,l)}}return s}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let i=1;i<t.length;++i){const a=t[i]==null?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}let r=[];for(const i of t)i!=null&&i[0]!==null&&r.push(i[0]);return r=co(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(t,n){return st(()=>{if(n==null)return null;if(!Array.isArray(n))throw new Z("`mask` should be an Array");if(!Array.isArray(t))throw new Z("`inputs` should be an Array");if(n.length!==t.length)throw new Z(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:Ir(i,0));let r=n[0];for(let i=1;i<n.length-1;++i)r=bs(r,n[i]);return r})}}class FH extends Gl{constructor(t){super(t)}mergeFunction(t){return st(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=Ct(n,t[r]);return n})}}FH.className="Add";St(FH);class LH extends Gl{constructor(t){super(t)}mergeFunction(t){return st(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=J(n,t[r]);return n})}}LH.className="Multiply";St(LH);class BH extends Gl{constructor(t){super(t)}mergeFunction(t){return st(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=Ct(n,t[r]);return J(1/t.length,n)})}}BH.className="Average";St(BH);class zH extends Gl{constructor(t){super(t)}mergeFunction(t){return st(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=Eo(n,t[r]);return n})}}zH.className="Maximum";St(zH);class jH extends Gl{constructor(t){super(t)}mergeFunction(t){return st(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=Td(n,t[r]);return n})}}jH.className="Minimum";St(jH);class UH extends Gl{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new Z("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const i of t)if(i!=null){n=!1;break}if(n)return;const r=[];for(let i=0;i<t.length;++i){const a=t[i].slice();a.splice(this.axis,1);let s=!1;for(const o of r)if(we(o,a)){s=!0;break}s||r.push(a)}if(r.length>1)throw new Z("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return st(()=>SI(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new Z("A `Concatenate` layer should be called on a list of inputs.");const n=t,r=n[0].slice(),i=this.axis<0?r.length+this.axis:this.axis;for(const a of n.slice(1)){if(r[i]==null||a[i]==null){r[i]=null;break}r[i]+=a[i]}return r}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new Z("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Z("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new Z(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return st(()=>{let r=!0;if(n.forEach(s=>{if(s!=null){r=!1;return}}),r)return null;const i=[];for(let s=0;s<t.length;++s)n[s]==null?i.push(_t(Bi(t[s]),"bool")):n[s].rank<t[s].rank?i.push(Ir(n[s],-1)):i.push(n[s]);const a=_r(i,this.axis);return UW(a,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}UH.className="Concatenate";St(UH);function Sh(e,t){for(;e<0;)e+=t;return e}function Cxt(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new te("batchDot is not implemented for tensors of 4D or higher rank yet");if(j(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),j(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new te("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);const a=n;return st(()=>{let s;if(r>i){s=r-i;const l=[];for(let c=0;c<s;++c)l.push(1);t=nt(t,t.shape.concat(l))}else if(i>r){s=i-r;const l=[];for(let c=0;c<s;++c)l.push(1);e=nt(e,e.shape.concat(l))}else s=0;let o;if(e.shape.length===2&&t.shape.length===2)a[0]===a[1]?o=Rt(J(e,t),a[0]):o=Rt(J(me(e,[1,0]),t),a[1]);else{const l=a[0]!==e.shape.length-1,c=a[1]===t.shape.length-1;o=xe(e,t,l,c)}if(s>0){let l;r>i?l=r+i-3:l=r-1;const c=[];for(let h=l;h<l+s;++h)c.push(h);o=qp(o,c)}return o.shape.length===1&&(o=Ir(o,1)),o})}class VH extends Gl{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){j(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],r=t[1];if(n.length>3||r.length>3)throw new te("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);if(n[i[0]]!==r[i[1]])throw new Z(`Dimension incompatibility: ${n[i[0]]} !== ${r[i[1]]}`)}mergeFunction(t){if(t.length!==2)throw new Z(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],r=t[1],i;return Array.isArray(this.axes)?i=this.axes.map((a,s)=>Sh(a,t[s].shape.length)):i=[Sh(this.axes,n.shape.length),Sh(this.axes,r.shape.length)],this.normalize&&(n=dv(n,i[0]),r=dv(r,i[1])),Cxt(n,r,i)}interpretAxes(t,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[Sh(this.axes,t.length),Sh(this.axes,n.length)],r}computeOutputShape(t){j(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),r=t[1].slice();if(n.length>3||r.length>3)throw new te("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);n.splice(i[0],1),r.splice(i[1],1),r.splice(0,1);const a=n.concat(r);return a.length===1&&a.push(1),a}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}VH.className="Dot";St(VH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WH extends ie{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return st(()=>{this.invokeCallHook(t,n);const r=Yt(t);return tm(()=>Ct(x0(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}WH.className="GaussianNoise";St(WH);class GH extends ie{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return st(()=>{this.invokeCallHook(t,n);const r=Yt(t);return this.rate>0&&this.rate<1?tm(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return J(r,x0(r.shape,1,a))},()=>r,n.training||!1):r})}}GH.className="GaussianDropout";St(GH);class qH extends ie{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||Yt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return st(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(t);return tm(()=>{const a=Yt(t),o=-1.6732632423543772*1.0507009873554805;let l=Ul(Gp(r),this.rate);l=Oa(l,"float32");const c=((1-this.rate)*(1+this.rate*o**2))**-.5,h=-c*o*this.rate,d=Ct(J(a,l),J(Ct(l,-1),o));return Ct(J(d,c),h)},()=>Yt(t),n.training||!1)}return t})}}qH.className="AlphaDropout";St(qH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Id(e,t,n,r,i,a=.001){let s;if(e.rank===2)s=rdt(e,t,n,r,i,a);else if(e.rank===3)s=adt(e,t,n,r,i,a);else if(e.rank===4)s=odt(e,t,n,r,i,a);else throw new te(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return s}function Txt(e,t,n,r,i=.001){return st(()=>{const a=OE(e,r),s=a.mean,o=a.variance;return[Id(e,s,o,n,t,i),s,o]})}function $xt(e,t,n,r,i=.001){return st(()=>{const a=OE(e,r),s=a.mean,o=a.variance,l=[];for(const v of oa(0,e.rank))r.indexOf(v)!==-1?l.push(1):l.push(e.shape[v]);const c=nt(s,l),h=nt(o,l),d=t==null?null:nt(t,l),p=n==null?null:nt(n,l);return[Id(e,c,h,p,d,i),s,o]})}function Axt(e,t,n,r,i=.001){return we(r.slice().sort(),oa(0,e.rank-1))?Txt(e,t,n,r,i):$xt(e,t,n,r,i)}class HH extends ie{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Ke(t.betaInitializer||"zeros"),this.gammaInitializer=Ke(t.gammaInitializer||"ones"),this.movingMeanInitializer=Ke(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Ke(t.movingVarianceInitializer||"ones"),this.betaConstraint=In(t.betaConstraint),this.gammaConstraint=In(t.gammaConstraint),this.betaRegularizer=Ze(t.betaRegularizer),this.gammaRegularizer=Ze(t.gammaRegularizer)}build(t){t=be(t);const n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(r==null)throw new Z(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new An({ndim:t.length,axes:{[n]:r}})];const i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return st(()=>{const r=n.training==null?!1:n.training,i=Yt(t),a=i.shape,s=a.length,o=oa(0,s),l=this.axis>=0?this.axis:this.axis+s;o.splice(l,1);const c=Rl(1,s);c[l]=a[l];const h=o.slice();h.sort();const d=!we(h,oa(0,s).slice(0,s-1)),p=()=>{if(d){const C=nt(this.movingMean.read(),c),T=nt(this.movingVariance.read(),c),$=this.center?nt(this.beta.read(),c):null,A=this.scale?nt(this.gamma.read(),c):null;return Id(i,C,T,$,A,this.epsilon)}else return Id(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return p();const[g,v,x]=Axt(i,this.gamma.read(),this.beta.read(),o,this.epsilon),b=(C,T,$)=>{st(()=>{const A=1-$,E=C.read(),O=J(Vt(E,T),A);C.write(Vt(E,O))})};return(()=>{b(this.movingMean,v,this.momentum),b(this.movingVariance,x,this.momentum)})(),g})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tn(this.betaInitializer),gammaInitializer:tn(this.gammaInitializer),movingMeanInitializer:tn(this.movingMeanInitializer),movingVarianceInitializer:tn(this.movingVarianceInitializer),betaRegularizer:Le(this.betaRegularizer),gammaRegularizer:Le(this.gammaRegularizer),betaConstraint:En(this.betaConstraint),gammaConstraint:En(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}HH.className="BatchNormalization";St(HH);class XH extends ie{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Ke(t.betaInitializer||"zeros"),this.gammaInitializer=Ke(t.gammaInitializer||"ones"),this.betaRegularizer=Ze(t.betaRegularizer),this.gammaRegularizer=Ze(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=be(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=n);for(const a of this.axis)if(a<0||a>=n)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==co(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(a=>t[a]),i=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(t,n){const r=Yt(t),i=r.shape,a=i.length;return st(()=>{let{mean:o,variance:l}=OE(r,this.axis,!0);const c=Rl(1,a);for(const x of this.axis)c[x]=i[x];const h=x=>x!=null&&x.shape.length!==a?nt(x,c):x;let d=this.scale?h(this.gamma.read()):null,p=this.center?h(this.beta.read()):null;const g=[],v=[];for(let x=0;x<a;++x)this.axis.indexOf(x)!==-1?(g.push(i[x]),v.push(1)):(g.push(1),v.push(i[x]));return o=ia(o,g),l=ia(l,g),d!=null&&(d=ia(d,v)),p!=null&&(p=ia(p,v)),Id(r,o,l,p,d,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tn(this.betaInitializer),gammaInitializer:tn(this.gammaInitializer),betaRegularizer:Le(this.betaRegularizer),gammaRegularizer:Le(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}XH.className="LayerNormalization";St(XH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kxt(e,t,n){return st(()=>{if(e.rank!==4)throw new Z(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new Z("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=la()),n!=="channelsLast"&&n!=="channelsFirst")throw new Z(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],NE(e,r)})}class KH extends ie{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?la():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new Z(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,r;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],r=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new Z(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new Z(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);r=t.padding[1]}this.padding=[n,r]}this.inputSpec=[new An({ndim:4})]}computeOutputShape(t){t=be(t);let n,r;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?r=t[3]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],t[1],n,r]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?r=t[2]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],n,r,t[3]])}call(t,n){return st(()=>kxt(Yt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}KH.className="ZeroPadding2D";St(KH);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function E0(e,t,n,r,i,a){return st(()=>{hn(i),fq(a),mi(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=la()),a==null&&(a="max"),e=MI(e,i);let s;const o=r==="same"?"same":"valid";return a==="max"?s=IE(e,t,n,o):s=xE(e,t,n,o),i==="channelsFirst"&&(s=me(s,[0,3,1,2])),s})}function YH(e,t,n,r,i,a){return st(()=>{hn(i),fq(a),mi(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=la()),a==null&&(a="max"),e=dH(e,i);let s;const o=r==="same"?"same":"valid";return a==="max"?s=Wpt(e,t,n,o):s=Hht(e,t,n,o),i==="channelsFirst"&&(s=me(s,[0,4,1,2,3])),s})}class ZH extends ie{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new Z(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(jn(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new Z(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);jn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,mi(this.padding),this.inputSpec=[new An({ndim:3})]}computeOutputShape(t){t=be(t);const n=sa(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return st(()=>{this.invokeCallHook(t,n),t=Qp(Yt(t),2);const r=this.poolingFunction(Yt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return qp(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class QH extends ZH{constructor(t){super(t)}poolingFunction(t,n,r,i,a){return hn(a),mi(i),E0(t,n,r,i,a,"max")}}QH.className="MaxPooling1D";St(QH);class JH extends ZH{constructor(t){super(t)}poolingFunction(t,n,r,i,a){return hn(a),mi(i),E0(t,n,r,i,a,"avg")}}JH.className="AveragePooling1D";St(JH);class t6 extends ie{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new Z(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];jn(this.poolSize,"poolSize"),jn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,hn(this.dataFormat),mi(this.padding),this.inputSpec=[new An({ndim:4})]}computeOutputShape(t){t=be(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=sa(n,this.poolSize[0],this.padding,this.strides[0]),r=sa(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r]:[t[0],n,r,t[3]]}call(t,n){return st(()=>(this.invokeCallHook(t,n),this.poolingFunction(Yt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class e6 extends t6{constructor(t){super(t)}poolingFunction(t,n,r,i,a){return hn(a),mi(i),E0(t,n,r,i,a,"max")}}e6.className="MaxPooling2D";St(e6);class n6 extends t6{constructor(t){super(t)}poolingFunction(t,n,r,i,a){return hn(a),mi(i),E0(t,n,r,i,a,"avg")}}n6.className="AveragePooling2D";St(n6);class r6 extends ie{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new Z(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];jn(this.poolSize,"poolSize"),jn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,hn(this.dataFormat),mi(this.padding),this.inputSpec=[new An({ndim:5})]}computeOutputShape(t){t=be(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=sa(n,this.poolSize[0],this.padding,this.strides[0]),r=sa(r,this.poolSize[1],this.padding,this.strides[1]),i=sa(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r,i]:[t[0],n,r,i,t[4]]}call(t,n){return st(()=>(this.invokeCallHook(t,n),this.poolingFunction(Yt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class i6 extends r6{constructor(t){super(t)}poolingFunction(t,n,r,i,a){return hn(a),mi(i),YH(t,n,r,i,a,"max")}}i6.className="MaxPooling3D";St(i6);class a6 extends r6{constructor(t){super(t)}poolingFunction(t,n,r,i,a){return hn(a),mi(i),YH(t,n,r,i,a,"avg")}}a6.className="AveragePooling3D";St(a6);class s6 extends ie{constructor(t){super(t),this.inputSpec=[new An({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new te}}class o6 extends s6{constructor(t){super(t||{})}call(t,n){return st(()=>{const r=Yt(t);return vn(r,1)})}}o6.className="GlobalAveragePooling1D";St(o6);class l6 extends s6{constructor(t){super(t||{})}call(t,n){return st(()=>{const r=Yt(t);return Pi(r,1)})}}l6.className="GlobalMaxPooling1D";St(l6);class u6 extends ie{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,hn(this.dataFormat),this.inputSpec=[new An({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new te}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class c6 extends u6{call(t,n){return st(()=>{const r=Yt(t);return this.dataFormat==="channelsLast"?vn(r,[1,2]):vn(r,[2,3])})}}c6.className="GlobalAveragePooling2D";St(c6);class f6 extends u6{call(t,n){return st(()=>{const r=Yt(t);return this.dataFormat==="channelsLast"?Pi(r,[1,2]):Pi(r,[2,3])})}}f6.className="GlobalMaxPooling2D";St(f6);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class h6 extends ie{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,r={}){const i=n.layer,a=ds(i,r);delete n.layer;const s={layer:a};return Object.assign(s,n),new t(s)}}class d6 extends h6{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=be(t),t.length<3)throw new Z(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=be(t);const n=[t[0]].concat(t.slice(2)),r=this.layer.computeOutputShape(n),i=t[1];return[r[0],i].concat(r.slice(1))}call(t,n){return st(()=>(t=Yt(t),SH((s,o)=>[Yt(this.layer.call(s,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}d6.className="TimeDistributed";St(d6);function Ext(e){Wl(Kbt,"BidirectionalMergeMode",e)}const Ixt="concat";class p6 extends h6{constructor(t){super(t);const n=t.layer.getConfig(),r={};r.className=t.layer.getClassName(),r.config=n,this.forwardLayer=ds(r),n.goBackwards=n.goBackwards!==!0;const i={};if(i.className=t.layer.getClassName(),i.config=n,this.backwardLayer=ds(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?Ixt:t.mergeMode,Ext(this.mergeMode),t.weights)throw new te("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,r=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,r)),this.backwardLayer.setWeights(t.slice(r))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,i,a;return this.returnState&&(a=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):this.mergeMode==null?i=[r,r.slice()]:i=[r],this.returnState?this.mergeMode==null?i.concat(a).concat(a.slice()):[r].concat(a).concat(a.slice()):Or(i)}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const a=wH(t,r,i,this.numConstants);if(t=a.inputs,r=a.initialState,i=a.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(r==null||r.length===0)&&i==null)return super.apply(t,n);const s=[],o=[];if(r!=null){const c=r.length;if(c%2>0)throw new Z("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,s.push(...r);const h=r.map(d=>new An({shape:d.shape}));this.forwardLayer.stateSpec=h.slice(0,c/2),this.backwardLayer.stateSpec=h.slice(c/2),o.push(...h)}if(i!=null)throw new te("Support for constants in Bidirectional layers is not implemented yet.");const l=s[0]instanceof Pa;for(const c of s)if(c instanceof Pa!==l)throw new Z("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[t].concat(s),h=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=h;const p=super.apply(c,n);return this.inputSpec=d,p}else return super.apply(t,n)}call(t,n){return st(()=>{const r=n.initialState;let i,a;if(r==null)i=this.forwardLayer.call(t,n),a=this.backwardLayer.call(t,n);else{const l=r.slice(0,r.length/2),c=r.slice(r.length/2);i=this.forwardLayer.call(t,Object.assign(n,{initialState:l})),a=this.backwardLayer.call(t,Object.assign(n,{initialState:c}))}let s;this.returnState&&(Array.isArray(i)&&(s=i.slice(1).concat(a.slice(1))),i=i[0],a=a[0]),this.returnSequences&&(a=Nl(a,1));let o;return this.mergeMode==="concat"?o=SI([i,a]):this.mergeMode==="sum"?o=Ct(i,a):this.mergeMode==="ave"?o=J(.5,Ct(i,a)):this.mergeMode==="mul"?o=J(i,a):this.mergeMode==null&&(o=[i,a]),this.returnState?this.mergeMode==null?o.concat(s):[o].concat(s):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){gl(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),gl(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const a=this.forwardLayer.states.map(s=>null);return Array.isArray(r)?r.concat(a).concat(a):[r].concat(a).concat(a)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const r=ds(n.layer);if(delete n.layer,n.numConstants!=null)throw new te("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=n;return i.layer=r,new t(i)}}p6.className="Bidirectional";St(p6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class m6 extends ie{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return st(()=>(t=Yt(t),t.dtype!=="float32"&&(t=Oa(t,"float32")),Ct(J(t,this.scale),this.offset)))}}m6.className="Rescaling";St(m6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Oxt,cropAndResize:Nxt}=us;class g6 extends ie{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,n,r,i,a,s,o,l){return st(()=>{let c,h=!1;const d=n/s,p=r/o,g=(i+n)/s,v=(a+r)/o,x=[d,p,g,v],b=[];t.rank===3?(h=!0,c=xs([t])):c=t;for(let A=0;A<c.shape[0];A++)b.push(x);const w=_W(b,[b.length,4]),C=$d(0,b.length,1,"int32"),$=Nxt(c,w,C,[i,a],"nearest");return Oa(h?Yt(_l($)):$,l)})}upsize(t,n,r,i){return st(()=>{const a=Oxt(t,[n,r]);return Oa(a,i)})}call(t,n){return st(()=>{const r=Yt(t),i=r.dtype,a=r.shape,s=a[a.length-3],o=a[a.length-2];let l=0;s!==this.height&&(l=Math.floor((s-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(r,l,c,this.height,this.width,s,o,i):this.upsize(t,this.height,this.width,i)})}getConfig(){const t={height:this.height,width:this.width},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=be(t);const n=t.length-3,r=t.length-2;return t[n]=this.height,t[r]=this.width,t}}g6.className="CenterCrop";St(g6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _xt(e,t,n,r){let i=Yt(e);if(i.dtype!=="int32"&&(i=Oa(i,"int32")),t==="int")return i;const a=i.shape;if(i.rank===0&&(i=Ir(i,-1)),t==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=Ir(i,-1)),i.rank>2)throw new Z(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${a} which would result in output rank ${i.rank}.`);const s=["multiHot","oneHot"].includes(t),o=i;let l;if(typeof r<"u"&&t==="count"?l=oz(o,r,n,s):l=oz(o,[],n,s),t!=="tfIdf")return l;if(r)return J(l,r);throw new Z("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class y6 extends ie{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){return t=be(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,n){return st(()=>{t=Yt(t),t.dtype!=="int32"&&(t=Oa(t,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new Z(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=Yt(n.countWeights)}const i=Pi(t),a=Cd(t),s=pi(this.numTokens,i).bufferSync().get(0),o=Ul(a,0).bufferSync().get(0);if(!(s&&o))throw new Z(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return _xt(t,this.outputMode,this.numTokens,r)})}}y6.className="CategoryEncoding";St(y6);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Rxt=["bilinear","nearest"],Xz=new Set(Rxt);class v6 extends ie{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(Xz.has(t.interpolation))this.interpolation=t.interpolation;else throw new Z(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!t.cropToAspectRatio}computeOutputShape(t){t=be(t);const n=t[2];return[this.height,this.width,n]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return st(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return us.resizeBilinear(t,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return us.resizeNearestNeighbor(t,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Xz]} are supported`)})}}v6.className="Resizing";St(v6);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class b6{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}b6.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class x6 extends ie{constructor(t){super(t),this.randomGenerator=new b6(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(t,n),t}}x6.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Dxt=["bilinear","nearest"],Kz=new Set(Dxt);class w6 extends x6{constructor(t){super(t);const{factor:n,interpolation:r="bilinear"}=t;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new Z(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new Z(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Z(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(Kz.has(r))this.interpolation=r;else throw new Z(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=be(t);const n=t[2];return[this.imgHeight,-1,n]}call(t,n){return st(()=>{const r=Yt(t);this.imgHeight=r.shape[r.shape.length-3];const i=r.shape[r.shape.length-2];this.widthFactor=Gp([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*i;a=Math.round(a);const s=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return us.resizeBilinear(t,s);case"nearest":return us.resizeNearestNeighbor(t,s);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...Kz]} are supported`)}})}}w6.className="RandomWidth";St(w6);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mxt=ct();Mxt.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Yz;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(Yz||(Yz={}));var Zz;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(Zz||(Zz={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Qz;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(Qz||(Qz={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&j(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pxt=yG;class I0 extends $k{nextDataId(){return I0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new zV(this,ya())}write(t,n,r){this.firstUse&&(this.firstUse=!1,ct().get("IS_NODE")&&ui(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:r,refCount:1}),i}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&Gd(r[0])){const a=r.map(s=>uo(s));i=this.write(a,t,n)}else i=this.write(r,t,n);return{dataId:i,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,r,i,a){this.data.set(t,{values:n,dtype:i,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:r}=this.data.get(t);if(n==="complex64"){const i=this.readSync(r.real.dataId),a=this.readSync(r.imag.dataId);return ws(i,a)}return oft(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>ho(i));return ne(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ne(t.shape,t.dtype,n)}makeOutput(t,n,r){return ya().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(t);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=Er();return t(),{kernelMs:Er()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Mt([t],"where");const n=this.readSync(t.dataId);return Pxt(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}I0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const Fxt=e=>{const{x:t}=e.inputs,n=e.backend;Mt(t,"abs");let r=new Float32Array(pt(t.shape));const i=n.data.get(t.dataId).values;return r=S6(i),n.makeOutput(r,t.shape,t.dtype)},Lxt={kernelName:sb,backendName:"cpu",kernelFunc:Fxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dn(e){return(t,n,r,i,a)=>{const s=Jt(t,n),o=s.length,l=Bt(s),c=pt(s),h=lr(a,c),d=t.length,p=n.length,g=Bt(t),v=Bt(n),x=Oc(t,s),b=Oc(n,s);if(x.length+b.length===0)for(let w=0;w<h.length;++w)h[w]=e(r[w%r.length],i[w%i.length]);else for(let w=0;w<h.length;++w){const C=Hc(w,o,l),T=C.slice(-d);x.forEach(O=>T[O]=0);const $=ka(T,d,g),A=C.slice(-p);b.forEach(O=>A[O]=0);const E=ka(A,p,v);h[w]=e(r[$],i[E])}return[h,s]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qr(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",s)},o}const Bxt={kernelName:Fk,backendName:"cpu",kernelFunc:qr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vv(e,t,n="float32"){if(n==="complex64"){const i=vv(e,t,"float32"),a=vv(e,t,"float32");return qr({inputs:{real:i,imag:a},backend:e})}const r=ur(pt(t),n);return e.makeTensorInfo(t,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const zxt={kernelName:hp,backendName:"cpu",kernelFunc:Fa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dl(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const jxt={kernelName:oE,backendName:"cpu",kernelFunc:Dl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(e,t,n,r){if(r==="int32"){const i=Int32Array.from(e);return[t,"int32",i]}if(r==="bool"){const i=jl([0],n),[a,s]=dn((o,l)=>o!==l?1:0)(t,[],e,i,"bool");return[s,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function vo(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:a}=r;if(a==="complex64"){if(i.dtype==="complex64")return Fa({inputs:{x:i},backend:n});const h=vv(n,i.shape,i.dtype),d=vo({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),p=qr({inputs:{real:d,imag:h},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),p}if(i.dtype==="complex64"){const h=Dl({inputs:{input:i},backend:n}),d=vo({inputs:{x:h},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(h),d}if(!VV(i.dtype,a)){const h=Fa({inputs:{x:i},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:a}}const s=n.data.get(i.dataId).values,[o,l,c]=C6(s,i.shape,i.dtype,a);return n.makeTensorInfo(o,l,c)}const Uxt={kernelName:Jd,backendName:"cpu",kernelFunc:vo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _n(e,t,n,r){return n==null?({inputs:i,backend:a})=>{const{a:s,b:o}=i,l=a;Mt([s,o],e);const c=l.data.get(s.dataId).values,h=l.data.get(o.dataId).values,d=s.dtype==="string"?Ss(c):c,p=s.dtype==="string"?Ss(h):h,g=r||s.dtype,[v,x]=t(s.shape,o.shape,d,p,g);return l.makeTensorInfo(x,g,v)}:({inputs:i,backend:a})=>{const{a:s,b:o}=i,l=a;if(s.dtype==="complex64"||o.dtype==="complex64"){const c=vo({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(c.dataId),d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,g=l.data.get(d.dataId).values,v=l.data.get(p.dataId).values,x=vo({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),b=l.data.get(x.dataId),w=b.complexTensorInfos.real,C=b.complexTensorInfos.imag,T=l.data.get(w.dataId).values,$=l.data.get(C.dataId).values,[A,E,O]=n(s.shape,o.shape,g,v,T,$),N=l.makeTensorInfo(O,"float32",A),_=l.makeTensorInfo(O,"float32",E),R=qr({inputs:{real:N,imag:_},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(N),l.disposeIntermediateTensorInfo(_),R}else{const c=l.data.get(s.dataId).values,h=l.data.get(o.dataId).values,d=r||s.dtype,[p,g]=t(s.shape,o.shape,c,h,d);return l.makeTensorInfo(g,d,p)}}}function jI(e){return(t,n,r,i,a,s)=>{const o=Jt(t,n),l=pt(o),c=o.length,h=Bt(o),d=lr("float32",l),p=lr("float32",l),g=Oc(t,o),v=Oc(n,o),x=ws(r,i),b=ws(a,s),w=t.length,C=Bt(t),T=n.length,$=Bt(n);if(g.length+v.length===0)for(let A=0;A<d.length;A++){const E=A%x.length,O=A%b.length,N=e(x[E*2],x[E*2+1],b[O*2],b[O*2+1]);d[A]=N.real,p[A]=N.imag}else for(let A=0;A<d.length;A++){const E=Hc(A,c,h),O=E.slice(-w);g.forEach(P=>O[P]=0);const N=ka(O,w,C),_=E.slice(-T);v.forEach(P=>_[P]=0);const R=ka(_,T,$),I=e(x[N*2],x[N*2+1],b[R*2],b[R*2+1]);d[A]=I.real,p[A]=I.imag}return[d,p,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T6=dn((e,t)=>e+t),Vxt=jI((e,t,n,r)=>({real:e+n,imag:t+r})),Rc=_n(Xc,T6,Vxt),Wxt={kernelName:Xc,backendName:"cpu",kernelFunc:Rc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UI(e,t,n,r,i){const a=pt(r),s=ur(i,n);for(let o=0;o<e.length;o++){const l=e[o];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(a>0?s[l]+=t[o]:s[l]+=1)}return s}function $6(e,t,n,r=!1){const i=e.shape[0],a=e.shape[1],s=ne([i,n],t.dtype);for(let o=0;o<i;o++)for(let l=0;l<a;l++){const c=e.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?s.set(1,o,c):t.size>0?s.set(s.get(o,c)+t.get(o,l),o,c):s.set(s.get(o,c)+1,o,c))}return s}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A6=dn((e,t)=>e&t),Gxt=_n(Pk,A6),qxt={kernelName:Pk,backendName:"cpu",kernelFunc:Gxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ba(e){return(t,n,r)=>{const i=un(n,t.length);for(let a=0;a<t.length;++a)i[a]=e(t[a],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ie(e,t,n){const r=Ba(t);return _o(e,r,n)}function _o(e,t,n){return({inputs:r,attrs:i,backend:a})=>{const{x:s}=r;Mt(s,e);const o=a,l=o.data.get(s.dataId).values;let c;if(s.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Ss(l)}else c=l;const h=n||s.dtype,d=t(c,h,i);return o.makeTensorInfo(s.shape,h,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k6=Ba(e=>Math.ceil(e)),Hxt=_o(tp,k6),Xxt={kernelName:tp,backendName:"cpu",kernelFunc:Hxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(e,t,n,r){const i=un(n,pt(t));if(r&&n!=="string"){let a=0;e.forEach(s=>{const o=pt(s.shape);i.set(s.vals,a),a+=o})}else{let a=0;e.forEach(s=>{const o=n==="string"?Ss(s.vals):s.vals;let l=0;for(let c=0;c<s.shape[0];++c){const h=c*t[1]+a;for(let d=0;d<s.shape[1];++d)i[h+d]=o[l++]}a+=s.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I6=dn((e,t)=>e===t?1:0),O6=_n(Sb,I6,null,"bool"),Kxt={kernelName:Sb,backendName:"cpu",kernelFunc:O6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N6=Ba(e=>Math.exp(e)),_6=_o(op,N6,"float32"),Yxt={kernelName:op,backendName:"cpu",kernelFunc:_6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R6=Ba(e=>Math.expm1(e)),Zxt=_o(lp,R6),Qxt={kernelName:lp,backendName:"cpu",kernelFunc:Zxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D6=Ba(e=>Math.floor(e)),Jxt=_o(up,D6),t1t={kernelName:up,backendName:"cpu",kernelFunc:Jxt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M6=dn((e,t)=>Math.floor(e/t)),e1t=_n(cp,M6,null,"int32"),n1t={kernelName:cp,backendName:"cpu",kernelFunc:e1t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(e,t,n,r,i,a,s,o,l){const c=ne([r,a],n);for(let h=0;h<r;h++){const d=[];let p=0;for(let g=0;g<i;g++){const v=e[h*i+g];p+=v*s[g],d.push(v)}if(p<0||p>=l/a)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let g=0;g<a;g++)c.values[h*a+g]=t.get(...t.indexToLoc(p*a+g))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(e,t,n){const r=ne(n,e.dtype);for(let i=0;i<r.size;++i){const s=r.indexToLoc(i).slice(),o=s[0],l=s[2],c=t.locToIndex([o,l]);s[2]=t.values[c];const h=e.locToIndex(s);0<=h&&h<e.values.length&&(r.values[i]=e.values[h])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L6=dn((e,t)=>e>t?1:0),r1t=_n(Ab,L6,null,"bool"),i1t={kernelName:Ab,backendName:"cpu",kernelFunc:r1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B6=dn((e,t)=>e>=t?1:0),a1t=_n(fp,B6,null,"bool"),s1t={kernelName:fp,backendName:"cpu",kernelFunc:a1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6=dn((e,t)=>e<t?1:0),o1t=_n(Eb,z6,null,"bool"),l1t={kernelName:Eb,backendName:"cpu",kernelFunc:o1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j6=dn((e,t)=>e<=t?1:0),u1t=_n(Ib,j6,null,"bool"),c1t={kernelName:Ib,backendName:"cpu",kernelFunc:u1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(e,t,n){const r=(t-e)/(n-1),i=ur(n,"float32");i[0]=e;for(let a=1;a<i.length;a++)i[a]=i[a-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V6=Ba(e=>Math.log(e)),f1t=_o(gp,V6),h1t={kernelName:gp,backendName:"cpu",kernelFunc:f1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(e,t,n,r){const i=lr(r,pt(n));for(let a=0;a<i.length;++a){const s=a*t;let o=e[s];for(let l=0;l<t;++l){const c=e[s+l];(Number.isNaN(c)||c>o)&&(o=c)}i[a]=o}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G6=dn((e,t)=>Math.max(e,t)),d1t=_n(vp,G6),p1t={kernelName:vp,backendName:"cpu",kernelFunc:d1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q6=dn((e,t)=>Math.min(e,t)),m1t=_n(bp,q6),g1t={kernelName:bp,backendName:"cpu",kernelFunc:m1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VI=dn((e,t)=>e*t),y1t=jI((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),O0=_n(wp,VI,y1t),v1t={kernelName:wp,backendName:"cpu",kernelFunc:O0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(e,t,n){const r=$o(-1,n);return VI([],t,r,e,n)}function b1t(e){const{inputs:t,backend:n}=e,{x:r}=t;Mt(r,"neg");const i=n.data.get(r.dataId).values,[a,s]=H6(i,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,a)}const x1t={kernelName:zb,backendName:"cpu",kernelFunc:b1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X6=dn((e,t)=>e!==t?1:0),w1t=_n(jb,X6,null,"bool"),S1t={kernelName:jb,backendName:"cpu",kernelFunc:w1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(e,t,n,r,i){const a=t.length,s=pt(t),o=Bt(t),l=Bt(i),c=lr(n,pt(i));for(let h=0;h<s;++h){const d=Hc(h,a,o),p=new Array(d.length);for(let v=0;v<p.length;v++)p[v]=d[r[v]];const g=ka(p,a,l);c[g]=e[h]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mr(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:a}=n;Mt(i,"transpose");const s=i.shape.length,o=new Array(s);for(let d=0;d<o.length;d++)o[d]=i.shape[a[d]];const l=r.data.get(i.dataId).values,c=WI(l,i.shape,i.dtype,a,o);return{dataId:r.write(c,o,i.dtype),shape:o,dtype:i.dtype}}const C1t={kernelName:tc,backendName:"cpu",kernelFunc:Mr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6(e,t,n,r){const[i,a]=Vn(e,r),s=Xr(t,"int32"),o=ur(pt(i),s),l=pt(a);for(let c=0;c<o.length;++c){const h=c*l;let d=1;for(let p=0;p<l;++p)d*=n[h+p];o[c]=d}return{outVals:o,outShape:i,outDtype:s}}function T1t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;Mt(i,"prod");const o=i.shape.length,l=re(a,i.shape),c=en(l,o);let h=l,d=i;const p=[];c!=null&&(d=Mr({inputs:{x:i},backend:n,attrs:{perm:c}}),p.push(d),h=fn(h.length,o));const g=n.data.get(d.dataId).values,{outVals:v,outShape:x,outDtype:b}=K6(d.shape,d.dtype,g,h);let w=x;return s&&(w=bn(x,l)),p.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(w,b,v)}const $1t={kernelName:Hb,backendName:"cpu",kernelFunc:T1t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1t(e,t,n){e.forEach((r,i)=>{if(r<0||r>=n){const a=Hc(i,t.length,Bt(t)).join(",");throw new Error(`indices[${a}] = ${r} is not in [0, ${n})`)}})}function k1t(e,t){for(let n=0;n<e.length;++n){const r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let a=1;a<r.length;++a)if(r[a-1]>r[a])throw new Error("Ragged splits must be sorted in ascending order")}}function E1t(e,t,n,r){const i=[];let a=0;const s=t.length-1+n.length,o=new Array(s).fill(null).map(()=>[0]);k1t(n,r);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const h=t[c+1];for(let d=1;d<l+1;++d)o[c].push(d*h)}for(let c=0;c<e.length;++c){let h=e[c],d=e[c]+1;for(let p=0;p<n.length;++p){const g=n[p],v=p+t.length-1;if(v>=0){const x=o[v],b=x[x.length-1]-g[h];for(let w=h;w<d;++w)o[v].push(g[w+1]+b)}h=g[h],d=g[d]}d!==h&&(i.push([h,d]),a+=d-h)}return{outSplits:o,valueSlices:i,numValues:a}}function I1t(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n].length,i=un("int32",r);t.push(i),e[n].forEach((a,s)=>i[s]=a)}return t}function Jz(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function O1t(e,t,n,r,i,a){const s=Jz(t,2)[1],o=Jz(a,2)[1];let l=0;for(const c of n)for(let h=c[0];h<c[1];++h){for(let d=0;d<r;++d)i[l*o+d]=e[h*s+d];++l}}function N1t(e,t,n,r,i){const a=t.slice();a[0]=i;const s=un(n,pt(a)),o=e.length,l=o===0?0:o/t[0];return O1t(e,t,r,l,s,a),[s,a]}function Y6(e,t,n,r,i,a,s,o){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const l=t[0][0]-1;if(A1t(a,s,l),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:h,valueSlices:d,numValues:p}=E1t(a,s,e,c),g=I1t(h),v=N1t(n,r,i,d,p);return[g,v[0],v[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t4=2147483647;function Z6(e,t,n,r,i,a,s){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");const o=t.length===0,l=i.length===0,c=s.length===0,h=[];o||h.push(t[0]),l||h.push(i[0]),c||h.push(s[0]);for(let b=1;b<h.length;++b)if(h[b]!==h[b-1])throw new Error("starts, limits, and deltas must have the same shape");const d=h.length===0?1:h[0],p=un("int32",d+1);p[0]=0;for(let b=0;b<d;++b){const w=o?e[0]:e[b],C=l?r[0]:r[b],T=c?a[0]:a[b];if(T===0)throw new Error("Requires delta != 0");let $;if(T>0&&C<w||T<0&&C>w)$=0;else if($=Math.ceil(Math.abs((C-w)/T)),$>t4)throw new Error(`Requires ((limit - start) / delta) <= ${t4}`);p[b+1]=p[b]+$}const g=p[d],v=un(n,g);let x=0;for(let b=0;b<d;++b){const w=p[b+1]-p[b];let C=o?e[0]:e[b];const T=c?a[0]:a[b];for(let $=0;$<w;++$)v[x++]=C,C+=T}return[p,v]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ei=ea;class bv{constructor(t,n,r,i,a,s,o,l,c,h){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=a,this.defaultValue=s,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=PG(h),this.raggedRank=FG(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===Ei.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===Ei.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case Ei.VALUE_ROWIDS:return bv.getMaxWidthValueRowID(n);case Ei.ROW_SPLITS:return bv.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ei[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){const a=t[i+1]-t[i];a>r&&(r=a)}return r}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let r=0,i=t[0],a=0;for(let s=1;s<n;++s){const o=t[s];o!==i&&(i=o,a=Math.max(s-r,a),r=s)}return Math.max(n-r,a)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return n4(t,r)}calculateOutputSize(t){const n=this.valuesShape,r=this.defaultValueShape;LG(r,n);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),s=MG(this.raggedRank,i,n);s[0]<0&&(s[0]=t);for(let o=1;o<=this.raggedRank;++o)s[o]<0&&(s[o]=this.getMaxWidth(o));return s}calculateFirstParentOutputIndex(t,n,r){const i=Math.min(t,r),a=[];let s=0;for(let o=0;o<i;++o,s+=n)a.push(s);for(let o=i;o<t;++o)a.push(-1);return j(a.length===t,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(t,n,r,i){const a=t.length,s=[];for(let o=0;o<a-1;++o){const l=t[o+1]-t[o];let c=Math.min(i,l),h=n[o];h===-1&&(c=0);for(let d=0;d<c;++d)s.push(h),h+=r;for(let d=0;d<l-c;++d)s.push(-1)}if(a>0&&s.length!==t[a-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(t,n,r,i){const a=t.length,s=[];if(a===0)return[];let o=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];s.push(c);for(let h=1;h<a;++h){const d=t[h];if(d===l)c>=0&&(++o,o<i?c+=r:c=-1);else{if(o=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}s.push(c)}if(s.length!==t.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(t,n,r,i){const a=this.getRowPartitionTensor(t),s=this.getRowPartitionTypeByDimension(t);switch(s){case Ei.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,r,i);case Ei.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,r,i);default:throw new Error(`Unsupported partition type: ${Ei[s]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ei.FIRST_DIM_SIZE:return t[0];case Ei.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ei.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ei[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*r[l+1];const a=n4(r,!1),s=un(this.valuesDType,pt(a));if(i[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,i[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,i[c],r[c]);this.setOutput(this.raggedRank,l,s,a)}return[a,s]}setOutput(t,n,r,i){if(r.length===0)return;const a=this.values,s=r;let o=i.slice();o=o.slice(t+1);const l=pt(o),c=n.length;let h=this.defaultValue;if(h.length!==l&&h.length!==1){const v=this.defaultValueShape;st(()=>{const x=nt(h,v);h=Fh(x,o).dataSync()})}let d=0,p=0,g=0;for(let v=0;v<=c;++v){let x=v<c?n[v]:-1;if(x===g){++g;continue}if(p<g){const b=a.subarray(d*l),w=s.subarray(p*l),C=(g-p)*l;e4(w,b,C)}if(v>=c){const b=r.length;x=Math.floor(b/l)}if(x>g)if(this.defaultValue.length===1)s.subarray(g*l,x*l).fill(this.defaultValue[0]),g=x;else for(;x>g;){const b=s.slice(g*l);e4(b,h,l),++g}x<0?(d=v+1,p=g):(d=v,p=g,g=p+1)}}}function e4(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function n4(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function Q6(e,t,n,r,i,a,s,o,l,c){return new bv(e,t,n,r,i,a,s,o,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J6(e,t,n,r){const i=e===t,a=e<t&&n<0,s=t<e&&n>1;if(i||a||s)return ur(0,r);const o=Math.abs(Math.ceil((t-e)/n)),l=ur(o,r);t<e&&n===1&&(n=-1),l[0]=e;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5=Ba(e=>1/Math.sqrt(e)),_1t=_o(kp,t5),R1t={kernelName:kp,backendName:"cpu",kernelFunc:_1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hl(e,t,n,r,i,a,s,o,l,c){const h=[r/i,i],d=e.values,p=t.values;if(r===0)return ne(n,t.dtype);const g=l instanceof Yn?l:ne(h,t.dtype);typeof l=="string"||typeof l=="number"?g.values.fill(l):typeof l=="boolean"&&g.values.fill(+l);for(let v=0;v<a;v++){const x=[];let b=0;for(let w=0;w<s;w++){const C=d[v*s+w];x.push(C),b+=C*o[w]}if(b<0||b>=r/i)throw new Error(`Invalid indices: ${x} does not index into ${n}`);for(let w=0;w<i;w++)c?g.values[b*i+w]+=p[v*i+w]:g.values[b*i+w]=t.rank===0?p[0]:p[v*i+w]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D1t=Ba(e=>1/(1+Math.exp(-e))),e5=Ie(_p,e=>1/(1+Math.exp(-e))),M1t={kernelName:_p,backendName:"cpu",kernelFunc:e5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n5(e,t,n,r,i){const a=ZE(r,t,n),s=pt(n),o=Bt(r);if(a){const d=QE(t,o);return i==="string"?e.slice(d,d+s):e.subarray(d,d+s)}const l=i==="string"?Ss(e):e,c=ne(r,i,l),h=ne(n,i);for(let d=0;d<h.size;++d){const p=h.indexToLoc(d),g=p.map((v,x)=>v+t[x]);h.set(c.get(...g),...p)}return i==="string"?iq(h.values):h.values}function Ml(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,size:s}=r;Mt(i,"slice");const[o,l]=m0(i,a,s);KE(i,o,l);const c=n.data.get(i.dataId).values,h=n5(c,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,h)}const P1t={kernelName:Jb,backendName:"cpu",kernelFunc:Ml};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5(e,t,n,r,i,a,s){const o=t[0],l=a[0],c=new Array(l),h=new Array(o),d=t[1];if(l===0){if(o!==0)throw new Error(GG(o));const b=un(n,0),w=un(i,0);return[b,[0,d],w,c,h]}let p=!0,g=0;const v=new Array(l).fill(0);for(let b=0;b<o;++b){const w=e[b*d];if(w<0)throw new Error(qG(b,w));if(w>=l)throw new Error(HG(b,w,l));++v[w],p=p&&w>=g,g=w}let x=!0;for(let b=0;b<l;++b){const w=v[b]===0;c[b]=w,x=x&&!w,v[b]=Math.max(v[b],1),b>0&&(v[b]+=v[b-1])}if(x&&p){const b=e,w=r;for(let C=0;C<o;++C)h[C]=C;return[b,[o,d],w,c,h]}else{const b=v[l-1],w=un(n,b*d),C=un(i,b),T=new Array(l).fill(0);for(let $=0;$<o;++$){const A=e[$*d],E=T[A],O=(A===0?0:v[A-1])+E;T[A]++;for(let N=0;N<d;++N)w[O*d+N]=e[$*d+N];C[O]=r[$],h[$]=O}for(let $=0;$<l;++$)if(T[$]===0){const E=$===0?0:v[$-1];w[E*d+0]=$;for(let O=1;O<d;++O)w[E*d+O]=0;C[E]=s}return[w,[b,d],C,c,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i5(e,t,n,r,i){const a=pt(r),s=t[0],o=i.length,l=[];let c=1,h=-1;for(let b=0;b<o;++b){const w=i[b];if(w===-1){if(h!==-1)throw new Error(XG(h,b));h=b,l.push(1)}else{if(w<0)throw new Error(KG(b,w));c*=w,l.push(w)}}if(h!==-1){if(c<=0)throw new Error(YG());const b=Math.trunc(a/c);if(c*b!==a)throw new Error(ZG(r,l));l[h]=b}if(pt(l)!==a)throw new Error(QG(r,l));const p=r.length,g=[];if(p>0){g[p-1]=1;for(let b=p-2;b>=0;--b)g[b]=g[b+1]*r[b+1]}const v=[];if(o>0){v[o-1]=1;for(let b=o-2;b>=0;--b)v[b]=v[b+1]*l[b+1]}const x=un(n,s*o);for(let b=0;b<s;++b){let w=0;for(let C=0;C<p;++C)w+=e[b*p+C]*g[C];for(let C=0;C<o;++C)x[b*o+C]=Math.trunc(w/v[C]),w%=v[C]}return[x,[s,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GI(e,t,n,r,i,a=!1,s=0){const o=r.length,l=[t[0],e.length/t[0]],c=l[1],d=o>0?i[o-1]+1:0;if(d<0)throw new Error(rA());const p=t.slice();p[0]=d;const g=p.reduce((T,$)=>T*$,1),v=un(n,g);if(o===0)return d>0&&v.fill(s),[v,p];if(d<=0)throw new Error(rA());let x=0,b=1,w=0,C=i[x];for(;;){let T=0;if(b<o){if(T=i[b],C===T){++b;continue}if(C>=T)throw new Error(JG())}if(C<0||C>=d)throw new Error(tq(C,d));C>w&&v.fill(s,w*c,C*c);for(let $=x;$<b;++$){const A=r[$];if(A<0||A>=l[0])throw new Error(eq($,r[$],l[0]));for(let E=0;E<c;E++)v[C*c+E]+=e[A*c+E]}if(a)for(let $=0;$<c;$++)v[C*c+$]/=b-x;if(x=b,++b,w=C+1,C=T,b>o)break}return w<d&&v.fill(s,w*c,d*c),[v,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1t=Ba(e=>Math.sqrt(e)),L1t=Ie(Dp,e=>Math.sqrt(e)),B1t={kernelName:Dp,backendName:"cpu",kernelFunc:L1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5=dn((e,t)=>{const n=e-t;return n*n}),z1t=_n(Mp,a5),j1t={kernelName:Mp,backendName:"cpu",kernelFunc:z1t};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s5=Ba((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),U1t=_o(fE,s5),V1t={kernelName:fE,backendName:"cpu",kernelFunc:U1t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o5(e,t,n,r){const i=ne(e,t.dtype);for(let a=0;a<i.size;a++){const s=i.indexToLoc(a),o=new Array(s.length);for(let l=0;l<o.length;l++)o[l]=s[l]*n[l]+r[l];i.set(t.get(...o),...s)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W1t{constructor(t,n,r,i,a,s){this.separator=uo(t),this.nGramWidths=n,this.leftPad=uo(r),this.rightPad=uo(i),this.padWidth=a,this.preserveShort=s}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const r=this.getPadWidth(n);return Math.max(0,t+2*r-n+1)}createNGrams(t,n,r,i,a,s){for(let o=0;o<a;++o){const l=this.getPadWidth(s),c=Math.max(0,l-o),h=Math.max(0,l-(a-(o+1))),d=s-(c+h),p=n+(c>0?0:o-l);let g=0;g+=c*this.leftPad.length;for(let C=0;C<d;++C)g+=t[p+C].length;g+=h*this.rightPad.length;const v=c+h+d-1;g+=v*this.separator.length,r[i+o]=new Uint8Array(g);const x=r[i+o];let b=0;const w=C=>C.forEach(T=>x[b++]=T);for(let C=0;C<c;++C)w(this.leftPad),w(this.separator);for(let C=0;C<d-1;++C)w(t[p+C]),w(this.separator);if(d>0){w(t[p+d-1]);for(let C=0;C<h;++C)w(this.separator),w(this.rightPad)}else{for(let C=0;C<h-1;++C)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(t,n){const r=t.length,i=n.length;if(i>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<i;++c){let h=n[c]>=l;if(h=h&&n[c]<=r,!h)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${r}]`);l=n[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const a=i-1,s=un("int32",i);if(r===0||i===0){const l=new Array(r);for(let c=0;c<=a;++c)s[c]=0;return[l,s]}s[0]=0;for(let l=1;l<=a;++l){const c=n[l]-n[l-1];let h=0;this.nGramWidths.forEach(d=>{h+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&h===0&&(h=1),s[l]=s[l-1]+h}const o=new Array(s[a]);for(let l=0;l<a;++l){const c=n[l];let h=s[l];if(this.nGramWidths.forEach(d=>{const p=n[l+1]-n[l],g=this.getNumNGrams(p,d);this.createNGrams(t,c,o,h,g,d),h+=g}),this.preserveShort&&h===s[l]){const d=n[l+1]-n[l];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(t,c,o,h,1,p)}}return[o,s]}}function l5(e,t,n,r,i,a,s,o){return new W1t(n,r,i,a,s,o).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1t(e,t,n,r){if(!e.length)return;if(t.length===0){for(let a=0;a<e.length;++a)r.push(e.subarray(a,a+1));return}if(t.length===1){const a=t[0];let s=e.indexOf(a);for(;s!==-1;){const o=e.subarray(0,s);(!n||o.length!==0)&&r.push(o),e=e.subarray(s+1),s=e.indexOf(a)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let a=0;a<e.length+1;a++)if(a===e.length||t.indexOf(e[a])!==-1){const s=e.subarray(i,a);(!n||s.length!==0)&&r.push(s),i=a+1}}function u5(e,t,n){const r=e.length,i=[];let a=0,s=0;const o=new Array(r);for(let p=0;p<r;++p){const g=i.length;G1t(e[p],t,n,i);const v=i.length-g;o[p]=v,a+=v,s=Math.max(s,v)}const l=un("int32",a*2),c=new Array(a),h=[r,s];let d=0;for(let p=0;p<r;++p)for(let g=0;g<o[p];++g)l[d*2]=p,l[d*2+1]=g,c[d]=i[d],++d;return[l,c,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(e,t){const n=un("int32",e.length);for(let r=0;r<e.length;++r)n[r]=Aft(e[r]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f5=dn((e,t)=>e-t),q1t=jI((e,t,n,r)=>({real:e-n,imag:t-r})),qI=_n(Pp,f5,q1t),H1t={kernelName:Pp,backendName:"cpu",kernelFunc:qI};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(e,t){const n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];const r=ne(n,e.dtype);for(let i=0;i<r.values.length;++i){const a=r.indexToLoc(i),s=new Array(e.rank);for(let l=0;l<s.length;l++)s[l]=a[l]%e.shape[l];const o=e.locToIndex(s);r.values[i]=e.values[o]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ih=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function d5(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){const o=r-n+1,l=t-n+1,c=Math.log(o),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(o-h)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(t-l*h/o+d)),g=Math.min(r,Math.floor(t+(o-l)*h/o+d));d5(e,t,p,g)}const i=e[t];let a=n,s=r;for(Vu(e,n,t),Ih(e[r],i)>0&&Vu(e,n,r);a<s;){for(Vu(e,a,s),a++,s--;Ih(e[a],i)<0;)a=a+1;for(;Ih(e[s],i)>0;)s=s-1}Ih(e[n],i)===0?Vu(e,n,s):(s=s+1,Vu(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}function p5(e,t,n,r,i){const a=t[t.length-1],[s,o]=[e.length/a,a],l=lr(n,s*r),c=lr("int32",s*r);for(let d=0;d<s;d++){const p=d*o,g=e.subarray(p,p+o);let v=new Array(g.length);g.forEach((C,T)=>v[T]={value:C,index:T}),r<v.length&&(d5(v,r),v=v.slice(0,r)),i&&v.sort(Ih);const x=d*r,b=l.subarray(x,x+r),w=c.subarray(x,x+r);for(let C=0;C<r;C++)b[C]=v[C].value,w[C]=v[C].index}const h=t.slice();return h[h.length-1]=r,[ne(h,n,l),ne(h,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(e,t,n,r){const i=re(t,n)[0],a=[1,n[0],1];for(let v=0;v<i;v++)a[0]*=n[v];a[1]=n[i];for(let v=i+1;v<n.length;v++)a[2]*=n[v];const s=new Map,o=new Int32Array(n[i]),l=new Yn(a,r,e),c=[],h=a[0]===1&&a[2]===1;for(let v=0;v<n[i];v++){let x;if(h)x=e[v].toString();else{const w=[];for(let C=0;C<a[0];C++)for(let T=0;T<a[2];T++)w.push(l.get(C,v,T));x=w.join(",")}const b=s.get(x);if(b!=null)o[v]=b;else{const w=s.size;s.set(x,w),o[v]=w,c.push(v)}}const d=a.slice();d[1]=s.size;const p=new Yn(d,r);c.forEach((v,x)=>{for(let b=0;b<a[0];b++)for(let w=0;w<a[2];w++)p.set(l.get(b,v,w),b,x,w)});const g=n.slice();return g[i]=d[1],{outputValues:p.values,outputShape:g,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X1t=Object.freeze(Object.defineProperty({__proto__:null,addImpl:T6,bincountImpl:UI,bincountReduceImpl:$6,bitwiseAndImpl:A6,castImpl:C6,ceilImpl:k6,concatImpl:E6,equalImpl:I6,expImpl:N6,expm1Impl:R6,floorDivImpl:M6,floorImpl:D6,gatherNdImpl:P6,gatherV2Impl:F6,greaterEqualImpl:B6,greaterImpl:L6,lessEqualImpl:j6,lessImpl:z6,linSpaceImpl:U6,logImpl:V6,maxImpl:W6,maximumImpl:G6,minimumImpl:q6,multiplyImpl:VI,negImpl:H6,notEqualImpl:X6,prodImpl:K6,raggedGatherImpl:Y6,raggedRangeImpl:Z6,raggedTensorToTensorImpl:Q6,rangeImpl:J6,rsqrtImpl:t5,scatterImpl:hl,sigmoidImpl:D1t,simpleAbsImpl:S6,sliceImpl:n5,sparseFillEmptyRowsImpl:r5,sparseReshapeImpl:i5,sparseSegmentReductionImpl:GI,sqrtImpl:F1t,squaredDifferenceImpl:a5,staticRegexReplaceImpl:s5,stridedSliceImpl:o5,stringNGramsImpl:l5,stringSplitImpl:u5,stringToHashBucketFastImpl:c5,subImpl:f5,tileImpl:h5,topKImpl:p5,transposeImpl:WI,uniqueImpl:m5},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */RW("cpu",()=>new I0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g5=Ie(ap,e=>e>=0?e:Math.exp(e)-1),K1t={kernelName:ap,backendName:"cpu",kernelFunc:g5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y5(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:a}=r;Mt([i],"leakyRelu");const s=pt(i.shape),o=n.data.get(i.dataId).values,l=lr("float32",s);for(let c=0;c<o.length;c++)l[c]=o[c]<0?a*o[c]:o[c];return n.makeTensorInfo(i.shape,"float32",l)}const Y1t={kernelName:kb,backendName:"cpu",kernelFunc:y5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z1t=dn((e,t)=>e<0?t*e:e);function v5(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;Mt([r,i],"prelu");const a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,[o,l]=Z1t(r.shape,i.shape,a,s,"float32");return n.makeTensorInfo(l,"float32",o)}const Q1t={kernelName:qb,backendName:"cpu",kernelFunc:v5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b5=Ie(Tp,e=>Math.max(0,e)),J1t={kernelName:Tp,backendName:"cpu",kernelFunc:b5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x5=Ie($p,e=>Math.min(Math.max(0,e),6)),twt={kernelName:$p,backendName:"cpu",kernelFunc:x5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xv(e,t,n,r,i){if(n==="linear")return Fa({inputs:{x:t},backend:e});if(n==="relu")return b5({inputs:{x:t},backend:e});if(n==="elu")return g5({inputs:{x:t},backend:e});if(n==="relu6")return x5({inputs:{x:t},backend:e});if(n==="prelu")return v5({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return y5({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n==="sigmoid")return e5({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function We(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:a}=r,s=pt(i.shape),o=UV(a,s),l=pt(o);j(s===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const c=n.data.get(i.dataId);if(c.complexTensorInfos!=null){const h=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;h.shape=o,d.shape=o}return{dataId:i.dataId,shape:o,dtype:i.dtype}}const ewt={kernelName:Xb,backendName:"cpu",kernelFunc:We};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:s,transposeB:o}=r;Mt([i,a],"matMul");const l=i.shape.length,c=a.shape.length,h=s?i.shape[l-2]:i.shape[l-1],d=o?a.shape[c-1]:a.shape[c-2],p=s?i.shape[l-1]:i.shape[l-2],g=o?a.shape[c-2]:a.shape[c-1],v=i.shape.slice(0,-2),x=a.shape.slice(0,-2),b=pt(v),w=pt(x),T=Jt(i.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,g]);j(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${i.shape} and ${a.shape} and transposeA=${s} and transposeB=${o} must match.`);const $=s?[b,h,p]:[b,p,h],A=o?[w,g,d]:[w,d,g],E=We({inputs:{x:i},backend:n,attrs:{shape:$}}),O=We({inputs:{x:a},backend:n,attrs:{shape:A}}),N=s?E.shape[1]:E.shape[2],_=s?E.shape[2]:E.shape[1],R=o?O.shape[1]:O.shape[2],I=Math.max(b,w),P=n.data.get(E.dataId).values,B=n.data.get(O.dataId).values,V=Bt(E.shape),z=Bt(O.shape),[M,U,W]=s?[V[0],1,V[1]]:[V[0],V[1],1],[q,F,G]=o?[1,z[1],z[0]]:[z[1],1,z[0]],H=_*R,Y=ne([I,_,R],E.dtype),ot=Y.values,ht=n.blockSize;for(let yt=0;yt<I;yt++){const It=yt%b,$t=yt%w;for(let mt=0;mt<_;mt+=ht){const At=Math.min(mt+ht,_);for(let kt=0;kt<R;kt+=ht){const gt=Math.min(kt+ht,R);for(let Ut=0;Ut<N;Ut+=ht){const Lt=Math.min(Ut+ht,N);for(let Zt=mt;Zt<At;Zt++)for(let Wt=kt;Wt<gt;Wt++){let qt=0;for(let fe=Ut;fe<Lt;fe++){const Rn=P[It*M+Zt*U+fe*W],Ge=B[fe*q+Wt*F+$t*G];qt+=Rn*Ge}ot[yt*H+(Zt*R+Wt)]+=qt}}}}}return n.disposeIntermediateTensorInfo(E),n.disposeIntermediateTensorInfo(O),n.makeTensorInfo(T,Y.dtype,Y.values)}const nwt={kernelName:hb,backendName:"cpu",kernelFunc:w5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rwt(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:d}=r;let p,g,v;const x=[];p=w5({inputs:{a:i,b:a},attrs:{transposeA:l,transposeB:c},backend:n}),s&&(g=Rc({inputs:{a:p,b:s},backend:n}),x.push(p),p=g),h&&(v=xv(n,p,h,o,d),x.push(p),p=v);for(const w of x)n.disposeIntermediateTensorInfo(w);return p}const iwt={kernelName:ev,backendName:"cpu",kernelFunc:rwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const awt=Ie(qd,e=>Math.acos(e)),swt={kernelName:qd,backendName:"cpu",kernelFunc:awt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const owt=Ie(Hd,e=>Math.acosh(e)),lwt={kernelName:Hd,backendName:"cpu",kernelFunc:owt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uwt(e){const{inputs:t,backend:n}=e,r=t;Mt(t,"addN");const i=r.map(o=>n.data.get(o.dataId).values),a=ne(r[0].shape,r[0].dtype),s=a.values;for(let o=0;o<r.length;o++){const l=i[o];for(let c=0;c<s.length;c++)s[c]+=l[c]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}const cwt={kernelName:ob,backendName:"cpu",kernelFunc:uwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;Mt(i,"all");const o=re(a,i.shape);let l=o;const c=en(l,i.shape.length);let h=i;c!=null&&(h=Mr({inputs:{x:i},backend:n,attrs:{perm:c}}),l=fn(l.length,i.shape.length)),Jn("all",l,h.shape.length);const[d,p]=Vn(h.shape,l),g=pt(p),v=ur(pt(d),h.dtype),x=n.data.get(h.dataId).values;for(let w=0;w<v.length;++w){const C=w*g;let T=x[C];for(let $=0;$<g;++$){const A=x[C+$];T=T&&A}v[w]=T}c!=null&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(d,h.dtype,v);if(s){const w=bn(d,o),C=We({inputs:{x:b},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(b),C}return b}const hwt={kernelName:Nk,backendName:"cpu",kernelFunc:fwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;Mt(i,"any");const o=re(a,i.shape);let l=o;const c=en(l,i.shape.length);let h=i;c!=null&&(h=Mr({inputs:{x:i},backend:n,attrs:{perm:c}}),l=fn(l.length,i.shape.length)),Jn("any",l,h.shape.length);const[d,p]=Vn(h.shape,l),g=pt(p),v=ur(pt(d),h.dtype),x=n.data.get(h.dataId).values;for(let w=0;w<v.length;++w){const C=w*g;let T=x[C];for(let $=0;$<g;++$){const A=x[C+$];T=T||A}v[w]=T}c!=null&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(d,h.dtype,v);if(s){const w=bn(d,o),C=We({inputs:{x:b},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(b),C}return b}const pwt={kernelName:_k,backendName:"cpu",kernelFunc:dwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;Mt(i,"argMax");let s=re(a,i.shape);const o=en(s,i.shape.length);let l=i;const c=[];o!=null&&(l=Mr({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),s=fn(s.length,l.shape.length)),s=[s[0]],Jn("argMax",s,l.shape.length);const[h,d]=Vn(l.shape,s),p=pt(h),g=ur(p,"int32"),v=pt(d),x=n.data.get(l.dataId).values;for(let b=0;b<g.length;++b){const w=b*v;let C=x[w],T=0;for(let $=0;$<v;++$){const A=x[w+$];A>C&&(C=A,T=$)}g[b]=T}return c.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(h,"int32",g)}const gwt={kernelName:lb,backendName:"cpu",kernelFunc:mwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ywt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;Mt(i,"argMin");let s=re(a,i.shape);const o=en(s,i.shape.length);let l=i;const c=[];o!=null&&(l=Mr({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),s=fn(s.length,l.shape.length)),s=[s[0]],Jn("argMin",s,l.shape.length);const[h,d]=Vn(l.shape,s),p=pt(h),g=ur(p,"int32"),v=pt(d),x=n.data.get(l.dataId).values;for(let b=0;b<g.length;++b){const w=b*v;let C=x[w],T=0;for(let $=0;$<v;++$){const A=x[w+$];A<C&&(C=A,T=$)}g[b]=T}return c.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(h,"int32",g)}const vwt={kernelName:ub,backendName:"cpu",kernelFunc:ywt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bwt=Ie(Xd,e=>Math.asin(e)),xwt={kernelName:Xd,backendName:"cpu",kernelFunc:bwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wwt=Ie(Kd,e=>Math.asinh(e)),Swt={kernelName:Kd,backendName:"cpu",kernelFunc:wwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cwt=Ie(Yd,e=>Math.atan(e)),Twt={kernelName:Yd,backendName:"cpu",kernelFunc:Cwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $wt=dn((e,t)=>Math.atan2(e,t)),Awt=_n(Qd,$wt),kwt={kernelName:Qd,backendName:"cpu",kernelFunc:Awt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ewt=Ie(Zd,e=>Math.atanh(e)),Iwt={kernelName:Zd,backendName:"cpu",kernelFunc:Ewt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HI(e,t,n,r,i,a){const s=i.strideHeight,o=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,h=i.effectiveFilterHeight,d=i.effectiveFilterWidth,p=i.padInfo.top,g=i.padInfo.left,v=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=ne(i.outShape,n),b=x.values,w=i.outShape[1]*i.outShape[2]*i.outShape[3],C=i.outShape[2]*i.outShape[3],T=i.outShape[3];for(let $=0;$<i.batchSize;++$){const A=$*w,E=$*r[0];for(let O=0;O<i.inChannels;++O)for(let N=0;N<i.outHeight;++N){const _=N*s-p,R=Math.max(0,_),I=Math.min(i.inHeight,h+_),P=A+N*C;for(let B=0;B<i.outWidth;++B){const V=B*o-g,z=Math.max(0,V),M=Math.min(i.inWidth,d+V);let U=v,W=0,q=0;for(let G=R;G<I;G+=l){const H=E+G*r[1];for(let Y=z;Y<M;Y+=c){const ot=H+Y*r[2],ht=e[ot+O];a==="max"&&ht>U?U=ht:a==="avg"&&(W+=ht,q++)}if(isNaN(U))break}const F=P+B*T+O;b[F]=a==="avg"?W/q:U}}}return x}function S5(e,t,n,r,i=!1,a=!1){const s=ne(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,g=r.padInfo.top,v=r.padInfo.left,x=ne(t,n,e);for(let b=0;b<r.batchSize;++b)for(let w=0;w<r.inChannels;++w)for(let C=0;C<r.outHeight;++C){const T=C*o-g;let $=T;for(;$<0;)$+=c;const A=Math.min(r.inHeight,d+T);for(let E=0;E<r.outWidth;++E){const O=E*l-v;let N=O;for(;N<0;)N+=h;const _=Math.min(r.inWidth,p+O);let R=Number.NEGATIVE_INFINITY,I=-1;for(let P=$;P<A;P+=c){const B=P-T;for(let V=N;V<_;V+=h){const z=V-O,M=x.get(b,P,V,w);M>R&&(R=M,i?I=a?((b*r.inHeight+P)*r.inWidth+V)*r.inChannels+w:(P*r.inWidth+V)*r.inChannels+w:I=B*p+z)}}s.set(I,b,C,E,w)}}return s}function C5(e,t,n,r,i,a){const s=i.strideDepth,o=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,h=i.dilationHeight,d=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,v=i.effectiveFilterWidth,x=i.padInfo.front,b=i.padInfo.top,w=i.padInfo.left,C=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=ne(i.outShape,n),$=T.values,A=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],E=i.outShape[2]*i.outShape[3]*i.outShape[4],O=i.outShape[3]*i.outShape[4],N=i.outShape[4];for(let _=0;_<i.batchSize;++_){const R=_*A,I=_*r[0];for(let P=0;P<i.inChannels;++P)for(let B=0;B<i.outDepth;++B){const V=B*s-x;let z=V;for(;z<0;)z+=c;const M=Math.min(i.inDepth,p+V),U=R+B*E;for(let W=0;W<i.outHeight;++W){const q=W*o-b;let F=q;for(;F<0;)F+=h;const G=Math.min(i.inHeight,g+q),H=U+W*O;for(let Y=0;Y<i.outWidth;++Y){const ot=Y*l-w;let ht=ot;for(;ht<0;)ht+=d;const yt=Math.min(i.inWidth,v+ot),It=H+Y*N;let $t=C,mt=0,At=0;for(let gt=z;gt<M;gt+=c){const Ut=I+gt*r[1];for(let Lt=F;Lt<G;Lt+=h){const Zt=Ut+Lt*r[2];for(let Wt=ht;Wt<yt;Wt+=d){const qt=Zt+Wt*r[3],fe=e[qt+P];if(a==="max"&&fe>$t?$t=fe:a==="avg"&&(mt+=fe,At++),isNaN($t))break}if(isNaN($t))break}if(isNaN($t))break}const kt=It+P;$[kt]=a==="avg"?mt/Math.max(At,1):$t}}}}return T}function Owt(e,t){const n=ne(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,g=t.padInfo.top,v=t.padInfo.left;for(let x=0;x<t.batchSize;++x)for(let b=0;b<t.inChannels;++b)for(let w=0;w<t.outDepth;++w){const C=w*r-p;let T=C;for(;T<0;)T+=s;const $=Math.min(t.inDepth,c+C);for(let A=0;A<t.outHeight;++A){const E=A*i-g;let O=E;for(;O<0;)O+=o;const N=Math.min(t.inHeight,h+E);for(let _=0;_<t.outWidth;++_){const R=_*a-v;let I=R;for(;I<0;)I+=l;const P=Math.min(t.inWidth,d+R);let B=Number.NEGATIVE_INFINITY,V=-1;for(let z=T;z<$;z+=s){const M=z-C;for(let U=O;U<N;U+=o){const W=U-E;for(let q=I;q<P;q+=l){const F=q-R,G=e.get(x,z,U,q,b);G>=B&&(B=G,V=M*h*d+W*h+F)}}}n.set(V,x,w,A,_,b)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Mt(i,"avgPool");const{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,c=1;j(cr(s,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const h=ji(i.shape,a,s,c,o,l);let d;if(h.filterWidth===1&&h.filterHeight===1&&we(h.inShape,h.outShape))d=Fa({inputs:{x:i},backend:n});else{const p=n.data.get(i.dataId).values,g=Bt(i.shape),v=HI(p,i.shape,i.dtype,g,h,"avg");d=n.makeTensorInfo(h.outShape,i.dtype,v.values)}return d}const _wt={kernelName:cb,backendName:"cpu",kernelFunc:Nwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r;Mt(i,"avgPool3d");const h=ks(i.shape,a,s,1,o,l,c),d=n.data.get(i.dataId).values,p=C5(d,i.shape,i.dtype,Bt(i.shape),h,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const Dwt={kernelName:fb,backendName:"cpu",kernelFunc:Rwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;Mt([i,a],"avgPool3DGrad");const h=ks(a.shape,s,o,1,l,c),d=h.strideDepth,p=h.strideHeight,g=h.strideWidth,v=h.filterDepth,x=h.filterHeight,b=h.filterWidth,w=h.dilationDepth,C=h.dilationHeight,T=h.dilationWidth,$=h.effectiveFilterDepth,A=h.effectiveFilterHeight,E=h.effectiveFilterWidth,O=$-1-h.padInfo.front,N=E-1-h.padInfo.left,_=A-1-h.padInfo.top,R=ne(a.shape,"float32"),I=1/(v*x*b),P=n.bufferSync(i);for(let B=0;B<h.batchSize;++B)for(let V=0;V<h.inChannels;++V)for(let z=0;z<h.inDepth;++z)for(let M=0;M<h.inHeight;++M)for(let U=0;U<h.inWidth;++U){const W=z-O,q=M-_,F=U-N;let G=0;for(let H=0;H<$;H+=w){const Y=(W+H)/d;if(!(Y<0||Y>=h.outDepth||Math.floor(Y)!==Y))for(let ot=0;ot<A;ot+=C){const ht=(q+ot)/p;if(!(ht<0||ht>=h.outHeight||Math.floor(ht)!==ht))for(let yt=0;yt<E;yt+=T){const It=(F+yt)/g;if(It<0||It>=h.outWidth||Math.floor(It)!==It)continue;const $t=P.get(B,Y,ht,It,V);G+=$t}}}R.set(G*I,B,z,M,U,V)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const Pwt={kernelName:Dk,backendName:"cpu",kernelFunc:Mwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fwt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a;Mt([i,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=r,h=ji(s.shape,o,l,1,c),d=h.strideHeight,p=h.strideWidth,g=h.filterHeight,v=h.filterWidth,x=h.dilationHeight,b=h.dilationWidth,w=h.effectiveFilterHeight,C=h.effectiveFilterWidth,T=C-1-h.padInfo.left,$=w-1-h.padInfo.top,A=ne(s.shape,"float32"),E=1/(g*v),O=n.data.get(i.dataId).values,N=ne(i.shape,"float32",O);for(let _=0;_<h.batchSize;++_)for(let R=0;R<h.inChannels;++R)for(let I=0;I<h.inHeight;++I)for(let P=0;P<h.inWidth;++P){const B=I-$,V=P-T;let z=0;for(let M=0;M<w;M+=x){const U=(B+M)/d;if(!(U<0||U>=h.outHeight||Math.floor(U)!==U))for(let W=0;W<C;W+=b){const q=(V+W)/p;if(q<0||q>=h.outWidth||Math.floor(q)!==q)continue;const F=N.get(_,U,q,R);z+=F}}A.set(z*E,_,I,P,R)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const Lwt={kernelName:Rk,backendName:"cpu",kernelFunc:Fwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,scale:a,offset:s,mean:o,variance:l}=t;j(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Mt([i,o,l,a,s],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);const h=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,g=a?n.data.get(a.dataId).values:new Float32Array([1]),v=s?n.data.get(s.dataId).values:new Float32Array([0]),x=new Float32Array(h.length),b=v.length,w=g.length,C=p.length,T=d.length;let $=0,A=0,E=0,O=0;for(let N=0;N<h.length;++N)x[N]=v[$++]+(h[N]-d[A++])*g[E++]/Math.sqrt(p[O++]+c),$>=b&&($=0),A>=T&&(A=0),E>=w&&(E=0),O>=C&&(O=0);return n.makeTensorInfo(i.shape,i.dtype,x)}const zwt={kernelName:Tb,backendName:"cpu",kernelFunc:Bwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:s}=r;Mt([i],"batchToSpaceND");const o=a.reduce((w,C)=>w*C),l=Xp(i.shape,a,o),c=Kp(l.length,a.length),h=Yp(i.shape,a,o),d=rI(s,a.length),p=iI(h,s,a.length),g=We({inputs:{x:i},backend:n,attrs:{shape:l}}),v=Mr({inputs:{x:g},backend:n,attrs:{perm:c}}),x=We({inputs:{x:v},backend:n,attrs:{shape:h}}),b=Ml({inputs:{x},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),b}const Uwt={kernelName:db,backendName:"cpu",kernelFunc:jwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vwt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s}=r,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,c=UI(o,l,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,c)}const Wwt={kernelName:Mk,backendName:"cpu",kernelFunc:Vwt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gwt(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,o=Jt(Array.from(a),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const qwt={kernelName:XV,backendName:"cpu",kernelFunc:Gwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hwt=Ie(ep,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),Xwt={kernelName:ep,backendName:"cpu",kernelFunc:Hwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kwt=e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(pt(t.shape)),i=n.data.get(t.dataId),a=i.complexTensorInfos.real,s=i.complexTensorInfos.imag,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values;for(let c=0;c<o.length;c++){const h=o[c],d=l[c];r[c]=Math.hypot(h,d)}return n.makeOutput(r,t.shape,"float32")},Ywt={kernelName:pb,backendName:"cpu",kernelFunc:Kwt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dc(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const Zwt={kernelName:Jk,backendName:"cpu",kernelFunc:Dc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mc(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,a=re(i,t[0].shape)[0],s=t.map(x=>x.shape);tI(s,a);let o=Ia(t.map(x=>x.shape),a);if(pt(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(x=>pt(x.shape)>0);if(l.length===1)return Fa({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const x=l.map($=>Dl({inputs:{input:$},backend:n})),b=l.map($=>Dc({inputs:{input:$},backend:n})),w=Mc({inputs:x,backend:n,attrs:{axis:a}}),C=Mc({inputs:b,backend:n,attrs:{axis:a}}),T=qr({inputs:{real:w,imag:C},backend:n});return x.forEach($=>n.disposeIntermediateTensorInfo($)),b.forEach($=>n.disposeIntermediateTensorInfo($)),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(C),T}const c=l.map(x=>{const w=[-1,pt(x.shape.slice(a))];return We({inputs:{x},backend:n,attrs:{shape:w}})}),h=c.map(x=>({vals:n.data.get(x.dataId).values,shape:x.shape}));o=Ia(c.map(x=>x.shape),1);const d=c[0].shape[0]===1,p=E6(h,o,t[0].dtype,d),g=Ia(l.map(x=>x.shape),a),v=n.makeTensorInfo(g,t[0].dtype,p);return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const Qwt={kernelName:mb,backendName:"cpu",kernelFunc:Mc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dataFormat:l,dilations:c,dimRoundingMode:h}=r;Mt([i,a],"conv2d");const d=Es(l),p=Qn(i.shape,a.shape,s,c,o,h,!1,d),g=p.filterHeight,v=p.filterWidth,x=p.dilationHeight,b=p.dilationWidth,w=p.padInfo.left,C=p.padInfo.top,T=p.dataFormat==="channelsLast",$=new Yn(p.outShape,i.dtype),A=Bt(i.shape),E=Bt(a.shape),O=A[0],N=T?A[1]:A[2],_=T?A[2]:1,R=T?1:A[1],I=$.strides[0],P=T?$.strides[1]:$.strides[2],B=T?$.strides[2]:1,V=T?1:$.strides[1],z=n.data.get(i.dataId).values,M=n.data.get(a.dataId).values,U=$.values;for(let W=0;W<p.batchSize;++W){const q=W*O,F=W*I;for(let G=0;G<p.outHeight;++G){const H=F+G*P,Y=G*p.strideHeight-C;for(let ot=0;ot<g;++ot){const ht=Y+ot*x;if(ht<0||ht>=p.inHeight)continue;const yt=ot*E[0],It=q+ht*N;for(let $t=0;$t<p.outWidth;++$t){const mt=H+$t*B,At=$t*p.strideWidth-w;for(let kt=0;kt<v;++kt){const gt=At+kt*b;if(gt<0||gt>=p.inWidth)continue;const Ut=yt+kt*E[1],Lt=It+gt*_;let Zt=Ut;for(let Wt=0;Wt<p.inChannels;++Wt){const qt=z[Lt+Wt*R];for(let fe=0;fe<p.outChannels;++fe)U[mt+fe*V]+=qt*M[Zt+fe];Zt+=p.outChannels}}}}}}return n.makeTensorInfo($.shape,$.dtype,U)}const Jwt={kernelName:gb,backendName:"cpu",kernelFunc:T5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:h}=r;Mt([i,a],"conv2dBackpropFilter");const d=Es(l),p=Qn(i.shape,h,s,1,o,c,!1,d),{strideHeight:g,strideWidth:v,filterHeight:x,filterWidth:b}=p,w=p.dataFormat==="channelsLast",C=new Yn(p.filterShape,"float32"),T=p.padInfo.left,$=p.padInfo.top,A=n.data.get(i.dataId).values,E=n.data.get(a.dataId).values,O=new Yn(i.shape,i.dtype,A),N=new Yn(a.shape,a.dtype,E);for(let _=0;_<x;++_){const R=Math.max(0,Math.ceil(($-_)/g)),I=Math.min(p.outHeight,(p.inHeight+$-_)/g);for(let P=0;P<b;++P){const B=Math.max(0,Math.ceil((T-P)/v)),V=Math.min(p.outWidth,(p.inWidth+T-P)/v);for(let z=0;z<p.inChannels;++z)for(let M=0;M<p.outChannels;++M){let U=0;for(let W=0;W<p.batchSize;++W)for(let q=R;q<I;++q){const F=_+q*g-$;for(let G=B;G<V;++G){const H=P+G*v-T;w?U+=O.get(W,F,H,z)*N.get(W,q,G,M):U+=O.get(W,z,F,H)*N.get(W,M,q,G)}}C.set(U,_,P,z,M)}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const eSt={kernelName:Lk,backendName:"cpu",kernelFunc:tSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:h}=r;Mt([i,a],"conv2dBackpropInput");const d=Bt(a.shape),p=Bt(i.shape);let g=Es(c);const v=Qn(s,a.shape,o,1,l,h,!1,g),x=new Yn(v.inShape,"float32"),b=x.values,w=n.data.get(i.dataId).values,C=n.data.get(a.dataId).values,[T,$,A]=d,{batchSize:E,filterHeight:O,filterWidth:N,inChannels:_,inHeight:R,inWidth:I,outChannels:P,outHeight:B,outWidth:V,strideHeight:z,strideWidth:M}=v;g=v.dataFormat;const U=O-1-v.padInfo.top,W=N-1-v.padInfo.left,q=g==="channelsLast",F=x.strides[0],G=q?x.strides[1]:x.strides[2],H=q?x.strides[2]:1,Y=q?1:x.strides[1],ot=p[0],ht=q?p[1]:p[2],yt=q?p[2]:1,It=q?1:p[1];for(let $t=0;$t<E;++$t)for(let mt=0;mt<_;++mt)for(let At=0;At<R;++At){const kt=At-U,gt=Math.max(0,Math.ceil(kt/z)),Ut=Math.min(B,(O+kt)/z);for(let Lt=0;Lt<I;++Lt){const Zt=Lt-W,Wt=Math.max(0,Math.ceil(Zt/M)),qt=Math.min(V,(N+Zt)/M);let fe=0;for(let Ge=gt;Ge<Ut;++Ge){const pn=Ge*z-kt;for(let nn=Wt;nn<qt;++nn){const Fr=nn*M-Zt,dr=ot*$t+ht*Ge+yt*nn,Lr=T*(O-1-pn)+$*(N-1-Fr)+A*mt;for(let Br=0;Br<P;++Br){const an=w[dr+It*Br],er=C[Lr+Br];fe+=an*er}}}const Rn=F*$t+G*At+H*Lt+Y*mt;b[Rn]=fe}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const rSt={kernelName:yb,backendName:"cpu",kernelFunc:nSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r;Mt([i,a],"conv3d");const c=Ao(i.shape,a.shape,s,l,o),{filterDepth:h,filterHeight:d,filterWidth:p,dilationDepth:g,dilationHeight:v,dilationWidth:x,padInfo:b}=c,w=b.front,C=b.left,T=b.top,$=new Yn(c.outShape,i.dtype),A=n.data.get(i.dataId).values,E=n.data.get(a.dataId).values,O=$.values,N=Bt(i.shape),_=Bt(a.shape);for(let R=0;R<c.batchSize;++R){const I=R*N[0],P=R*$.strides[0];for(let B=0;B<c.outDepth;++B){const V=P+B*$.strides[1],z=B*c.strideDepth-w;for(let M=0;M<h;++M){const U=z+M*g;if(U<0||U>=c.inDepth)continue;const W=M*_[0],q=I+U*N[1];for(let F=0;F<c.outHeight;++F){const G=V+F*$.strides[2],H=F*c.strideHeight-T;for(let Y=0;Y<d;++Y){const ot=H+Y*v;if(ot<0||ot>=c.inHeight)continue;const ht=W+Y*_[1],yt=q+ot*N[2];for(let It=0;It<c.outWidth;++It){const $t=G+It*c.outChannels,mt=It*c.strideWidth-C;for(let At=0;At<p;++At){const kt=mt+At*x;if(kt<0||kt>=c.inWidth)continue;const gt=ht+At*_[2],Ut=yt+kt*c.inChannels;let Lt=gt;for(let Zt=0;Zt<c.inChannels;++Zt){const Wt=A[Ut+Zt];for(let qt=0;qt<c.outChannels;++qt)O[$t+qt]+=Wt*E[Lt+qt];Lt+=c.outChannels}}}}}}}}return n.makeTensorInfo($.shape,$.dtype,$.values)}const aSt={kernelName:vb,backendName:"cpu",kernelFunc:iSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,filterShape:l}=r;Mt([i,a],"conv3dBackpropFilterV2");const c=Bt(i.shape),h=Bt(a.shape),d=Ao(i.shape,l,s,1,o),p=d.strideDepth,g=d.strideHeight,v=d.strideWidth,x=d.filterDepth,b=d.filterHeight,w=d.filterWidth,C=new Yn(d.filterShape,"float32"),T=C.values,[$,A,E,O]=C.strides,N=n.data.get(a.dataId).values,[_,R,I,P]=h,B=n.data.get(i.dataId).values,[V,z,M,U]=c,W=d.padInfo.front,q=d.padInfo.left,F=d.padInfo.top;for(let G=0;G<x;++G){const H=Math.max(0,Math.ceil((W-G)/p)),Y=Math.min(d.outDepth,(d.inDepth+W-G)/p),ot=G*$;for(let ht=0;ht<b;++ht){const yt=Math.max(0,Math.ceil((F-ht)/g)),It=Math.min(d.outHeight,(d.inHeight+F-ht)/g),$t=ht*A+ot;for(let mt=0;mt<w;++mt){const At=Math.max(0,Math.ceil((q-mt)/v)),kt=Math.min(d.outWidth,(d.inWidth+q-mt)/v),gt=mt*E+$t;for(let Ut=0;Ut<d.inChannels;++Ut){const Lt=Ut*O+gt;for(let Zt=0;Zt<d.outChannels;++Zt){let Wt=0;for(let qt=0;qt<d.batchSize;++qt){const fe=qt*V,Rn=qt*_;for(let Ge=H;Ge<Y;++Ge){const nn=(G+Ge*p-W)*z+fe,Fr=Ge*R+Rn;for(let dr=yt;dr<It;++dr){const Br=(ht+dr*g-F)*M+nn,an=dr*I+Fr;for(let er=At;er<kt;++er){const cf=(mt+er*v-q)*U+Br,ff=er*P+an;Wt+=B[cf+Ut]*N[ff+Zt]}}}}T[Lt+Zt]=Wt}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const oSt={kernelName:Bk,backendName:"cpu",kernelFunc:sSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:s,strides:o,inputShape:l}=r;Mt([i],"conv3dBackpropInputV2");const c=Bt(i.shape),h=Bt(a.shape),d=Ao(l,a.shape,o,1,s),p=new Yn(d.inShape,"float32"),g=p.values,[v,x,b,w]=p.strides,C=n.data.get(i.dataId).values,[T,$,A,E]=c,O=n.data.get(a.dataId).values,[N,_,R,I]=h,{batchSize:P,filterDepth:B,filterHeight:V,filterWidth:z,inChannels:M,inDepth:U,inHeight:W,inWidth:q,outChannels:F,outDepth:G,outHeight:H,outWidth:Y,strideDepth:ot,strideHeight:ht,strideWidth:yt}=d,It=B-1-d.padInfo.front,$t=V-1-d.padInfo.top,mt=z-1-d.padInfo.left;for(let At=0;At<P;++At)for(let kt=0;kt<M;++kt)for(let gt=0;gt<U;++gt){const Ut=gt-It,Lt=Math.max(0,Math.ceil(Ut/ot)),Zt=Math.min(G,(B+Ut)/ot);for(let Wt=0;Wt<W;++Wt){const qt=Wt-$t,fe=Math.max(0,Math.ceil(qt/ht)),Rn=Math.min(H,(V+qt)/ht);for(let Ge=0;Ge<q;++Ge){const pn=Ge-mt,nn=Math.max(0,Math.ceil(pn/yt)),Fr=Math.min(Y,(z+pn)/yt);let dr=0;for(let Lr=Lt;Lr<Zt;++Lr){const Br=Lr*ot-Ut;for(let an=fe;an<Rn;++an){const er=an*ht-qt;for(let Dn=nn;Dn<Fr;++Dn){const cf=Dn*yt-pn,ff=T*At+$*Lr+A*an+E*Dn,P0=N*(B-1-Br)+_*(V-1-er)+R*(z-1-cf)+I*kt;for(let za=0;za<F;++za){const Yl=C[ff+za],ja=O[P0+za];dr+=Yl*ja}}}}g[v*At+x*gt+b*Wt+w*Ge+kt]=dr}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const uSt={kernelName:zk,backendName:"cpu",kernelFunc:lSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cSt=Ie(np,e=>Math.cos(e)),fSt={kernelName:np,backendName:"cpu",kernelFunc:cSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hSt=Ie(rp,e=>Math.cosh(e)),dSt={kernelName:rp,backendName:"cpu",kernelFunc:hSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pSt(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:a,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=r,[h,d,p,g]=i.shape,v=a.shape[0],[x,b]=o,w=ne([v,x,b,g],"float32"),C=n.data.get(a.dataId).values,T=n.data.get(s.dataId).values,$=n.data.get(i.dataId).values,A=Bt(i.shape),E=Bt(w.shape);for(let O=0;O<v;O++){const N=O*4,_=C[N],R=C[N+1],I=C[N+2],P=C[N+3],B=T[O];if(B>=h)continue;const V=x>1?(I-_)*(d-1)/(x-1):0,z=b>1?(P-R)*(p-1)/(b-1):0;for(let M=0;M<x;M++){const U=x>1?_*(d-1)+M*V:.5*(_+I)*(d-1);if(U<0||U>d-1){for(let W=0;W<b;W++)for(let q=0;q<g;q++){const F=q+W*E[2]+M*E[1]+O*E[0];w.values[F]=c}continue}if(l==="bilinear"){const W=Math.floor(U),q=Math.ceil(U),F=U-W;for(let G=0;G<b;G++){const H=b>1?R*(p-1)+G*z:.5*(R+P)*(p-1);if(H<0||H>p-1){for(let yt=0;yt<g;yt++){const It=yt+G*E[2]+M*E[1]+O*E[0];w.values[It]=c}continue}const Y=Math.floor(H),ot=Math.ceil(H),ht=H-Y;for(let yt=0;yt<g;yt++){let It=yt+Y*A[2]+W*A[1]+B*A[0];const $t=$[It];It=yt+ot*A[2]+W*A[1]+B*A[0];const mt=$[It];It=yt+Y*A[2]+q*A[1]+B*A[0];const At=$[It];It=yt+ot*A[2]+q*A[1]+B*A[0];const kt=$[It],gt=$t+(mt-$t)*ht,Ut=At+(kt-At)*ht;It=yt+G*E[2]+M*E[1]+O*E[0],w.values[It]=gt+(Ut-gt)*F}}}else for(let W=0;W<b;++W){const q=b>1?R*(p-1)+W*z:.5*(R+P)*(p-1);if(q<0||q>p-1){for(let H=0;H<g;H++){const Y=H+W*E[2]+M*E[1]+O*E[0];w.values[Y]=c}continue}const F=Math.round(q),G=Math.round(U);for(let H=0;H<g;H++){const Y=H+F*A[2]+G*A[1]+B*A[0],ot=H+W*E[2]+M*E[1]+O*E[0];w.values[ot]=$[Y]}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const mSt={kernelName:Uk,backendName:"cpu",kernelFunc:pSt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;Mt(i,"cumprod");const l=en([a],i.shape.length);let c=i;l!=null&&(c=Mr({inputs:{x:i},backend:n,attrs:{perm:l}}));const h=fn(1,i.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const d=Xr(c.dtype,"int32"),p=Ek(pt(c.shape),d),g=n.data.get(c.dataId).values,v=c.shape[c.shape.length-1],x=o?(w,C)=>w+v-C-1:(w,C)=>w+C;for(let w=0;w<g.length;w+=v)for(let C=0;C<v;C++){const T=x(w,C);if(C===0)p[T]=s?1:g[T];else{const $=x(w,C-1);p[T]=s?g[$]*p[$]:g[T]*p[$]}}const b=n.makeTensorInfo(c.shape,d,p);if(l!=null){const w=ko(l),C=Mr({inputs:{x:b},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),C}return b}const ySt={kernelName:jk,backendName:"cpu",kernelFunc:gSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;Mt(i,"cumsum");const l=en([a],i.shape.length);let c=i;l!=null&&(c=Mr({inputs:{x:i},backend:n,attrs:{perm:l}}));const h=fn(1,i.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const d=Xr(c.dtype,"int32"),p=ur(pt(c.shape),d),g=n.data.get(c.dataId).values,v=c.shape[c.shape.length-1],x=o?(w,C)=>w+v-C-1:(w,C)=>w+C;for(let w=0;w<g.length;w+=v)for(let C=0;C<v;C++){const T=x(w,C);if(C===0)p[T]=s?0:g[T];else{const $=x(w,C-1);p[T]=s?g[$]+p[$]:g[T]+p[$]}}const b=n.makeTensorInfo(c.shape,d,p);if(l!=null){const w=ko(l),C=Mr({inputs:{x:b},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),C}return b}const bSt={kernelName:bb,backendName:"cpu",kernelFunc:vSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s,binaryOutput:o}=r;if(i.shape.length===1){const l=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,h=UI(l,c,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,h)}else if(i.shape.length===2){const l=n.bufferSync(i),c=n.bufferSync(a),h=$6(l,c,s,o);return n.makeTensorInfo(h.shape,a.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const wSt={kernelName:Vk,backendName:"cpu",kernelFunc:xSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SSt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:a,dataFormat:s}=r;j(s==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`);const o=i.shape[0],l=i.shape[1],c=i.shape[2],h=i.shape[3],d=l*a,p=c*a,g=h/(a*a),v=n.data.get(i.dataId).values,x=new Float32Array(o*d*p*g);let b=0;for(let w=0;w<o;++w)for(let C=0;C<d;++C){const T=Math.floor(C/a),$=C%a;for(let A=0;A<p;++A){const E=Math.floor(A/a),O=A%a,N=($*a+O)*g;for(let _=0;_<g;++_){const I=_+N+h*(E+c*(T+l*w));x[b++]=v[I]}}}return n.makeTensorInfo([o,d,p,g],i.dtype,x)}const CSt={kernelName:Wk,backendName:"cpu",kernelFunc:SSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $5(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:c}=r;Mt([i,a],"depthwiseConv2DNative");const h=Bt(i.shape),d=Bt(a.shape);let p=l;p==null&&(p=[1,1]),j(cr(s,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${p}'`);const g=Qn(i.shape,a.shape,s,p,o,c,!0),{filterHeight:v,filterWidth:x,dilationHeight:b,dilationWidth:w,padInfo:C}=g,T=C.left,$=C.top,A=g.outChannels/g.inChannels,E=new Yn(g.outShape,i.dtype),O=n.data.get(i.dataId).values,N=n.data.get(a.dataId).values,_=E.values;for(let R=0;R<g.batchSize;++R){const I=R*h[0],P=R*E.strides[0];for(let B=0;B<g.outHeight;++B){const V=P+B*E.strides[1],z=B*g.strideHeight-$;for(let M=0;M<v;++M){const U=z+M*b;if(U<0||U>=g.inHeight)continue;const W=M*d[0],q=I+U*h[1];for(let F=0;F<g.outWidth;++F){const G=V+F*E.strides[2],H=F*g.strideWidth-T;for(let Y=0;Y<x;++Y){const ot=H+Y*w;if(ot<0||ot>=g.inWidth)continue;const ht=W+Y*d[1],yt=q+ot*g.inChannels;let It=G,$t=ht;for(let mt=0;mt<g.inChannels;++mt){const At=O[yt+mt];for(let kt=0;kt<A;++kt)_[It+kt]+=At*N[$t+kt];It+=A,$t+=A}}}}}}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const TSt={kernelName:xb,backendName:"cpu",kernelFunc:$5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $St(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:h}=r;Mt([i,a],"depthwiseConv2dNativeBackpropFilter");const d=Qn(i.shape,h,s,o,l,c,!0),{strideHeight:p,strideWidth:g,filterHeight:v,filterWidth:x}=d,b=new Yn(d.filterShape,"float32"),w=d.padInfo.left,C=d.padInfo.top,T=d.outChannels/d.inChannels,$=n.data.get(i.dataId).values,A=new Yn(i.shape,i.dtype,$),E=n.data.get(a.dataId).values,O=new Yn(a.shape,a.dtype,E);for(let N=0;N<v;++N){const _=Math.max(0,Math.ceil((C-N)/p)),R=Math.min(d.outHeight,(d.inHeight+C-N)/p);for(let I=0;I<x;++I){const P=Math.max(0,Math.ceil((w-I)/g)),B=Math.min(d.outWidth,(d.inWidth+w-I)/g);for(let V=0;V<d.outChannels;++V){const z=Math.trunc(V/T),M=V%T;let U=0;for(let W=0;W<d.batchSize;++W)for(let q=_;q<R;++q){const F=N+q*p-C;for(let G=P;G<B;++G){const H=I+G*g-w;U+=A.get(W,F,H,z)*O.get(W,q,G,V)}}b.set(U,N,I,z,M)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const ASt={kernelName:Gk,backendName:"cpu",kernelFunc:$St};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kSt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:h}=r;Mt([i,a],"depthwiseConv2DNativeBackpropInput");const d=Bt(i.shape),p=Bt(a.shape),g=Qn(h,a.shape,s,o,l,c,!0),v=new Yn(g.inShape,"float32"),x=v.values,[b,w,C]=v.strides,T=n.data.get(i.dataId).values,[$,A,E]=d,O=n.data.get(a.dataId).values,[N,_,R]=p,{batchSize:I,filterHeight:P,filterWidth:B,inChannels:V,inHeight:z,inWidth:M,outChannels:U,outHeight:W,outWidth:q,strideHeight:F,strideWidth:G}=g,H=P-1-g.padInfo.top,Y=B-1-g.padInfo.left,ot=U/V;for(let ht=0;ht<I;++ht)for(let yt=0;yt<V;++yt)for(let It=0;It<z;++It){const $t=It-H,mt=Math.max(0,Math.ceil($t/F)),At=Math.min(W,(P+$t)/F);for(let kt=0;kt<M;++kt){const gt=kt-Y,Ut=Math.max(0,Math.ceil(gt/G)),Lt=Math.min(q,(B+gt)/G);let Zt=0;for(let Wt=mt;Wt<At;++Wt){const qt=Wt*F-$t;for(let fe=Ut;fe<Lt;++fe){const Rn=fe*G-gt,Ge=$*ht+A*Wt+E*fe,pn=N*(P-1-qt)+_*(B-1-Rn)+R*yt;for(let nn=0;nn<ot;++nn){const Fr=yt*ot+nn,dr=T[Ge+Fr],Lr=O[pn+nn];Zt+=dr*Lr}}}x[b*ht+w*It+C*kt+yt]=Zt}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const ESt={kernelName:qk,backendName:"cpu",kernelFunc:kSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISt(e){const{inputs:t,backend:n}=e,{x:r}=t,i=pt(r.shape),a=n.data.get(r.dataId).values,s=ne([i,i],r.dtype),o=s.values;for(let c=0;c<a.length;c++)o[c*i+c]=a[c];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}const OSt={kernelName:KV,backendName:"cpu",kernelFunc:ISt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NSt={kernelName:wb,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i}=e,{strides:a,pad:s,dilations:o}=n,l=t,c=l.data.get(r.dataId).values,h=r.shape.length,d=l.data.get(i.dataId).values,p=i.shape.length,{batchSize:g,inHeight:v,inWidth:x,inChannels:b,outHeight:w,outWidth:C,padInfo:T,strideHeight:$,strideWidth:A,filterHeight:E,filterWidth:O,dilationHeight:N,dilationWidth:_,outShape:R}=jp(r.shape,i.shape,a,s,"NHWC",o),I=pt(R),P=R.length,B=un(r.dtype,I);for(let z=0;z<g;++z)for(let M=0;M<w;++M){const U=M*$-T.top;for(let W=0;W<C;++W){const q=W*A-T.left;for(let F=0;F<b;++F){let G=Number.MIN_SAFE_INTEGER;for(let Y=0;Y<E;++Y){const ot=U+Y*N;if(ot>=0&&ot<v)for(let ht=0;ht<O;++ht){const yt=q+ht*_;if(yt>=0&&yt<x){const It=ka([z,ot,yt,F],h,Bt(r.shape)),$t=ka([Y,ht,F],p,Bt(i.shape)),mt=c[It]+d[$t];mt>G&&(G=mt)}}}const H=ka([z,M,W,F],P,Bt(R));B[H]=G}}}return{dataId:l.write(jl(B,r.dtype),R,r.dtype),shape:R,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _St={kernelName:U2,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:a}=e,{strides:s,pad:o,dilations:l}=n,c=t,h=aa(r.shape,c.data.get(r.dataId).values),d=aa(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:g,inWidth:v,inChannels:x,outHeight:b,outWidth:w,padInfo:C,strideHeight:T,strideWidth:$,filterHeight:A,filterWidth:E,dilationHeight:O,dilationWidth:N,outShape:_}=jp(r.shape,i.shape,s,o,"NHWC",l);j(a.rank===_.length,()=>`Error in ${U2}, dy must have the same rank as output ${_.length}, but got ${a.rank}`);const R=aa(_,c.data.get(a.dataId).values),I=GV(i.shape,i.dtype);for(let B=0;B<p;++B)for(let V=0;V<b;++V){const z=V*T-C.top;for(let M=0;M<w;++M){const U=M*$-C.left;for(let W=0;W<x;++W){let q=Number.MIN_SAFE_INTEGER,F=0,G=0;for(let H=0;H<A;++H){const Y=z+H*O;if(Y>=0&&Y<g)for(let ot=0;ot<E;++ot){const ht=U+ot*N;if(ht>=0&&ht<v){const yt=h[B][Y][ht][W]+d[H][ot][W];yt>q&&(q=yt,F=H,G=ot)}}}I[F][G][W]+=R[B][V][M][W]}}}return{dataId:c.write(jl(I,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RSt={kernelName:j2,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:a}=e,{strides:s,pad:o,dilations:l}=n,c=t,h=aa(r.shape,c.data.get(r.dataId).values),d=aa(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:g,inWidth:v,inChannels:x,outHeight:b,outWidth:w,padInfo:C,strideHeight:T,strideWidth:$,filterHeight:A,filterWidth:E,dilationHeight:O,dilationWidth:N,outShape:_}=jp(r.shape,i.shape,s,o,"NHWC",l);j(a.rank===_.length,()=>`Error in ${j2}, dy must have the same rank as output ${_.length}, but got ${a.rank}`);const R=aa(_,c.data.get(a.dataId).values),I=GV(r.shape,r.dtype);for(let B=0;B<p;++B)for(let V=0;V<b;++V){const z=V*T-C.top;for(let M=0;M<w;++M){const U=M*$-C.left;for(let W=0;W<x;++W){let q=Number.MIN_SAFE_INTEGER,F=z<0?0:z,G=U<0?0:U;for(let H=0;H<A;++H){const Y=z+H*O;if(Y>=0&&Y<g)for(let ot=0;ot<E;++ot){const ht=U+ot*N;if(ht>=0&&ht<v){const yt=h[B][Y][ht][W]+d[H][ot][W];yt>q&&(q=yt,F=Y,G=ht)}}}I[B][F][G][W]+=R[B][V][M][W]}}}return{dataId:c.write(jl(I,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DSt(e){const{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:a,options:s}=r,{contextOptions:o,imageOptions:l}=s||{},c=(l==null?void 0:l.alpha)||1,h=(o==null?void 0:o.contextType)||"2d";if(h!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=a.getContext(h,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${h} type.`);const[p,g]=i.shape.slice(0,2),v=i.shape.length===2?1:i.shape[2],x=n.data.get(i.dataId).values,b=i.dtype==="float32"?255:1,w=new Uint8ClampedArray(g*p*4);for(let T=0;T<p*g;++T){const $=[0,0,0,255*c];for(let E=0;E<v;E++){const O=x[T*v+E];if(i.dtype==="float32"){if(O<0||O>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${O}.`)}else if(i.dtype==="int32"&&(O<0||O>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${O}.`);v===1?($[0]=O*b,$[1]=O*b,$[2]=O*b):$[E]=O*b}const A=T*4;w[A+0]=Math.round($[0]),w[A+1]=Math.round($[1]),w[A+2]=Math.round($[2]),w[A+3]=Math.round($[3])}a.width=g,a.height=p;const C=new ImageData(w,g,p);return d.putImageData(C,0,0),i}const MSt={kernelName:mft,backendName:"cpu",kernelFunc:DSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function am(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;Mt(i,"sum");let o;i.dtype==="bool"?o=vo({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):o=Fa({inputs:{x:i},backend:n});const l=o.shape.length,c=re(a,o.shape),h=en(c,l);let d=c,p=o;h!=null&&(p=Mr({inputs:{x:o},backend:n,attrs:{perm:h}}),d=fn(d.length,l)),Jn("sum",d,p.shape.length);const[g,v]=Vn(p.shape,d),x=Xr(p.dtype,"int32");let b=vv(n,g,x);const w=pt(v),C=n.data.get(b.dataId).values,T=n.data.get(p.dataId).values;for(let $=0;$<C.length;++$){const A=$*w;let E=0;for(let O=0;O<w;++O)E+=T[A+O];C[$]=E}if(s){const $=bn(b.shape,c),A=b;b=We({inputs:{x:b},backend:n,attrs:{shape:$}}),n.disposeIntermediateTensorInfo(A)}return n.disposeIntermediateTensorInfo(o),h!=null&&n.disposeIntermediateTensorInfo(p),b}const PSt={kernelName:t0,backendName:"cpu",kernelFunc:am};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FSt(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,a=t,{allDims:s,summedDims:o,idDims:l}=hI(i,a.length);pI(s.length,l,a);const{path:c,steps:h}=mI(o,l),d=h.length;let p=null,g=s.length;const v=[];for(let x=0;x<d;++x){for(const b of h[x]){const{permutationIndices:w,expandDims:C}=dI(g,l[b]);let T;gI(w)?T=a[b]:(T=Mr({inputs:{x:a[b]},backend:n,attrs:{perm:w}}),v.push(T));const $=T.shape.slice();for(let A=0;A<C.length;++A)$.splice(C[A],0,1);we(T.shape,$)||(T=We({inputs:{x:T},backend:n,attrs:{shape:$}}),v.push(T)),p===null?p=T:(p=O0({inputs:{a:T,b:p},backend:n}),v.push(p))}x<d-1&&(c[x]>=0&&(p=am({inputs:{x:p},backend:n,attrs:{axis:c[x]-(s.length-g),keepDims:!1}}),v.push(p)),g--)}for(const x of v)x!==p&&n.disposeIntermediateTensorInfo(x);return p}const LSt={kernelName:Hk,backendName:"cpu",kernelFunc:FSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BSt(e){const{inputs:t,backend:n}=e,{dy:r,y:i}=t;Mt([r,i],"eluGrad");const a=new Float32Array(pt(i.shape)),s=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){const c=s[l];c>=0?a[l]=o[l]:a[l]=o[l]*(c+1)}return n.makeTensorInfo(i.shape,"float32",a)}const zSt={kernelName:Xk,backendName:"cpu",kernelFunc:BSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jSt=aI,USt=sI,VSt=oI,WSt=lI,GSt=uI,qSt=cI,HSt=Ie(sp,e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+jSt*n);return t*(1-((((qSt*r+GSt)*r+WSt)*r+VSt)*r+USt)*r*Math.exp(-n*n))}),XSt={kernelName:sp,backendName:"cpu",kernelFunc:HSt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wv(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:a}=r,s=i.shape.length,o=i.shape.slice();let l=a;return a<0&&(j(-(s+1)<=a,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+a+1),o.splice(l,0,1),We({inputs:{x:i},backend:n,attrs:{shape:o}})}const KSt={kernelName:Cb,backendName:"cpu",kernelFunc:wv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YSt=dn((e,t)=>e/t),XI=_n(ip,YSt),pA={kernelName:ip,backendName:"cpu",kernelFunc:XI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A5(e,t,n){const r=e.shape,i=r[0],a=r[1],s=n.data.get(e.dataId),o=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,c=[i,a],h=pt(c),d=lr("float32",h),p=lr("float32",h);for(let b=0;b<i;b++){const w=Ml({inputs:{x:o},backend:n,attrs:{begin:[b,0],size:[1,a]}}),C=Ml({inputs:{x:l},backend:n,attrs:{begin:[b,0],size:[1,a]}}),T=qr({inputs:{real:w,imag:C},backend:n}),{real:$,imag:A}=ZSt(T,t,n),E=ws($,A);for(let O=0;O<a;O++){const N=fI(E,O);d[b*a+O]=N.real,p[b*a+O]=N.imag}n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(T)}const g=n.makeTensorInfo(c,"float32",d),v=n.makeTensorInfo(c,"float32",p),x=qr({inputs:{real:g,imag:v},backend:n});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),x}function ZSt(e,t,n){const r=pt(e.shape),i=n.data.get(e.dataId),a=n.data.get(i.complexTensorInfos.real.dataId).values,s=n.data.get(i.complexTensorInfos.imag.dataId).values;if(QSt(r)){const o=mA(a,s,r,t,n),l=[e.shape[0],e.shape[1]];if(t){const c=n.makeTensorInfo(l,"float32",o.real),h=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",$o(r,"float32")),p=Fa({inputs:{x:d},backend:n}),g=pA.kernelFunc({inputs:{a:c,b:d},backend:n}),v=pA.kernelFunc({inputs:{a:h,b:p},backend:n}),x=n.data.get(g.dataId).values,b=n.data.get(v.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),{real:x,imag:b}}return o}else{const o=ws(a,s),l=JSt(o,r,t);return BG(l)}}function QSt(e){return(e&e-1)===0}function mA(e,t,n,r,i){if(n===1)return{real:e,imag:t};const a=ws(e,t),s=n/2,o=zG(a),l=o.real,c=o.imag,h=[l.length],d=i.makeTensorInfo(h,"float32",l),p=i.makeTensorInfo(h,"float32",c),g=qr({inputs:{real:d,imag:p},backend:i}),v=jG(a),x=v.real,b=v.imag,w=[x.length],C=i.makeTensorInfo(w,"float32",x),T=i.makeTensorInfo(w,"float32",b),$=qr({inputs:{real:C,imag:T},backend:i}),A=mA(l,c,s,r,i),E=A.real,O=A.imag,N=[E.length],_=i.makeTensorInfo(N,"float32",E),R=i.makeTensorInfo(N,"float32",O),I=qr({inputs:{real:_,imag:R},backend:i}),P=mA(x,b,s,r,i),B=P.real,V=P.imag,z=[B.length],M=i.makeTensorInfo(z,"float32",B),U=i.makeTensorInfo(z,"float32",V),W=qr({inputs:{real:M,imag:U},backend:i}),q=VG(n,r),F=[q.real.length],G=i.makeTensorInfo(F,"float32",q.real),H=i.makeTensorInfo(F,"float32",q.imag),Y=qr({inputs:{real:G,imag:H},backend:i}),ot=O0({inputs:{a:Y,b:W},backend:i}),ht=Rc({inputs:{a:I,b:ot},backend:i}),yt=qI({inputs:{a:I,b:ot},backend:i}),It=Dl({inputs:{input:ht},backend:i}),$t=Dl({inputs:{input:yt},backend:i}),mt=Dc({inputs:{input:ht},backend:i}),At=Dc({inputs:{input:yt},backend:i}),kt=Mc({inputs:[It,$t],backend:i,attrs:{axis:0}}),gt=Mc({inputs:[mt,At],backend:i,attrs:{axis:0}}),Ut=i.data.get(kt.dataId).values,Lt=i.data.get(gt.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(g),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo($),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(R),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(ot),i.disposeIntermediateTensorInfo(ht),i.disposeIntermediateTensorInfo(yt),i.disposeIntermediateTensorInfo(It),i.disposeIntermediateTensorInfo(mt),i.disposeIntermediateTensorInfo($t),i.disposeIntermediateTensorInfo(At),i.disposeIntermediateTensorInfo(kt),i.disposeIntermediateTensorInfo(gt),{real:Ut,imag:Lt}}function JSt(e,t,n){const r=new Float32Array(t*2);for(let i=0;i<t;i++){let a=0,s=0;for(let o=0;o<t;o++){const l=WG(i*o,t,n),c=fI(e,o);a+=c.real*l.real-c.imag*l.imag,s+=c.real*l.imag+c.imag*l.real}n&&(a/=t,s/=t),UG(r,a,s,i)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCt(e){const{inputs:t,backend:n}=e,{input:r}=t,i=pt(r.shape),a=r.shape[r.shape.length-1],s=i/a,o=We({inputs:{x:r},backend:n,attrs:{shape:[s,a]}}),l=A5(o,!1,n),c=We({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const eCt={kernelName:Kk,backendName:"cpu",kernelFunc:tCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KI(e){const{backend:t,attrs:n}=e,{shape:r,value:i,dtype:a}=n,s=a||qc(i),o=un(s,pt(r));return rCt(o,i,s),t.makeTensorInfo(r,s,o)}const nCt={kernelName:Yk,backendName:"cpu",kernelFunc:KI};function rCt(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iCt={kernelName:Zk,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,i=n,a=lr(r.dtype,pt(r.shape)),[s,o,l,c]=r.shape,h=i.data.get(r.dataId).values;for(let p=0;p<s;p++){const g=p*l*o*c;for(let v=0;v<o;v++){const x=v*(l*c);for(let b=0;b<l;b++){const w=b*c;for(let C=0;C<c;C++){const T=Math.round(l-b-1),$=g+x+w+C;let A=h[$];if(T>=0&&T<l){const E=T*c,O=g+x+E+C;A=h[O]}a[$]=A}}}}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:h,dilations:d,dimRoundingMode:p,activation:g,leakyreluAlpha:v}=r;let x=T5({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:c,dataFormat:h,dilations:d,dimRoundingMode:p}});if(s){const b=x;if(h==="NCHW"&&s.shape.length===1&&s.shape[0]!==1){const w=We({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});x=Rc({inputs:{a:x,b:w},backend:n}),n.disposeIntermediateTensorInfo(w)}else x=Rc({inputs:{a:x,b:s},backend:n});n.disposeIntermediateTensorInfo(b)}if(g){const b=x;if(h==="NCHW"&&g==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const w=We({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});x=xv(n,x,g,w,v),n.disposeIntermediateTensorInfo(w)}else x=xv(n,x,g,o,v);n.disposeIntermediateTensorInfo(b)}return x}const sCt={kernelName:nv,backendName:"cpu",kernelFunc:aCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:h,dilations:d,dimRoundingMode:p,activation:g,leakyreluAlpha:v}=r;let x=$5({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:c,dataFormat:h,dilations:d,dimRoundingMode:p}});if(s){const b=x;x=Rc({inputs:{a:x,b:s},backend:n}),n.disposeIntermediateTensorInfo(b)}if(g){const b=x;x=xv(n,x,g,o,v),n.disposeIntermediateTensorInfo(b)}return x}const lCt={kernelName:pW,backendName:"cpu",kernelFunc:oCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uCt(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,a=pt(r.shape),s=i.shape,o=s[s.length-1],[l,c,h,d]=XE(r,i);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);const p=n.data.get(i.dataId).values,g=n.bufferSync(r),v=P6(p,g,r.dtype,c,o,h,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,v.values)}const cCt={kernelName:YV,backendName:"cpu",kernelFunc:uCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:a}=t,{axis:s,batchDims:o}=r;Mt([i,a],"gatherV2");const l=re(s,i.shape)[0],c=n.data.get(a.dataId).values,h=i.shape[l];for(let $=0;$<c.length;++$){const A=c[$];j(A<=h-1&&A>=0,()=>`GatherV2: the index value ${A} is not in [0, ${h-1}]`)}let d=o;o==null&&(d=0);const p=pt(a.shape),g=vI(i,a,l,d),v=We({inputs:{x:i},backend:n,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),x=We({inputs:{x:a},backend:n,attrs:{shape:[g.batchSize,p/g.batchSize]}}),b=[g.batchSize,g.outerSize,p/g.batchSize,g.sliceSize],w=n.bufferSync(x),C=n.bufferSync(v),T=F6(C,w,b);return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),n.makeTensorInfo(g.outputShape,T.dtype,T.values)}const hCt={kernelName:$b,backendName:"cpu",kernelFunc:fCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCt(e){const{inputs:t,backend:n}=e,{input:r}=t,i=pt(r.shape),a=r.shape[r.shape.length-1],s=i/a,o=We({inputs:{x:r},backend:n,attrs:{shape:[s,a]}}),l=A5(o,!0,n),c=We({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const pCt={kernelName:Qk,backendName:"cpu",kernelFunc:dCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mCt=Ie(dp,e=>Number.isFinite(e)?1:0,"bool"),gCt={kernelName:dp,backendName:"cpu",kernelFunc:mCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yCt=Ie(pp,e=>Math.abs(e)===1/0?1:0,"bool"),vCt={kernelName:pp,backendName:"cpu",kernelFunc:yCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bCt=Ie(mp,e=>Number.isNaN(e)?1:0,"bool"),xCt={kernelName:mp,backendName:"cpu",kernelFunc:bCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wCt(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:a}=n,s=U6(r,i,a);return t.makeTensorInfo([s.length],"float32",s)}const SCt={kernelName:ZV,backendName:"cpu",kernelFunc:wCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CCt=Ie(yp,e=>Math.log1p(e)),TCt={kernelName:yp,backendName:"cpu",kernelFunc:CCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ct=dn((e,t)=>e&&t),ACt=_n(Ob,$Ct,null,"bool"),kCt={kernelName:Ob,backendName:"cpu",kernelFunc:ACt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ECt=Ie(Nb,e=>e?0:1,"bool"),ICt={kernelName:Nb,backendName:"cpu",kernelFunc:ECt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OCt=dn((e,t)=>e||t),NCt=_n(_b,OCt,null,"bool"),_Ct={kernelName:_b,backendName:"cpu",kernelFunc:NCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:s,alpha:o,beta:l}=r;Mt(i,"LRN");const c=i.shape[3],h=c-1,d=n.data.get(i.dataId).values,p=pt(i.shape),g=new Float32Array(p);function v(x){const b=x%c;let w=x-b+Math.max(0,b-a);const C=x-b+Math.min(b+a,h);let T=0;for(;w<=C;w++){const $=d[w];T+=$*$}return T}for(let x=0;x<p;x++){const b=v(x),w=d[x]*Math.pow(s+o*b,-l);g[x]=w}return n.makeTensorInfo(i.shape,i.dtype,g)}const DCt={kernelName:Rb,backendName:"cpu",kernelFunc:RCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:h}=r;Mt(s,"LRNGrad");const d=pt(s.shape),p=s.shape[3],g=n.data.get(s.dataId).values,v=n.data.get(i.dataId).values,x=n.data.get(a.dataId).values,b=new Float32Array(d),w=d;for(let C=0;C<w;C++){const T=C%p,$=C-T+Math.max(0,T-o),A=C-T+Math.min(p,T+o+1);let E=0;for(let O=$;O<A;O++)E+=Math.pow(v[O],2);E=c*E+l;for(let O=$;O<A;O++){let N=-2*c*h*v[O]*x[C]/E;C===O&&(N+=Math.pow(E,-h)),N*=g[C],b[O]+=N}}return n.makeTensorInfo(s.shape,i.dtype,b)}const PCt={kernelName:tE,backendName:"cpu",kernelFunc:MCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k5(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:a,keepDims:s}=r,o=n;let l=i.shape;const c=l.length,h=re(a,l);let d=h;const p=en(d,c);let g=o.data.get(i.dataId).values;if(p!=null){const $=new Array(c);for(let A=0;A<$.length;A++)$[A]=l[p[A]];g=WI(g,l,i.dtype,p,$),d=fn(d.length,c),l=$}Mt(i,"max"),Jn("max",d,c);const[v,x]=Vn(l,d),b=pt(x),w=W6(g,b,v,i.dtype),C=o.write(w,v,i.dtype);let T=v;return s&&(T=bn(v,h)),{dataId:C,shape:T,dtype:i.dtype}}const FCt={kernelName:Db,backendName:"cpu",kernelFunc:k5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Mt(i,"maxPool");const{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,c=1;j(cr(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const h=ji(i.shape,a,s,c,o,l);let d;if(h.filterWidth===1&&h.filterHeight===1&&we(h.inShape,h.outShape))d=Fa({inputs:{x:i},backend:n});else{const p=n.data.get(i.dataId).values,g=Bt(i.shape),v=HI(p,i.shape,i.dtype,g,h,"max");d=n.makeTensorInfo(h.outShape,i.dtype,v.values)}return d}const BCt={kernelName:Mb,backendName:"cpu",kernelFunc:LCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r;Mt(i,"maxPool3d");const h=ks(i.shape,a,s,1,o,l,c),d=n.data.get(i.dataId).values,p=C5(d,i.shape,i.dtype,Bt(i.shape),h,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const jCt={kernelName:Pb,backendName:"cpu",kernelFunc:zCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UCt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:o,pad:l,dimRoundingMode:c}=r;Mt([i,a],"maxPool3DGrad");const h=ks(a.shape,s,o,1,l,c),d=n.bufferSync(a),p=Owt(d,h),g=h.strideDepth,v=h.strideHeight,x=h.strideWidth,b=h.dilationDepth,w=h.dilationHeight,C=h.dilationWidth,T=h.effectiveFilterDepth,$=h.effectiveFilterHeight,A=h.effectiveFilterWidth,E=T-1-h.padInfo.front,O=A-1-h.padInfo.left,N=$-1-h.padInfo.top,_=ne(a.shape,"float32"),R=n.bufferSync(i);for(let I=0;I<h.batchSize;++I)for(let P=0;P<h.inChannels;++P)for(let B=0;B<h.inDepth;++B)for(let V=0;V<h.inHeight;++V)for(let z=0;z<h.inWidth;++z){const M=B-E,U=V-N,W=z-O;let q=0;for(let F=0;F<T;F+=b){const G=(M+F)/g;if(!(G<0||G>=h.outDepth||Math.floor(G)!==G))for(let H=0;H<$;H+=w){const Y=(U+H)/v;if(!(Y<0||Y>=h.outHeight||Math.floor(Y)!==Y))for(let ot=0;ot<A;ot+=C){const ht=(W+ot)/x;if(ht<0||ht>=h.outWidth||Math.floor(ht)!==ht)continue;const yt=T*$*A-1-p.get(I,G,Y,ht,P),It=F*$*A+H*A+ot,$t=yt===It?1:0;if($t===0)continue;const mt=R.get(I,G,Y,ht,P);q+=mt*$t}}}_.set(q,I,B,V,z,P)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const VCt={kernelName:nE,backendName:"cpu",kernelFunc:UCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a,output:s}=t,o=a;Mt([a,s],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:d}=r,p=ji(o.shape,l,c,1,h,d),g=n.data.get(o.dataId).values,v=ne(p.outShape,o.dtype,S5(g,o.shape,o.dtype,p).values),x=p.strideHeight,b=p.strideWidth,w=p.dilationHeight,C=p.dilationWidth,T=p.effectiveFilterHeight,$=p.effectiveFilterWidth,A=$-1-p.padInfo.left,E=T-1-p.padInfo.top,O=ne(o.shape,"float32"),N=n.data.get(i.dataId).values,_=ne(i.shape,"float32",N);for(let R=0;R<p.batchSize;++R)for(let I=0;I<p.inChannels;++I)for(let P=0;P<p.inHeight;++P)for(let B=0;B<p.inWidth;++B){const V=P-E,z=B-A;let M=0;for(let U=0;U<T;U+=w){const W=(V+U)/x;if(!(W<0||W>=p.outHeight||Math.floor(W)!==W))for(let q=0;q<$;q+=C){const F=(z+q)/b;if(F<0||F>=p.outWidth||Math.floor(F)!==F)continue;const G=T*$-1-v.get(R,W,F,I),H=U*$+q,Y=G===H?1:0;if(Y===0)continue;const ot=_.get(R,W,F,I);M+=ot*Y}}O.set(M,R,P,B,I)}return n.makeTensorInfo(O.shape,O.dtype,O.values)}const GCt={kernelName:eE,backendName:"cpu",kernelFunc:WCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCt(e,t,n,r,i){const a=Bt(t),s=HI(e,t,n,a,i,"max"),o=S5(e,t,n,i,!0,r);return[s.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HCt={kernelName:QV,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:a,pad:s,includeBatchInIndex:o}=t,l=n;Mt(r,"MaxPoolWithArgmax");const c=l.data.get(r.dataId).values,h=ji(r.shape,i,a,[1,1],s),[d,p]=qCt(c,r.shape,r.dtype,o,h),g=l.write(d,h.outShape,r.dtype),v=l.write(p,h.outShape,r.dtype);return[{dataId:g,shape:h.outShape,dtype:r.dtype},{dataId:v,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=re(a,i.shape),c=Vn(i.shape,o)[1],h=pt(c),d=[],p=n.makeTensorInfo([],"float32",new Float32Array([h]));d.push(p);const g=vo({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});d.push(g);const v=XI({inputs:{a:g,b:p},backend:n});d.push(v);const x=am({inputs:{x:v},backend:n,attrs:{axis:a,keepDims:s}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}const KCt={kernelName:Fb,backendName:"cpu",kernelFunc:XCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;Mt(i,"min");const o=re(a,i.shape);let l=o;const c=en(l,i.shape.length);let h=i;c!=null&&(h=Mr({inputs:{x:i},backend:n,attrs:{perm:c}}),l=fn(l.length,i.shape.length)),Jn("min",l,h.shape.length);const[d,p]=Vn(h.shape,l),g=pt(p),v=ur(pt(d),h.dtype),x=n.data.get(h.dataId).values;for(let w=0;w<v.length;++w){const C=w*g;let T=x[C];for(let $=0;$<g;++$){const A=x[C+$];(Number.isNaN(A)||A<T)&&(T=A)}v[w]=T}c!=null&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(d,h.dtype,v);if(s){const w=bn(d,o),C=We({inputs:{x:b},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(b),C}return b}const ZCt={kernelName:Lb,backendName:"cpu",kernelFunc:YCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QCt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,mode:s}=r;Mt(i,"mirrorPad");const o=a.map((T,$)=>T[0]+i.shape[$]+T[1]),l=a.map(T=>T[0]),c=a.map((T,$)=>T[0]+i.shape[$]),h=s==="reflect"?0:1,d=n.data.get(i.dataId).values,p=i.shape.length,g=Bt(i.shape),v=pt(o),x=o.length,b=Bt(o),w=lr(i.dtype,v);for(let T=0;T<v;T++){let $=Hc(T,x,b);for(let E=0;E<x;E++)$[E]<l[E]?$[E]=l[E]*2-$[E]-h:$[E]>=c[E]&&($[E]=(c[E]-1)*2-$[E]+h);$=$.map((E,O)=>E-l[O]);const A=ka($,p,g);w[T]=d[A]}return{dataId:n.write(w,o,i.dtype),shape:o,dtype:i.dtype}}const JCt={kernelName:Bb,backendName:"cpu",kernelFunc:QCt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTt=dn((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),eTt=_n(xp,tTt),nTt={kernelName:xp,backendName:"cpu",kernelFunc:eTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E5(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:a}=r,s=i.shape.length;let o=a;if(o===-1&&(o=s-1),o!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${o}`);const l=re([o],i.shape),c=k5({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),h=bn(c.shape,l),d=We({inputs:{x:c},backend:n,attrs:{shape:h}}),p=qI({inputs:{a:i,b:d},backend:n}),g=_6({inputs:{x:p},backend:n}),v=am({inputs:{x:g},backend:n,attrs:{axis:l,keepDims:!1}}),x=We({inputs:{x:v},backend:n,attrs:{shape:h}}),b=XI({inputs:{a:g,b:x},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),b}const rTt={kernelName:r0,backendName:"cpu",kernelFunc:E5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iTt(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:s,normalized:o}=r;Mt(i,"multinomial");const l=o?i:E5({inputs:{logits:i},backend:n,attrs:{dim:-1}}),c=l.shape[0],h=l.shape[1],d=n.data.get(l.dataId).values,p=[c,a],g=ur(pt(p),"int32");for(let v=0;v<c;++v){const x=v*h,b=new Float32Array(h-1);b[0]=d[x];for(let T=1;T<b.length;++T)b[T]=b[T-1]+d[x+T];const w=DE.alea(s.toString()),C=v*a;for(let T=0;T<a;++T){const $=w();g[C+T]=b.length;for(let A=0;A<b.length;A++)if($<b[A]){g[C+T]=A;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",g)}const aTt={kernelName:JV,backendName:"cpu",kernelFunc:iTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sTt=VE;function oTt(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r;Mt(i,"NonMaxSuppression");const c=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,{selectedIndices:d}=sTt(c,h,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const lTt={kernelName:rE,backendName:"cpu",kernelFunc:oTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uTt=WE;function cTt(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r;Mt(i,"NonMaxSuppressionPadded");const h=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:p,validOutputs:g}=uTt(h,d,s,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}const fTt={kernelName:iE,backendName:"cpu",kernelFunc:cTt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hTt=GE;function dTt(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r;Mt(i,"NonMaxSuppressionWithScore");const h=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,p=s,g=o,v=l,x=c,{selectedIndices:b,selectedScores:w}=hTt(h,d,p,g,v,x);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const pTt={kernelName:aE,backendName:"cpu",kernelFunc:dTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mTt(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:s,onValue:o,offValue:l}=r;Mt(i,"oneHot");const c=pt(i.shape),h=new Float32Array(c*s);h.fill(l);const d=n.data.get(i.dataId).values;for(let p=0;p<c;++p)d[p]>=0&&d[p]<s&&(h[p*s+d[p]]=o);return n.makeTensorInfo([...i.shape,s],a,h)}const gTt={kernelName:Vb,backendName:"cpu",kernelFunc:mTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sv(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const i=Dl({inputs:{input:r},backend:n}),a=Sv({inputs:{x:i},backend:n}),s=Dc({inputs:{input:r},backend:n}),o=Sv({inputs:{x:s},backend:n}),l=qr({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return KI({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const yTt={kernelName:s0,backendName:"cpu",kernelFunc:Sv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const i=Dl({inputs:{input:r},backend:n}),a=I5({inputs:{x:i},backend:n}),s=Dc({inputs:{input:r},backend:n}),o=Sv({inputs:{x:s},backend:n}),l=qr({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return KI({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const vTt={kernelName:Ub,backendName:"cpu",kernelFunc:I5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O5(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return wv({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const a=t[0].shape,s=t[0].dtype;t.forEach(h=>{kk(a,h.shape,"All tensors passed to stack must have matching shapes"),j(s===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(h=>{const d=wv({inputs:{input:h},backend:n,attrs:{dim:i}});return o.push(d),d}),c=Mc({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(h=>n.disposeIntermediateTensorInfo(h)),c}const bTt={kernelName:Wb,backendName:"cpu",kernelFunc:O5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,constantValue:s}=r;Mt(i,"pad");const o=a.map((C,T)=>C[0]+i.shape[T]+C[1]),l=a.map(C=>C[0]),c=n.data.get(i.dataId).values,h=pt(i.shape),d=i.shape.length,p=Bt(i.shape),g=pt(o),v=o.length,x=Bt(o),b=lr(i.dtype,g);s!==0&&b.fill(s);for(let C=0;C<h;C++){const $=Hc(C,d,p).map((E,O)=>E+l[O]),A=ka($,v,x);b[A]=c[C]}return{dataId:n.write(b,o,i.dtype),shape:o,dtype:i.dtype}}const N5={kernelName:Gb,backendName:"cpu",kernelFunc:xTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wTt=dn((e,t)=>Math.pow(e,t)),STt=_n(Sp,wTt),CTt={kernelName:Sp,backendName:"cpu",kernelFunc:STt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TTt(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:a,indices:s}=t,{outputRaggedRank:o}=r,l=i.map(w=>n.data.get(w.dataId).values),c=i.map(w=>w.shape),h=n.data.get(a.dataId).values,d=n.data.get(s.dataId).values,[p,g,v]=Y6(l,c,h,a.shape,a.dtype,d,s.shape),x=p.map(w=>n.makeTensorInfo([w.length],"int32",w)),b=n.makeTensorInfo(v,a.dtype,g);return x.concat([b])}const $Tt={kernelName:tW,backendName:"cpu",kernelFunc:TTt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ATt(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:a}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[c,h]=Z6(s,r.shape,r.dtype,o,i.shape,l,a.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([h.length],r.dtype,h);return[d,p]}const kTt={kernelName:eW,backendName:"cpu",kernelFunc:ATt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ETt(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:a,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(s.dataId).values,p=o.map(b=>n.data.get(b.dataId).values),g=o.map(b=>b.shape),[v,x]=Q6(c,i.shape,h,a.shape,a.dtype,d,s.shape,p,g,l);return n.makeTensorInfo(v,a.dtype,x)}const ITt={kernelName:nW,backendName:"cpu",kernelFunc:ETt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OTt(e){const{backend:t,attrs:n}=e,{start:r,stop:i,dtype:a,step:s}=n,o=J6(r,i,s,a);return t.makeTensorInfo([o.length],a,o)}const NTt={kernelName:sE,backendName:"cpu",kernelFunc:OTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Tt=Ie(Cp,e=>1/e),RTt={kernelName:Cp,backendName:"cpu",kernelFunc:_Tt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DTt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r;Mt(i,"resizeBilinear");const l=Bt(i.shape),[c,h]=o,[d,p,g,v]=i.shape,x=n.data.get(i.dataId).values,b=new Float32Array(pt([d,c,h,v])),w=[a&&c>1?p-1:p,a&&h>1?g-1:g],C=[a&&c>1?c-1:c,a&&h>1?h-1:h];let T=0;const $=w[0]/C[0],A=w[1]/C[1];for(let E=0;E<d;E++)for(let O=0;O<c;O++){let N;s?N=$*(O+.5)-.5:N=$*O;const _=Math.max(0,Math.floor(N)),R=N-_,I=Math.min(p-1,Math.ceil(N)),P=E*l[0]+_*l[1],B=E*l[0]+I*l[1];for(let V=0;V<h;V++){let z;s?z=A*(V+.5)-.5:z=A*V;const M=Math.max(0,Math.floor(z)),U=z-M,W=Math.min(g-1,Math.ceil(z)),q=P+M*l[2],F=B+M*l[2],G=P+W*l[2],H=B+W*l[2];for(let Y=0;Y<v;Y++){const ot=x[q+Y],ht=x[F+Y],yt=x[G+Y],It=x[H+Y],$t=ot+(yt-ot)*U,mt=ht+(It-ht)*U,At=$t+(mt-$t)*R;b[T++]=At}}}return n.makeTensorInfo([d,c,h,v],"float32",b)}const MTt={kernelName:Yb,backendName:"cpu",kernelFunc:DTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r;Mt([a,i],"resizeBilinearGrad");const o=Bt(i.shape),[l,c,h,d]=i.shape,[,p,g]=a.shape,v=new Float32Array(l*c*h*d),x=[s&&p>1?c-1:c,s&&g>1?h-1:h],b=[s&&p>1?p-1:p,s&&g>1?g-1:g],w=x[0]/b[0],C=x[1]/b[1],T=n.data.get(a.dataId).values;let $=0;for(let A=0;A<l;A++){const E=A*o[0];for(let O=0;O<p;O++){const N=O*w,_=Math.floor(N),R=Math.min(Math.ceil(N),c-1),I=E+_*o[1],P=E+R*o[1],B=N-_,V=1-B;for(let z=0;z<g;z++){const M=z*C,U=Math.floor(M),W=Math.min(Math.ceil(M),h-1),q=M-U,F=1-q,G=I+U*o[2],H=I+W*o[2],Y=P+U*o[2],ot=P+W*o[2],ht=V*F,yt=V*q,It=B*F,$t=B*q;for(let mt=0;mt<d;mt++){const At=T[$++];v[G+mt]+=At*ht,v[H+mt]+=At*yt,v[Y+mt]+=At*It,v[ot+mt]+=At*$t}}}}return n.makeTensorInfo([l,h,c,d],"float32",v)}const FTt={kernelName:uE,backendName:"cpu",kernelFunc:PTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LTt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r;Mt(i,"resizeNearestNeighbor");const l=Bt(i.shape),[c,h]=o,[d,p,g,v]=i.shape,x=n.data.get(i.dataId).values,b=new Float32Array(d*c*h*v),w=[a&&c>1?p-1:p,a&&h>1?g-1:g],C=[a&&c>1?c-1:c,a&&h>1?h-1:h],T=w[0]/C[0],$=w[1]/C[1];let A=0;for(let E=0;E<d;E++){const O=E*l[0];for(let N=0;N<c;N++){const _=s?T*(N+.5):T*N;let R=Math.min(p-1,a?Math.round(_):Math.floor(_));s&&(R=Math.max(0,R));const I=O+R*l[1];for(let P=0;P<h;P++){const B=s?$*(P+.5):$*P;let V=Math.min(g-1,a?Math.round(B):Math.floor(B));s&&(V=Math.max(0,V));const z=I+V*l[2];for(let M=0;M<v;M++){const U=x[z+M];b[A++]=U}}}}return n.makeTensorInfo([d,c,h,v],i.dtype,b)}const BTt={kernelName:Kb,backendName:"cpu",kernelFunc:LTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zTt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r;Mt([a,i],"resizeNearestNeighborGrad");const o=Bt(i.shape),l=Bt(a.shape),[c,h,d,p]=i.shape,[,g,v]=a.shape,x=new Float32Array(c*h*d*p),b=n.data.get(a.dataId).values,w=[s&&g>1?h-1:h,s&&v>1?d-1:d],C=[s&&g>1?g-1:g,s&&v>1?v-1:v],T=w[0]/C[0],$=w[1]/C[1],A=1/T,E=1/$,O=Math.ceil(A)*2+2,N=Math.ceil(E)*2+2;for(let _=0;_<c;_++){const R=_*o[0];for(let I=0;I<h;I++){const P=R+I*o[1],B=Math.floor(I*A),V=Math.floor(B-O/2);for(let z=0;z<d;z++){const M=P+z*o[2],U=Math.floor(z*E),W=Math.floor(U-N/2);for(let q=0;q<p;q++){let F=0;for(let G=0;G<O;G++){const H=G+V;if(H<0||H>=g)continue;const Y=R+H*l[1],ot=H*T,ht=Math.min(h-1,s?Math.round(ot):Math.floor(ot));if(I===ht)for(let yt=0;yt<N;yt++){const It=yt+W;if(It<0||It>=v)continue;const $t=Y+It*l[2],mt=It*$,At=Math.min(d-1,s?Math.round(mt):Math.floor(mt));z===At&&(F+=b[$t+q])}}x[M+q]=F}}}}return n.makeTensorInfo(i.shape,i.dtype,x)}const jTt={kernelName:lE,backendName:"cpu",kernelFunc:zTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UTt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r;Mt(i,"reverse");const s=i.shape.length,o=re(a,i.shape);if(s===0)return Fa({inputs:{x:i},backend:n});const l=new Yn(i.shape,i.dtype),c=n.bufferSync(i);for(let h=0;h<l.size;h++){const d=l.indexToLoc(h),p=d.slice();o.forEach(g=>p[g]=i.shape[g]-1-p[g]),l.set(c.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const VTt={kernelName:Zb,backendName:"cpu",kernelFunc:UTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTt={kernelName:gE,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:a,center:s}=t,o=n,l=lr(r.dtype,pt(r.shape)),[c,h,d,p]=r.shape,[g,v]=nI(s,h,d),x=255,b=Math.sin(i),w=Math.cos(i),C=o.data.get(r.dataId).values;for(let $=0;$<c;$++){const A=$*d*h*p;for(let E=0;E<h;E++){const O=E*(d*p);for(let N=0;N<d;N++){const _=N*p;for(let R=0;R<p;R++){const I=[c,E,N,R],P=I[2],B=I[1];let V=(P-g)*w-(B-v)*b,z=(P-g)*b+(B-v)*w;V=Math.round(V+g),z=Math.round(z+v);let M=a;if(typeof a!="number"&&(R===3?M=x:M=a[R]),V>=0&&V<d&&z>=0&&z<h){const W=z*(d*p),q=V*p,F=A+W+q+R;M=C[F]}const U=A+O+_+R;l[U]=M}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTt=Ie(Ap,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),qTt={kernelName:Ap,backendName:"cpu",kernelFunc:GTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTt(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:a}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:h,outputSize:d}=Vl(a,i,s),p=!0,g=n.bufferSync(i),v=n.bufferSync(a),x=hl(g,v,s,d,c,l,o,h,0,p);return n.makeTensorInfo(s,x.dtype,x.values)}const XTt={kernelName:rW,backendName:"cpu",kernelFunc:HTt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KTt(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function YTt(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function ZTt(e,t,n,r,i,a){const s=un("int32",n*i);for(let o=0;o<n;++o){const l=e.slice(o*r,(o+1)*r),c=o*i;for(let h=0;h<i;++h)s[c+h]=a==="left"?KTt(l,t[h+c]):YTt(l,t[h+c])}return s}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QTt(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:s}=r,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,c=ZTt(o,l,i.shape[0],i.shape[1],a.shape[1],s);return n.makeTensorInfo(a.shape,"int32",c)}const JTt={kernelName:aW,backendName:"cpu",kernelFunc:QTt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$t(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t;Mt([r,i,a],"select");const s=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,h=Xr(i.dtype,a.dtype),d=ur(pt(i.shape),h);let p=0;const g=s===0||s>1||i.shape.length===1?1:pt(i.shape.slice(1));for(let v=0;v<o.length;v++)for(let x=0;x<g;x++)o[v]===1?d[p++]=l[v]:d[p++]=c[v];return n.makeTensorInfo(i.shape,h,d)}const e$t={kernelName:Qb,backendName:"cpu",kernelFunc:t$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n$t=y0,r$t=v0,i$t=Ie(Ep,e=>e>=0?r$t*e:n$t*(Math.exp(e)-1)),a$t={kernelName:Ep,backendName:"cpu",kernelFunc:i$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s$t=Ie(Np,e=>e<0?-1:e>0?1:0),o$t={kernelName:Np,backendName:"cpu",kernelFunc:s$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$t=Ie(Ip,e=>Math.sin(e)),u$t={kernelName:Ip,backendName:"cpu",kernelFunc:l$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c$t=Ie(Op,e=>Math.sinh(e)),f$t={kernelName:Op,backendName:"cpu",kernelFunc:c$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$t=11920928955078125e-23,r4=Math.log(h$t)+2,d$t=Ie(Rp,e=>{const t=e>-r4,n=e<r4,r=Math.exp(e);let i;return n?i=r:t?i=e:i=Math.log(1+r),i}),p$t={kernelName:Rp,backendName:"cpu",kernelFunc:d$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:s}=r;Mt([i],"spaceToBatchND");const o=pt(a),l=[[0,0]];l.push(...s);for(let E=1+a.length;E<i.shape.length;++E)l.push([0,0]);const c=N5.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),h=Xp(c.shape,a,o,!1),d=Kp(h.length,a.length,!1),p=Yp(c.shape,a,o,!1),x=We({inputs:{x:c},backend:n,attrs:{shape:h}}),C=Mr({inputs:{x},backend:n,attrs:{perm:d}}),A=We({inputs:{x:C},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(C),A}const g$t={kernelName:e0,backendName:"cpu",kernelFunc:m$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$t(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:a,defaultValue:s}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values[0],[d,p,g,v,x]=r5(o,r.shape,r.dtype,l,i.dtype,c,h);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],i.dtype,g),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map(b=>Number(b)))),n.makeTensorInfo([x.length],r.dtype,new Int32Array(x))]}const v$t={kernelName:sW,backendName:"cpu",kernelFunc:y$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$t(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:a}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const s=Array.from(n.data.get(i.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(a.dataId).values),[c,h,d]=i5(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(h,r.dtype,c),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const x$t={kernelName:oW,backendName:"cpu",kernelFunc:b$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$t(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[c,h]=GI(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(h,r.dtype,c)}const S$t={kernelName:lW,backendName:"cpu",kernelFunc:w$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$t(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[c,h]=GI(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(h,r.dtype,c)}const T$t={kernelName:uW,backendName:"cpu",kernelFunc:C$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $$t(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:h,strides:d,outputSize:p}=Vl(a,i,o),g=!1,v=n.bufferSync(i);let x;switch(a.dtype){case"bool":{const b=n.bufferSync(a),w=!!n.data.get(s.dataId).values[0];x=hl(v,b,o,p,h,c,l,d,w,g);break}case"float32":{const b=n.bufferSync(a),w=n.data.get(s.dataId).values[0];x=hl(v,b,o,p,h,c,l,d,w,g);break}case"int32":{const b=n.bufferSync(a),w=n.data.get(s.dataId).values[0];x=hl(v,b,o,p,h,c,l,d,w,g);break}case"string":{const b=n.bufferSync(a),w=ho(n.data.get(s.dataId).values[0]);x=hl(v,b,o,p,h,c,l,d,w,g);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(o,x.dtype,x.values)}const A$t={kernelName:cW,backendName:"cpu",kernelFunc:$$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:s}=r,o=re(s,i.shape)[0],l=yI(i,a,o),c=new Array(i.shape.length).fill(0),h=i.shape.slice();return l.map(d=>{const p=[...h];p[o]=d;const g=Ml({inputs:{x:i},backend:n,attrs:{begin:c,size:p}});return c[o]+=d,g})}const E$t={kernelName:n0,backendName:"cpu",kernelFunc:k$t};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$t={kernelName:cE,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,r=t;Mt(n,"square");const i=r.data.get(n.dataId).values,a=new Float32Array(i.length);for(let o=0;o<i.length;++o){const l=i[o];a[o]=l*l}return{dataId:r.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$t=Ie(zp,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),N$t={kernelName:zp,backendName:"cpu",kernelFunc:O$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:p}=r;Mt(i,"stridedSlice");const{finalShapeSparse:g,finalShape:v,isIdentity:x,sliceDim0:b,isSimpleSlice:w,begin:C,end:T,strides:$}=JE(i.shape,a,s,o,l,c,h,d,p);let A;if(x)A=We({inputs:{x:i},backend:n,attrs:{shape:v}});else if(b||w){j(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const E=YE(C,T,$),O=Ml({inputs:{x:i},backend:n,attrs:{begin:C,size:E}});A=We({inputs:{x:O},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(O)}else{const E=n.bufferSync(i),O=o5(g,E,$,C);A=n.makeTensorInfo(v,O.dtype,O.values)}return A}const R$t={kernelName:hE,backendName:"cpu",kernelFunc:_$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D$t(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:a,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:h,dataSplits:d}=t,p=n.data.get(h.dataId).values,g=n.data.get(d.dataId).values,[v,x]=l5(p,g,i,a,s,o,l,c);return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(d.shape,"int32",x)]}const M$t={kernelName:fW,backendName:"cpu",kernelFunc:D$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P$t(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:a,delimiter:s}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values[0],[c,h,d]=u5(o,l,i),p=h.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const F$t={kernelName:hW,backendName:"cpu",kernelFunc:P$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L$t(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const s=n.data.get(a.dataId).values,o=c5(s,i);return n.makeTensorInfo(a.shape,"int32",o)}const B$t={kernelName:dW,backendName:"cpu",kernelFunc:L$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z$t=Ie(Fp,e=>Math.tan(e)),j$t={kernelName:Fp,backendName:"cpu",kernelFunc:z$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U$t=Ie(Lp,e=>Math.tanh(e)),V$t={kernelName:Lp,backendName:"cpu",kernelFunc:U$t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W$t(e){const{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:a}=t,{sliceRank:s,numUpdates:o,sliceSize:l,strides:c,outputSize:h}=Vl(a,i,r.shape),d=!1,p=n.bufferSync(i),g=n.bufferSync(a),v=n.bufferSync(r),x=hl(p,g,r.shape,h,l,o,s,c,v,d);return n.makeTensorInfo(r.shape,x.dtype,x.values)}const G$t={kernelName:iW,backendName:"cpu",kernelFunc:W$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:a}=r;Mt(i,"tile");const s=h5(n.bufferSync(i),a);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const H$t={kernelName:Bp,backendName:"cpu",kernelFunc:q$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X$t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:a,sorted:s}=r;Mt(i,"topk");const o=n.data.get(i.dataId).values,[l,c]=p5(o,i.shape,i.dtype,a,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const K$t={kernelName:dE,backendName:"cpu",kernelFunc:X$t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$t(e){const{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:a}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=n,[h,d,p,g]=i.shape,[v,x]=c??[d,p],b=[h,v,x,g],w=Bt(i.shape),C=w[0],T=w[1],$=w[2],A=Bt(b),E=A[0],O=A[1],N=A[2],_=lr(i.dtype,pt(b));_.fill(l);const R=r.data.get(i.dataId).values,I=r.data.get(a.dataId).values;for(let B=0;B<h;++B){const V=a.shape[0]===1?I:I.subarray(B*8,B*8+8);for(let z=0;z<v;++z)for(let M=0;M<x;++M)for(let U=0;U<g;++U){let W;const q=V[6]*M+V[7]*z+1;if(q===0)continue;const F=(V[0]*M+V[1]*z+V[2])/q,G=(V[3]*M+V[4]*z+V[5])/q,H=i4(F,p,o),Y=i4(G,d,o);switch(s){case"nearest":W=n2t(R,d,p,C,T,$,B,Y,H,U,l);break;case"bilinear":W=r2t(R,d,p,C,T,$,B,Y,H,U,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}const ot=B*E+z*O+M*N+U;_[ot]=W}return r.makeTensorInfo(b,i.dtype,_)}return{dataId:r.write(_,b,i.dtype),shape:i.shape,dtype:i.dtype}}const Z$t={kernelName:pE,backendName:"cpu",kernelFunc:Y$t};function i4(e,t,n){switch(n){case"reflect":return Q$t(e,t);case"wrap":return J$t(e,t);case"nearest":return e2t(e,t);case"constant":default:return t2t(e)}}function Q$t(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{const r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return Cl(0,n,t-1)}function J$t(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{const r=t-1;n-=t*Math.trunc(n/r)}return Cl(0,n,t-1)}function t2t(e,t){return e}function e2t(e,t){return Cl(0,e,t-1)}function Oh(e,t,n,r,i,a,s,o,l,c,h){const d=s*r+o*i+l*a+c;return 0<=o&&o<t&&0<=l&&l<n?e[d]:h}function n2t(e,t,n,r,i,a,s,o,l,c,h){const d=Math.round(o),p=Math.round(l);return Oh(e,t,n,r,i,a,s,d,p,c,h)}function r2t(e,t,n,r,i,a,s,o,l,c,h){const d=Math.floor(o),p=Math.floor(l),g=d+1,v=p+1,x=(v-l)*Oh(e,t,n,r,i,a,s,d,p,c,h)+(l-p)*Oh(e,t,n,r,i,a,s,d,v,c,h),b=(v-l)*Oh(e,t,n,r,i,a,s,g,p,c,h)+(l-p)*Oh(e,t,n,r,i,a,s,g,v,c,h);return(g-o)*x+(o-d)*b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2t(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t;Mt(a,"unique");const s=r.data.get(a.dataId).values,{outputValues:o,outputShape:l,indices:c}=m5(s,i,a.shape,a.dtype);return[r.makeTensorInfo(l,a.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}const a2t={kernelName:mE,backendName:"cpu",kernelFunc:i2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s2t(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:a}=r;a<0&&(a+=i.shape.length);const s=i.shape.length,o=i.shape[a],l=new Array(s-1);let c=0;for(let g=0;g<s;g++)g!==a&&(l[c++]=i.shape[g]);const h=new Array(s).fill(0),d=i.shape.slice();d[a]=1;const p=new Array(o);for(let g=0;g<p.length;g++){h[a]=g;const v=Ml({inputs:{x:i},backend:n,attrs:{begin:h,size:d}});p[g]=We({inputs:{x:v},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(v)}return p}const o2t={kernelName:i0,backendName:"cpu",kernelFunc:s2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l2t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:a}=t,{numSegments:s}=r;Mt(i,"unsortedSegmentSum");const o=i.shape.length,l=a.shape.length,c=[],h=[],d=o-l;let p=a;for(let v=0;v<d;++v){const x=wv({inputs:{input:p},backend:n,attrs:{dim:v+1}});p=x,h.push(x)}for(let v=0;v<s;++v){const x=$o(v,"int32"),b=n.makeTensorInfo([],"int32",x),w=O6({inputs:{a:b,b:p},backend:n}),C=vo({inputs:{x:w},backend:n,attrs:{dtype:"float32"}}),T=O0({inputs:{a:C,b:i},backend:n}),$=am({inputs:{x:T},backend:n,attrs:{axis:0,keepDims:!1}});c.push($),h.push(b),h.push(w),h.push(C),h.push(T),h.push($)}const g=O5({inputs:c,backend:n,attrs:{axis:0}});return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const u2t={kernelName:a0,backendName:"cpu",kernelFunc:l2t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c2t=[iwt,Lxt,swt,lwt,Wxt,cwt,hwt,pwt,gwt,vwt,xwt,Swt,Twt,kwt,Iwt,_wt,Dwt,Pwt,Lwt,nwt,zwt,Uwt,Wwt,qxt,qwt,Uxt,Xxt,Xwt,Bxt,Ywt,Qwt,Jwt,eSt,rSt,aSt,oSt,uSt,fSt,dSt,mSt,ySt,bSt,wSt,CSt,TSt,ASt,ESt,OSt,NSt,_St,RSt,MSt,LSt,K1t,zSt,Kxt,XSt,Yxt,KSt,Qxt,eCt,nCt,iCt,t1t,n1t,sCt,lCt,cCt,hCt,i1t,s1t,zxt,pCt,Zwt,gCt,vCt,xCt,Y1t,l1t,c1t,SCt,h1t,TCt,kCt,ICt,_Ct,DCt,PCt,FCt,p1t,BCt,jCt,VCt,GCt,HCt,KCt,ZCt,g1t,JCt,nTt,aTt,v1t,x1t,lTt,fTt,pTt,S1t,gTt,vTt,bTt,N5,CTt,Q1t,$1t,$Tt,kTt,ITt,NTt,jxt,pA,RTt,J1t,twt,ewt,MTt,FTt,BTt,jTt,VTt,WTt,qTt,R1t,XTt,JTt,e$t,a$t,M1t,o$t,u$t,f$t,P1t,rTt,p$t,g$t,v$t,x$t,S$t,T$t,A$t,E$t,B1t,I$t,j1t,V1t,N$t,R$t,M$t,F$t,B$t,H1t,PSt,j$t,V$t,G$t,H$t,K$t,Z$t,C1t,a2t,o2t,u2t,yTt];for(const e of c2t)mW(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sl={},jg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function f2t(e,t){sl[e]=t}function ua(e,t){if(!(e in sl)||t!=null){const r=d2t(e,t);if(r!==null)sl[e]=r;else return console.log("Could not get context for WebGL version",e),null}const n=sl[e];return n==null||n.isContextLost()?(delete sl[e],ua(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),sl[e])}function h2t(e){if(!ct().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function d2t(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t??h2t(e);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete sl[e]},!1),ct().getBool("SOFTWARE_WEBGL_ENABLED")&&(jg.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",jg)||n.getContext("experimental-webgl",jg):n.getContext("webgl2",jg)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Od;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Od||(Od={}));var ci;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(ci||(ci={}));var Kn;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Kn||(Kn={}));function sm(e,t){return[t,e]}function p2t(e,t){return e*t}function Ug(e){const t=pt(e),n=Math.ceil(t/4);return F2(n)}function ef(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function m2t(e,t){const[n,r]=ef(e,t);return n*r*4}function YI(e,t){const n=e;let r,i,a,s,o,l,c,h,d,p;return ct().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,a=n.RGBA16F,s=n.RGBA32F,o=n.RED,c=4,h=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=e.RGBA,i=e.RGBA,a=e.RGBA,s=n.RGBA,o=e.RGBA,c=4,h=4,d=t!=null?t.HALF_FLOAT_OES:null,p=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:s,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:h,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nt(e,t){const n=t();return ct().getBool("DEBUG")&&g2t(e),n}function g2t(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+x2t(e,t))}const y2t=596e-10,v2t=65504;function b2t(e){return!!(ct().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||y2t<Math.abs(e)&&Math.abs(e)<v2t)}function x2t(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function Vg(e,t){return Is(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function w2t(e,t){const n=Is(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Nt(e,()=>e.shaderSource(n,t)),Nt(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function S2t(e,t){const n=Is(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Nt(e,()=>e.shaderSource(n,t)),Nt(e,()=>e.compileShader(n)),ct().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw _5(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const C2t=/ERROR: [0-9]+:([0-9]+):/g;function _5(e,t){const n=C2t.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}const r=+n[1],i=e.split(`
`),a=i.length.toString().length+2,s=i.map((d,p)=>Ju((p+1).toString(),a)+d);let o=0;for(let d=0;d<s.length;d++)o=Math.max(s[d].length,o);const l=s.slice(0,r-1),c=s.slice(r-1,r),h=s.slice(r);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${Ju(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function T2t(e){return Is(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function $2t(e,t){if(Nt(e,()=>e.linkProgram(t)),!ct().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function d$(e,t){if(Nt(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function A2t(e,t){const n=Is(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Nt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Nt(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function k2t(e,t){const n=Is(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Nt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),Nt(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function E2t(e){return Is(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function I2t(e,t){const n=ct().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){const r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function O2t(e){return Is(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function a4(e,t,n,r,i,a,s){const o=e.getAttribLocation(t,n);return o===-1?!1:(Nt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Nt(e,()=>e.vertexAttribPointer(o,i,e.FLOAT,!1,a,s)),Nt(e,()=>e.enableVertexAttribArray(o)),!0)}function N2t(e,t,n){P2t(e,n),Nt(e,()=>e.activeTexture(e.TEXTURE0+n)),Nt(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function _2t(e,t,n){return Is(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function R2t(e,t,n){return e.getUniformLocation(t,n)}function D2t(e,t,n,r){Nt(e,()=>N2t(e,t,r)),Nt(e,()=>e.uniform1i(n,r))}function p$(e,t,n){Nt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),Nt(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function s4(e,t){Nt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Nt(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function Wg(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+M2t(e,t))}function M2t(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Is(e,t,n){const r=Nt(e,()=>t());if(r==null)throw new Error(n);return r}function P2t(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Pc(e,t=2){return pt(e.slice(0,e.length-t))}function Fc(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Gg(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Pc(e),...Fc(e)]),t}function F2t(e,t=!1){let n=ct().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ct().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&ct().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((o,l)=>l>=e.length-2?Ak(e[l]):e[l]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=To(e).newShape);let i=pt(e),a=null;e.length<=1&&i<=n?a=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?a=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?a=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?a=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?a=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(a=[e[0],e[1]*e[2]*e[3]]);const s=a!=null&&Math.max(...a)>r&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(a==null||s)if(t){const o=Pc(e);let l=2,c=2;e.length&&([l,c]=Fc(e)),i=o*(l/2)*(c/2),a=F2(i).map(h=>h*2)}else a=F2(i);return a}function qg(e){return e%2===0}function Cv(e,t){if(e=e.slice(-2),t=t.slice(-2),we(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r||qg(n)&&qg(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&qg(e[0])&&qg(t[0])}let m$,g$;function L2t(e){if(m$==null){const t=ua(e);m$=t.getParameter(t.MAX_TEXTURE_SIZE)}return m$}function B2t(e){if(g$==null){const t=ua(e);g$=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,g$)}function z2t(e){if(e===0)return 0;let t;const n=ua(e);return Ri(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:Ri(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Ri(e,t){return e.getExtension(t)!=null}function o4(e){try{if(ua(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function j2t(e){if(e===0)return!1;const t=ua(e);if(e===1){if(!Ri(t,"OES_texture_float"))return!1}else if(!Ri(t,"EXT_color_buffer_float"))return!1;return gA(t)}function U2t(e){if(e===0)return!1;const t=ua(e);if(e===1){if(!Ri(t,"OES_texture_float")||!Ri(t,"WEBGL_color_buffer_float"))return!1}else{if(Ri(t,"EXT_color_buffer_float"))return gA(t);const r="EXT_color_buffer_half_float";if(Ri(t,r)){const i=t.getExtension(r);return V2t(t,i)}return!1}return gA(t)}function gA(e){const t=YI(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),s}function V2t(e,t){const n=YI(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(s),o}function W2t(e){return e!==2?!1:ua(e).fenceSync!=null}function om(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&j(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ft=ct();Ft.registerFlag("HAS_WEBGL",()=>Ft.getNumber("WEBGL_VERSION")>0);Ft.registerFlag("WEBGL_VERSION",()=>o4(2)?2:o4(1)?1:0);Ft.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ft.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ft.get("WEBGL_VERSION")===2);Ft.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ft.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ft.registerFlag("WEBGL_PACK",()=>Ft.getBool("HAS_WEBGL"));Ft.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_CLIP",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_REDUCE",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_CONV_IM2COL",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>L2t(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>B2t(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=Ft.getNumber("WEBGL_VERSION");return e===0?0:z2t(e)});Ft.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ft.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!EW());Ft.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>j2t(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ft.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ft.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ft.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>U2t(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_FENCE_API_ENABLED",()=>W2t(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ft.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ft.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});Ft.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>EW()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});Ft.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ft.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ft.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ft.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ft.registerFlag("WEBGL_EXP_CONV",()=>!1);Ft.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ft.getBool("IS_TEST"));Ft.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ft.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ft.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ft.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(){let e,t,n,r,i,a,s,o,l,c;return ct().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",s="out vec4 outputColor;",o=ct().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",s="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ql(e,t,n="index"){const r=Bt(t);return r.map((i,a)=>{const s=`int ${e[a]} = ${n} / ${i}`,o=a===r.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * ${i}`:`index -= ${e[a]} * ${i}`;return`${s}; ${o};`}).join("")}function N0(e,t,n="index"){const r=Bt(t);return r.map((i,a)=>{const s=`int ${e[a]} = ${n} / outShapeStrides[${a}]`,o=a===r.length-1?`int ${e[a+1]} = ${n} - ${e[a]} * outShapeStrides[${a}]`:`index -= ${e[a]} * outShapeStrides[${a}]`;return`${s}; ${o};`}).join("")}function G2t(e,t){const n=e.length,r=e.map(a=>`${t}[${a}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let a=n-3;a>=0;--a)i[a]=`(${i[a+1]} * ${r[a+1]})`;return i}function q2t(e,t,n="index"){const r=e.map((a,s)=>s),i=G2t(r,t);return i.map((a,s)=>{const o=`int ${e[s]} = ${n} / ${i[s]}`,l=s===i.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${i[s]}`:`index -= ${e[s]} * ${i[s]}`;return`${o}; ${l};`}).join("")}function ZI(e){const t=Bt(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function QI(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const R5=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:D5}=Pyt;function H2t(e,t,n){const r=[];if(e.forEach(g=>{const v=pt(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?r.push(`uniform float ${g.name}${v>1?`[${v}]`:""};`):(r.push(`uniform sampler2D ${g.name};`),r.push(`uniform int offset${g.name};`)),n.enableShapeUniforms){const{uniformShape:x}=JI(n.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(x.length){case 1:r.push(`uniform int ${g.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${g.name}Shape;`);break}r.push(`uniform ivec2 ${g.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(g=>{r.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const i=r.join(`
`),a=e.map(g=>X2t(g,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),s=t.texShape,o=$r(),l=Z2t(o);let c,h,d=tAt(o);return t.isPacked?(c=K2t(t.logicalShape,s,n.enableShapeUniforms),h=J2t(o)):(c=Y2t(t.logicalShape,s,n.enableShapeUniforms),h=Q2t(o)),n.packedInputs&&(d+=iAt),[d,l,h,i,c,a,n.userCode].join(`
`)}function nf(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return gAt(e,t);case 1:return vAt(e,t);case 2:return xAt(e,t);case 3:return SAt(e,t);case 4:return TAt(e,t);case 5:return $At(e);case 6:return AAt(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function M5(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return mAt(e);case 1:return yAt(e,t);case 2:return bAt(e,t);case 3:return wAt(e,t);default:return CAt(e,t)}}function X2t(e,t,n=!1,r){let i="";n?i+=M5(e,r):i+=nf(e,r);const a=e.shapeInfo.logicalShape,s=t.logicalShape;return a.length<=s.length&&(n?i+=kAt(e,t):i+=EAt(e,t)),i}function K2t(e,t,n){switch(e.length){case 0:return P5();case 1:return aAt(e,t,n);case 2:return dAt(e,t,n);case 3:return oAt(e,t,n);default:return uAt(e,t,n)}}function Y2t(e,t,n){switch(e.length){case 0:return P5();case 1:return sAt(e,t,n);case 2:return pAt(e,t,n);case 3:return lAt(e,t,n);case 4:return cAt(e,t,n);case 5:return fAt(e,t);case 6:return hAt(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function Z2t(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function Q2t(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function J2t(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function tAt(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${eAt}
    ${nAt}
    ${rAt}
  `}const eAt=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,nAt=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rAt=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,iAt=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function P5(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function aAt(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function sAt(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function oAt(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),a=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function lAt(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${N0(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;const r=ql(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function uAt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),a=i*Math.ceil(e[e.length-2]/2);let s=a,o="",l="b, r, c";for(let c=2;c<e.length-1;c++)s*=e[e.length-c-1],o=`
      int b${c} = index / ${s};
      index -= b${c} * ${s};
    `+o,l=`b${c}, `+l;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${l});
    }
  `}function cAt(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${N0(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;const r=ql(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function fAt(e,t){const n=ql(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function hAt(e,t){const n=ql(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function dAt(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(we(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function pAt(e,t,n){return we(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function Hl(e){return`offset${e}`}function mAt(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=$r();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function gAt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,a]=e.shapeInfo.texShape;if(i===1&&a===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const s=Hl(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});
      return sampleTexture(${n}, uv);
    }
  `;const[o,l]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${s});
      return sampleTexture(${n}, uv);
    }
  `}function yAt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,a=$r();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;const s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${s[0]}, ${s[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function vAt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${rf(e)}
      }
    `;const i=e.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Hl(n);return s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${s}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${a}, ${s}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function bAt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,s=a[0],o=a[1],l=$r();if(a!=null&&we(n,a))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${s}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],h=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function xAt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape;if(a!=null&&we(n,a)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const p=a[0],g=a[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:s,keptDims:o}=To(n),l=s;if(l.length<n.length){const p=af(e,l),g=["row","col"];return`
      ${nf(p,t)}
      float ${i}(int row, int col) {
        return ${i}(${sf(g,o)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${rf(e)}
      }
    `;const c=a[0],h=a[1],d=Hl(r);return h===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${h}, index);
    return sampleTexture(${r}, uv);
  }
`}function wAt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){const p=n.slice(1),g=[1,2],v=af(e,p),x=["b","row","col"];return`
        ${M5(v,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${sf(x,g)});
        }
      `}const o=$r();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;const l=s[0],c=s[1],h=Math.ceil(n[2]/2),d=h*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${h}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function SAt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],s=n[2],{newShape:o,keptDims:l}=To(n),c=o;if(c.length<n.length){const x=af(e,c),b=["row","col","depth"];return`
        ${nf(x,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${sf(b,l)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${s}, 1)));
        ${rf(e)}
      }
    `;const h=e.shapeInfo.texShape,d=h[0],p=h[1],g=e.shapeInfo.flatOffset;if(p===a&&g==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${s}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===s&&g==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const v=Hl(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${v};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${s} + depth + ${v};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function CAt(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=$r();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;const a=e.shapeInfo.logicalShape,s=a.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],h=l[1],d=Math.ceil(a[s-1]/2);let p=d*Math.ceil(a[s-2]/2),g="int b, int row, int col",v=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let x=2;x<s-1;x++)g=`int b${x}, `+g,p*=a[s-x-1],v=`b${x} * ${p} + `+v;return`
    vec4 ${r}(${g}) {
      int index = ${v};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${c});
      return ${i.texture2D}(${n}, uv);
    }
  `}function TAt(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],s=n[2]*a,o=n[1]*s,{newShape:l,keptDims:c}=To(n);if(l.length<n.length){const C=af(e,l),T=["row","col","depth","depth2"];return`
      ${nf(C,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${sf(T,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${s}, ${a}, 1)));
        ${rf(e)}
      }
    `;const h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],g=d[1],v=`int stride2 = ${r}Shape[3];`,x=`int stride1 = ${r}Shape[2] * stride2;`,b=`int stride0 = ${r}Shape[1] * stride1;`;if(g===o&&h==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${v}
        ${x}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${s}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(g===a&&h==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;const w=Hl(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${v}
      ${x}
      ${b}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${w});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${p}, ${g}, index + ${w});
      return sampleTexture(${r}, uv);
    }
  `}function $At(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],a=t[3]*i,s=t[2]*a,o=t[1]*s,{newShape:l,keptDims:c}=To(t);if(l.length<t.length){const x=af(e,l),b=["row","col","depth","depth2","depth3"];return`
      ${nf(x)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${sf(b,c)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${s}, ${a}, ${i})) +
          depth3;
        ${rf(e)}
      }
    `;const h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],g=d[1];if(g===o&&h==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${s}, ${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(g===i&&h==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const v=Hl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} + depth * ${a} +
          depth2 * ${i} + depth3 + ${v};
      vec2 uv = uvFromFlat(${p}, ${g}, index);
      return sampleTexture(${n}, uv);
    }
  `}function AAt(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:a}=To(t);if(i.length<t.length){const b=af(e,i),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${nf(b)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${sf(w,a)});
      }
    `}const s=t[5],o=t[4]*s,l=t[3]*o,c=t[2]*l,h=t[1]*c;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${s}, 1)));
        ${rf(e)}
      }
    `;const d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,g=p[0],v=p[1];if(v===h&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${s})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${v}.0, ${g}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(v===s&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${v}.0, ${g}.0);
        return sampleTexture(${n}, uv);
      }
    `;const x=Hl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${s} + depth4 + ${x};
      vec2 uv = uvFromFlat(${g}, ${v}, index);
      return sampleTexture(${n}, uv);
    }
  `}function rf(e){const t=e.name,n=pt(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function kAt(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,o=D5(e.shapeInfo.logicalShape,t.logicalShape),l=Re(s),c=s-a;let h;const d=["x","y","z","w","u","v"];a===0?h="":s<2&&o.length>=1?h="coords = 0;":h=o.map(C=>`coords.${d[C+c]} = 0;`).join(`
`);let p="";s<2&&a>0?p="coords":p=e.shapeInfo.logicalShape.map((C,T)=>`coords.${d[T+c]}`).join(", ");let g="return outputValue;";const x=pt(e.shapeInfo.logicalShape)===1,w=pt(t.logicalShape)===1;if(a===1&&!x&&!w)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(x&&!w)s===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(o.length){const C=a-2,T=a-1;o.indexOf(C)>-1&&o.indexOf(T)>-1?g="return vec4(outputValue.x);":o.indexOf(C)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(T)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${r}(${p});
      ${g}
    }
  `}function EAt(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=t.texShape,s=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&e.shapeInfo.flatOffset==null&&we(s,a))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=Re(l),h=D5(e.shapeInfo.logicalShape,t.logicalShape),d=l-o;let p;const g=["x","y","z","w","u","v"];o===0?p="":l<2&&h.length>=1?p="coords = 0;":p=h.map(x=>`coords.${g[x+d]} = 0;`).join(`
`);let v="";return l<2&&o>0?v="coords":v=e.shapeInfo.logicalShape.map((x,b)=>`coords.${g[b+d]}`).join(", "),`
    float ${i}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${r}(${v});
    }
  `}function Re(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function JI(e,t,n){const{newShape:r,keptDims:i}=To(t),a=t.length,s=e&&a===3&&t[0]===1,o=s?t.slice(1):r,l=!e&&a>1&&!we(t,n)&&r.length<a||s;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:i}}function af(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function sf(e,t){return t.map(n=>e[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IAt(e,t,n,r){const i=n.map((h,d)=>{const p={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(p.flatOffset=h.texData.slice.flatOffset),{name:t.variableNames[d],shapeInfo:p}}),a=i.map(h=>h.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=H2t(i,s,t),l=S2t(e.gl,o),c=e.createProgram(l);return ct().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:s},F5(e,t,c)))}function F5(e,t,n){const r=[],i=[];let a,s,o,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),ct().getNumber("WEBGL_VERSION")===1&&(l=e.getUniformLocation(n,"INFINITY",!1));const h=!1;for(const d of t.variableNames){const p={name:d,uniform:e.getUniformLocation(n,d,h),offset:e.getUniformLocation(n,`offset${d}`,h)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,`${d}Shape`,h),p.texShape=e.getUniformLocation(n,`${d}TexShape`,h)),r.push(p)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",h),o=e.getUniformLocation(n,"outShapeStrides",h),s=e.getUniformLocation(n,"outTexShape",h)),t.customUniforms)for(const d of t.customUniforms)i.push(e.getUniformLocation(n,d.name,h));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:c,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:s}}function l4(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{const i=n.logicalShape,a=t[r],s=a.shape;if(!we(i,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${s} must match`);if(n.isUniform&&a.isUniform)return;const o=n.texShape,l=a.isUniform?null:a.texData.texShape;if(!we(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function OAt(e,t,n,r,i){t.program.enableShapeUniforms||(l4(t.inShapeInfos,n),l4([t.outShapeInfo],[r]));const a=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(a.texture,s[0],s[1]):e.setOutputMatrixTexture(a.texture,s[0],s[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),ct().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:h,offset:d,shape:p,texShape:g}=t.variablesLocations[l];if(p){const{uniformShape:v}=JI(t.program.packedInputs,c.shape,c.texData.texShape);switch(v.length){case 1:e.gl.uniform1iv(p,new Int32Array(v));break;case 2:e.gl.uniform2iv(p,new Int32Array(v));break;case 3:e.gl.uniform3iv(p,new Int32Array(v));break;case 4:e.gl.uniform4iv(p,new Int32Array(v));break}}if(g&&e.gl.uniform2i(g,c.texData.texShape[0],c.texData.texShape[1]),h!=null){if(c.isUniform){if(pt(c.shape)<2)e.gl.uniform1f(h,c.uniformValues[0]);else{let v=c.uniformValues;v instanceof Float32Array||(v=new Float32Array(v)),e.gl.uniform1fv(h,v)}continue}c.texData.slice!=null&&d!=null&&e.gl.uniform1i(d,c.texData.slice.flatOffset),e.setInputMatrixTexture(c.texData.texture.texture,h,l)}}const o=t.outShapeLocation;if(o)switch(r.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){const l=Bt(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let l=0;l<t.program.customUniforms.length;++l){const c=t.program.customUniforms[l],h=t.customUniformLocations[l],d=i[l];if(c.type==="float")e.gl.uniform1fv(h,d);else if(c.type==="vec2")e.gl.uniform2fv(h,d);else if(c.type==="vec3")e.gl.uniform3fv(h,d);else if(c.type==="vec4")e.gl.uniform4fv(h,d);else if(c.type==="int")e.gl.uniform1iv(h,d);else if(c.type==="ivec2")e.gl.uniform2iv(h,d);else if(c.type==="ivec3")e.gl.uniform3iv(h,d);else if(c.type==="ivec4")e.gl.uniform4iv(h,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}e.executeProgram()}function NAt(e,t,n){let r="";t.concat(n).forEach(s=>{const o=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!s.isUniform){const l=s.texData.texShape,{useSqueezeShape:c,uniformShape:h,keptDims:d}=JI(e.packedInputs,s.shape,l);let p="",g="",v="";if(h.length===1&&e.packedInputs){const A=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${A[0]>1}_${A[1]>1}`}else if(h.length===2&&!e.packedInputs)g=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!e.packedInputs){const A=Bt(h);v=`${A[0]===l[1]}_${A[A.length-1]===l[1]}`}const x=s.shape.length,b=h.length===2&&we(s.shape,l),w=pt(s.shape)===1,C=Oc(s.shape,n.shape),T=!e.packedInputs&&x===n.shape.length&&we(l,n.texData.texShape),$=e.packedInputs||h.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${x}_${T}_${c?d:""}_${h.length}_${w}_${C}_${b}_${p}_${g}_${v}_${$}_${o}`}else{const l=s.isUniform?"uniform":s.texData.texShape;r+=`${s.shape}_${l}_${o}`}});const i=e.userCode;let a=e.constructor.name;return a+="_"+r+"_"+i+`${ct().getNumber("WEBGL_VERSION")}`,a}function hr(e){return ct().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _At{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Od.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=$r();this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?N0(["r","c","d"],t):ql(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RAt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Od.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=$r();this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?N0(["r","c","d"],t):ql(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DAt{constructor(t){this.variableNames=["A"],this.outTexUsage=ci.DOWNLOAD;const n=$r();this.outputShape=t,this.userCode=`
      ${R5}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MAt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ci.DOWNLOAD;const n=$r();this.outputShape=t,this.userCode=`
      ${R5}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PAt={R:0,G:1,B:2,A:3};class u4{constructor(t,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=$r();this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length);let a="result";n&&(a="floor(result * 255. + 0.5)");let s="";for(let o=0;o<r.length;o++){const l=r[o];s+=`
          if(offset == ${o}) {
            result = values[${PAt[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?QI():ZI(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${s}
        }
        ${i.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FAt{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=$r();this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length);let i="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let o=0;o<=1;o++){const l=s*2+o;i+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${s} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${s};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?QI():ZI(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LAt(e){const t=$r(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return w2t(e,n)}function BAt(e){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return A2t(e,t)}function zAt(e){const t=new Uint16Array([0,1,2,2,1,3]);return k2t(e,t)}function lm(e,t,n,r,i,a){I2t(t,n);const s=E2t(e),o=e.TEXTURE_2D;return Nt(e,()=>e.bindTexture(o,s)),Nt(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Nt(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Nt(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),Nt(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),ct().getNumber("WEBGL_VERSION")===1?Nt(e,()=>e.texImage2D(o,0,r,t,n,0,i,a,null)):Nt(e,()=>e.texStorage2D(o,1,r,t,n)),Nt(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:s,texShape:[n,t]}}function L5(e){return e.internalFormatFloat}function jAt(e,t,n,r){const[i,a]=sm(t,n);return lm(e,i,a,L5(r),r.textureFormatFloat,e.FLOAT)}function B5(e){return e.internalFormatHalfFloat}function UAt(e,t,n,r){const[i,a]=sm(t,n);return lm(e,i,a,B5(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function z5(e){return e.downloadTextureFormat}function VAt(e,t,n,r){const[i,a]=sm(t,n);return lm(e,i,a,z5(r),e.RGBA,e.UNSIGNED_BYTE)}function j5(e){return e.internalFormatPackedFloat}function WAt(e,t,n,r){const[i,a]=ef(t,n);return lm(e,i,a,j5(r),e.RGBA,e.FLOAT)}function U5(e){return e.internalFormatPackedHalfFloat}function GAt(e,t,n,r){const[i,a]=ef(t,n);return lm(e,i,a,U5(r),e.RGBA,r.textureTypeHalfFloat)}function qAt(e,t,n){return Nt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),a4(e,t,"clipSpacePos",n,3,20,0)&&a4(e,t,"uv",n,2,20,12)}function HAt(e,t,n,r,i,a){Nt(e,()=>e.bindTexture(e.TEXTURE_2D,t));let s,o,l;i instanceof Uint8Array?(s=new Uint8Array(n*r*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(n*r*4),o=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),ct().getNumber("WEBGL_VERSION")===2?Nt(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,o,s)):Nt(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,o,s)),Nt(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function XAt(e,t,n){Nt(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?ct().getNumber("WEBGL_VERSION")===2?Nt(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):Nt(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):ct().getNumber("WEBGL_VERSION")===2?Nt(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):Nt(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),Nt(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function KAt(e,t,n,r){const i=e.createBuffer();Nt(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));const o=4*4*t*n;return Nt(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)),Nt(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),Nt(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function YAt(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function ZAt(e,t,n,r){const[i,a]=sm(t,n),s=4,o=new Uint8Array(p2t(t*n,s));return Nt(e,()=>e.readPixels(0,0,i,a,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function QAt(e,t,n,r,i,a,s,o){const l=e,c=new Float32Array(m2t(a,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function JAt(e,t,n){const r=new Float32Array(t*n*4);return Nt(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y${constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ct().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,f2t(n,t)):this.gl=ua(n),t=this.gl,ct().getNumber("WEBGL_VERSION")===2){const a=t;this.createVertexArray=()=>Nt(a,()=>a.createVertexArray()),this.bindVertexArray=s=>Nt(a,()=>a.bindVertexArray(s)),this.deleteVertexArray=s=>Nt(a,()=>a.deleteVertexArray(s)),this.getVertexArray=()=>Nt(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(t!=null){const a=t.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Nt(t,()=>a.createVertexArrayOES()),this.bindVertexArray=s=>Nt(t,()=>a.bindVertexArrayOES(s)),this.deleteVertexArray=s=>Nt(t,()=>a.deleteVertexArrayOES(s)),this.getVertexArray=()=>Nt(t,()=>t.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ct().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",s="OES_texture_half_float";if(this.textureFloatExtension=Vg(this.gl,a),Ri(this.gl,s))this.textureHalfFloatExtension=Vg(this.gl,s);else if(ct().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ri(this.gl,i))this.colorBufferHalfFloatExtension=Vg(this.gl,i);else if(ct().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ri(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Ri(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=BAt(this.gl),this.indexBuffer=zAt(this.gl),this.framebuffer=O2t(this.gl),this.textureConfig=YI(this.gl,this.textureHalfFloatExtension)}get debug(){return ct().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Nt(t,()=>t.finish()),Nt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Nt(t,()=>t.deleteFramebuffer(this.framebuffer)),Nt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Nt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Nt(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),jAt(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),UAt(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),VAt(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),XAt(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,r,i){this.throwIfDisposed(),HAt(this.gl,t,n,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),GAt(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),WAt(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(s4(this.gl,this.framebuffer),this.outputTexture=null),Nt(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,r){return this.downloadMatrixDriver(t,()=>ZAt(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,r,i,a,s){return QAt(this.gl,t,n,r,i,a,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return YAt(this.gl,t,n)}createBufferFromTexture(t,n,r){this.bindTextureToFrameBuffer(t);const i=KAt(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,r;if(ct().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(t,n,r){return this.downloadMatrixDriver(t,()=>JAt(this.gl,n,r))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=LAt(n));const r=T2t(n);Nt(n,()=>n.attachShader(r,this.vertexShader)),Nt(n,()=>n.attachShader(r,t)),$2t(n,r);const i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&d$(n,i),i}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const n=this.gl;Nt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),qAt(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(Nt(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&d$(this.gl,this.program),Nt(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,r=!0){return this.throwIfDisposed(),r?_2t(this.gl,t,n):R2t(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Nt(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),D2t(this.gl,t,n,r)}setOutputMatrixTexture(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)}setOutputPackedMatrixTexture(t,n,r){this.throwIfDisposed();const[i,a]=ef(n,r);this.setOutputMatrixTextureDriver(t,i,a)}setOutputMatrixWriteRegion(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)}setOutputPackedMatrixWriteRegion(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&d$(this.gl,this.program),Wg(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Nt(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Nt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Vg(this.gl,ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,a),a}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await WB(()=>this.disposed||this.isQueryAvailable(t,ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=tkt(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ct().platform&&(r=ct().platform.setTimeoutCustom.bind(ct().platform)),WB(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),p$(this.gl,t,this.framebuffer),this.debug&&Wg(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(p$(this.gl,this.outputTexture,this.framebuffer),this.debug&&Wg(this.gl)):s4(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,n,r){this.throwIfDisposed();const i=this.gl;p$(i,t,this.framebuffer),this.debug&&Wg(i),this.outputTexture=t,Nt(i,()=>i.viewport(0,0,n,r)),Nt(i,()=>i.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(t,n,r,i){this.throwIfDisposed(),Nt(this.gl,()=>this.gl.scissor(t,n,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function tkt(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:ekt,bincountImpl:V5,bincountReduceImpl:nkt,bitwiseAndImpl:rkt,castImpl:ikt,ceilImpl:akt,concatImpl:skt,equalImpl:okt,expImpl:lkt,expm1Impl:ukt,floorImpl:ckt,gatherNdImpl:fkt,gatherV2Impl:hkt,greaterImpl:dkt,greaterEqualImpl:pkt,lessImpl:mkt,lessEqualImpl:gkt,linSpaceImpl:ykt,logImpl:vkt,maxImpl:bkt,maximumImpl:xkt,minimumImpl:wkt,multiplyImpl:Skt,negImpl:Ckt,notEqualImpl:Tkt,prodImpl:$kt,raggedGatherImpl:Akt,raggedRangeImpl:kkt,raggedTensorToTensorImpl:Ekt,rangeImpl:Ikt,rsqrtImpl:Okt,scatterImpl:Nkt,sigmoidImpl:_kt,simpleAbsImpl:W5,sliceImpl:Rkt,sparseFillEmptyRowsImpl:Dkt,sparseReshapeImpl:Mkt,sparseSegmentReductionImpl:G5,sqrtImpl:Pkt,staticRegexReplaceImpl:Fkt,stridedSliceImpl:Lkt,stringNGramsImpl:Bkt,stringSplitImpl:zkt,stringToHashBucketFastImpl:jkt,subImpl:Ukt,tileImpl:Vkt,topKImpl:Wkt,transposeImpl:tO,uniqueImpl:Gkt}=X1t;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q5(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function Sr(e,t){return t===1?[e]:q5(e,t)}function qkt(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hkt{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=hr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Sr("rc",this.rank),r=Re(this.rank),i=this.getOutOfBoundsCondition(n),a=this.getSetup(n),s=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${s}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let a=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let s=2;s<this.rank;s++)a=`${t[t.length-1-s]},`+a;n.push(a)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H5{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length);let r="";for(let i=0;i<4;i++){let a="thisRC = rc;";i%2===1&&(a+="thisRC.z += 1;"),i>1&&(a+="thisRC.y += 1;"),r+=`
        ${a}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${Xkt(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?QI():ZI(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${r}

        setOutput(result);
      }
    `}}function Xkt(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?q2t(["r","c","d"],"inputShape"):ql(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kkt{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,r){const i=f4(n,r),a=h4(t,i,r);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const s=c4(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();const l=this.freeTextures[a].pop();return this.usedTextures[a].push(l),l}let o;return i===Kn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Kn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Kn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Kn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Kn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),o}releaseTexture(t,n,r,i){if(this.freeTextures==null)return;const a=f4(r,i),s=h4(n,a,i);s in this.freeTextures||(this.freeTextures[s]=[]);const o=c4(n,a,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=ct().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=o):(this.freeTextures[s].push(t),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[s],h=c&&c.indexOf(t);if(h==null||h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[h]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Ykt(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function c4(e,t,n,r,i){const a=Zkt(t,r);let s;if(i){const[l,c]=ef(e[0],e[1]);s=l*c}else{const[l,c]=sm(e[0],e[1]);s=l*c}const o=Ykt(n,a);return s*o}function Zkt(e,t){switch(e){case Kn.PACKED_2X2_FLOAT32:return j5(t);case Kn.PACKED_2X2_FLOAT16:return U5(t);case Kn.UNPACKED_FLOAT32:return L5(t);case Kn.UNPACKED_FLOAT16:return B5(t);case Kn.PACKED_4X1_UNSIGNED_BYTE:return z5(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function Qkt(e){return ct().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Kn.PACKED_2X2_FLOAT32:Kn.UNPACKED_FLOAT32:e?Kn.PACKED_2X2_FLOAT16:Kn.UNPACKED_FLOAT16}function f4(e,t){if(e===ci.UPLOAD)return Kn.PACKED_2X2_FLOAT32;if(e===ci.RENDER||e==null)return Qkt(t);if(e===ci.DOWNLOAD||e===ci.PIXELS)return Kn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function h4(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ta{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Vi="if (isnan(x)) return x;",Jkt="return x;",d4="return abs(x);",tEt="return (x >= 0.0) ? x : (exp(x) - 1.0);",eEt=Vi+`
  return (x < 0.0) ? 0.0 : x;
`,nEt=Vi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,to="return x;",rEt="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iEt="return x;",aEt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,sEt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,oEt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,lEt="return 1.0 / (1.0 + exp(-1.0 * x));";class ao{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uEt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length);const n=t.length,r=Sr("rc",n),i=Re(n),a=qkt(n,r),s=r.slice(-2),o=n<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cEt=yG,fEt=1e-7,hEt=1e-4,Hg={};function dEt(e){return e in Hg||(Hg[e]={}),Hg[e]}const pEt=ct().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),mEt=600;function gEt(){return ct().global.screen==null?1024:ct().global.screen.height*ct().global.screen.width*window.devicePixelRatio*mEt/1024/1024}class _0 extends $k{nextDataId(){return _0.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ct().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof y$)n=t;else{const r=ua(ct().getNumber("WEBGL_VERSION"),t);n=new y$(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=ua(ct().getNumber("WEBGL_VERSION"));n=new y$(r),this.binaryCache=dEt(ct().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Kkt(this.gpgpu),this.numMBBeforeWarning=gEt(),this.texData=new zV(this,ya())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,r,i,a,s){const o=this.makeTensorInfo(n,r),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:t,texShape:[i,a]},l.texShape=[i,a];const c=Gg(n),h=new u4(c,!1,s),d=this.runWebGLProgram(h,[o],r,[[i,a]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(t,n,r){if((ct().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ct().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:r,values:t,usage:ci.UPLOAD,refCount:1}),i}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,r,i,a){if(ct().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:i,values:n,usage:ci.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:r,dtype:i,complexTensorInfos:a,slice:s,shape:o,isPacked:l}=n;if(s!=null){let p;l?p=new ao(o,to):p=new Ta(o,to);const g=this.runWebGLProgram(p,[{dataId:t,shape:o,dtype:i}],i),v=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),v}if(r!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return r;const c=this.activeTimers!=null;let h;c&&(h=Er());let d;if(i==="complex64"){const p=this.readSync(a.real.dataId),g=this.readSync(a.imag.dataId);d=ws(p,g)}else d=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=Er()-h),this.convertAndCacheOnCPU(t,d)}async read(t){if(this.pendingRead.has(t)){const v=this.pendingRead.get(t);return new Promise(x=>v.push(x))}const n=this.texData.get(t),{values:r,shape:i,slice:a,dtype:s,complexTensorInfos:o,isPacked:l}=n;if(a!=null){let v;l?v=new ao(i,to):v=new Ta(i,to);const x=this.runWebGLProgram(v,[{dataId:t,shape:i,dtype:s}],s),b=this.read(x.dataId);return this.disposeIntermediateTensorInfo(x),b}if(r!=null)return this.convertAndCacheOnCPU(t);if(ct().getBool("DEBUG")&&!ct().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ct().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,h;if(s!=="complex64"&&ct().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(t);const v=this.texData.get(h.dataId);c=this.gpgpu.createBufferFromTexture(v.texture.texture,...Ug(i))}this.pendingRead.set(t,[]),s!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(s==="complex64"){const v=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),x=v[0],b=v[1];d=ws(x,b)}else if(c==null)d=this.getValuesFromTexture(t);else{const v=pt(i);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,v)}if(h!=null&&this.disposeIntermediateTensorInfo(h),c!=null){const v=this.gpgpu.gl;Nt(v,()=>v.deleteBuffer(c))}const p=this.convertAndCacheOnCPU(t,d),g=this.pendingRead.get(t);return this.pendingRead.delete(t),g.forEach(v=>v(p)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&ya().removeDataId(t,this),this.pendingDeletes--),p}readToGPU(t,n={}){const r=this.texData.get(t),{values:i,shape:a,slice:s,dtype:o,isPacked:l,texture:c}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(s!=null){let g;l?g=new ao(a,to):g=new Ta(a,to);const v=this.runWebGLProgram(g,[{dataId:t,shape:a,dtype:o}],o),x=this.readToGPU(v,n);return this.disposeIntermediateTensorInfo(v),x}if(c==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(t,n.customTexShape),d=ya().makeTensorFromTensorInfo(h),p=this.texData.get(h.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>ho(i));return ne(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ne(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const r=t[n];if(!b2t(r))throw ct().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:r,isPacked:i}=this.texData.get(t),a=pt(n);if(ct().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(t),g=this.texData.get(p.dataId),v=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...Ug(n)).subarray(0,a);return this.disposeIntermediateTensorInfo(p),v}const s=ct().getBool("WEBGL_PACK")&&i===!0,o=s?Gg(n):n,l=s?new MAt(o):new DAt(o),c=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:t}],"float32"),h=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t();const a=Tl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),s=Tl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(a);o.kernelMs=nft(l),o.getExtraProfileInfo=()=>l.map((c,h)=>({name:s[h],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Er(),endMs:null}}endTimer(t){return ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Er(),t)}async getQueryTime(t){if(ct().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:r}=this.texData.get(t);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:r,texShape:i,usage:a,isPacked:s,slice:o}=this.texData.get(t),l=o&&o.origDataId||t,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,a,s)));const h=this.texData.get(t);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=pEt){return ct().getBool("WEBGL_CPU_FORWARD")&&t.every(r=>this.texData.get(r.dataId).texture==null&&pt(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){ui("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return cEt(t.shape,n)}packedUnaryOp(t,n,r){const i=new ao(t.shape,n),a=this.compileAndRun(i,[t],r);return ya().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const i=W5(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,i)}if(ct().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,d4,t.dtype);const n=new Ta(t.shape,d4),r=this.compileAndRun(n,[t]);return ya().makeTensorFromTensorInfo(r)}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&Gd(r[0])){const a=r.map(s=>uo(s));i=this.write(a,t,n)}else i=this.write(r,t,n);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:n}}makeOutput(t,n,r){return ya().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,r),this)}unpackTensor(t){const n=new uEt(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new Hkt(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){const r=[Pc(t.shape),...Fc(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},a=[Pc(n),...Fc(n)],s=new H5(a,r),o=!0,l=[r],c=this.runWebGLProgram(s,[i],t.dtype,l,o);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(t,n){const r=this.texData.get(t),{isPacked:i,shape:a,dtype:s}=r;if(n!=null){const p=pt(a),g=n[0]*n[1]*4;j(p<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=Gg(a);let l;i?l=new RAt(o):l=new _At(o);const c=!0,h=[n??Ug(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:t}],s,h,c,n);return{dtype:s,shape:a,dataId:d.dataId}}runWebGLProgram(t,n,r,i,a=!1,s){const o=this.makeTensorInfo(t.outputShape,r),l=this.texData.get(o.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===Od.DENSE){const w=s??Ug(t.outputShape);l.texShape=w.map(C=>C*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),pt(o.shape)===0)return l.values=lr(o.dtype,0),o;const c=[],h=n.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let C=this.texData.get(w.dataId);if(C.texture==null){if(!t.packedInputs&&pt(w.shape)<=ct().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:C.values};t.packedInputs&&(C.isPacked=!0,C.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!C.isPacked!=!!t.packedInputs)w=C.isPacked?this.unpackTensor(w):this.packTensor(w),c.push(w),C=this.texData.get(w.dataId);else if(C.isPacked&&!Cv(C.shape,w.shape)){const T=w,$=w.shape;w.shape=C.shape,w=this.packedReshape(w,$),c.push(w),C=this.texData.get(w.dataId),T.shape=$}return{shape:w.shape,texData:C,isUniform:!1}});this.uploadToGPU(o.dataId);const d={shape:o.shape,texData:l,isUniform:!1},p=NAt(t,h,d),g=this.getAndSaveBinary(p,()=>IAt(this.gpgpu,t,h,d)),v=this.activeTimers!=null;let x;v&&(x=this.startTimer()),ct().get("ENGINE_COMPILE_ONLY")||OAt(this.gpgpu,g,h,d,i),c.forEach(w=>this.disposeIntermediateTensorInfo(w)),v&&(x=this.endTimer(x),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(x)}));const b=ct().getNumber("WEBGL_FLUSH_THRESHOLD");if(b>0){const w=Er();w-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!ct().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){const w=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),w}return o}compileAndRun(t,n,r,i,a=!1){return r=r||n[0].dtype,this.runWebGLProgram(t,n,r,i,a)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ct().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=st(()=>{if(!ct().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=ct().getBool("DEBUG");ct().set("DEBUG",!1);const n=this.abs(de(1e-8)).dataSync()[0];if(ct().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?fEt:hEt}uploadToGPU(t){const n=this.texData.get(t),{shape:r,dtype:i,values:a,texture:s,usage:o,isPacked:l}=n;if(s!=null)return;const c=this.activeTimers!=null;let h;c&&(h=Er());let d=n.texShape;if(d==null&&(d=F2t(r,l),n.texShape=d),a!=null){const p=Gg(r);let g,v=d[1],x=d[0];const b=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(l||!b)&&([v,x]=ef(d[0],d[1])),l?g=new FAt(p,b):g=new u4(p,b);const w=b?[x,v]:d,C=this.makeTensorInfo(w,i),T=this.texData.get(C.dataId);b?T.usage=ci.PIXELS:T.usage=ci.UPLOAD,T.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),v,x,a);const $=[[x,v]],E=this.runWebGLProgram(g,[C],i,$,!0),O=this.texData.get(E.dataId);n.texShape=O.texShape,n.isPacked=O.isPacked,n.usage=O.usage,ct().get("ENGINE_COMPILE_ONLY")?this.disposeData(E.dataId):(n.texture=O.texture,n.values=null,this.texData.delete(E.dataId)),this.disposeIntermediateTensorInfo(C),c&&(this.uploadWaitMs+=Er()-h)}else{const p=this.acquireTexture(d,o,i,l);n.texture=p}}convertAndCacheOnCPU(t,n){const r=this.texData.get(t),{dtype:i}=r;return n!=null&&(r.values=yEt(n,i)),r.values}acquireTexture(t,n,r,i){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,i)}computeBytes(t,n){return t[0]*t[1]*tv(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(a){throw a}});t.push(r)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await DG(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(_5(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:i,nanLoc:a,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:l}=F5(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=r,t.infLoc=i,t.nanLoc=a,t.outShapeLocation=s,t.outShapeStridesLocation=o,t.outTexShapeLocation=l}}createTensorFromGPUData(t,n,r){t.channels=t.channels||"RGBA";const{texture:i,height:a,width:s,channels:o}=t,l=ya().backend;if(!l.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(i,n,r,a,s,o);return ya().makeTensorFromDataId(c,n,r,l)}}_0.nextDataId=0;function yEt(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */IW()&&RW("webgl",()=>new _0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eO=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Pl{constructor(t,n,r){this.variableNames=["A","B"],this.outputShape=Jt(n,r),this.enableShapeUniforms=hr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class of{constructor(t,n,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Jt(n,r);const a=this.outputShape.length;this.enableShapeUniforms=hr(a);let s="";if(i)if(a===0||pt(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          ${Re(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?s+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:s+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Sr("coords",a);this.enableShapeUniforms?s+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:s+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${s}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yr(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const vEt={kernelName:hp,backendName:"webgl",kernelFunc:Yr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ro(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(a.dataId),o=Yr({inputs:{x:r},backend:n}),l=Yr({inputs:{x:i},backend:n});return s.complexTensorInfos={real:o,imag:l},a}const bEt={kernelName:Fk,backendName:"webgl",kernelFunc:Ro};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X5="return (a < 0.) ? b * a : a;",K5=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function xEt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:a}=r,s=n.makeTensorInfo([],"float32",$o(a,"float32")),o=ct().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new of(K5,i.shape,s.shape):new Pl(X5,i.shape,s.shape),l=n.runWebGLProgram(o,[i,s],"float32");return n.disposeIntermediateTensorInfo(s),l}const wEt={kernelName:kb,backendName:"webgl",kernelFunc:xEt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y5="return (a < 0.) ? b * a : a;",Z5=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function SEt(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t,a=ct().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new of(Z5,r.shape,i.shape):new Pl(Y5,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],"float32")}const CEt={kernelName:qb,backendName:"webgl",kernelFunc:SEt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lf="if (isnan(x)) return x;";function ye({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:a})=>{const{x:s}=i,o=a,l=r||s.dtype;if(o.shouldExecuteOnCPU([s])&&n!=null){const d=o.texData.get(s.dataId),p=n(d.values,l);return o.makeTensorInfo(s.shape,l,p)}const c=ct().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let h;return c?h=new ao(s.shape,t):h=new Ta(s.shape,e),o.runWebGLProgram(h,[s],l)}}function tr({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:a}){return({inputs:s,backend:o})=>{const{a:l,b:c}=s,h=o;if(r&&l.dtype==="complex64"){const v=h.texData.get(l.dataId),x=h.texData.get(c.dataId),[b,w]=[[v.complexTensorInfos.real,x.complexTensorInfos.real],[v.complexTensorInfos.imag,x.complexTensorInfos.imag]].map(T=>{const[$,A]=T,E={dataId:$.dataId,dtype:$.dtype,shape:l.shape},O={dataId:A.dataId,dtype:A.dtype,shape:c.shape},N=new Pl(e,l.shape,c.shape);return h.runWebGLProgram(N,[E,O],Xr($.dtype,A.dtype))}),C=Ro({inputs:{real:b,imag:w},backend:h});return h.disposeIntermediateTensorInfo(b),h.disposeIntermediateTensorInfo(w),C}const d=a||Xr(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||h.shouldExecuteOnCPU([l,c]))&&i!=null){const v=h.texData.get(l.dataId).values,x=h.texData.get(c.dataId).values,b=l.dtype==="string"?Ss(v):v,w=l.dtype==="string"?Ss(x):x,[C,T]=i(l.shape,c.shape,b,w,d),$=h.makeTensorInfo(T,d),A=h.texData.get($.dataId);return A.values=C,$}const p=ct().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let g;return p?g=new of(t,l.shape,c.shape,n):g=new Pl(e,l.shape,c.shape),h.runWebGLProgram(g,[l,c],d)}}function Nd(e,t=!1){if(e==="linear")return t?iEt:Jkt;if(e==="relu")return t?sEt:eEt;if(e==="elu")return t?aEt:tEt;if(e==="relu6")return t?oEt:nEt;if(e==="prelu")return t?Z5:Y5;if(e==="leakyrelu")return t?K5:X5;if(e==="sigmoid")return t?lEt:rEt;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q5{constructor(t,n,r,i=!1,a=!1,s=!1,o=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=hr(this.outputShape.length);const h=i?t[1]:t[2],d=Math.ceil(h/2),p=i?"i * 2, rc.y":"rc.y, i * 2",g=a?"rc.z, i * 2":"i * 2, rc.z",v=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],x=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let b="",w="";o&&(l?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:b=`vec4 activation(vec4 x) {
          ${o}
        }`,w="result = activation(result);");const C=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let T="rc.x",$="rc.x";t[0]<n[0]?T=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&($=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${b}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${T};
        int batchB = ${$};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${v[0]} * ${x[0]});
          result += (${v[1]} * ${x[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${C}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p4={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class m4{constructor(t,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Jt(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g4="return a * b;";function nO(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,a=Xr(r.dtype,i.dtype);if(r.dtype==="complex64"){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),c=new m4(p4.REAL,r.shape,i.shape),h=new m4(p4.IMAG,r.shape,i.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],p=n.runWebGLProgram(c,d,"float32"),g=n.runWebGLProgram(h,d,"float32"),v=Ro({inputs:{real:p,imag:g},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),v}if(n.shouldExecuteOnCPU([r,i])){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),[c,h]=Skt(r.shape,i.shape,o.values,l.values,a),d=n.makeTensorInfo(h,a),p=n.texData.get(d.dataId);return p.values=c,d}let s;return ct().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new of(g4,r.shape,i.shape):s=new Pl(g4,r.shape,i.shape),n.runWebGLProgram(s,[r,i],a)}const TEt={kernelName:wp,backendName:"webgl",kernelFunc:nO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Et(e,t,n){const r=[Pc(e.shape),...Fc(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},a=[Pc(t),...Fc(t)],s=new H5(a,r),o=!0,l=[r],c=n.runWebGLProgram(s,[i],e.dtype,l,o);return{dataId:c.dataId,shape:t,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Et(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:a}=r,s=n,o=pt(i.shape),l=UV(a,o),c=pt(l);j(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const h=s.texData.get(i.dataId);return h.isPacked&&!Cv(i.shape,l)&&!(h.texture!==null&&Cv(h.shape,l))?$Et(i,l,s):(s.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}const AEt={kernelName:Xb,backendName:"webgl",kernelFunc:Et};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y4{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:a,outSize:s}=t;this.outputShape=[i,s];const o=Math.floor(r/4)*4,l=r%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${kc(d)?d.toPrecision(2):d}, ones);`}let h="";a%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kEt{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:a,outSize:s}=t;this.outputShape=[i,s];let o="0.0",l="";n==="prod"?o="1.0":n==="min"?(o="1.0 / 1e-20",l="min"):n==="max"&&(o="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const h=Math.floor(r/4)*4,d=r%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";n==="all"?(o="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):n==="any"&&(o="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let v="";a%r>0&&(v=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${v}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${d===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EEt(e){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:e[1],r=g0(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function Kl(e,t,n,r){const i=EEt(e.shape);let a=e;for(let s=0;s<i.length;s++){const{inSize:o,windowSize:l,outSize:c}=i[s];let h,d;n==="mean"?h=s===0?new y4({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},o):new y4({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c}):h=new kEt({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},n),d=a,a=r.runWebGLProgram(h,[a],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IEt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let s=0;s<r.length;s++)r[s]=t[n[s]];this.outputShape=r,this.rank=r.length;const i=Re(this.rank),a=OEt(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function OEt(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NEt{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let h=0;h<r.length;h++)r[h]=t[n[h]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=Re(this.rank),a=q5("rc",this.rank),s=new Array(this.rank);for(let h=0;h<n.length;h++)s[n[h]]=a[h];const o=`vec2(${s.slice(-2).join()})`,l=`++${a[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${s.join()}), ${o})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0(e,t,n){const r=ct().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new NEt(e.shape,t):new IEt(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Et(e,t,n,r){const i=t,a=e.shape.length,s=re(i,e.shape);let o=s;const l=en(o,a),c=l!=null;let h=e;c&&(h=R0(e,l,r),o=fn(o.length,a)),Jn("sum",o,a);const[d,p]=Vn(h.shape,o);let g=d;n&&(g=bn(d,s));const v=pt(p),b=pt(e.shape)/v,w=Et({inputs:{x:h},attrs:{shape:[b,v]},backend:r}),C=yE(e.dtype),T=Kl(w,C,"sum",r),$=Et({inputs:{x:T},attrs:{shape:g},backend:r});return r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(T),c&&r.disposeIntermediateTensorInfo(h),$}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D0(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;return _Et(i,a,s,n)}const REt={kernelName:t0,backendName:"webgl",kernelFunc:D0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tr(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:a}=r,s=n,o=i.shape.length,l=new Array(o);for(let h=0;h<l.length;h++)l[h]=i.shape[a[h]];let c;if(s.shouldExecuteOnCPU([i])){const d=s.texData.get(i.dataId).values,p=tO(d,i.shape,i.dtype,a,l);c=s.makeTensorInfo(l,i.dtype);const g=s.texData.get(c.dataId);g.values=p}else c=R0(i,a,s);return c}const DEt={kernelName:tc,backendName:"webgl",kernelFunc:Tr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J5=1e3;function Tv({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){const c=e.shape.length,h=t.shape.length,d=n?e.shape[c-2]:e.shape[c-1],p=r?t.shape[h-1]:t.shape[h-2],g=n?e.shape[c-1]:e.shape[c-2],v=r?t.shape[h-2]:t.shape[h-1],x=e.shape.slice(0,-2),b=t.shape.slice(0,-2),w=pt(x),C=pt(b),$=Jt(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([g,v]);j(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);const A=n?[w,d,g]:[w,g,d],E=r?[C,v,p]:[C,p,v],O=Et({inputs:{x:e},backend:i,attrs:{shape:A}}),N=Et({inputs:{x:t},backend:i,attrs:{shape:E}}),_=[O,N],R=Math.max(w,C),I=n?O.shape[1]:O.shape[2],P=a!=null,B=s!=null,V=l==="leakyrelu",z=l!=null?Nd(l,!0):null,M=P||B||V||z!=null;let U;if((g===1||v===1)&&I>J5&&M===!1){let q=O,F=N;n&&(q=Tr({inputs:{x:O},backend:i,attrs:{perm:[0,2,1]}}),_.push(q)),r&&(F=Tr({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),_.push(F));const G=v!==1,H=v===1;let Y=q;G&&(Y=Et({inputs:{x:q},backend:i,attrs:{shape:[R,I,1]}}),_.push(Y));const ot=v===1?2:1;let ht=F;H&&(ht=Et({inputs:{x:F},backend:i,attrs:{shape:[R,1,I]}}),_.push(ht));const yt=nO({inputs:{a:Y,b:ht},backend:i});U=D0({inputs:{x:yt},backend:i,attrs:{axis:ot,keepDims:!0}}),_.push(yt)}else{const q=Xr(e.dtype,t.dtype),F=new Q5(A,E,[R,g,v],n,r,P,z,B,V),G=[O,N];if(a!=null&&G.push(a),B&&G.push(s),V){const H=i.makeTensorInfo([],"float32",$o(o,"float32"));G.push(H),_.push(H)}U=i.runWebGLProgram(F,G,q)}const W=Et({inputs:{x:U},backend:i,attrs:{shape:$}});_.push(U);for(const q of _)i.disposeIntermediateTensorInfo(q);return W}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MEt(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:s,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:d}=r;return Tv({a:i,b:a,transposeA:l,transposeB:c,backend:n,bias:s,preluActivationWeights:o,leakyreluAlpha:d,activation:h})}const PEt={kernelName:ev,backendName:"webgl",kernelFunc:MEt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v4="return abs(x);";function FEt(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const a=n.texData.get(r.dataId),s=W5(a.values);return n.makeTensorInfo(r.shape,r.dtype,s)}let i;return ct().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new ao(r.shape,v4):i=new Ta(r.shape,v4),n.runWebGLProgram(i,[r],r.dtype)}const LEt={kernelName:sb,backendName:"webgl",kernelFunc:FEt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BEt=Vi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,zEt=ye({opSnippet:BEt}),jEt={kernelName:qd,backendName:"webgl",kernelFunc:zEt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UEt=Vi+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,VEt=ye({opSnippet:UEt}),WEt={kernelName:Hd,backendName:"webgl",kernelFunc:VEt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b4="return a + b;",GEt=tr({opSnippet:b4,packedOpSnippet:b4,supportsComplex:!0,cpuKernelImpl:ekt}),qEt={kernelName:Xc,backendName:"webgl",kernelFunc:GEt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HEt{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((a,s)=>`T${s}`);const r=[];this.variableNames.forEach(a=>{r.push(`float v${a} = get${a}AtOutCoords();`)});const i=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XEt{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((a,s)=>`T${s}`);const r=[];this.variableNames.forEach(a=>{r.push(`vec4 v${a} = get${a}AtOutCoords();`)});const i=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ry(e){const{inputs:t,backend:n}=e,r=t;if(r.length===1)return Yr({inputs:{x:r[0]},backend:n});if(r.length>ct().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),c=ry({inputs:r.slice(0,l),backend:n}),h=ry({inputs:r.slice(l),backend:n});return ry({inputs:[c,h],backend:n})}const i=r.map(l=>l.dtype).reduce((l,c)=>Xr(l,c)),a=r.map(l=>l.shape),o=ct().getBool("WEBGL_PACK")?new XEt(r[0].shape,a):new HEt(r[0].shape,a);return n.runWebGLProgram(o,r,i)}const KEt={kernelName:ob,backendName:"webgl",kernelFunc:ry};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YEt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=re(a,i.shape);let c=l;const h=en(c,o);let d=i;h!=null&&(d=Tr({inputs:{x:i},backend:n,attrs:{perm:h}}),c=fn(c.length,o)),Jn("all",c,o);const[p,g]=Vn(d.shape,c),v=pt(g),x=Et({inputs:{x:d},backend:n,attrs:{shape:[-1,v]}}),b=Kl(x,x.dtype,"all",n);let w;if(s){const C=bn(p,l);w=Et({inputs:{x:b},backend:n,attrs:{shape:C}})}else w=Et({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),h!=null&&n.disposeIntermediateTensorInfo(d),w}const ZEt={kernelName:Nk,backendName:"webgl",kernelFunc:YEt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QEt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=re(a,i.shape);let c=l;const h=en(c,o);let d=i;h!=null&&(d=Tr({inputs:{x:i},backend:n,attrs:{perm:h}}),c=fn(c.length,o)),Jn("any",c,o);const[p,g]=Vn(d.shape,c),v=pt(g),x=Et({inputs:{x:d},backend:n,attrs:{shape:[-1,v]}}),b=Kl(x,x.dtype,"any",n);let w;if(s){const C=bn(p,l);w=Et({inputs:{x:b},backend:n,attrs:{shape:C}})}else w=Et({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),h!=null&&n.disposeIntermediateTensorInfo(d),w}const JEt={kernelName:_k,backendName:"webgl",kernelFunc:QEt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tIt{constructor(t,n,r){this.variableNames=["A"];const{windowSize:i,batchSize:a,outSize:s}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];const o=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eIt{constructor(t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,j(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const a=t[t.length-1],s=Math.ceil(a/n);this.outputShape=t.slice(0,-1),s>1&&this.outputShape.push(s),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,c=Re(l),h=Sr("coords",l);let d,p;if(s===1){p=l+1;const N=Re(p);d=`
        ${N} sourceLocR = ${N}(${h.join()}, 0);
        ++${h[l-1]};
        ${N} sourceLocG = ${N}(${h.join()}, 0);
        ++${h[l-2]};
        ${N} sourceLocA = ${N}(${h.join()}, 0);
        --${h[l-1]};
        ${N} sourceLocB = ${N}(${h.join()}, 0);
        --${h[l-2]};`}else p=l,d=`
        ${c} sourceLocR = coords;
        ++${h[l-1]};
        ${c} sourceLocG = coords;
        ++${h[l-2]};
        ${c} sourceLocA = coords;
        --${h[l-1]};
        ${c} sourceLocB = coords;
        --${h[l-2]};`;const g=["x","y","z","w","u","v"].slice(0,p),v="."+g[p-1],x=g.map(N=>"int "+N),b=Sr("sourceLocR",p-1).concat("inIdx.r"),w=Sr("sourceLocG",p-1).concat("inIdx.g"),C=Sr("sourceLocB",p-1).concat("inIdx.b"),T=Sr("sourceLocA",p-1).concat("inIdx.a"),$=r==="max"?"greaterThan":"lessThan",A=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${C.join()}),
                             getBestIndicesAChannel(${T.join()})));`,E=`vec4(
            getAChannel(${b.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${C.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${T.join()}) : 0.)`,O=i?"":`
      float getBestIndicesAChannel(${x.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${x.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${O}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${h[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${h[l-2]} < ${o[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${v}, sourceLocG${v},
          sourceLocB${v}, sourceLocA${v}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${E};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${A}
          vec4 candidate = ${E};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${$}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(e,t,n,r=null){let i=t.shape[0],a=t.shape[1];r!=null&&(i=r.shape[0],a=r.shape[1]);const s=g0(a),o={windowSize:s,inSize:a,batchSize:i,outSize:Math.ceil(a/s)},l=new tIt(o,n,r==null),c=[t];r!=null&&c.push(r);const h=e.runWebGLProgram(l,c,"int32");if(h.shape[1]===1)return h;const d=t8(e,t,n,h);return e.disposeIntermediateTensorInfo(h),d}function e8(e,t,n,r=null){const i=r!=null?r.shape:t.shape,a=i[i.length-1],s=g0(a),o=new eIt(i,s,n,r==null),l=r==null?[t]:[t,r],c=e.runWebGLProgram(o,l,"int32");if(c.shape.length===t.shape.length){const h=e8(e,t,n,c);return e.disposeIntermediateTensorInfo(c),h}return c}function n8(e,t,n,r){const i=[n];if(Jn("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!ct().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const a=[],s=e.texData.get(t.dataId),o=s!==null&&s.isPacked;let l=t;o&&(l=e.unpackTensor(t),a.push(l));const[c,h]=Vn(l.shape,i),d=pt(h),p=Et({inputs:{x:l},backend:e,attrs:{shape:[-1,d]}});a.push(p);const g=t8(e,p,r);a.push(g);const v=Et({inputs:{x:g},backend:e,attrs:{shape:c}});return a.forEach(x=>e.disposeIntermediateTensorInfo(x)),v}return e8(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;let s=re(a,i.shape);const o=en(s,i.shape.length);let l=i;const c=[];o!=null&&(l=Tr({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),s=fn(s.length,l.shape.length)),Jn("argMax",[s[0]],l.shape.length);const h=n8(n,l,s[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),h}const rIt={kernelName:lb,backendName:"webgl",kernelFunc:nIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;let s=re(a,i.shape);const o=en(s,i.shape.length);let l=i;const c=[];o!=null&&(l=Tr({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),s=fn(s.length,l.shape.length)),Jn("argMin",[s[0]],l.shape.length);const h=n8(n,l,s[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),h}const aIt={kernelName:ub,backendName:"webgl",kernelFunc:iIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sIt=Vi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,oIt=ye({opSnippet:sIt}),lIt={kernelName:Xd,backendName:"webgl",kernelFunc:oIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uIt=Vi+"return log(x + sqrt(x * x + 1.0));",cIt=ye({opSnippet:uIt}),fIt={kernelName:Kd,backendName:"webgl",kernelFunc:cIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hIt=Vi+`
  return atan(x);
`,dIt=ye({opSnippet:hIt}),pIt={kernelName:Yd,backendName:"webgl",kernelFunc:dIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mIt=eO+`
  return atan(a, b);
`,gIt=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,yIt=tr({opSnippet:mIt,packedOpSnippet:gIt}),vIt={kernelName:Qd,backendName:"webgl",kernelFunc:yIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bIt=Vi+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,xIt=ye({opSnippet:bIt}),wIt={kernelName:Zd,backendName:"webgl",kernelFunc:xIt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _d{constructor(t,n,r,i=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,g=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;const x=n==="avg",b=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,w=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let C="0.0";if(x||(C="-1.0 / 1e-20"),r){const N=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${g}, ${v});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${N} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?a?b:w:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const T="max";let $=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&($="avgValue / max(count, 1.0)");const A=Math.floor(s/4)*4,E=s%4,O=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${T}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${g}, ${v});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${A}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${O}
          }

          int xC = xCCorner + ${A};
          if (${E===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${O}
          } else if (${E===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${O}
          } else if (${E===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${O}
          }
        }
        setOutput(${$});
      }
    `}}class rO{constructor(t,n,r,i=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideDepth,l=t.strideHeight,c=t.strideWidth,h=t.dilationDepth,d=t.dilationHeight,p=t.dilationWidth,g=t.effectiveFilterDepth,v=t.effectiveFilterHeight,x=t.effectiveFilterWidth,b=t.padInfo.front,w=t.padInfo.top,C=t.padInfo.left;this.outputShape=t.outShape;const T=n==="avg";let $="0.0";if(T||($="-1.0 / 1e-20"),r){const R=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${c});
        const ivec3 pads = ivec3(${b}, ${w}, ${C});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${v};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${x};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${R} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?a?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${v} * ${x} +
                      wR * ${x} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const A="max";let E=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(E="avgValue / max(count, 1.0)");const O=Math.floor(s/4)*4,N=s%4,_=`
      if (${T}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${A}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${c});
      const ivec3 pads = ivec3(${b}, ${w}, ${C});
      const float initializationValue = ${$};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${$});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${v};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${O}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${_}
            }

            int xC = xCCorner + ${O};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${_}
            }
          }
        }
        setOutput(${E});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;om(i,"avgPool");const{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,c=1;j(cr(s,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const h=ji(i.shape,a,s,c,o,l);if(h.filterWidth===1&&h.filterHeight===1&&we(h.inShape,h.outShape))return Yr({inputs:{x:i},backend:n});const d=new _d(h,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}const CIt={kernelName:cb,backendName:"webgl",kernelFunc:SIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:c}=r,h=[1,1,1],d=ks(i.shape,a,s,h,o,l,c),p=new rO(d,"avg",!1);return n.runWebGLProgram(p,[i],"float32")}const $It={kernelName:fb,backendName:"webgl",kernelFunc:TIt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AIt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,a=t.strideWidth,s=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,h=l-1-t.padInfo.top,d=c-1-t.padInfo.left,p=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class kIt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,a=t.strideDepth,s=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,g=t.effectiveFilterWidth,v=d-1-t.padInfo.front,x=p-1-t.padInfo.top,b=g-1-t.padInfo.left,w=1/(n*r*i);this.userCode=`
      const ivec3 pads = ivec3(${v}, ${x}, ${b});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:h}=r,d=[1,1,1],p=ks(s.shape,o,l,d,c,h),g=new kIt(p);return n.runWebGLProgram(g,[i],s.dtype)}const IIt={kernelName:Dk,backendName:"webgl",kernelFunc:EIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OIt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a;om([i,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=r,h=ji(s.shape,o,l,1,c),d=new AIt(h);return n.runWebGLProgram(d,[i],s.dtype)}const NIt={kernelName:Rk,backendName:"webgl",kernelFunc:OIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _It(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:s,transposeB:o}=r;return Tv({a:i,b:a,transposeA:s,transposeB:o,backend:n})}const RIt={kernelName:hb,backendName:"webgl",kernelFunc:_It};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DIt{constructor(t,n,r,i,a,s){this.outputShape=[],this.variableNames=["x","mean","variance"],Jt(t,n),Jt(t,r);let o="0.0";i!=null&&(Jt(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";a!=null&&(Jt(t,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${s}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MIt{constructor(t,n,r,i,a,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Jt(t,n),Jt(t,r);let o="vec4(0.0)";i!=null&&(Jt(t,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";a!=null&&(Jt(t,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${s}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIt=({inputs:e,backend:t,attrs:n})=>{const{x:r,mean:i,variance:a,offset:s,scale:o}=e;j(i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(s==null||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[r,i,a];let h=null;s!=null&&(h=s.shape,c.push(s));let d=null;o!=null&&(d=o.shape,c.push(o));const p=ct().getBool("WEBGL_PACK_NORMALIZATION")?new MIt(r.shape,i.shape,a.shape,h,d,l):new DIt(r.shape,i.shape,a.shape,h,d,l);return t.runWebGLProgram(p,c,c[0].dtype)},FIt={kernelName:Tb,backendName:"webgl",kernelFunc:PIt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LIt{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=Re(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=BIt(this.rank);let i;const a=t.map((s,o)=>`sourceLoc.${yA[o]} = start[${o}] + coords.${yA[o]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}}const yA=["x","y","z","w","u","v"];function BIt(e){if(e===1)return"sourceLoc";if(e<=6)return yA.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zIt{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Re(this.rank),r=Sr("coords",this.rank),i=Sr("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,s=`getChannel(getSource(${i.join()}), ${a})`,o=`
      result.x = ${s};
      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${s};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${s};
        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${s};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((h,d)=>`start[${d}]`).join()});`:t.map((h,d)=>`${i[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jIt(e,t,n,r){const i=r.texData.get(e.dataId),a=r.makeTensorInfo(n,e.dtype),s=r.texData.get(a.dataId);Object.assign(s,i),s.refCount=1,s.shape=n,s.dtype=e.dtype;let o=QE(t,Bt(e.shape));i.slice&&(o+=i.slice.flatOffset),s.slice={flatOffset:o,origDataId:i.slice&&i.slice.origDataId||e.dataId};const l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),a}function uf(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,size:s}=r,[o,l]=m0(i,a,s);if(KE(i,o,l),pt(l)===0)return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){const d=n.texData.get(i.dataId),p=Rkt(d.values,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,p)}const{isPacked:c}=n.texData.get(i.dataId),h=ZE(i.shape,o,l);if(c||!h){const d=ct().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zIt(l):new LIt(l),p=[o];return n.runWebGLProgram(d,[i],i.dtype,p)}return n.uploadToGPU(i.dataId),jIt(i,o,l,n)}const UIt={kernelName:Jb,backendName:"webgl",kernelFunc:uf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VIt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:s}=r;j(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((C,T)=>C*T),l=Xp(i.shape,a,o),c=Kp(l.length,a.length),h=Yp(i.shape,a,o),d=rI(s,a.length),p=iI(h,s,a.length),g=[],v=Et({inputs:{x:i},backend:n,attrs:{shape:l}}),x=Tr({inputs:{x:v},backend:n,attrs:{perm:c}}),b=Et({inputs:{x},backend:n,attrs:{shape:h}}),w=uf({inputs:{x:b},backend:n,attrs:{begin:d,size:p}});return g.push(v),g.push(x),g.push(b),g.forEach(C=>n.disposeIntermediateTensorInfo(C)),w},WIt={kernelName:db,backendName:"webgl",kernelFunc:VIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s}=r,o=n.readSync(i.dataId),l=n.readSync(a.dataId),c=V5(o,l,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,c)}const qIt={kernelName:Mk,backendName:"webgl",kernelFunc:GIt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HIt=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,XIt=`
  return float(int(a.r) & int(b.r));
`;function KIt(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,a=ct().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=ct().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||s===1){const l=n.texData.get(r.dataId).values,c=n.texData.get(i.dataId).values,[h,d]=rkt(r.shape,i.shape,l,c,r.dtype),p=n.makeTensorInfo(d,r.dtype),g=n.texData.get(p.dataId);return g.values=h,p}let o;return a?o=new of(HIt,r.shape,i.shape,!1):o=new Pl(XIt,r.shape,i.shape),n.runWebGLProgram(o,[r,i],r.dtype)}const YIt={kernelName:Pk,backendName:"webgl",kernelFunc:KIt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIt(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.readSync(r.dataId),s=n.readSync(i.dataId),o=Jt(Array.from(a),Array.from(s));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const QIt={kernelName:XV,backendName:"webgl",kernelFunc:ZIt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JIt="return float(a != b);",r8=tr({opSnippet:JIt,cpuKernelImpl:Tkt,dtype:"bool"}),tOt={kernelName:jb,backendName:"webgl",kernelFunc:r8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function um(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return Yr({inputs:{x:i.complexTensorInfos.real},backend:n})}const eOt={kernelName:oE,backendName:"webgl",kernelFunc:um};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nOt="return float(int(x));";function rOt(e,t){const n=new Ta(e.shape,nOt),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vA(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:a}=r;if(a==="complex64"){if(i.dtype==="complex64")return Yr({inputs:{x:i},backend:n});const s=Bn(i.shape),o=vA({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),l=Ro({inputs:{real:o,imag:s},backend:n});return s.dispose(),n.disposeIntermediateTensorInfo(o),l}if(i.dtype==="complex64"){const s=um({inputs:{input:i},backend:n}),o=vA({inputs:{x:s},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(s),o}if(!VV(i.dtype,a)){const s=Yr({inputs:{x:i},backend:n});return{dataId:s.dataId,shape:s.shape,dtype:a}}if(n.shouldExecuteOnCPU([i])){const s=n.texData.get(i.dataId).values,[o,l,c]=ikt(s,i.shape,i.dtype,a);return n.makeTensorInfo(o,l,c)}if(a==="int32")return rOt(i,n);if(a==="bool"){const s=n.makeTensorInfo([],"bool",lr("bool",1)),l=r8({inputs:{a:i,b:s},backend:n});return n.disposeIntermediateTensorInfo(s),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${a}`)}const iOt={kernelName:Jd,backendName:"webgl",kernelFunc:vA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x4="return ceil(x);",aOt=ye({opSnippet:x4,packedOpSnippet:x4,cpuKernelImpl:akt}),sOt={kernelName:tp,backendName:"webgl",kernelFunc:aOt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oOt{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lOt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:a,clipValueMax:s}=r;let o;ct().getBool("WEBGL_PACK_CLIP")?o=new lOt(i.shape):o=new oOt(i.shape);const l=[[a],[s]];return n.runWebGLProgram(o,[i],i.dtype,l)}const cOt={kernelName:ep,backendName:"webgl",kernelFunc:uOt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fOt{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w4(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function hOt(e){const{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),a=new fOt(r.shape),s=[w4(r,i.complexTensorInfos.real),w4(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,s,s[0].dtype)}const dOt={kernelName:pb,backendName:"webgl",kernelFunc:hOt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pOt{constructor(t){this.outputShape=[],this.outputShape=Ia(t,1),this.variableNames=t.map((s,o)=>`T${o}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let s=1;s<n.length;s++)n[s]=n[s-1]+t[s][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<n.length;s++){const o=n[s-1];r.push(`else if (yC < ${n[s]}) setOutput(getT${s}(yR, yC-${o}));`)}const i=n.length,a=n[n.length-1];r.push(`else setOutput(getT${i}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mOt{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ia(t,n);const r=this.outputShape,i=r.length,a=Re(i),s=Sr("coords",i),o=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((x,b)=>`T${b}`);const l=new Array(t.length-1);l[0]=t[0][n];for(let x=1;x<l.length;x++)l[x]=l[x-1]+t[x][n];const c=o[n],h=o.slice(-2),d=o.join();let p=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${h.join()}));
        }`;for(let x=1;x<l.length;x++){const b=l[x-1];p+=`
        if (${c} < ${l[x]}  && ${c} >= ${l[x-1]}) {
          return getChannel(
            getT${x}(${Xg(o,c,b)}),
            vec2(${Xg(h,c,b)}));
        }`}const g=l.length,v=l[l.length-1];p+=`
        return getChannel(
          getT${g}(${Xg(o,c,v)}),
          vec2(${Xg(h,c,v)}));`,this.userCode=`
      float getValue(${o.map(x=>"int "+x)}) {
        ${p}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${s}), 0., 0., 0.);

        ${s[i-1]} = ${s[i-1]} + 1;
        if (${s[i-1]} < ${r[i-1]}) {
          result.g = getValue(${s});
        }

        ${s[i-2]} = ${s[i-2]} + 1;
        if (${s[i-2]} < ${r[i-2]}) {
          result.a = getValue(${s});
        }

        ${s[i-1]} = ${s[i-1]} - 1;
        if (${s[i-2]} < ${r[i-2]} &&
            ${s[i-1]} < ${r[i-1]}) {
          result.b = getValue(${s});
        }
        setOutput(result);
      }
    `}}function Xg(e,t,n){const r=e.indexOf(t);return e.map((a,s)=>s===r?`${a} - ${n}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return Yr({inputs:{x:i.complexTensorInfos.imag},backend:n})}const gOt={kernelName:Jk,backendName:"webgl",kernelFunc:M0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nh(e,t,n){const r=e[0].dtype;if(r==="complex64"){const g=e.map(C=>um({inputs:{input:C},backend:n})),v=e.map(C=>M0({inputs:{input:C},backend:n})),x=Nh(g,t,n),b=Nh(v,t,n),w=Ro({inputs:{real:x,imag:b},backend:n});return g.forEach(C=>n.disposeIntermediateTensorInfo(C)),v.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),w}let i=n.shouldExecuteOnCPU(e);if(r==="string"&&(i=!0),i){const g=e.map($=>{const E=[-1,pt($.shape.slice(t))];return Et({inputs:{x:$},backend:n,attrs:{shape:E}})}),v=g.map($=>({vals:n.readSync($.dataId),shape:$.shape})),x=Ia(g.map($=>$.shape),1),b=g[0].shape[0]===1,w=skt(v,x,r,b),C=Ia(e.map($=>$.shape),t),T=n.makeTensorInfo(C,r,w);return g.forEach($=>n.disposeIntermediateTensorInfo($)),T}const a=e.filter(g=>pt(g.shape)>0),s=ct().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const g=s?new Ta(e[0].shape,to):new ao(e[0].shape,to);return n.runWebGLProgram(g,e,r)}const o=ct().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>o){const g=[];for(let x=0;x<a.length;x+=o){const b=a.slice(x,x+o);g.push(Nh(b,t,n))}const v=Nh(g,t,n);for(const x of g)n.disposeIntermediateTensorInfo(x);return v}if(s){const g=new mOt(a.map(v=>v.shape),t);return n.runWebGLProgram(g,a,r)}const{tensors2D:l,outShape:c}=yOt(a,t,n),h=new pOt(l.map(g=>g.shape)),d=n.runWebGLProgram(h,l,r);l.forEach(g=>n.disposeIntermediateTensorInfo(g));const p=Et({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),p}function yOt(e,t,n){const r=Ia(e.map(a=>a.shape),t);return{tensors2D:e.map(a=>Et({inputs:{x:a},attrs:{shape:[-1,pt(a.shape.slice(t))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i8(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,a=re(i,t[0].shape)[0],s=t.map(c=>c.shape);tI(s,a);const o=Ia(t.map(c=>c.shape),a);if(pt(o)===0)return n.makeTensorInfo(o,t[0].dtype,[]);const l=t.filter(c=>pt(c.shape)>0);return l.length===1?Yr({inputs:{x:l[0]},backend:n}):Nh(l,a,n)}const vOt={kernelName:mb,backendName:"webgl",kernelFunc:i8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a8{constructor(t,n=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const s=t.padInfo.top,o=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,g=t.filterWidth,v=Math.floor(t.inChannels/4)*4,x=t.inChannels%4,b=t.dataFormat==="channelsLast",w=b?1:2,C=b?2:3,T=b?3:1;let $="",A="";r&&(i?$=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?$=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:$=`
          float activation(float x) {
            ${r}
          }
        `,A="result = activation(result);");const E=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${$}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${T}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${C}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${v}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${b}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${x===1}) {

              if (${b}) {
                dotProd +=
                    getX(batch, xR, xC, ${v}) *
                    getW(wR, wC, ${v}, d2);
              } else {
                dotProd +=
                    getX(batch, ${v}, xR, xC) *
                    getW(wR, wC, ${v}, d2);
              }

            } else if (${x===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${v}, d2),
                getW(wR, wC, ${v} + 1, d2)
              );

              if (${b}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${v}),
                  getX(batch, xR, xC, ${v} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${v}, xR, xC),
                  getX(batch, ${v} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${x===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${v}, d2),
                getW(wR, wC, ${v} + 1, d2),
                getW(wR, wC, ${v} + 2, d2)
              );

              if (${b}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${v}),
                  getX(batch, xR, xC, ${v} + 1),
                  getX(batch, xR, xC, ${v} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${v}, xR, xC),
                  getX(batch, ${v} + 1, xR, xC),
                  getX(batch, ${v} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${E}
        ${A}
        setOutput(result);
      }
    `}}class bOt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,a=t.strideDepth,s=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,d=t.filterDepth,p=t.filterHeight,g=t.filterWidth,v=Math.floor(t.inChannels/4)*4,x=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${s}, ${o});
      const ivec3 pads = ivec3(${n}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${v}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${x===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${v}) *
                  getW(wF, wR, wC, ${v}, d2);
              } else if (${x===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${v}),
                  getX(batch, xF, xR, xC, ${v} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${v}, d2),
                  getW(wF, wR, wC, ${v} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${x===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${v}),
                  getX(batch, xF, xR, xC, ${v} + 1),
                  getX(batch, xF, xR, xC, ${v} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${v}, d2),
                  getW(wF, wR, wC, ${v} + 1, d2),
                  getW(wF, wR, wC, ${v} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s8{constructor(t,n=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=hr(this.outputShape.length);const s=t.padInfo.left,o=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,h=t.filterWidth,d=h;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<h;b++)p+=`
           vec4 xTexelC${b*2};
           int xTexelC${b*2}Ready;
           vec4 xTexelC${b*2+1};
           int xTexelC${b*2+1}Ready;
           vec4 xC${b};`;p+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let b=0;b<h;b++)p+=`
           xTexelC${b*2} = vec4(0.0);
           xTexelC${b*2}Ready = 0;
           xTexelC${b*2+1} = vec4(0.0);
           xTexelC${b*2+1}Ready = 0;
           xC${b} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let b=0;b<(d+1)/2;b++){const w=b*2;if(p+=`
           xC = xCCorner + ${w*l};
           `,o===1){if(w<h&&(s%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,l===1&&w>0?p+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<h)){const C=s%2===0?Ak(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${C};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:p+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):C===1?p+=`
                     xC${w+1} = xTexelC${w};
                     `:p+=`
                     xCOffset = xC + ${C};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<h&&(s%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<h&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<h&&(p+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<h&&(p+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<h&&(p+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let g="",v="";r&&(i?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:a?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:g=`vec4 activation(vec4 x) {
           ${r}
         }`,v="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${x}
         ${v}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xOt{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=hr(this.outputShape.length);const{dataFormat:r}=n,i=$r(),a=r==="channelsLast",s=a?1:2,o=a?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let c="";for(let h=0;h<=1;h++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${h};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${s}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $v(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function o8({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:o=null}){const l=e.shape,c=r.texData.get(e.dataId),h=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,g=n.dataFormat==="channelsLast",v=!1,x=!1;let b;const w=[];if(a!=null){const $=$v(a.shape,g);$!=null&&(a=Et({inputs:{x:a},backend:r,attrs:{shape:$}}),w.push(a))}if(i!=null){const $=$v(i.shape,g);$!=null&&(i=Et({inputs:{x:i},backend:r,attrs:{shape:$}}),w.push(i))}if(!((d===1||p===1)&&h>J5)&&c.isPacked&&g&&c.texture!=null&&l[2]%2!==0&&we(c.shape.slice(-3),l.slice(-3))){const $=l[0]*l[1]*(l[2]+1),A={dataId:e.dataId,shape:[1,$,n.inChannels],dtype:e.dtype},E=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,j(Cv(c.shape,A.shape),()=>`packed reshape ${c.shape} to ${A.shape} isn't free`);const O=Et({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});w.push(O);const N=Tv({a:A,b:O,backend:r,transposeA:v,transposeB:x,bias:i,activation:o,preluActivationWeights:a,leakyreluAlpha:s}),_=r.texData.get(N.dataId);j(_.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=E,_.shape=n.outShape,b=Yr({inputs:{x:N},backend:r}),b.shape=n.outShape,w.push(N)}else{const $=n.outHeight*n.outWidth,A=Et({inputs:{x:e},backend:r,attrs:{shape:g?[n.batchSize,$,n.inChannels]:[n.batchSize,n.inChannels,$]}}),E=Et({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),O=Tv({a:g?A:E,b:g?E:A,transposeA:!g,transposeB:x,backend:r,bias:i,activation:o,preluActivationWeights:a,leakyreluAlpha:s});b=Et({inputs:{x:O},backend:r,attrs:{shape:n.outShape}}),w.push(A),w.push(E),w.push(O)}for(const $ of w)r.disposeIntermediateTensorInfo($);return b}function l8({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:o=null}){const{filterWidth:l,filterHeight:c,inChannels:h,outWidth:d,outHeight:p,dataFormat:g}=n,v=g==="channelsLast",x=l*c*h,b=p*d,w=[n.batchSize,x,b],C=!0,T=!1,$=[];if(a!=null){const W=$v(a.shape,v);W!=null&&(a=Et({inputs:{x:a},backend:r,attrs:{shape:W}}),$.push(a))}if(i!=null){const W=$v(i.shape,v);W!=null&&(i=Et({inputs:{x:i},backend:r,attrs:{shape:W}}),$.push(i))}const A=Et({inputs:{x:t},backend:r,attrs:{shape:[1,x,pt(t.shape)/x]}});$.push(A);const E=new xOt(w,n),O=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],N=r.runWebGLProgram(E,[e],"float32",O),_=Et({inputs:{x:N},backend:r,attrs:{shape:w}});$.push(N),$.push(_);const R=i!=null,I=a!=null,P=o==="leakyrelu",B=o?Nd(o,!0):null,V=new Q5(v?_.shape:A.shape,v?A.shape:_.shape,v?[n.batchSize,b,n.outChannels]:[n.batchSize,n.outChannels,b],C,T,R,B,I,P),z=v?[_,A]:[A,_];if(i&&z.push(i),I&&z.push(a),P){const W=r.makeTensorInfo([],"float32",$o(s,"float32"));z.push(W),$.push(W)}const M=r.runWebGLProgram(V,z,"float32"),U=Et({inputs:{x:M},backend:r,attrs:{shape:n.outShape}});$.push(M);for(const W of $)r.disposeIntermediateTensorInfo(W);return U}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dataFormat:l,dilations:c,dimRoundingMode:h}=r,d=Es(l),p=Qn(i.shape,a.shape,s,c,o,h,!1,d);let g;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))g=o8({x:i,filter:a,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&ct().getBool("WEBGL_EXP_CONV")){const x=new s8(p),b=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];g=n.runWebGLProgram(x,[i,a],"float32",b)}else if(ct().getBool("WEBGL_CONV_IM2COL"))g=l8({x:i,filter:a,convInfo:p,backend:n});else{const x=new a8(p);g=n.runWebGLProgram(x,[i,a],"float32")}const v=Et({inputs:{x:g},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(g),v}const SOt={kernelName:gb,backendName:"webgl",kernelFunc:wOt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class COt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,a=t.padInfo.left,s=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${s?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class TOt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,a=t.strideWidth,s=t.dataFormat==="channelsLast",o=n-1-t.padInfo.top,l=r-1-t.padInfo.left,c=s?1:2,h=s?2:3,d=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${s}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $Ot{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,a=t.padInfo.front,s=t.padInfo.top,o=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${a};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${s};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${o};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class AOt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,a=t.strideDepth,s=t.strideHeight,o=t.strideWidth,l=n-1-t.padInfo.front,c=r-1-t.padInfo.top,h=i-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:h}=r,d=Es(l),p=Qn(i.shape,h,s,1,o,c,!1,d),g=new COt(p);return n.runWebGLProgram(g,[i,a],"float32")}const EOt={kernelName:Lk,backendName:"webgl",kernelFunc:kOt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IOt{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=hr(this.outputShape.length);const n=t.filterHeight,r=t.filterWidth,i=n-1-t.padInfo.top,a=r-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OOt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{inputShape:s,strides:o,pad:l,dataFormat:c,dimRoundingMode:h}=r,d=Es(c),p=Qn(s,a.shape,o,1,l,h,!1,d);if(ct().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const g=[[p.strideHeight,p.strideWidth]],v=new IOt(p);return n.runWebGLProgram(v,[i,a],"float32",g)}else{const g=new TOt(p);return n.runWebGLProgram(g,[i,a],"float32")}}const NOt={kernelName:yb,backendName:"webgl",kernelFunc:OOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ot(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r,c=Ao(i.shape,a.shape,s,l,o),h=new bOt(c);return n.runWebGLProgram(h,[i,a],"float32")}const ROt={kernelName:vb,backendName:"webgl",kernelFunc:_Ot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:o,filterShape:l}=r,c=Ao(i.shape,l,s,1,o),h=new $Ot(c);return n.runWebGLProgram(h,[i,a],"float32")}const MOt={kernelName:Bk,backendName:"webgl",kernelFunc:DOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:s,strides:o,inputShape:l}=r,c=Ao(l,a.shape,o,1,s),h=new AOt(c);return n.runWebGLProgram(h,[i,a],"float32")}const FOt={kernelName:zk,backendName:"webgl",kernelFunc:POt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LOt=lf+`
  return cos(x);
`,BOt=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Xl}
  return result;
`,zOt=ye({opSnippet:LOt,packedOpSnippet:BOt}),jOt={kernelName:np,backendName:"webgl",kernelFunc:zOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UOt=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,VOt=ye({opSnippet:UOt}),WOt={kernelName:rp,backendName:"webgl",kernelFunc:VOt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GOt{constructor(t,n,r,i,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,o,l,c]=t,[h]=n,[d,p]=r;this.outputShape=[h,d,p,c];const g=i==="bilinear"?1:0,[v,x]=[`${o-1}.0`,`${l-1}.0`],[b,w,C]=d>1?[`${(o-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${v} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${v}`],[T,$,A]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${x} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${x}`];this.userCode=`
      const float height_ratio = float(${b});
      const float width_ratio = float(${T});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${s}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${$};

        float in_y = ${C};
        if( in_y < 0.0 || in_y > ${v} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${A};
        if( in_x < 0.0 || in_x > ${x} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qOt=e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:a,boxInd:s}=t,{cropSize:o,method:l,extrapolationValue:c}=r,h=new GOt(i.shape,a.shape,o,l,c);return n.runWebGLProgram(h,[i,a,s],"float32")},HOt={kernelName:Uk,backendName:"webgl",kernelFunc:qOt};var Rd;(function(e){e.Prod="*",e.Sum="+"})(Rd||(Rd={}));class S4{constructor(t,n,r,i){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,s=this.op===Rd.Prod?"1.0":"0.0",o=r?s:`getX(${C4(a,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",h="";r?(c=i?`end != ${l-1}`:"end != 0",h=i?"end + 1":"end - 1"):(c=i?`end + pow2 < ${l}`:"end >= pow2",h=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Re(a)} coords = getOutputCoords();
        int end = ${T4(a,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${h};
          ${T4(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${C4(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function C4(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function T4(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8(e,t,n,r,i,a){const s=t.shape.length,o=en([r],s);let l=t;o!=null&&(l=Tr({inputs:{x:t},backend:n,attrs:{perm:o}}));const c=fn(1,s)[0];if(c!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const h=l.shape[c];let d=Yr({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(h))-1;p++){const g=new S4(e,l.shape,!1,a),v=[[p]],x=d;d=n.runWebGLProgram(g,[d],d.dtype,v),n.disposeIntermediateTensorInfo(x)}if(i){const p=new S4(e,l.shape,i,a),g=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(g)}if(o!=null){const p=ko(o),g=Tr({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),g}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;return u8(Rd.Prod,i,n,a,s,o)}const KOt={kernelName:jk,backendName:"webgl",kernelFunc:XOt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:s,reverse:o}=r;return u8(Rd.Sum,i,n,a,s,o)}const ZOt={kernelName:bb,backendName:"webgl",kernelFunc:YOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QOt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:s,binaryOutput:o}=r;if(i.shape.length===1){const l=n.readSync(i.dataId),c=n.readSync(a.dataId),h=V5(l,c,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,h)}else if(i.shape.length===2){const l=n.bufferSync(i),c=n.bufferSync(a),h=nkt(l,c,s,o);return n.makeTensorInfo(h.shape,a.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const JOt={kernelName:Vk,backendName:"webgl",kernelFunc:QOt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tNt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eNt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:a,dataFormat:s}=r,o=i.shape[0],l=s==="NHWC"?i.shape[1]:i.shape[2],c=s==="NHWC"?i.shape[2]:i.shape[3],h=s==="NHWC"?i.shape[3]:i.shape[1],d=l*a,p=c*a,g=h/(a*a),v=s==="NHWC"?[o,d,p,g]:[o,g,d,p],x=new tNt(v,a,s);return n.runWebGLProgram(x,[i],i.dtype)}const nNt={kernelName:Wk,backendName:"webgl",kernelFunc:eNt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c8{constructor(t,n=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=hr(this.outputShape.length);const s=t.filterHeight,o=t.filterWidth,l=t.outChannels/t.inChannels;let c="",h="";r&&(i?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,h="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${s}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f8{constructor(t,n=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=hr(this.outputShape.length);const s=t.outChannels/t.inChannels,o=t.padInfo.left,l=t.strideWidth,c=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=d;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<d;w++)g+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;g+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let w=0;w<d;w++)g+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(p+1)/2;w++){const C=w*2;if(g+=`
          xC = xCCorner + ${C*c};
          `,l===1){if(C<d&&(o%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }
              `,c===1&&C>0?g+=`
                xC${C} = vec4(xTexelC${C-2}.zw, xTexelC${C}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${C} = vec4(previous.zw, xTexelC${C}.xy);
                  } else {
                    xC${C} = vec4(0.0, 0.0, xTexelC${C}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xC${C} = xTexelC${C};
                `,C+1<d)){const T=o%2===0?Ak(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${T};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                    xTexelC${C+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${C+1}.zw = vec2(0.0);
                    }
                    xTexelC${C+1}Ready = 1;
                  }
                  `,c>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${C+1} = vec4(previous.zw, xTexelC${C+1}.xy);
                    } else {
                     xC${C+1} = vec4(0.0, 0.0, xTexelC${C+1}.xy);
                    }
                    `:g+=`
                    xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.xy);
                    `):T===1?g+=`
                    xC${C+1} = xTexelC${C};
                    `:g+=`
                    xCOffset = xC + ${T};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                      xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${C+1}.zw = vec2(0.0);
                      }
                      xTexelC${C+1}Ready = 1;
                    }

                    xC${C+1} = xTexelC${C+1};
                    `}}else C<d&&(o%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.0);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
              `,C+1<d&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${C+1} = vec4(xTexelC${C+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(
                  xTexelC${C}.xy, xTexelC${C+1}.xy);
              `,C+1<d&&(g+=`
                  xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
                `)));C<d&&(g+=`
            wTexel = getW(r, ${C}, d1, q);
            dotProd += xC${C} * vec4(wTexel.xz, wTexel.xz);
          `,C+1<d&&(g+=`
              wTexel = getW(r, ${C+1}, d1, q);
              dotProd += xC${C+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let v="",x="";r&&(i?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:v=`vec4 activation(vec4 x) {
          ${r}
        }`,x="result = activation(result);");const b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${b}
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rNt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l,dimRoundingMode:c}=r;let h=l;h==null&&(h=[1,1]),j(cr(s,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${h}'`);const d=Qn(i.shape,a.shape,s,h,o,c,!0);let p;ct().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new f8(d):p=new c8(d);const g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[i,a],"float32",g)}const iNt={kernelName:xb,backendName:"webgl",kernelFunc:rNt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aNt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,a=t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${s} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class sNt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,a=t.strideWidth,s=n-1-t.padInfo.top,o=r-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,filterShape:h}=r,d=Qn(i.shape,h,s,o,l,c,!0),p=new aNt(d);return n.runWebGLProgram(p,[i,a],"float32")}const lNt={kernelName:Gk,backendName:"webgl",kernelFunc:oNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uNt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{strides:s,dilations:o,pad:l,dimRoundingMode:c,inputShape:h}=r,d=Qn(h,a.shape,s,o,l,c,!0),p=new sNt(d);return n.runWebGLProgram(p,[i,a],"float32")}const cNt={kernelName:qk,backendName:"webgl",kernelFunc:uNt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fNt{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hNt(e){const{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],a=pt(r.shape),s=Et({inputs:{x:r},backend:n,attrs:{shape:[a]}}),o=new fNt(a),l=n.runWebGLProgram(o,[s],s.dtype),c=Et({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),c}const dNt={kernelName:KV,backendName:"webgl",kernelFunc:hNt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pNt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:r,padInfo:i,strideHeight:a,strideWidth:s,filterHeight:o,filterWidth:l,dilationHeight:c,dilationWidth:h}=t,{top:d,left:p}=i;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${s});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mNt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:o,dilations:l}=r,c=jp(i.shape,a.shape,s,o,"NHWC",l);let h;const d=new pNt(c);h=n.runWebGLProgram(d,[i,a],"float32");const p=Et({inputs:{x:h},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(h),p}const gNt={kernelName:wb,backendName:"webgl",kernelFunc:mNt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yNt(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,a=t,{allDims:s,summedDims:o,idDims:l}=hI(i,a.length);pI(s.length,l,a);const{path:c,steps:h}=mI(o,l),d=h.length;let p=null,g=s.length;const v=[];for(let x=0;x<d;++x){for(const b of h[x]){const{permutationIndices:w,expandDims:C}=dI(g,l[b]);let T;gI(w)?T=a[b]:(T=Tr({inputs:{x:a[b]},backend:n,attrs:{perm:w}}),v.push(T));const $=T.shape.slice();for(let A=0;A<C.length;++A)$.splice(C[A],0,1);we(T.shape,$)||(T=Et({inputs:{x:T},backend:n,attrs:{shape:$}}),v.push(T)),p===null?p=T:(p=nO({inputs:{a:T,b:p},backend:n}),v.push(p))}x<d-1&&(c[x]>=0&&(p=D0({inputs:{x:p},backend:n,attrs:{axis:c[x]-(s.length-g),keepDims:!1}}),v.push(p)),g--)}for(const x of v)x!==p&&n.disposeIntermediateTensorInfo(x);return p}const vNt={kernelName:Hk,backendName:"webgl",kernelFunc:yNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bNt="return (x >= 0.0) ? x : (exp(x) - 1.0);",xNt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,wNt=ye({opSnippet:bNt,packedOpSnippet:xNt}),SNt={kernelName:ap,backendName:"webgl",kernelFunc:wNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CNt="return (b >= 0.0) ? a : a * (b + 1.0);",TNt=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,$Nt=e=>{const{inputs:t,backend:n}=e,{dy:r,y:i}=t,a=ct().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new of(TNt,r.shape,i.shape):new Pl(CNt,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],r.dtype)},ANt={kernelName:Xk,backendName:"webgl",kernelFunc:$Nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kNt=`
  return vec4(equal(a, b));
`,ENt="return float(a == b);",INt=tr({opSnippet:ENt,packedOpSnippet:kNt,dtype:"bool",cpuKernelImpl:okt}),ONt={kernelName:Sb,backendName:"webgl",kernelFunc:INt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NNt=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${aI};
  float a1 = ${sI};
  float a2 = ${oI};
  float a3 = ${lI};
  float a4 = ${uI};
  float a5 = ${cI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,_Nt=ye({opSnippet:NNt}),RNt={kernelName:sp,backendName:"webgl",kernelFunc:_Nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DNt=lf+`
  return exp(x);
`,MNt=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,h8=ye({opSnippet:DNt,packedOpSnippet:MNt,cpuKernelImpl:lkt,dtype:"float32"}),PNt={kernelName:op,backendName:"webgl",kernelFunc:h8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bA(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:a}=t,s=a.shape.length,o=a.shape.slice();let l=i;return i<0&&(j(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),o.splice(l,0,1),Et({inputs:{x:a},backend:r,attrs:{shape:o}})}const FNt={kernelName:Cb,backendName:"webgl",kernelFunc:bA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $4="return exp(x) - 1.0;",LNt=ye({opSnippet:$4,packedOpSnippet:$4,cpuKernelImpl:ukt}),BNt={kernelName:lp,backendName:"webgl",kernelFunc:LNt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A4{constructor(t,n,r){this.variableNames=["real","imag"];const i=n[1];this.outputShape=n;const a=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=r?`${i}.0`:"1.0";let o;if(t==="real")o="return real * expR - imag * expI;";else if(t==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(e,t,n){const r=n.texData.get(e.dataId),i=pt(e.shape),a=e.shape[e.shape.length-1],s=i/a,o=Et({inputs:{x:e},backend:n,attrs:{shape:[s,a]}}),l=o.shape,c=new A4("real",l,t),h=new A4("imag",l,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(c,d,"float32"),g=n.runWebGLProgram(h,d,"float32"),v=Ro({inputs:{real:p,imag:g},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g);const x=Et({inputs:{x:v},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(v),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zNt(e){const{inputs:t,backend:n}=e,{input:r}=t;return d8(r,!1,n)}const jNt={kernelName:Kk,backendName:"webgl",kernelFunc:zNt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UNt{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cm(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:a}=n;if(a=a||qc(i),a==="string"){const s=un(a,pt(r));return s.fill(i),t.makeTensorInfo(r,a,s)}else{const s=new UNt(r,i),o=[[i]];return t.runWebGLProgram(s,[],a,o)}}const VNt={kernelName:Yk,backendName:"webgl",kernelFunc:cm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WNt{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GNt={kernelName:Zk,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,r=t,i=new WNt(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k4="return floor(x);",qNt=ye({opSnippet:k4,packedOpSnippet:k4,cpuKernelImpl:ckt}),HNt={kernelName:up,backendName:"webgl",kernelFunc:qNt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XNt=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,KNt=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,YNt=tr({opSnippet:XNt,packedOpSnippet:KNt,dtype:"int32"}),ZNt={kernelName:cp,backendName:"webgl",kernelFunc:YNt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QNt{constructor(t){this.variableNames=["A"];const n=$r(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JNt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=$r(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_t={kernelName:yft,backendName:"webgl",kernelFunc:e_t};let Uu,v$=ct().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function e_t(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:a}=r,s=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,c]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],h=[c,l],d=[c,l,a];if(o||s){const x=ct().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Uu==null||x!==v$)&&(v$=x,Uu=document.createElement("canvas").getContext("2d",{willReadFrequently:v$})),Uu.canvas.width=l,Uu.canvas.height=c,Uu.drawImage(i,0,0,l,c),i=Uu.canvas}const p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=ci.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),i);const g=ct().getBool("WEBGL_PACK")?new JNt(d):new QNt(d),v=n.runWebGLProgram(g,[p],"int32");return n.disposeData(p.dataId),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:h,dilations:d,dimRoundingMode:p,activation:g,leakyreluAlpha:v}=r,x=Es(h),b=Qn(i.shape,a.shape,l,d,c,p,!1,x);let w;const C=[],T=s!=null,$=o!=null,A=g==="leakyrelu",E=()=>{const N=[i,a],_=(R,I)=>{if(I==="NCHW"&&R.shape.length===1&&R.shape[0]!==1){const P=Et({inputs:{x:R},backend:n,attrs:{shape:[R.shape[0],1,1]}});return C.push(P),P}return R};if(T&&N.push(_(s,h)),$&&N.push(_(o,h)),A){const R=n.makeTensorInfo([],"float32",$o(v,"float32"));N.push(R),C.push(R)}return N};if(b.filterHeight===1&&b.filterWidth===1&&b.dilationHeight===1&&b.dilationWidth===1&&b.strideHeight===1&&b.strideWidth===1&&(b.padInfo.type==="SAME"||b.padInfo.type==="VALID"))w=o8({x:i,filter:a,convInfo:b,backend:n,bias:s,activation:g,preluActivationWeights:o,leakyreluAlpha:v});else if(b.strideWidth<=2&&x==="channelsLast"&&ct().getBool("WEBGL_EXP_CONV")){const N=g?Nd(g,!0):null,_=new s8(b,T,N,$,A),R=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],I=E();w=n.runWebGLProgram(_,I,"float32",R)}else if(ct().getBool("WEBGL_CONV_IM2COL"))w=l8({x:i,filter:a,convInfo:b,backend:n,bias:s,activation:g,preluActivationWeights:o,leakyreluAlpha:v});else{const N=g?Nd(g,!1):null,_=new a8(b,T,N,$,A),R=E();w=n.runWebGLProgram(_,R,"float32")}const O=Et({inputs:{x:w},backend:n,attrs:{shape:b.outShape}});return C.push(w),C.forEach(N=>n.disposeIntermediateTensorInfo(N)),O}const r_t={kernelName:nv,backendName:"webgl",kernelFunc:n_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_t(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:s,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:h,dimRoundingMode:d,activation:p,leakyreluAlpha:g}=r,v=[];let x=h;x==null&&(x=[1,1]),j(cr(l,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${x}'`);const b=Qn(i.shape,a.shape,l,x,c,d,!0),w=ct().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels===1,C=p?Nd(p,w):null,T=[i,a],$=s!=null,A=o!=null,E=p==="leakyrelu";if($&&T.push(s),A&&T.push(o),E){const R=n.makeTensorInfo([],"float32",$o(g,"float32"));T.push(R),v.push(R)}let O;w?O=new f8(b,$,C,A,E):O=new c8(b,$,C,A,E);const N=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],_=n.runWebGLProgram(O,T,"float32",N);return v.forEach(R=>n.disposeIntermediateTensorInfo(R)),_}const a_t={kernelName:pW,backendName:"webgl",kernelFunc:i_t};class s_t{constructor(t,n,r,i){this.sliceDim=t,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const a=Re(r.length);let s=`
    int index;`;for(let o=0;o<this.sliceDim;o++)s+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${s}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_t(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,a=i.shape,s=a[a.length-1],o=pt(r.shape),[l,c,h,d]=XE(r,i),p=Et({inputs:{x:i},backend:n,attrs:{shape:[c,s]}}),g=Et({inputs:{x:r},backend:n,attrs:{shape:[pt(r.shape)/h,h]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const w=n.readSync(i.dataId),C=n.bufferSync(r),T=fkt(w,C,r.dtype,c,s,h,d,r.shape,o);return n.makeTensorInfo(l,r.dtype,T.values)}const v=new s_t(s,d,[c,h],r.shape),x=n.runWebGLProgram(v,[g,p],g.dtype),b=Et({inputs:{x},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),b}const l_t={kernelName:YV,backendName:"webgl",kernelFunc:o_t};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u_t{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=Re(this.rank),i=c_t(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function c_t(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<e.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:a}=t,{axis:s,batchDims:o}=r,l=re(s,i.shape)[0];if(ct().get("DEBUG")){const C=n.readSync(a.dataId),T=i.shape[l];for(let $=0;$<C.length;++$){const A=C[$];j(A<=T-1&&A>=0,()=>`GatherV2: the index value ${A} is not in [0, ${T-1}]`)}}const c=vI(i,a,l,o),h=pt(a.shape),d=[],p=Et({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),g=Et({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,h/c.batchSize]}});d.push(p),d.push(g);const v=[c.batchSize,c.outerSize,h/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([i,a])||i.dtype==="string"){const C=n.bufferSync(g),T=n.bufferSync(p),$=hkt(T,C,v);return d.forEach(A=>n.disposeIntermediateTensorInfo(A)),n.makeTensorInfo(c.outputShape,$.dtype,$.values)}const x=new u_t(p.shape,v),b=n.runWebGLProgram(x,[p,g],p.dtype);d.push(b);const w=Et({inputs:{x:b},backend:n,attrs:{shape:c.outputShape}});return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),w}const f_t={kernelName:$b,backendName:"webgl",kernelFunc:p8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h_t="return float(a > b);",d_t=`
  return vec4(greaterThan(a, b));
`,p_t=tr({opSnippet:h_t,packedOpSnippet:d_t,cpuKernelImpl:dkt,dtype:"bool"}),m_t={kernelName:Ab,backendName:"webgl",kernelFunc:p_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_t="return float(a >= b);",y_t=`
  return vec4(greaterThanEqual(a, b));
`,v_t=tr({opSnippet:g_t,packedOpSnippet:y_t,dtype:"bool",cpuKernelImpl:pkt}),b_t={kernelName:fp,backendName:"webgl",kernelFunc:v_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_t(e){const{inputs:t,backend:n}=e,{input:r}=t;return d8(r,!0,n)}const w_t={kernelName:Qk,backendName:"webgl",kernelFunc:x_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S_t="return float(!isnan(x) && !isinf(x));",C_t=ye({opSnippet:S_t,dtype:"bool"}),T_t={kernelName:dp,backendName:"webgl",kernelFunc:C_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_t="return float(isinf(x));",A_t=ye({opSnippet:$_t,dtype:"bool"}),k_t={kernelName:pp,backendName:"webgl",kernelFunc:A_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_t="return float(isnan(x));",I_t=ye({opSnippet:E_t,dtype:"bool"}),O_t={kernelName:mp,backendName:"webgl",kernelFunc:I_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_t="return float(a < b);",__t=`
  return vec4(lessThan(a, b));
`,R_t=tr({opSnippet:N_t,packedOpSnippet:__t,cpuKernelImpl:mkt,dtype:"bool"}),D_t={kernelName:Eb,backendName:"webgl",kernelFunc:R_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M_t="return float(a <= b);",P_t=`
  return vec4(lessThanEqual(a, b));
`,F_t=tr({opSnippet:M_t,packedOpSnippet:P_t,cpuKernelImpl:gkt,dtype:"bool"}),L_t={kernelName:Ib,backendName:"webgl",kernelFunc:F_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_t(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:a}=n,s=ykt(r,i,a);return t.makeTensorInfo([s.length],"float32",s)}const z_t={kernelName:ZV,backendName:"webgl",kernelFunc:B_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j_t=lf+`
  return x < 0.0 ? 0./0. : log(x);
`,U_t=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,V_t=ye({opSnippet:j_t,packedOpSnippet:U_t,cpuKernelImpl:vkt}),W_t={kernelName:gp,backendName:"webgl",kernelFunc:V_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_t=lf+`
  return log(1.0 + x);
`,q_t=ye({opSnippet:G_t}),H_t={kernelName:yp,backendName:"webgl",kernelFunc:q_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X_t="return float(a >= 1.0 && b >= 1.0);",K_t=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Y_t=tr({opSnippet:X_t,packedOpSnippet:K_t,dtype:"bool"}),Z_t={kernelName:Ob,backendName:"webgl",kernelFunc:Y_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q_t="return float(!(x >= 1.0));",J_t=ye({opSnippet:Q_t}),tRt={kernelName:Nb,backendName:"webgl",kernelFunc:J_t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eRt="return float(a >= 1.0 || b >= 1.0);",nRt=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,rRt=tr({opSnippet:eRt,packedOpSnippet:nRt,dtype:"bool"}),iRt={kernelName:_b,backendName:"webgl",kernelFunc:rRt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aRt{constructor(t,n,r,i,a){this.variableNames=["x"],this.outputShape=[];const s=n,o=t[3]-1;this.outputShape=t;let l;const c=`float(${r}) + float(${i}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${s}; j <= ${s}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sRt{constructor(t,n,r,i,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=n,o=t[3]-1;this.outputShape=t;let l;const c=`float(${r}) + float(${i}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${s};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${s}; j <= ${s}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oRt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:s,alpha:o,beta:l}=r,c=ct().getBool("WEBGL_PACK_NORMALIZATION")?new sRt(i.shape,a,s,o,l):new aRt(i.shape,a,s,o,l);return n.runWebGLProgram(c,[i],i.dtype)},lRt={kernelName:Rb,backendName:"webgl",kernelFunc:oRt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uRt{constructor(t,n,r,i,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cRt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:s}=t,{depthRadius:o,bias:l,alpha:c,beta:h}=r,d=new uRt(i.shape,o,l,c,h);return n.runWebGLProgram(d,[i,a,s],i.dtype)},fRt={kernelName:tE,backendName:"webgl",kernelFunc:cRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hRt(e,t,n,r){const i=pt(t),s=pt(e.shape)/i,o=Et({inputs:{x:e},attrs:{shape:[s,i]},backend:r}),l=Kl(o,e.dtype,"max",r),c=Et({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:a,keepDims:s}=r,o=i.shape.length,l=re(a,i.shape);let c=l;const h=en(c,o),d=h!=null,p=n.shouldExecuteOnCPU([i]);let g=i;if(d){if(p){const T=n.texData.get(g.dataId).values,$=new Array(o);for(let O=0;O<$.length;O++)$[O]=i.shape[h[O]];const A=tO(T,i.shape,i.dtype,h,$);g=n.makeTensorInfo($,i.dtype);const E=n.texData.get(g.dataId);E.values=A}else g=R0(i,h,n);c=fn(c.length,o)}Jn("max",c,o);const[v,x]=Vn(g.shape,c);let b=v;s&&(b=bn(v,l));let w;if(p){const T=n.texData.get(g.dataId).values,$=bkt(T,pt(x),b,i.dtype);w=n.makeTensorInfo(b,i.dtype);const A=n.texData.get(w.dataId);A.values=$}else w=hRt(g,x,b,n);return d&&n.disposeIntermediateTensorInfo(g),w}const dRt={kernelName:Db,backendName:"webgl",kernelFunc:m8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pRt=eO+`
  return max(a, b);
`,mRt=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,gRt=tr({opSnippet:pRt,packedOpSnippet:mRt,cpuKernelImpl:xkt}),yRt={kernelName:vp,backendName:"webgl",kernelFunc:gRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;om(i,"maxPool");const{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,c=1;j(cr(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const h=ji(i.shape,a,s,c,o,l);if(h.filterWidth===1&&h.filterHeight===1&&we(h.inShape,h.outShape))return Yr({inputs:{x:i},backend:n});const d=new _d(h,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}const bRt={kernelName:Mb,backendName:"webgl",kernelFunc:vRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xRt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:o,dataFormat:l,dimRoundingMode:c}=r,h=[1,1,1],d=ks(i.shape,a,s,h,o,c,l),p=new rO(d,"max",!1);return n.runWebGLProgram(p,[i],i.dtype)}const wRt={kernelName:Pb,backendName:"webgl",kernelFunc:xRt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SRt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,r=t.strideWidth,i=t.dilationHeight,a=t.effectiveFilterHeight,s=t.effectiveFilterWidth,o=a-1-t.padInfo.top,l=s-1-t.padInfo.left,c=a*s-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${s} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class CRt{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,o=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=l-1-t.padInfo.front,p=c-1-t.padInfo.top,g=h-1-t.padInfo.left,v=l*c*h-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${s}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${v} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TRt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,s=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:h}=r,d=[1,1,1],p=ks(s.shape,o,l,d,c,h),g=new rO(p,"max",!0),v=n.runWebGLProgram(g,[s],s.dtype),x=new CRt(p),b=n.runWebGLProgram(x,[i,v],s.dtype);return n.disposeIntermediateTensorInfo(v),b}const $Rt={kernelName:nE,backendName:"webgl",kernelFunc:TRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ARt(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a,output:s}=t,o=a;om([a,s],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:d}=r,p=ji(o.shape,l,c,1,h,d),g=!0,v=new _d(p,"max",g),x=n.runWebGLProgram(v,[o],o.dtype),b=new SRt(p),w=n.runWebGLProgram(b,[i,x],o.dtype);return n.disposeIntermediateTensorInfo(x),w}const kRt={kernelName:eE,backendName:"webgl",kernelFunc:ARt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERt(e,t,n,r){let i=new _d(n,"max",!1);const a=r.runWebGLProgram(i,[e],"float32");i=new _d(n,"max",!0,!0,t);const s=r.runWebGLProgram(i,[e],"float32");return[a,s]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IRt={kernelName:QV,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:a,pad:s,includeBatchInIndex:o}=t,l=n;j(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];j(cr(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const h=ji(r.shape,i,a,c,s),[d,p]=ERt(r,o,h,l);return[d,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ORt(e,t,n,r){const i=pt(t),s=pt(e.shape)/i,o=Et({inputs:{x:e},attrs:{shape:[s,i]},backend:r}),l=Kl(o,"float32","mean",r),c=Et({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NRt={kernelName:Fb,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{keepDims:i,axis:a}=t,s=n,o=r.shape.length,l=re(a,r.shape);let c=l;const h=en(c,o),d=h!=null,p=s.shouldExecuteOnCPU([r]),g=[];let v=r;if(d){if(p){const $=s.texData.get(v.dataId).values,A=new Array(o);for(let N=0;N<A.length;N++)A[N]=r.shape[h[N]];const E=tO($,r.shape,r.dtype,h,A);v=s.makeTensorInfo(A,r.dtype);const O=s.texData.get(v.dataId);O.values=E}else v=R0(r,h,s);g.push(v),c=fn(c.length,o)}Jn("sum",c,o);const[x,b]=Vn(v.shape,c);let w=x;i&&(w=bn(x,l));const C=ORt(v,b,w,s);for(const T of g)s.disposeIntermediateTensorInfo(T);return C}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Rt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=re(a,i.shape);let c=l;const h=en(c,o);let d=i;h!=null&&(d=Tr({inputs:{x:i},backend:n,attrs:{perm:h}}),c=fn(c.length,i.shape.length)),Jn("min",c,o);const[p,g]=Vn(d.shape,c),v=pt(g),x=Et({inputs:{x:d},backend:n,attrs:{shape:[-1,v]}}),b=Kl(x,x.dtype,"min",n);let w;if(s){const C=bn(p,l);w=Et({inputs:{x:b},backend:n,attrs:{shape:C}})}else w=Et({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b),h!=null&&n.disposeIntermediateTensorInfo(d),w}const RRt={kernelName:Lb,backendName:"webgl",kernelFunc:_Rt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DRt=eO+`
  return min(a, b);
`,MRt=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Xl+`
  return result;
`,PRt=tr({opSnippet:DRt,packedOpSnippet:MRt,cpuKernelImpl:wkt}),FRt={kernelName:bp,backendName:"webgl",kernelFunc:PRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LRt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=n.map((h,d)=>h[0]+t[d]+h[1]);const i=t.length,a=Re(i),s=n.map(h=>h[0]).join(","),o=n.map((h,d)=>h[0]+t[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),c=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${s};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BRt{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((v,x)=>v[0]+t[x]+v[1]);const i=t.length,a=Re(i),s=n.map(v=>v[0]).join(","),o=n.map((v,x)=>v[0]+t[x]).join(","),l=Sr("rc",i),c=Sr("source",i),h=`${l[i-1]} < ${this.outputShape[i-1]}`,d=i===1?"source":`vec2(${c.slice(-2).join()})`,p=r==="reflect"?0:1;let g="";if(i===1){const v=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${v}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[i-1]} += 1;
        if(${h}) {
          ${v}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const v=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${v}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[i-1]} += 1;
        if(${h}) {
          ${v}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${v}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[i-1]} += 1;
          if(${h}) {
            ${v}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zRt=({inputs:e,backend:t,attrs:n})=>{const{x:r}=e,{paddings:i,mode:a}=n,s=ct().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BRt(r.shape,i,a):new LRt(r.shape,i,a);return t.runWebGLProgram(s,[r],r.dtype)},jRt={kernelName:Bb,backendName:"webgl",kernelFunc:zRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const URt=`if (b == 0.0) return NAN;
  return mod(a, b);`,VRt=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Xl+`
  return result;
`,WRt=tr({opSnippet:URt,packedOpSnippet:VRt}),GRt={kernelName:xp,backendName:"webgl",kernelFunc:WRt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qRt{constructor(t,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HRt=`
if (a == b) {
  return 1.0;
};
return a / b;`,XRt=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,g8=tr({opSnippet:HRt,packedOpSnippet:XRt,checkOutOfBounds:!0}),KRt={kernelName:ip,backendName:"webgl",kernelFunc:g8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E4="return a - b;",y8=tr({opSnippet:E4,packedOpSnippet:E4,supportsComplex:!0,cpuKernelImpl:Ukt}),YRt={kernelName:Pp,backendName:"webgl",kernelFunc:y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:a}=r,s=re([a],i.shape),o=m8({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=bn(o.shape,s),c=Et({inputs:{x:o},backend:n,attrs:{shape:l}}),h=y8({inputs:{a:i,b:c},backend:n}),d=h8({inputs:{x:h},backend:n}),p=D0({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),g=Et({inputs:{x:p},backend:n,attrs:{shape:l}}),v=g8({inputs:{a:d,b:g},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),v}const ZRt={kernelName:r0,backendName:"webgl",kernelFunc:v8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QRt(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:s,normalized:o}=r,l=o?i:v8({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),c=l.shape[0],h=l.shape[1],d=new qRt(c,h,a),p=[[s]],g=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),g}const JRt={kernelName:JV,backendName:"webgl",kernelFunc:QRt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tDt=Vi+`
  return -x;
`,eDt=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function nDt(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const a=n.texData.get(r.dataId),[s,o]=Ckt(a.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}let i;return ct().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new ao(r.shape,eDt):i=new Ta(r.shape,tDt),n.runWebGLProgram(i,[r],r.dtype)}const rDt={kernelName:zb,backendName:"webgl",kernelFunc:nDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iDt=VE;function aDt(e){ui("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r,c=n.readSync(i.dataId),h=n.readSync(a.dataId),{selectedIndices:d}=iDt(c,h,s,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const sDt={kernelName:rE,backendName:"webgl",kernelFunc:aDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oDt=WE;function lDt(e){ui("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r,h=n.readSync(i.dataId),d=n.readSync(a.dataId),{selectedIndices:p,validOutputs:g}=oDt(h,d,s,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}const uDt={kernelName:iE,backendName:"webgl",kernelFunc:lDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cDt=GE;function fDt(e){ui("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r,h=n.readSync(i.dataId),d=n.readSync(a.dataId),p=s,g=o,v=l,x=c,{selectedIndices:b,selectedScores:w}=cDt(h,d,p,g,v,x);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const hDt={kernelName:aE,backendName:"webgl",kernelFunc:fDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dDt{constructor(t,n,r,i){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pDt=e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:s,onValue:o,offValue:l}=r,c=pt(i.shape),h=new dDt(c,s,o,l),d=Et({inputs:{x:i},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(h,[d],a);n.disposeIntermediateTensorInfo(d);const g=[...i.shape,s],v=Et({inputs:{x:p},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(p),v},mDt={kernelName:Vb,backendName:"webgl",kernelFunc:pDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Av(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){const i=um({inputs:{input:r},backend:n}),a=Av({inputs:{x:i},backend:n}),s=M0({inputs:{input:r},backend:n}),o=Av({inputs:{x:s},backend:n}),l=Ro({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return cm({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const gDt={kernelName:s0,backendName:"webgl",kernelFunc:Av};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=um({inputs:{input:r},backend:n}),a=b8({inputs:{x:i},backend:n}),s=M0({inputs:{input:r},backend:n}),o=Av({inputs:{x:s},backend:n}),l=Ro({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),l}else return cm({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const yDt={kernelName:Ub,backendName:"webgl",kernelFunc:b8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vDt(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return bA({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const a=t[0].shape,s=t[0].dtype;t.forEach(h=>{kk(a,h.shape,"All tensors passed to stack must have matching shapes"),j(s===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=t.map(h=>{const d=bA({inputs:{input:h},backend:n,attrs:{dim:i}});return o.push(d),d}),c=i8({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(h=>n.disposeIntermediateTensorInfo(h)),c}const bDt={kernelName:Wb,backendName:"webgl",kernelFunc:vDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xDt{constructor(t,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,h)=>c[0]+t[h]+c[1]);const i=t.length,a=Re(i),s=n.map(c=>c[0]).join(","),o=n.map((c,h)=>c[0]+t[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${s};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wDt{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((x,b)=>x[0]+t[b]+x[1]);const i=t.length,a=Re(i),s=n.map(x=>x[0]).join(","),o=n.map((x,b)=>x[0]+t[b]).join(","),l=Sr("rc",i),c=Sr("source",i),h=`${l[i-1]} < ${this.outputShape[i-1]}`,d=i===1?"source":`vec2(${c.slice(-2).join()})`,p=[`${a} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${h}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${h}) {`],g=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let v="";for(let x=0,b=i===1?2:4;x<b;x++)v+=`
        ${p[x]}
        if (${g}) {
          result[${x}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${x}] = getChannel(getX(${c.join()}), ${d});
        }
      `;v+=i===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,constantValue:s}=r;if(pt(i.shape)===0){const c=a.map((h,d)=>h[0]+i.shape[d]+h[1]);return cm({backend:n,attrs:{shape:c,value:s,dtype:i.dtype}})}const o=ct().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wDt(i.shape,a,s):new xDt(i.shape,a,s),l=[[s]];return n.runWebGLProgram(o,[i],i.dtype,l)},SDt={kernelName:Gb,backendName:"webgl",kernelFunc:x8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CDt=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,TDt=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Xl+`
  return result;
`,$Dt=tr({opSnippet:CDt,packedOpSnippet:TDt}),ADt={kernelName:Sp,backendName:"webgl",kernelFunc:$Dt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kDt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r,o=i.shape.length,l=[],c=re(a,i.shape);let h=c;const d=en(h,o);let p=i;d!=null&&(p=Tr({inputs:{x:i},backend:n,attrs:{perm:d}}),h=fn(h.length,o),l.push(p)),Jn("prod",h,o);let g;if(n.shouldExecuteOnCPU([p])){const v=n.texData.get(p.dataId).values,{outVals:x,outShape:b,outDtype:w}=$kt(p.shape,p.dtype,v,h);g=n.makeTensorInfo(b,w,x)}else{const[v,x]=Vn(p.shape,h),b=pt(x),w=Et({inputs:{x:p},backend:n,attrs:{shape:[-1,b]}}),C=yE(i.dtype),T=Kl(w,C,"prod",n);g=Et({inputs:{x:T},backend:n,attrs:{shape:v}}),l.push(w),l.push(T)}if(s){l.push(g);const v=bn(g.shape,c);g=Et({inputs:{x:g},backend:n,attrs:{shape:v}})}return l.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const EDt={kernelName:Hb,backendName:"webgl",kernelFunc:kDt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IDt(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:a,indices:s}=t,{outputRaggedRank:o}=r,l=i.map(w=>n.readSync(w.dataId)),c=i.map(w=>w.shape),h=n.readSync(a.dataId),d=n.readSync(s.dataId),[p,g,v]=Akt(l,c,h,a.shape,a.dtype,d,s.shape,o),x=p.map(w=>n.makeTensorInfo([w.length],"int32",w)),b=n.makeTensorInfo(v,a.dtype,g);return x.concat([b])}const ODt={kernelName:tW,backendName:"webgl",kernelFunc:IDt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NDt(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:a}=t,s=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(a.dataId),[c,h]=kkt(s,r.shape,r.dtype,o,i.shape,l,a.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([h.length],r.dtype,h);return[d,p]}const _Dt={kernelName:eW,backendName:"webgl",kernelFunc:NDt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RDt(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:a,defaultValue:s,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=r,c=n.readSync(i.dataId),h=n.readSync(a.dataId),d=n.readSync(s.dataId),p=o.map(b=>n.readSync(b.dataId)),g=o.map(b=>b.shape),[v,x]=Ekt(c,i.shape,h,a.shape,a.dtype,d,s.shape,p,g,l);return n.makeTensorInfo(v,a.dtype,x)}const DDt={kernelName:nW,backendName:"webgl",kernelFunc:RDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8=e=>{const{backend:t,attrs:n}=e,{start:r,stop:i,step:a,dtype:s}=n,o=Ikt(r,i,a,s);return t.makeTensorInfo([o.length],s,o)},MDt={kernelName:sE,backendName:"webgl",kernelFunc:w8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PDt="return 1.0 / x;",FDt=ye({opSnippet:PDt}),LDt={kernelName:Cp,backendName:"webgl",kernelFunc:FDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BDt=Vi+`
  return (x < 0.0) ? 0.0 : x;
`,zDt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jDt=ye({opSnippet:BDt,packedOpSnippet:zDt}),UDt={kernelName:Tp,backendName:"webgl",kernelFunc:jDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VDt=Vi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,WDt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,GDt=ye({opSnippet:VDt,packedOpSnippet:WDt}),qDt={kernelName:$p,backendName:"webgl",kernelFunc:GDt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HDt{constructor(t,n,r,i,a){this.variableNames=["A"],this.outputShape=[];const[s,o,l,c]=t;this.outputShape=[s,n,r,c];const h=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r];let p;a?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/d[0]},
          ${h[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XDt{constructor(t,n,r,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,o,l,c]=t;this.outputShape=[s,n,r,c];const h=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r];let p;a?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/d[0]},
          ${h[1]/d[1]},
          ${h[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KDt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,c]=o,h=ct().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new XDt(i.shape,l,c,a,s):new HDt(i.shape,l,c,a,s);return n.runWebGLProgram(h,[i],"float32")}const YDt={kernelName:Yb,backendName:"webgl",kernelFunc:KDt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZDt{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,a]=n,[,s,o]=t,l=[r&&s>1?i-1:i,r&&o>1?a-1:a],c=[r&&s>1?s-1:s,r&&o>1?o-1:o],h=l[0]/c[0],d=l[1]/c[1],p=1/h,g=1/d,v=Math.ceil(p)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${v});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QDt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r,o=new ZDt(a.shape,i.shape,s);return n.runWebGLProgram(o,[a],a.dtype)}const JDt={kernelName:uE,backendName:"webgl",kernelFunc:QDt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tMt{constructor(t,n,r,i,a){this.variableNames=["A"],this.outputShape=[];const[s,o,l,c]=t;this.outputShape=[s,n,r,c];const h=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r],p=i?"0.5":"0.0";let g;a?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/d[0]},
          ${h[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eMt{constructor(t,n,r,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,o,l,c]=t;this.outputShape=[s,n,r,c];const h=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r],p=i?"0.5":"0.0";let g;a?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/d[0]},
          ${h[1]/d[1]},
          ${h[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nMt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,c]=o,h=ct().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eMt(i.shape,l,c,a,s):new tMt(i.shape,l,c,a,s);return n.runWebGLProgram(h,[i],i.dtype)}const rMt={kernelName:Kb,backendName:"webgl",kernelFunc:nMt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iMt{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,a]=n,[,s,o]=t,l=[r&&s>1?i-1:i,r&&o>1?a-1:a],c=[r&&s>1?s-1:s,r&&o>1?o-1:o],h=l[0]/c[0],d=l[1]/c[1],p=1/h,g=1/d,v=Math.ceil(p)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${v});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aMt(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:s}=r,o=new iMt(a.shape,i.shape,s);return n.runWebGLProgram(o,[a],a.dtype)}const sMt={kernelName:lE,backendName:"webgl",kernelFunc:aMt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oMt{constructor(t,n){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const i=o=>n.indexOf(o)!==-1&&t[o]!==1?`${t[o]} - coords[${o}] - 1`:`coords[${o}]`,a=t.map((o,l)=>i(l)).join(","),s=Re(r);this.userCode=`
      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lMt{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=Sr("rc",r),a=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,s=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,o=Re(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${a}){
            result.g = ${c(i.slice())};
          }
          if(${s}) {
            result.b = ${h(i.slice())};
            if(${a}) {
              result.a = ${d(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(v){return p(v)}function c(v){return v[r-1]="("+v[r-1]+" + 1)",p(v)}function h(v){return v[r-2]="("+v[r-2]+" + 1)",p(v)}function d(v){return v[r-1]="("+v[r-1]+" + 1)",v[r-2]="("+v[r-2]+" + 1)",p(v)}function p(v){const x=t.map((C,T)=>g(T,v)),b=x.join(","),w=x.slice(-2).join(",");return`getChannel(getX(${b}), vec2(${w}))`}function g(v,x){return n.indexOf(v)!==-1&&t[v]!==1?`${t[v]} - ${x[v]} - 1`:`${x[v]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uMt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r,s=i.shape.length,o=re(a,i.shape);if(s===0)return Yr({inputs:{x:i},backend:n});const l=ct().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lMt(i.shape,o):new oMt(i.shape,o);return n.runWebGLProgram(l,[i],i.dtype)}const cMt={kernelName:Zb,backendName:"webgl",kernelFunc:uMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fMt{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=t[1],i=t[2];this.outputShape=t;let a="";typeof n=="number"?a=`float outputValue = ${n.toFixed(2)};`:a=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hMt={kernelName:gE,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:a,center:s}=t,o=n,l=new fMt(r.shape,a),[c,h]=nI(s,r.shape[1],r.shape[2]),d=[[c,h,Math.sin(i),Math.cos(i)]];return o.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dMt=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,pMt=ye({opSnippet:dMt}),mMt={kernelName:Ap,backendName:"webgl",kernelFunc:pMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gMt="return inversesqrt(x);",yMt=ye({opSnippet:gMt,cpuKernelImpl:Okt}),vMt={kernelName:kp,backendName:"webgl",kernelFunc:yMt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iO{constructor(t,n,r,i,a,s,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const c=Re(a.length),h=Re(s.length);let d="";r===1?d="i":r===2&&(d="i, j");const p=`getIndices(${d})`;let g="";i===1?g="i":i===2&&(g="i, coords[1]");const v=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const b=`getDefaultValue(${x})`,w=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${h} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${v};
              found = true;
            }
          }
          setOutput(mix(${b}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bMt{constructor(t,n,r,i,a,s,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;const c=Re(a.length),h=Re(s.length);let d="";r===1?d="i":r===2&&(d="i, j");const p=`getIndices(${d})`;let g="";i===1?g="i":i===2&&(g="i, coords[1]");const v=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const b=`getDefaultValue(${x})`,w=n>1?"strides[j]":"strides",C=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${h} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${C};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${v};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${b}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xMt(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:a}=t,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:h,outputSize:d}=Vl(a,i,s),p=[d/c,c];if(d===0)return n.makeTensorInfo(s,i.dtype);const g=Et({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),v=Et({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),x=n.makeTensorInfo([],"float32",new Float32Array([0]));let b;ct().getBool("WEBGL_PACK")?b=new bMt(l,o,g.shape.length,v.shape.length,h,p):b=new iO(l,o,g.shape.length,v.shape.length,h,p);const w=n.runWebGLProgram(b,[v,g,x],v.dtype),C=Et({inputs:{x:w},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(x),C}const wMt={kernelName:rW,backendName:"webgl",kernelFunc:xMt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SMt{constructor(t,n,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];const a="while (left < right) {",s=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,o=ct().getNumber("WEBGL_VERSION")===2?a:s,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CMt(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:s}=r,o=new SMt(i.shape[0],i.shape[1],a.shape[1],s),l=[[i.shape[1]]];return n.runWebGLProgram(o,[i,a],"int32",l)}const TMt={kernelName:aW,backendName:"webgl",kernelFunc:CMt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Mt{constructor(t,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let i,a;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)a="resRC",i="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let h=0;h<n.length;h++)c.push(`${o[h]}`),h<t&&l.push(`${o[h]}`);i=l.join(),a=c.join()}const s=Re(r);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AMt(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t,s=new $Mt(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(s,[r,i,a],Xr(i.dtype,a.dtype))}const kMt={kernelName:Qb,backendName:"webgl",kernelFunc:AMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EMt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${y0};
  float scale = ${v0};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,IMt=ye({opSnippet:EMt}),OMt={kernelName:Ep,backendName:"webgl",kernelFunc:IMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NMt=lf+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,_Mt=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,RMt=ye({opSnippet:NMt,packedOpSnippet:_Mt,cpuKernelImpl:_kt}),DMt={kernelName:_p,backendName:"webgl",kernelFunc:RMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MMt=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,PMt=ye({opSnippet:MMt}),FMt={kernelName:Np,backendName:"webgl",kernelFunc:PMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LMt=lf+`
  return sin(x);
`,BMt=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Xl}
  return result;
`,zMt=ye({opSnippet:LMt,packedOpSnippet:BMt}),jMt={kernelName:Ip,backendName:"webgl",kernelFunc:zMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UMt=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,VMt=ye({opSnippet:UMt}),WMt={kernelName:Op,backendName:"webgl",kernelFunc:VMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GMt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,qMt=ye({opSnippet:GMt}),HMt={kernelName:Rp,backendName:"webgl",kernelFunc:qMt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XMt=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:s}=r;j(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((w,C)=>w*C),l=[[0,0]];l.push(...s);for(let w=1+a.length;w<i.shape.length;++w)l.push([0,0]);const c=[],h=x8({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),d=Xp(h.shape,a,o,!1),p=Kp(d.length,a.length,!1),g=Yp(h.shape,a,o,!1),v=Et({inputs:{x:h},backend:n,attrs:{shape:d}}),x=Tr({inputs:{x:v},backend:n,attrs:{perm:p}}),b=Et({inputs:{x},backend:n,attrs:{shape:g}});return c.push(h),c.push(v),c.push(x),c.forEach(w=>n.disposeIntermediateTensorInfo(w)),b},KMt={kernelName:e0,backendName:"webgl",kernelFunc:XMt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YMt(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:a,defaultValue:s}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);const o=n.readSync(r.dataId),l=n.readSync(i.dataId),c=n.readSync(a.dataId),h=n.readSync(s.dataId)[0],[d,p,g,v,x]=Dkt(o,r.shape,r.dtype,l,i.dtype,c,h);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],i.dtype,g),n.makeTensorInfo([v.length],"bool",new Uint8Array(v.map(b=>Number(b)))),n.makeTensorInfo([x.length],r.dtype,new Int32Array(x))]}const ZMt={kernelName:sW,backendName:"webgl",kernelFunc:YMt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QMt(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:a}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const s=Array.from(n.readSync(i.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(a.dataId)),[c,h,d]=Mkt(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(h,r.dtype,c),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const JMt={kernelName:oW,backendName:"webgl",kernelFunc:QMt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tPt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const s=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(a.dataId),[c,h]=G5(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(h,r.dtype,c)}const ePt={kernelName:lW,backendName:"webgl",kernelFunc:tPt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nPt(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const s=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(a.dataId),[c,h]=G5(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(h,r.dtype,c)}const rPt={kernelName:uW,backendName:"webgl",kernelFunc:nPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iPt(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:s}=t,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:h,strides:d,outputSize:p}=Vl(a,i,o),g=!1;if(a.dtype==="string"){const w=n.bufferSync(i),C=n.bufferSync(a),T=ho(n.readSync(s.dataId)[0]),$=Nkt(w,C,o,p,h,c,l,d,T,g);return n.makeTensorInfo(o,$.dtype,$.values)}const v=new iO(c,l,i.shape.length,a.shape.length,d,[p,1],g),x=n.runWebGLProgram(v,[a,i,s],a.dtype),b=Et({inputs:{x},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(x),b}const aPt={kernelName:cW,backendName:"webgl",kernelFunc:iPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sPt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:s}=r,o=re(s,i.shape)[0],l=yI(i,a,o),c=i.shape.length,h=new Array(c).fill(0),d=i.shape.slice();return l.map(p=>{const g=[...d];g[o]=p;const v=uf({inputs:{x:i},backend:n,attrs:{begin:h,size:g}});return h[o]+=p,v})}const oPt={kernelName:n0,backendName:"webgl",kernelFunc:sPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I4="return sqrt(x);",lPt=ye({opSnippet:I4,packedOpSnippet:I4,cpuKernelImpl:Pkt}),uPt={kernelName:Dp,backendName:"webgl",kernelFunc:lPt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cPt="return x * x;",fPt=ye({opSnippet:cPt}),hPt={kernelName:cE,backendName:"webgl",kernelFunc:fPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O4="return (a - b) * (a - b);",dPt=tr({opSnippet:O4,packedOpSnippet:O4}),pPt={kernelName:Mp,backendName:"webgl",kernelFunc:dPt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mPt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");const a=n.readSync(i.dataId),s=Ss(a),o=Fkt(s,"string",r);return n.makeTensorInfo(i.shape,"string",o)}const gPt={kernelName:fE,backendName:"webgl",kernelFunc:mPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yPt({inputs:e,attrs:t,backend:n}){const{x:r}=e,i=Vi+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,a=new Ta(r.shape,i);return n.runWebGLProgram(a,[r],r.dtype)}const vPt={kernelName:zp,backendName:"webgl",kernelFunc:yPt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bPt{constructor(t,n,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,a=Re(r.length),s=Re(r.length);let o="";if(i===1)o="coords * strides + begin";else{let l=0;o=r.map((c,h)=>(l++,r.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${l-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${t});
      ${a} strides = ${a}(${n});

      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xPt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,end:s,strides:o,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:g,finalShape:v,isIdentity:x,sliceDim0:b,isSimpleSlice:w,begin:C,end:T,strides:$}=JE(i.shape,a,s,o,l,c,h,d,p);let A;if(x)A=Et({inputs:{x:i},backend:n,attrs:{shape:v}});else if(b||w){j(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const O=YE(C,T,$),N=uf({inputs:{x:i},backend:n,attrs:{begin:C,size:O}});A=Et({inputs:{x:N},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(N)}else if(n.shouldExecuteOnCPU([i])){const N=n.readSync(i.dataId),_=ne(i.shape,i.dtype,N),R=Lkt(g,_,$,C);A=n.makeTensorInfo(v,i.dtype,R.values)}else{const N=new bPt(C,$,g);A=n.runWebGLProgram(N,[i],i.dtype)}const E=Et({inputs:{x:A},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(A),E}const wPt={kernelName:hE,backendName:"webgl",kernelFunc:xPt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SPt(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:a,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:h,dataSplits:d}=t,p=n.readSync(h.dataId),g=n.readSync(d.dataId),[v,x]=Bkt(p,g,i,a,s,o,l,c);return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(d.shape,"int32",x)]}const CPt={kernelName:fW,backendName:"webgl",kernelFunc:SPt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TPt(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:a,delimiter:s}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const o=n.readSync(a.dataId),l=n.readSync(s.dataId)[0],[c,h,d]=zkt(o,l,i),p=h.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const $Pt={kernelName:hW,backendName:"webgl",kernelFunc:TPt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function APt(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const s=n.readSync(a.dataId),o=jkt(s,i);return n.makeTensorInfo(a.shape,"int32",o)}const kPt={kernelName:dW,backendName:"webgl",kernelFunc:APt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EPt="return tan(x);",IPt=ye({opSnippet:EPt}),OPt={kernelName:Fp,backendName:"webgl",kernelFunc:IPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NPt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,_Pt=ye({opSnippet:NPt}),RPt={kernelName:Lp,backendName:"webgl",kernelFunc:_Pt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DPt(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:a,updates:s}=t,{sliceRank:o,numUpdates:l,sliceSize:c,strides:h,outputSize:d}=Vl(s,a,i.shape),p=[d/c,c];if(d===0)return n.makeTensorInfo(i.shape,a.dtype);const g=Et({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),v=Et({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),x=Et({inputs:{x:i},backend:n,attrs:{shape:p}}),b=new iO(l,o,g.shape.length,v.shape.length,h,p,!1,!0),w=n.runWebGLProgram(b,[v,g,x],x.dtype),C=Et({inputs:{x:w},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),C}const MPt={kernelName:iW,backendName:"webgl",kernelFunc:DPt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PPt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let s=0;s<r.length;s++)r[s]=t[s]*n[s];this.outputShape=r,this.rank=r.length;const i=Re(this.rank),a=FPt(t);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function FPt(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:a}=r;if(i.dtype==="string"||i.shape.length>5){const l=n.readSync(i.dataId),c=i.dtype==="string"?l.map(p=>ho(p)):l,h=ne(i.shape,i.dtype,c),d=Vkt(h,a);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const s=new PPt(i.shape,a);return n.runWebGLProgram(s,[i],i.dtype)}const LPt={kernelName:Bp,backendName:"webgl",kernelFunc:S8};class BPt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class zPt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jo(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function N4(e){let t=1;for(;t<e;)t*=2;return t}function jPt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:a,sorted:s}=r,o=ct().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ct().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=i.shape,h=c[c.length-1];if(n.shouldExecuteOnCPU([i])||h<o||a>l){const R=n.readSync(i.dataId),[I,P]=Wkt(R,c,i.dtype,a,s);return[n.makeTensorInfo(I.shape,I.dtype,I.values),n.makeTensorInfo(P.shape,P.dtype,P.values)]}if(a===0)return c[c.length-1]=0,[n.makeTensorInfo(c,i.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(h===1)return[i,cm({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(i.dataId),p=d!==null&&d.isPacked,g=p?n.unpackTensor(i):i,x=pt(c)/h,b=Et({inputs:{x:g},attrs:{shape:[x,h]},backend:n});p&&Jo(n,g);const w=N4(a),C=N4(h);let T=null;const $=()=>T===null?[b,b]:[b,T],A=(R,I,P)=>{const B=$(),V=new BPt(P),M=[[h],[T===null?1:0],[Number.NEGATIVE_INFINITY],[R],[I]],U=T;T=n.runWebGLProgram(V,B,"int32",M),Jo(n,U)};for(let R=1;R<w;R*=2){const I=R*2;for(let P=R;P>=1;P/=2)A(I,P,[x,C])}for(let R=C;R>w;R/=2){const I=$(),P=new zPt([x,R/2]),V=[[h],[T===null?1:0],[w]],z=T;T=n.runWebGLProgram(P,I,"int32",V),Jo(n,z);const M=w/2,U=M*2;for(let W=M;W>=1;W/=2)A(U,W,T.shape)}let E=T;T=uf({inputs:{x:T},backend:n,attrs:{begin:0,size:[x,a]}}),Jo(n,E);let O=p8({inputs:{x:b,indices:T},backend:n,attrs:{axis:1,batchDims:1}});Jo(n,b);const N=c.slice(0,-1);N.push(a),E=T,T=Et({inputs:{x:T},attrs:{shape:N},backend:n}),Jo(n,E);const _=O;return O=Et({inputs:{x:O},attrs:{shape:N},backend:n}),Jo(n,_),[O,T]}const UPt={kernelName:dE,backendName:"webgl",kernelFunc:jPt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VPt{constructor(t,n,r,i,a,s){this.variableNames=["Image","Transforms"],this.outputShape=s;const o=r==="nearest"?1:2;let l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WPt(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:a}=t,{interpolation:s,fillMode:o,fillValue:l,outputShape:c}=r,[h,d,p,g]=i.shape,[v,x]=c??[d,p],b=[h,v,x,g],w=new VPt(d,p,s,o,l,b);return n.runWebGLProgram(w,[i,a],"float32")}const GPt={kernelName:pE,backendName:"webgl",kernelFunc:WPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qPt(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t;om(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const s=r.readSync(a.dataId),{outputValues:o,outputShape:l,indices:c}=Gkt(s,i,a.shape,a.dtype);return[r.makeTensorInfo(l,a.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}const HPt={kernelName:mE,backendName:"webgl",kernelFunc:qPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XPt(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:a}=r;a<0&&(a+=i.shape.length);const s=i,o=s.shape.length,l=i.shape[a],c=new Array(o-1);let h=0;for(let x=0;x<o;x++)x!==a&&(c[h++]=s.shape[x]);const d=[],p=new Array(o).fill(0),g=s.shape.slice();g[a]=1;const v=new Array(l);for(let x=0;x<v.length;x++){p[a]=x;const b=uf({inputs:{x:s},backend:n,attrs:{begin:p,size:g}}),w=Et({inputs:{x:b},backend:n,attrs:{shape:c}});v[x]=w,d.push(b)}return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const KPt={kernelName:i0,backendName:"webgl",kernelFunc:XPt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YPt{constructor(t,n){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,a=t.inSize,s=t.numSegments,o=s*Math.ceil(a/r);this.outputShape=[i,o];const l="0.0",c="sumValue",h=Math.floor(r/4)*4,d=r%4,p=`
        sumValue += dot(values, segFilter);
    `;let g="";a%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let v="";a%r>0&&(v=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${v}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${s})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${s})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZPt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:a}=t,{numSegments:s}=r,o=i.shape.length,l=[];let c=0;const h=en([c],o);let d=i;h!=null&&(d=Tr({inputs:{x:i},backend:n,attrs:{perm:h}}),l.push(d),c=fn(1,o)[0]);const p=rq(d.shape,c,s),g=pt([d.shape[c]]),v=Et({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}});l.push(v);const x=yE(i.dtype),b=($,A,E,O,N)=>{const _=$.shape[0],R=$.shape[1],I=nq(R,N),P={windowSize:I,inSize:R,batchSize:_,numSegments:N},B=new YPt(P,A),V=n.compileAndRun(B,[$,E],O);if(l.push(V),V.shape[1]===N)return V;const z=w8({backend:n,attrs:{start:0,stop:N,step:1,dtype:"float32"}}),M=S8({inputs:{x:z},backend:n,attrs:{reps:[R/I]}});return l.push(z),l.push(M),b(V,A,M,O,N)},w=b(v,"unsortedSegmentSum",a,x,s),C=Et({inputs:{x:w},backend:n,attrs:{shape:p}});let T=C;if(h!=null){l.push(C);const $=ko(h);T=Tr({inputs:{x:T},backend:n,attrs:{perm:$}})}return l.forEach($=>n.disposeIntermediateTensorInfo($)),T}const QPt={kernelName:a0,backendName:"webgl",kernelFunc:ZPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JPt=[PEt,LEt,jEt,WEt,qEt,KEt,ZEt,JEt,rIt,aIt,lIt,fIt,pIt,vIt,wIt,CIt,$It,IIt,NIt,RIt,FIt,WIt,qIt,YIt,QIt,iOt,sOt,cOt,bEt,dOt,vOt,SOt,EOt,NOt,ROt,MOt,FOt,jOt,WOt,HOt,KOt,ZOt,JOt,nNt,iNt,lNt,cNt,dNt,gNt,vNt,SNt,ANt,ONt,RNt,PNt,FNt,BNt,jNt,VNt,GNt,HNt,ZNt,t_t,r_t,a_t,l_t,f_t,m_t,b_t,vEt,w_t,gOt,T_t,k_t,O_t,wEt,D_t,L_t,z_t,W_t,H_t,Z_t,tRt,iRt,lRt,fRt,dRt,yRt,bRt,wRt,$Rt,kRt,IRt,NRt,RRt,FRt,jRt,GRt,JRt,TEt,rDt,sDt,uDt,hDt,tOt,mDt,yDt,bDt,SDt,ADt,CEt,EDt,ODt,_Dt,DDt,MDt,eOt,KRt,LDt,UDt,qDt,AEt,YDt,JDt,rMt,sMt,cMt,hMt,mMt,vMt,wMt,TMt,kMt,OMt,DMt,FMt,jMt,WMt,UIt,ZRt,HMt,KMt,ZMt,JMt,ePt,rPt,aPt,oPt,uPt,hPt,pPt,gPt,vPt,wPt,CPt,$Pt,kPt,YRt,REt,OPt,RPt,MPt,LPt,UPt,GPt,DEt,HPt,KPt,QPt,gDt];for(const e of JPt)mW(e);class C8{constructor(t,n){Pu(this,"mu");Pu(this,"cov");Pu(this,"constraints",[]);Pu(this,"latestWeights",null);Pu(this,"lastPerf",{});this.mu=t,this.cov=n}addConstraint(t){this.constraints.push(t)}async optimize(t,n="minimize",r=1){const i=this.mu.length,a=gG(Up([i],1/i)),s=Tn(this.mu),o=nc(this.cov),l=d=>{let p=t(d,s,o);n==="maximize"&&(p=Ye(p));for(const g of this.constraints)p=p.add(g(d));return p},c=rl.adam(.05);for(let d=0;d<200;++d)c.minimize(()=>l(a),!1),a.assign(a.div(a.sum()).mul(r));const h=Array.from(await a.data());return this.latestWeights=h,this._updateStats(h,t),a.dispose(),s.dispose(),o.dispose(),h}_updateStats(t,n){const r=t.reduce((c,h,d)=>c+h*this.mu[d],0);let i=0;for(let c=0;c<t.length;++c)for(let h=0;h<t.length;++h)i+=t[c]*t[h]*this.cov[c][h];i=Math.sqrt(i);const a=Tn(t),s=Tn(this.mu),o=nc(this.cov),l=n(a,s,o).arraySync();this.lastPerf={ret:r,risk:i,obj:l},a.dispose(),s.dispose(),o.dispose()}getWeights(){return this.latestWeights}getPerformance(){return this.lastPerf}}function T8(e,t,n){return vs(e,vs(n,e))}function t3t(e,t,n){const r=Rt(e.mul(t)),i=Nn(vs(e,vs(n,e)));return r.div(i.add(1e-8))}function e3t(e,t,n){const r=Tn(n.arraySync().map((o,l)=>Math.sqrt(o[l]))),i=Rt(e.mul(r)),a=Nn(vs(e,vs(n,e))),s=i.div(a);return r.dispose(),a.dispose(),s}function n3t(e=1e3){return t=>Ct(Rt(Dr(t.sub(1))),Rt(Dr(Ye(t).sub(1)))).mul(e)}function r3t(e,t=1e3){return n=>_e(Rt(n).sub(e)).mul(t)}function i3t(e=1e3){return t=>Rt(Dr(Ye(t))).mul(e)}function a3t(e=1e3){return t=>_e(Rt(t).sub(1)).mul(e)}function s3t(e,t,n=1e3){return r=>sz(e.map((i,a)=>Dr(de(i).sub(r.slice([a],[1]))))).add(sz(t.map((i,a)=>Dr(r.slice([a],[1]).sub(de(i)))))).mul(n)}function o3t(e,t,n=1e3){return r=>Rt(Vp(r,e)).sub(t).relu().mul(n)}function l3t(e,t,n=1e3){return r=>de(t).sub(Rt(Vp(r,e))).relu().mul(n)}function u3t(e,t=1e3){return n=>Dr(Pi(n).sub(e)).mul(t)}function c3t(e,t=1e3){return n=>Dr(Vt(de(e),Cd(n))).mul(t)}function f3t(e,t,n=1e3){return r=>{const i=Tn(e),a=Rt(sr(r.sub(i))).sub(t).relu().mul(n);return i.dispose(),a}}function h3t(e,t,n=1e3){return r=>{const i=nc(e),a=Nn(vs(r,vs(i,r))),s=xe(i,r.reshape([-1,1])).div(a),o=r.mul(s.reshape([r.shape[0]])).div(a),l=Rt(Dr(o.sub(t))).mul(n);return i.dispose(),s.dispose(),o.dispose(),a.dispose(),l}}async function d3t(e,t,n,r){const i=Math.min(...e),a=Math.max(...e),s=[];for(let o=0;o<n;++o){const l=i+(a-i)*o/(n-1),c=new C8(e,t);r.forEach(p=>c.addConstraint(p)),c.addConstraint(p=>{const g=Tn(e),v=Rt(p.mul(g)),x=_e(v.sub(l)).mul(1e3).asScalar();return g.dispose(),x}),await c.optimize(T8,"minimize");const h=c.getWeights(),d=c.getPerformance();s.push({targetReturn:l,risk:d.risk,weights:h})}return s}const p3t={min_vol:{fn:T8,direction:"minimize"},max_sharpe:{fn:t3t,direction:"maximize"},max_div:{fn:e3t,direction:"maximize"}};function m3t(e){return e.map(t=>{switch(t.key){case"noShort":return n=>i3t()(n).asScalar();case"sumToOne":return n=>a3t()(n).asScalar();case"bounds":{const n=t.minVec.split(",").map(i=>Number(i.trim())),r=t.maxVec.split(",").map(i=>Number(i.trim()));return i=>s3t(n,r)(i).asScalar()}case"groupMax":{const n=t.groupIdx.split(",").map(r=>Number(r.trim()));return r=>o3t(n,Number(t.max))(r).asScalar()}case"groupMin":{const n=t.groupIdx.split(",").map(r=>Number(r.trim()));return r=>l3t(n,Number(t.min))(r).asScalar()}case"maxWeight":return n=>u3t(Number(t.max))(n).asScalar();case"betweenMinusOneAndOne":return n=>n3t()(n).asScalar();case"sumToTarget":return n=>r3t(Number(t.target))(n).asScalar();case"minWeight":return n=>c3t(Number(t.min))(n).asScalar();case"turnover":{const n=t.prevW.split(",").map(r=>Number(r.trim()));return r=>f3t(n,Number(t.maxTurnover))(r).asScalar()}case"riskBudget":{const n=JSON.parse(t.cov);return r=>h3t(n,Number(t.maxFraction))(r).asScalar()}default:throw new Error(`Unknown constraint key: ${t.key}`)}})}const g3t=["A","B","C"],y3t=[.12,.1,.08],v3t=[[.1,.03,.02],[.03,.12,.06],[.02,.06,.08]];function b3t(){const[e,t]=Tt.useState(g3t),[n,r]=Tt.useState(y3t),[i,a]=Tt.useState(v3t),[s,o]=Tt.useState("max_sharpe"),[l,c]=Tt.useState([{key:"sumToOne"},{key:"noShort"}]),[h,d]=Tt.useState([]),[p,g]=Tt.useState(null),[v,x]=Tt.useState(null),[b,w]=Tt.useState(!1),C=async()=>{w(!0);try{const T=m3t(l),$=new C8(n,i);T.forEach(R=>$.addConstraint(R));const{fn:A,direction:E}=p3t[s],O=l.find(R=>R.key==="sumToTarget"),N=O?Number(O.target):1;await $.optimize(A,E,N),g($.getWeights()),x($.getPerformance());const _=await d3t(n,i,30,T);d(_)}finally{w(!1)}};return Kt.jsxs("div",{style:{maxWidth:900,margin:"0 auto",padding:32},children:[Kt.jsx("h2",{children:"SAA Playground"}),Kt.jsx(QK,{assets:e,returns:n,cov:i,setAssets:t,setReturns:r,setCov:a}),Kt.jsx(JK,{objective:s,setObjective:o}),Kt.jsx(t7,{assets:e,constraints:l,setConstraints:c}),Kt.jsx("button",{onClick:C,disabled:b,style:{margin:"12px 0"},children:b?"Optimizing...":"Run Optimization"}),Kt.jsx(Zct,{data:h}),Kt.jsx(Qct,{weights:p,stats:v,assets:e})]})}ZK.createRoot(document.getElementById("root")).render(Kt.jsx(Tt.StrictMode,{children:Kt.jsx(b3t,{})}));
